function List(a){return this._index=0,this._array=[],this.isDisposed=!1,a&&this.init(a),this}function Map(a){if(this._map={},null!=a)for(var b in a)this.set(b,a[b])}function SystemNodeList(){return this._entityTokens=new List([]),this}function _LocalStorage(){}function _BroadcastMessages(){}function _EventBroadcaster(){}function _Constants(){}function _Client(){var a=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase(),c="Microsoft Internet Explorer"==navigator.appName,d=!c&&"undefined"!=typeof document.createTreeWalker,e=d&&(a.indexOf("webrunner")>-1||a.indexOf("prism")>-1),f=null!=history.pushState;this.isMozilla=d,this.isFirefox=a.indexOf("firefox")>-1,this.isWebKit=a.indexOf("webkit")>-1,this.isPerformanceTest=a.indexOf("performance")>-1,this.isExplorer=c,this.isExplorer6=this.isExplorer&&(a.indexOf("msie 6.0")>-1||a.indexOf("msie 6.1")>-1),this.isExplorer8=this.isExplorer&&null!=window.XDomainRequest,this.isExplorer11=!!navigator.userAgent.match(/Trident\/7\./),this.isEdge=!!navigator.userAgent.match(/Edge\/\d+/g),this.isAnyExplorer=this.isExplorer||this.isExplorer11||this.isEdge,this.isPrism=e,this.isWindows=b.indexOf("win")>-1,this.isVista=this.isWindows&&a.indexOf("windows nt 6")>-1,this.isMac=b.indexOf("mac")>-1,this.isPad=null!=navigator.userAgent.match(/iPad/i),this.isOS7=null!=navigator.userAgent.match(/CPU.*OS 7_\d/i);var g=this._getFlashVersion();return this.hasFlash=g&&g>=9,this.hasTransitions=f,this.canvas=!!document.createElement("canvas").getContext,this.hasSpellcheck=!0,this.hasXSLTProcessor=this.isMozilla&&!this.isExplorer11,this}function SystemLogger(a){this.identifier=a}function SystemTimer(a){this.logger=SystemLogger.getLogger("SystemTimer"),this._id=a,this._time=(new Date).getTime()}function _SystemDebug(){}function _Interfaces(){var a=SystemLogger.getLogger("Interfaces");this.isImplemented=function(b,c,d){var e=!0;for(var f in b)if(typeof c[f]==Types.UNDEFINED?e=!1:typeof b[f]!=typeof c[f]&&(e=!1),!e)break;return e||d&&a.fine(c+" invalid. Interface check abandoned at: "+f),e}}function _Types(){}function _KeyMaster(){}function _ImageProvider(){}function _Resolver(){}function _Download(){}function _Cookies(){}function _StatusBar(){function a(a,d,e,f){e&&(a=Resolver.resolveVars(a,e)),c?(c.setLabel(a),c.setImage(d),f&&c.startFadeOut(StatusBar.AUTOCLEAR_TIMEOUT)):b.error("Message not initialized for display: "+a)}this.AUTOCLEAR_TIMEOUT=5e3,this.GROUP_LANGUAGETOOLS="languagetools",this.document=null,this.state=null,this.ERROR="error",this.WARN="warn",this.BUSY="busy",this.READY="ready",this._groups=new Map;var b=SystemLogger.getLogger("StatusBar"),c=null,d="${icon:error}",e="${icon:warning}",f="${icon:loading}",g="${icon:message}",h=null,i=null,j=null,k=null;this.initialize=function(a){h=StringBundle.getString("ui","Website.App.StatusBar.Error"),i=StringBundle.getString("ui","Website.App.StatusBar.Warn"),j=StringBundle.getString("ui","Website.App.StatusBar.Busy"),k=StringBundle.getString("ui","Website.App.StatusBar.Ready"),c=a,this.document=a.bindingDocument},this.error=function(b,c){this.state=StatusBar.ERROR,b=b?b:h,a(b,d,c,!1)},this.warn=function(b,c){this.state=StatusBar.WARN,b=b?b:i,a(b,e,c,!1)},this.busy=function(b,c){this.state=StatusBar.BUSY,b=b?b:j,a(b,f,c,!1)},this.ready=function(b,c){this.state=StatusBar.READY,b=b?b:k,a(b,g,c,!0)},this.report=function(b,c,d,e){this.state=null,a(b,c,d,e)},this.clear=function(){this.state=null,c&&c.clear()},this.addToGroup=function(a,b){this._groups.has(a)||this._groups.set(a,c.addRight(ToolBarGroupBinding.newInstance(this.document))),this._groups.get(a).add(b)}}function _Localization(){EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,this),EventBroadcaster.subscribe(BroadcastMessages.LANGUAGES_UPDATED,this),EventBroadcaster.subscribe(BroadcastMessages.FROMLANGUAGE_UPDATED,this),EventBroadcaster.subscribe(BroadcastMessages.TOLANGUAGE_UPDATED,this)}function _Validator(){}function _DOMEvents(){}function _DOMSerializer(){}function _DOMUtil(){}function _XMLParser(){}function XPathResolver(){this.logger=SystemLogger.getLogger("XPathResolver"),this._evaluator=window.XPathEvaluator?new XPathEvaluator:null,this._nsResolver=null}function XSLTransformer(){this.logger=SystemLogger.getLogger("XSLTransformer"),this._processor=null,this._cache=null}function _CSSUtil(){}function _CSSComputer(){}function SystemNode(a){this.logger=SystemLogger.getLogger("SystemNode"),this._data=a,this._datas=null,this._actionProfile=null,this._propertyBag=null,this._registerSystemActions(),this.searchToken=null,null!=this._data.TagValue&&SystemNode.taggedNodes.set(this._data.TagValue,this)}function SystemAction(a){this.logger=SystemLogger.getLogger("SystemAction"),this._data=a,null!=this._data.TagValue&&SystemAction.taggedActions.set(this._data.TagValue,this)}function _UpdateManager(){var a=null;return window.UpdateManager||(this._construct(),a=this),a}function _UpdateAssistant(){var a=null;return window.UpdateAssistant||(this._construct(),a=this),a}function UpdatePlugin(){this.handleElement=function(a,b){var c=!1;switch(a.nodeName.toLowerCase()){case"input":case"textarea":switch(a.getAttribute("id")){case"__EVENTTARGET":case"__EVENTARGUMENT":case"__VIEWSTATE":case"__EVENTVALIDATION":c=!1}}return c},this.updateElement=function(a,b){var c=a.getAttribute("id"),d=document.getElementById(c);if(null!=d){var e=null;switch(d.nodeName.toLowerCase()){case"input":e=a.getAttribute("value");break;case"textarea":e=a.textContent?a.textContent:a.text}null==e&&(e=""),e!=d.value&&(d.value=e,UpdateManager.report('Property [value] updated on field "'+c+'"'))}return!0}}function Update(){return this}function ReplaceUpdate(a,b){return this.type=Update.TYPE_REPLACE,this.id=a,this.element=b,this}function SiblingUpdate(a,b,c,d){return this.type=a,this.id=b,this.element=c,this.isFirst=d,this}function AttributesUpdate(a,b,c){return this.type=type=Update.TYPE_ATTRIBUTES,this.id=a,this.element=b,this.currentElement=c,this._summary=[],this}function _WindowManager(){this._construct(KeyMaster.getUniqueKey())}function _Application(){this._construct()}function _Installation(){EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_KICKSTART,this)}function _Keyboard(){}function _Persistance(){}function StandardEventHandler(a,b){this.logger=SystemLogger.getLogger("StandardEventHandler ["+a.title+"]"),this._contextDocument=a,this._contextWindow=DOMUtil.getParentWindow(a),this.hasNativeKeys=!1,this._isAllowTabs=!1,this._isMouseHandlerOnly=b,this._addListeners()}function Action(a,b){this.target=a,this.type=b,this.listener=null,this.isConsumed=!1,this.isCancelled=!1}function Animation(a){this.id=KeyMaster.getUniqueKey(),this.interval=25,this.iterator=0,this.modifier=1,this.endcount=90;for(var b in a)this[b]=a[b]}function Point(a,b){this.x=a,this.y=b}function Dimension(a,b){this.w=a,this.h=b}function Geometry(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d}function BindingAcceptor(a){return this.logger=SystemLogger.getLogger("BindingDragger"),this._binding=a,this._acceptedList={},this._isAccepting=!1,this._corsor=null,this._initialize(),this}function BindingBoxObject(a){this._domElement=a.getBindingElement()}function BindingDragger(a){this.logger=SystemLogger.getLogger("BindingDragger"),this.binding=a,this.isDragReady=!1,this.isDragging=!1,this.startPoint=null,this.currentEvent=null}function BindingParser(a){this.logger=SystemLogger.getLogger("BindingParser"),this._ownerDocument=a,this._rootElement=null}function BindingSerializer(){this.logger=SystemLogger.getLogger("BindingSerializer"),this._dom=DOMUtil.getDOMDocument(),alert("BindingSerializer: Convert to Crawler!"),this._pointers=[]}function ImageProfile(a){this._default=a.image,this._hover=a.imageHover,this._active=a.imageActive,this._disabled=a.imageDisabled}function _BindingFinder(){}function NodeCrawler(){return this._construct(),this}function ElementCrawler(){return this._construct(),this}function BindingCrawler(){return this._construct(),this}function Crawler(){return this.id=null,this.response=null,this._construct(),this}function FlexBoxCrawler(){return this.id=FlexBoxCrawler.ID,this.mode=FlexBoxCrawler.MODE_NORMAL,this.startBinding=null,this._construct(),this}function FocusCrawler(){return this.id=FocusCrawler.ID,this._construct(),this}function FitnessCrawler(){return this.id=FitnessCrawler.ID,this.mode=FitnessCrawler.MODE_TRAINING,this._construct(),this}function _DocumentUpdatePlugin(){null!=window.UpdateManager&&(UpdateManager.plugins.push(this),this._setup())}function DocumentCrawler(){return this.mode=DocumentCrawler.MODE_REGISTER,this.id=DocumentCrawler.ID,this._construct(),this}function _DocumentManager(){this._construct()}function _DataManager(){}function _Templates(){}function DialogButton(a){if(this.label=null,this.image=null,this.response=null,this.isFocusable=!0,this.isDefault=!1,this.isFocused=!1,a)for(var b in a)"undefined"!=typeof this[b]&&(this[b]=a[b])}function _Dialog(){}function _Commands(){this._construct()}function _Prism(){}function Uri(a){var b=/^(~?\/|(\.\.\/)+|https?:\/\/[\w\d-\.:]*\/)(media|page)(\(|%28)[\w\d-\:]+(\)|%29)/,c=b.exec(a?a:"");c&&("media"==c[3]?this.isMedia=!0:"page"==c[3]&&(this.isPage=!0));var d={};return a.replace(/^[^\?]*/g,"").replace(/([^?=&]+)(=([^&]*))?/g,function(a,b,c,e){d[b]=e}),this.queryString=d,this.path=a.replace(/\?.*/g,""),this.isInternalUrl=0===a.indexOf("~/"),this}function ViewDefinition(){}function SystemViewDefinition(a){this.node=a,this.argument=a,this.url=SystemViewDefinition.DEFAULT_URL,this.handle=a.getHandle(),this.label=a.getLabel(),this.image=a.getImageProfile().getDefaultImage(),this.toolTip=a.getToolTip()}function HostedViewDefinition(a){if(this.position=DockBinding.MAIN,this.perspective=null,this.entityToken=null,this.label=null,this.image=null,a)for(var b in a){if(!this[b]&&null!=this.prop)throw"Property not recognized: "+b;this[b]=a[b],this.url&&(this.url=Resolver.resolve(this.url))}}function DialogViewDefinition(a){if(this.handler=null,this.position=Dialog.MODAL,this.label=null,this.image=null,this.width=null,this.height=null,a)for(var b in a){if(!this[b]&&null!=this.prop)throw"Property not recognized: "+b;if(this[b]=a[b],this.url&&(this.url=Resolver.resolve(this.url)),this.handler&&!Interfaces.isImplemented(IDialogResponseHandler,this.handler))throw"IDialogResponseHandler not implemented"}}function Binding(){this.logger=SystemLogger.getLogger("binding"),this.key=null,this.bindingElement=null,this.bindingDocument=null,this.bindingWindow=null,this.shadowTree=null,this.actionListeners=null,this.contextMenuBinding=null,this.isRegistered=!1,this.isAttached=!1,this.isInitialized=!1,this.isDisposed=!1,this.isDraggable=!1,this.dragger=null,this.memberDependencies=null,this.dependentBindings=null,this.propertyMethodMap=null,this.isBlockingActions=!1,this.isVisible=!0,this.boxObject=null,this.dragType=null,this.dragAccept=null,this.dragReject=!1,this.acceptor=null,this.isLazy=!1,this._persist=null,this.isBindingBuild=!1,this._hasActivationAwareness=!1,this.isFlexSuspended=!1,this.crawlerFilters=null,this._subscriptions=null}function DataBinding(){return this.logger=SystemLogger.getLogger("DataBinding"),this._name=null,this.isDirty=!1,this.isFocusable=!0,this.isFocused=!1,this.error=null,this}function RootBinding(){return this.logger=SystemLogger.getLogger("RootBinding"),this.isActivationAware=!1,this.isActivated=!1,this._activationawares=null,this}function StyleBinding(){return this.logger=SystemLogger.getLogger("StyleBinding"),this.style=null,this.href=null,this}function FlexBoxBinding(){return this.logger=SystemLogger.getLogger("FlexBoxBinding"),this.isFlexSuspended=!1,this.isFlexible=!0,this.isFit=!0,this}function ScrollBoxBinding(){this.logger=SystemLogger.getLogger("ScrollBoxBinding")}function LabelBinding(){return this.logger=SystemLogger.getLogger("LabelBinding"),this.hasImage=!1,this.hasLabel=!1,this.isFlipped=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TextBinding(){return this.logger=SystemLogger.getLogger("TextBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function BroadcasterSetBinding(){this.logger=SystemLogger.getLogger("BroadcasterSetBinding")}function BroadcasterBinding(){this.logger=SystemLogger.getLogger("BroadcasterBinding"),this._observers=null}function ButtonBinding(){this.logger=SystemLogger.getLogger("ButtonBinding"),this.isCheckButton=!1,this.isRadioButton=!1,this.isComboButton=!1,this.isCheckBox=!1,this.isActive=!1,this.isChecked=!1,this.isDisabled=!1,this.isFocusable=!1,this._isFocusableButton=!1,this.isFocused=!1,this.isDefault=!1,this.popupBinding=null,this.labelBinding=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.imageProfile=null,this._stateManager=null,this.response=null,this.popupBindingTargetElement=null,this.commandAction=ButtonBinding.ACTION_COMMAND,this.isFlipped=!1,this.isDirty=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID])}function ButtonStateManager(a){return this.logger=SystemLogger.getLogger("ButtonStateManager"),this.binding=a,this.imageProfile=a.imageProfile,this.assignDOMEvents(!0),this}function ClickButtonBinding(){this.logger=SystemLogger.getLogger("ClickButtonBinding")}function RadioButtonBinding(){return this.logger=SystemLogger.getLogger("RadioButtonBinding"),this.isRadioButton=!0,this}function CheckButtonBinding(){this.logger=SystemLogger.getLogger("CheckButtonBinding"),this.isCheckButton=!0,this.isCheckBox=!0}function ViewButtonBinding(){return this}function ControlGroupBinding(){return this.logger=SystemLogger.getLogger("ControlGroupBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function ControlBinding(){this.logger=SystemLogger.getLogger("ControlBinding"),this.controlType=null,this.commandAction=ControlBinding.ACTION_COMMAND,this.containingControlBoxBinding=null,this.isVisible=!0,this.isGhostable=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID])}function ControlBoxBinding(){this.logger=SystemLogger.getLogger("ControlBoxBinding"),this.isNormalized=!0,this.isMaximized=!1,this.isMinimized=!1}function MenuContainerBinding(){this.logger=SystemLogger.getLogger("MenuContainerBinding"),this._isOpen=!1,this._openElement=null,this.menuContainerBinding=null,this.menuPopupBinding=null}function MenuBarBinding(){return this.logger=SystemLogger.getLogger("MenuBarBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function MenuBinding(){this.logger=SystemLogger.getLogger("MenuBinding"),this.labelBinding=null,this.isFocused=!1}function MenuBodyBinding(){this.logger=SystemLogger.getLogger("MenuBodyBinding"),this._containingPopupBinding=null,this._focused=null,this._lastFocused=null,this._showSubMenuTimeout=null,this.arrowKey=null,this.isDirty=!0,this._hasImageLayout=!1,this._hasCheckBoxLayout=!1}function MenuGroupBinding(){this.logger=SystemLogger.getLogger("MenuGroupBinding"),this.isVisible=!0}function MenuItemBinding(){this.logger=SystemLogger.getLogger("MenuItemBinding"),this.type=null,this.oncommand=null,this.isDisabled=!1,this.labelBinding=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.imageProfile=null,this.isMenuContainer=!1,this.hasAction=!0,this.isTypeSet=!1,this.isChecked=!1,this.isFocused=!1,this._containingMenuBodyBinding=null}function PopupSetBinding(){return this.logger=SystemLogger.getLogger("PopupSetBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function PopupBinding(){return this.logger=SystemLogger.getLogger("PopupBinding"),this._bodyBinding=null,this.position=null,this.isVisible=!1,this.onshow=null,this.onhide=null,this.geometry=null,this._menuItems=null,this._menuGroups=null,this._menuItemCount=0,this.type=PopupBinding.TYPE_NORMAL,this._isOverflow=!1,this.hasImages=!0,this}function PopupBodyBinding(){this.logger=SystemLogger.getLogger("PopupBodyBinding")}function MenuPopupBinding(){return this.logger=SystemLogger.getLogger("MenuPopupBinding"),this}function DialogBinding(){return this.logger=SystemLogger.getLogger("DialogBinding"),this.isFlexible=!1,this._head=null,this._body=null,this._cover=null,this._titlebar=null,this._border=null,this.startPoint=null,this.geometry=null,this.isActive=!1,this.isActivatable=!1,this.isVisible=!1,this._isResizable=!0,this.isDialogResizable=!0,this.isModal=!1,this.mode=null,this.controlBindings={},this._index=null,this._hasTransitions=!1,this}function DialogHeadBinding(){this.logger=SystemLogger.getLogger("DialogHeadBinding")}function DialogBodyBinding(){this.logger=SystemLogger.getLogger("DialogBodyBinding"),this.panelBinding=null,this.isVisible=!0,this._dialogBinding=null}function DialogSetBinding(){this.logger=SystemLogger.getLogger("DialogSetBinding")}function DialogBorderBinding(){this.logger=SystemLogger.getLogger("DialogBorderBinding"),this.isDraggable=!0,this._type=null}function DialogCoverBinding(){this.logger=SystemLogger.getLogger("DialogCoverBinding"),this._dialogBinding=null}function DialogTitleBarBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarBinding"),this.bodyBinding=null,this.labelBinding=null,this._controlGroupBinding=null,this.isDraggable=!0}function DialogTitleBarBodyBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarBodyBinding")}function DialogControlBinding(){this.logger=SystemLogger.getLogger("DialogControlBinding"),this.isGhostable=!0}function DialogTitleBarPopupBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarPopupBinding")}function WindowBindingHighlightNodeCrawler(){return this._keywords=null,this._map=new Map,this._textnodes=null,this._construct(),this}function WindowBinding(){return this.logger=SystemLogger.getLogger("WindowBinding"),this._target=null,this._parameterMap=null,this._pageBinding=null,this._isReloading=!1,this._onloadHandler=null,this._unloadHandler=null,this._hasLoadActionFired=!1,this._native=!1,this}function PreviewWindowBinding(){return this.logger=SystemLogger.getLogger("PreviewWindowBinding"),this._postBackList=null,this._postBackURL=null,this._coverBinding=null,this._windowBinding=null,this._errorBinding=null,this._hasFullStop=!1,this._isReturning=!1,this._loadhandler=null,this._timeout=null,this}function RadioGroupBinding(){return this.logger=SystemLogger.getLogger("RadioGroupBinding"),this._checkedRadioBinding=null,this._radioButtonBindings=null,this._isUpToDate=!1,this}function DataBindingMap(a){this._map=a?a:{},this.type=DataBindingMap.TYPE_RESULT}function DataInputBinding(){return this.logger=SystemLogger.getLogger("DataInputBinding"),this.type=null,this.isRequired=!1,this.expression=null,this.isPassword=!1,this._value=null,this._isValid=!0,this._isInvalidBecauseRequired=!1,1==this._isInvalidBecauseMinLength,1==this._isInvalidBecauseMinLength,1==this._isInvalidBecauseMaxLength,this._sessionResult=null,this.isDisabled=!1,this.isReadOnly=!1,this._dirtyinterval=null,this._isAutoSelect=!1,this.minlength=null,this.maxlength=null,this._isAutoPost=!1,this._timeout=null,this._time=1500,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.spellcheck=!0,this}function TextBoxBinding(){return this.logger=SystemLogger.getLogger("TextBoxBinding"),this._hasWordWrap=!0,this}function EditorTextBoxBinding(){this.logger=SystemLogger.getLogger("EditorTextBoxBinding"),this._hasWordWrap=!1}function IEEditorTextBoxBinding(){this.logger=SystemLogger.getLogger("IEEditorTextBoxBinding")}function MozEditorTextBoxBinding(){return this.logger=SystemLogger.getLogger("MozEditorTextBoxBinding"),this}function SelectorBinding(){this.logger=SystemLogger.getLogger("SelectorBinding"),this.type=null,this._buttonBinding=null,this._popupBinding=null,this._isLocal=!1,this._menuBodyBinding=null,this._selectionValue=null,this._selectionLabel=null,this._searchString="",this.isSearchSelectionEnabled=!0,this.selections=null,this.isDisabled=!1,this.label=null,this.value=null,this.width=null,this.defaultSelection=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.isDirty=!1,this._isUpToDate=!1,this._hasKeyboard=!1,this.BUTTON_IMPLEMENTATION=ClickButtonBinding,this.MENUITEM_IMPLEMENTATION=MenuItemBinding,this._isImageLayout=!0,this.isRequired=!1,this._isValid=!0,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID])}function SimpleSelectorBinding(){return this.logger=SystemLogger.getLogger("SimpleSelectorBinding"),this._select=null,this.isRequired=!1,this._isValid=!0,this._cachewidth=0,this}function SelectorBindingSelection(a,b,c,d,e){this._init(a,b,c,d,e)}function DataInputSelectorBinding(){this.logger=SystemLogger.getLogger("DataInputSelectorBinding"),this._buttonBinding=null,this._popupBinding=null,this._menuBodyBinding=null,this._selectionValue=null,this.isDirty=!1,this._hasKeyboard=!1,this._isUpToDate=!1,this._selectedItemBinding=null,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.value=null}function DataInputDialogBinding(){this.logger=SystemLogger.getLogger("DataInputDialogBinding"),this._handle=null,this._dialogButtonBinding=null,this._isButtonClicked=!1}function UrlInputDialogBinding(){this.logger=SystemLogger.getLogger("UrlInputDialogBinding"),this.editButtonBinding=null,this.labelBinding=null}function DataInputButtonBinding(){this.logger=SystemLogger.getLogger("DataInputButtonBinding"),this._dialogButtonBinding=null}function DataDialogBinding(){this.logger=SystemLogger.getLogger("DataDialogBinding"),this._buttonBinding=null,this._handler=null,this._map=null,this._dialogViewHandle=null,this._hasKeyboard=!1,this._hasFocus=!1,this.isRequired=!1,this._isValid=!0}function PostBackDataDialogBinding(){return this.input=null,this}function ViewDefinitionPostBackDataDialogBinding(){return this.logger=SystemLogger.getLogger("ViewDefinitionPostBackDataDialogBinding"),this}function NullPostBackDataDialogBinding(){return this.logger=SystemLogger.getLogger("NullPostBackDataDialogBinding"),this._datathing=null,this._selector=null,this.isFocusable=!1,this}function NullPostBackDataDialogSelectorBinding(){return this.logger=SystemLogger.getLogger("NullPostBackDataDialogSelectorBinding"),this.master=null,this}function MultiSelectorBinding(){this.logger=SystemLogger.getLogger("MultiSelectorBinding"),this.isEditable=!0,this.isSelectable=!1,this._dataDialogBinding=null,this.selections=null,this._selectionMap=null,this._display=MultiSelectorBinding.DISPLAY_SELECTED,this._lastSelectedElement=null,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID])}function HierarchicalSelectorBinding(){this.logger=SystemLogger.getLogger("HierarchicalSelectorBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.autoSelectChildren=!1,this.autoSelectParents=!0,this.isRequired=!1}function HTMLDataDialogBinding(){this.logger=SystemLogger.getLogger("HTMLDataDialogBinding")}function MultiSelectorDataDialogBinding(){return this.logger=SystemLogger.getLogger("MultiSelectorDataDialogBinding"),this._dialogViewHandle="Composite.Management.MultiSelectorDialog",this.isFocusable=!1,this.selections=null,this}function LazyBindingSetBinding(){this.logger=SystemLogger.getLogger("LazyBindingSetBinding")}function LazyBindingBinding(){this.logger=SystemLogger.getLogger("LazyBindingBinding"),this.isFocusable=!1,this._isLazy=!1}function EditorDataBinding(){return this.logger=SystemLogger.getLogger("EditorDataBinding"),this.isFocusable=!1,this._url=WindowBinding.DEFAULT_URL,this.isDirty=!1,this}function FunctionEditorDataBinding(){return this.logger=SystemLogger.getLogger("FunctionEditorDataBinding"),this._url="${root}/content/misc/editors/functioncalleditor/functioncalleditor.aspx?StateProvider=${stateprovider}&Handle=${handle}",this.hasBasic=!1,this}function ParameterEditorDataBinding(){return this.logger=SystemLogger.getLogger("ParameterEditorDataBinding"),this._url="${root}/controls/FormsControls/FormUiControlTemplates/DeveloperTools/FunctionParameterEditor.aspx?StateProvider=${stateprovider}&handle=${handle}",this}function FilePickerBinding(){return this.logger=SystemLogger.getLogger("FilePickerBinding"),this.isReadOnly=!0,this._isValid=!0,this}function RequestBinding(){return this.logger=SystemLogger.getLogger("RequestBinding"),this}function FieldGroupBinding(){this.logger=SystemLogger.getLogger("FieldGroupBinding")}function FieldBinding(){return this.logger=SystemLogger.getLogger("FieldBinding"),this.bindingRelation=null,this}function FieldsBinding(){return this.logger=SystemLogger.getLogger("FieldsBinding"),this._invalidCount=0,this._invalidFieldLabels=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FitnessCrawler.ID]),this}function FieldDescBinding(){return this.logger=SystemLogger.getLogger("FieldDescBinding"),this}function FieldDataBinding(){return this.logger=SystemLogger.getLogger("FieldDataBinding"),this}function FieldHelpBinding(){return this.logger=SystemLogger.getLogger("FieldHelpBinding"),this}function ResolverContainerBinding(){return this.logger=SystemLogger.getLogger("ResolverContainerBinding"),this}function RadioDataGroupBinding(){this.logger=SystemLogger.getLogger("RadioDataGroupBinding"),this._name=null,this.isDirty=!1,this._hasFocus=!1,this.isFocusable=!0,this.isFocused=!1}function RadioDataBinding(){return this.logger=SystemLogger.getLogger("RadioDataBinding"),this.isRadioButton=!1,this.isChecked=!1,this._result=null,this.bindingRelate=null,this}function CheckBoxBinding(){this.logger=SystemLogger.getLogger("CheckBoxBinding"),this._buttonBinding=null,this._name=null,this.isDirty=!1,this.isChecked=!1,this._result=null,this.isFocusable=!0,this.isFocused=!1}function CheckBoxGroupBinding(){this.logger=SystemLogger.getLogger("CheckBoxGroupBinding"),this.isRequired=!1,this.isValid=!0}function BalloonSetBinding(){this.logger=SystemLogger.getLogger("BalloonSetBinding")}function BalloonBinding(){return this.logger=SystemLogger.getLogger("BalloonBinding"),this._snapTargetBinding=null,this._environmentBinding=null,this}function ErrorBinding(){return this.logger=SystemLogger.getLogger("ErrorBinding"),this}function FocusBinding(){return this.logger=SystemLogger.getLogger("FocusManangerBinding"),this._focusableList=null,this._isUpToDate=!1,this._isFocusManager=!0,this.isStrongFocusManager=!0,this._cachedFocus=null,this.isFlexible=!1,this}function TabsButtonBinding(){this.logger=SystemLogger.getLogger("TabsButtonBinding"),this.hiddenTabBindings=null,this.menuItemBindings=null,this.containingTabBoxBinding=null,this.selectedTabBinding=null,this.isVisible=!1,this.snapshotWindowWidth=null}function TabBoxBinding(){return this.logger=SystemLogger.getLogger("TabBoxBinding"),this._tabBoxPairs={},this._selectedTabElement=null,this._selectedTabBinding=null,this._tabsElement=null,this._tabPanelsElement=null,this._attachedMemberCount=0,this._isMembersAttached=!1,this.isEqualSize=!1,this._nodename_tab="tab",this._nodename_tabs="tabs",this._nodename_tabpanel="tabpanel",this._nodename_tabpanels="tabpanels",this._impl_tab=TabBinding,this._impl_tabs=TabsBinding,this._impl_tabpanel=TabPanelBinding,this._impl_tabpanels=TabPanelsBinding,this.updateType=null,this._hasBastardUpdates=!1,this}function TabsBinding(){return this.logger=SystemLogger.getLogger("TabsBinding"),this.containingTabBoxBinding=null,this.tabsButtonBinding=null,this._cachedOffsetWidth=parseInt(0),this.isManaging=!1,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TabBinding(){return this.logger=SystemLogger.getLogger("TabBinding"),this.tabboxkey=null,this.isSelected=!1,this.labelBinding=null,this.containingTabBoxBinding=null,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TabPanelsBinding(){this.logger=SystemLogger.getLogger("TabPanelsBinding"),this.containingTabBoxBinding=null,this._lastKnownDimension=null}function TabPanelBinding(){return this.logger=SystemLogger.getLogger("TabPanelBinding"),this.tabboxkey=null,this.isVisible=!1,this._focusedBinding=null,this}function SplitBoxBinding(){return this.logger=SystemLogger.getLogger("SplitBoxBinding"),this._orient=SplitBoxBinding.ORIENT_HORIZONTAL,this.isLayoutInitialized=!1,this._isFirstLayout=!0,this}function SplitPanelBinding(){return this.logger=SystemLogger.getLogger("SplitPanelBinding"),this._containingSplitBoxBinding=null,this.isCollapsed=!1,this.isFixed=!1,this.isVisible=!0,this._fixedSpan=null,this.isFlexible=!0,this}function SplitterBinding(){return this.logger=SystemLogger.getLogger("SplitterBinding"),this.isDraggable=!0,this.isDragging=!1,this.isCollapsed=!1,this.isDisabled=!0,this._containingSplitBoxBinding=null,this._collapseDirection=SplitterBinding.COLLAPSE_AFTER,this.offset=null,this}function DecksBinding(){this.logger=SystemLogger.getLogger("DecksBinding"),this._selectedDeckBinding=null,this._lastKnownDimension=null}function DeckBinding(){return this.logger=SystemLogger.getLogger("DeckBinding"),this.isSelected=!1,this.isVisible=!1,this.containingDecksBinding=null,this}function ToolBarBinding(){return this.logger=SystemLogger.getLogger("ToolBarBinding"),this.hasImages=!0,this.hasText=!0,this._imageSize=ToolBarBinding.IMAGESIZE_NORMAL,this.type=ToolBarBinding.TYPE_DEFAULT,this._hasDefaultContent=!0,this._toolBarBodyRight=null,this._toolBarBodyLeft=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID]),this._hasDOMContent=!1,this}function ToolBarBodyBinding(){return this.logger=SystemLogger.getLogger("ToolBarBodyBinding"),this.isRightAligned=!1,this}function ToolBarGroupBinding(){this.logger=SystemLogger.getLogger("ToolBarGroupBinding"),this.isDefaultContent=!1}function ToolBarButtonBinding(){this.logger=SystemLogger.getLogger("ToolBarButtonBinding")}function ToolBarLabelBinding(){this.logger=SystemLogger.getLogger("ToolBarLabelBinding")}function DialogToolBarBinding(){return this.logger=SystemLogger.getLogger("DialogToolBarBinding"),this._buttons=null,this._defaultButton=null,this._focusedButton=null,this._isListening=!1,this.crawlerFilters=new List([FlexBoxCrawler.ID]),this}function ComboBoxBinding(){return this.logger=SystemLogger.getLogger("ComboBoxBinding"),this}function ToolBarComboButtonBinding(){return this.logger=SystemLogger.getLogger("ToolBarComboButtonBinding"),this.isComboButton=!0,this.isCheckButton=!0,this.keepState=!0,this.alignWidth=!1,this}function ToolBoxToolBarButtonBinding(){return this.logger=SystemLogger.getLogger("ToolBoxToolBarButtonBinding"),this._views=new Map,this._lastGeneratedPerspective=null,this}function TreeBinding(){return this.logger=SystemLogger.getLogger("TreeBinding"),this.isFocusable=!0,this.isFocused=!1,this._treeBodyBinding=null,this._positionIndicatorBinding=null,this._treeNodeBuffer=null,this._treeNodeBindings=null,this._focusedTreeNodeBindings=null,this._isFocusable=!0,this._isSelectable=!1,this._selectionProperty=null,this._selectonValue=null,this._selectedTreeNodeBindings=null,this._selectionType=TreeBinding.SELECTIONTYPE_SINGLE,this._actionFilter=null,this._acceptingPosition=null,this._acceptingDimension=null,this._acceptingTreeNodeBinding=null,this._acceptingPositions=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID]),this._hasKeyboard=!1,this._yposition=0,this._openTreeNodesBackupMap=null,this}function TreeBodyBinding(){return this.logger=SystemLogger.getLogger("TreeBodyBinding"),this.containingTreeBinding=null,this}function TreeNodeBinding(){return this.logger=SystemLogger.getLogger("TreeNodeBinding"),this.hasBeenOpened=!1,this.isDisabled=!1,this.isFocused=!1,this.isOpen=!1,this.isPinned=!1,this.isContainer=!1,this.imageProfile=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.containingTreeBinding=null,this}function TreeContentBinding(){return this.logger=SystemLogger.getLogger("TreeContentBinding"),this}function TreePositionIndicatorBinding(){this.logger=SystemLogger.getLogger("TreePositionIndicatorBinding"),
this._geometry={x:0,y:0}}function TreeCrawler(){return this.mode=TreeCrawler.MODE_GETOPEN,this.id=TreeCrawler.ID,this._construct(),this}function CheckTreeBinding(){return this.logger=SystemLogger.getLogger("CheckTreeBinding"),this}function CheckTreeNodeBinding(){return this.logger=SystemLogger.getLogger("CheckTreeNodeBinding"),this.selectionElement=null,this.selectionValue=null,this.isSelectable=!0,this.isReadOnly=!1,this}function DockTabsButtonBinding(){this.logger=SystemLogger.getLogger("DockTabsButtonBinding")}function DockBinding(){this.logger=SystemLogger.getLogger("DockBinding"),this.isActive=!1,this.isActivatable=!0,this.type=null,this.reference=null,this.isCollapsed=!1,this.isEmpty=!0,this._containingSplitPanelBinding=null,this._viewBindingList=null,this.perspectiveNode=null,this._nodename_tab="docktab",this._nodename_tabs="docktabs",this._nodename_tabpanel="dockpanel",this._nodename_tabpanels="dockpanels",this._impl_tab=DockTabBinding,this._impl_tabs=DockTabsBinding,this._impl_tabpanel=DockPanelBinding,this._impl_tabpanels=DockPanelsBinding}function DockTabsBinding(){this.logger=SystemLogger.getLogger("DockTabsBinding")}function DockTabBinding(){return this.logger=SystemLogger.getLogger("DockTabBinding"),this.perspectiveNode=null,this._controlGroupBinding=null,this._viewBinding=null,this.isDirty=!1,this.isPinned=!1,this.isInitiallyHidden=!0,this._entityToken=null,this._canUpdateTree=!0,this}function DockPanelsBinding(){return this.logger=SystemLogger.getLogger("DockPanelsBinding"),this.isVisible=!0,this}function DockPanelBinding(){return this.logger=SystemLogger.getLogger("DockPanelBinding"),this.viewBinding=null,this}function DockTabPopupBinding(){this.logger=SystemLogger.getLogger("DockTabPopupBinding")}function ViewSetBinding(){return this.logger=SystemLogger.getLogger("ViewSetBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function ViewBinding(){return this.logger=SystemLogger.getLogger("ViewBinding"),this._viewDefinition=null,this.isVisible=!1,this._isViewBindingInitialized=!1,this._snapBinding=null,this.isFreeFloating=!1,this.windowBinding=null,this._coverBinding=null,this._isLoaded=!1,this._isFirstShow=!0,this._type=ViewBinding.TYPE_DOCKVIEW,this._pageBinding=null,this._lastknownposition=null,this._lastknowndimension=null,this.isActivated=!1,this}function PageBinding(){this.logger=SystemLogger.getLogger("PageBinding"),this.label=null,this.image=null,this.toolTip=null,this._isPageBindingInitialized=!1,this.pageArgument=null,this.isDialogSubPage=!1,this.isFitAsDialogSubPage=!0,this._initBlockers=null,this._isReadyForInitialize=!1,this.isActivationAware=!1,this.isActivated=!1,this.isNonAjaxPage=!1,this._canPostBack=!0,this._responseResolver=null,this._isUpdating=!1}function DialogPageBinding(){this.logger=SystemLogger.getLogger("DialogPageBinding"),this.response=null,this.result=null,this.width=null,this.height=null,this.minheight=null,this.controls=null,this.isResizable=null,this.isAutoHeightLayoutMode=!1,this.isNonAjaxPage=!0}function DialogPageBodyBinding(){this.logger=SystemLogger.getLogger("DialogPageBodyBinding")}function EditorPageBinding(){this.logger=SystemLogger.getLogger("EditorPageBinding"),this.isDirty=!1,this._tabBoxBinding=null,this._tabBinding=null,this._windowBinding=null,this._isGeneratingPreview=!1,this._isPreviewWindowVisible=!1,this._message=null,this._messages=null,this._messengers=null,this._isWaitingForPreview=!1,this._isPreviewing=!1}function ResponsePageBinding(){this.logger=SystemLogger.getLogger("ResponsePageBinding"),this.responseid=null}function WizardPageBinding(){return this.logger=SystemLogger.getLogger("WizardPageBinding"),this}function MarkupAwarePageBinding(){return this.logger=SystemLogger.getLogger("MarkupAwarePageBinding"),this._isActivated=!1,this._isWaiting=!1,this}function SystemToolBarBinding(){return this.logger=SystemLogger.getLogger("SystemToolBarBinding"),this._currentProfileKey=null,this._actionFolderNames={},this._actionProfile=null,this._moreActionsWidth=0,this._moreActions=null,this._node=null,this._syncHandle=null,this._activePosition=SystemAction.activePositions.NavigatorTree,this._keepBundleState=!1,this}function SystemTreeBinding(){this.logger=SystemLogger.getLogger("SystemTreeBinding"),this.perspectiveNode=null,this._defaultTreeNode=null,this._isActionProfileAware=!0,this._activePosition=SystemAction.activePositions.NavigatorTree,this._actionGroup=null,this._backupfocushandle=null,this._tempSelectedNode=null,this._tempSelectionTimeout=!1,this._entityTokenRegistry=null,this._refreshingTreeNodes=null,this._refreshToken=null,this.isLockedToEditor=!1,this._restorableFocusHandle=null}function SystemTreePopupBinding(){this.logger=SystemLogger.getLogger("SystemTreePopupBinding"),this._currentProfileKey=null,this._actionProfile=null,this._node=null,this._keepBundleState=!1,this.selectedTreeNodeBinding=null}function SystemTreeNodeBinding(){this.logger=SystemLogger.getLogger("SystemTreeNodeBinding"),this.perspectiveNode=null,this._isForcedOpen=!1,this.node=null,this.autoExpand=!1}function SystemPageBinding(){this.logger=SystemLogger.getLogger("SystemPageBinding"),this.node=null,this._tree=null}function StageContainerBinding(){this.logger=SystemLogger.getLogger("StageContainerBinding")}function StageBinding(){return this.logger=SystemLogger.getLogger("StageBinding"),this._activeViewDefinitions={},this._decksBinding=null,this._explorerBinding=null,this._isStageReady=!1,this._isExplorerReady=!1,this._isDecksReady=!1,this._dockBindings=new Map,this._isShowingStart=!1,this.isActivationAware=!1,this}function StageCrawler(){return this.mode=StageCrawler.MODE_MAXIMIZE,this.id=StageCrawler.ID,this._construct(),this}function StageDialogSetBinding(){this.logger=SystemLogger.getLogger("StageDialogSetBinding"),this._dialogs=new List}function StageDialogBinding(){return this.logger=SystemLogger.getLogger("StageDialogBinding"),this._viewBinding=null,this._pageBinding=null,this._dialogResponseHandler=null,this._isFirstPage=!0,this}function StageDecksBinding(){this.logger=SystemLogger.getLogger("StageDecksBinding"),this._decks={}}function StageDeckBinding(){this.logger=SystemLogger.getLogger("StageDeckBinding"),this.handle=null,this._isRefreshRequired=!1,this.perspectiveNode=null,this.isReady=!1,this._isStageDeckBindingInitialized=!1,this._dockBindings=null,this._dockBindingCount=0,this.windowBinding=null,this.isSubPanelMaximized=!1,this.definition=null}function StageDeckRootBinding(){this.logger=SystemLogger.getLogger("StageDeckRootBinding")}function StageSplitBoxBinding(){return this.logger=SystemLogger.getLogger("StageSplitBoxBinding"),this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this}function StageSplitPanelBinding(){this.logger=SystemLogger.getLogger("StageSplitPanelBinding"),this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this._isInvisibilized=!1,this.isActive=!0,this.isFixed=!1}function StageSplitterBinding(){this.logger=SystemLogger.getLogger("StageSplitterBinding"),this._wasHidden=null}function StageSplitterBodyBinding(){this.logger=SystemLogger.getLogger("StageSplitterBodyBinding"),this._orient=null}function StageBoxAbstraction(){this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this.isHiddenForReal=null}function StageBoxHandlerAbstraction(){this.isSubPanelMaximized=!1}function StageMenuBarBinding(){this.logger=SystemLogger.getLogger("StageMenuBarBinding"),this._rootNode=null}function StageViewMenuItemBinding(){this.logger=SystemLogger.getLogger("StageViewMenuItemBinding"),this._handle=null}function StageStatusBarBinding(){this.logger=SystemLogger.getLogger("StageStatusBarBinding"),this._label=null}function ExplorerBinding(){return this.logger=SystemLogger.getLogger("ExplorerBinding"),this._menuBinding=null,this}function ExplorerMenuBinding(){this.logger=SystemLogger.getLogger("ExplorerMenuBinding"),this._buttons=new Map,this._list=new List,this._index=-1,this._group=null,this._selectedHandle=null,this._selectedTag=null}function ExplorerToolBarBinding(){this.logger=SystemLogger.getLogger("ExplorerToolBarBinding"),this._hasDefaultContent=!1}function ExplorerToolBarButtonBinding(){this.logger=SystemLogger.getLogger("ExplorerToolBarButtonBinding"),this.isRadioButton=!0,this.explorerToolBarButtonType=null,this.node=null}function EditorBinding(){this.logger=SystemLogger.getLogger("EditorBinding"),this.action_initialized=null,this.url_default=null,this._popupBinding=null,this._startContent=null,this._explorerBookmark=null,this.isDirty=!1,this.isDialogMode=!1,this.isFocusable=!0,this.isFocused=!1,this._isActivated=!1,this._Binding=null,this._url=null,this.isBlockingActions=!0,this._isFinalized=!1,this._bookmark=null,this._checksum=null,this.crawlerFilters=new List([FocusCrawler.ID,FitnessCrawler.ID])}function EditorPopupBinding(){this.logger=SystemLogger.getLogger("EditorPopupBinding"),this._isEditorPopupBindingInitialized=!1,this.editorBinding=null}function EditorClickButtonBinding(){this.logger=SystemLogger.getLogger("EditorClickButtonBinding"),this._editorBinding=null,this.isEditorControlBinding=!0,this.isEditorSimpleControl=!0,this.cmd=null,this.val=null,this.gui=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this._codePressFrame=null,this._codePressEngine=null}function EditorToolBarButtonBinding(){this.logger=SystemLogger.getLogger("EditorToolBarButtonBinding"),this._editorBinding=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.isEditorSimpleControl=!0,this.isEditorControlBinding=!0,this.cmd=null,this.val=null,this.gui=null}function EditorSelectorBinding(){this.logger=SystemLogger.getLogger("EditorSelectorBinding"),this._editorBinding=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.BUTTON_IMPLEMENTATION=EditorClickButtonBinding,this.MENUITEM_IMPLEMENTATION=EditorMenuItemBinding,this.isFocusable=!1,this.isEditorControlBinding=!0,this.isSearchSelectionEnabled=!1}function EditorMenuItemBinding(){this.logger=SystemLogger.getLogger("EditorMenuItemBinding"),this.isEditorControlBinding=!0}function VisualEditorBinding(){return this.logger=SystemLogger.getLogger("VisualEditorBinding"),this.action_initialized=VisualEditorBinding.ACTION_INITIALIZED,this.url_default="${root}/content/misc/editors/visualeditor/visualeditor.aspx",this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.embedableFieldConfiguration=null,this._xhtml=null,this._previewPageId=null,this._previewTemplateId=null,this._previewPlaceholder=null,this}function VisualEditorPopupBinding(){this.logger=SystemLogger.getLogger("VisualEditorPopupBinding"),this.tinyElement=null,this.tinyEngine=null,this.tinyInstance=null,this.hasSelection=!1}function VisualEditorFormattingConfiguration(a){this._options=VisualEditorFormattingConfiguration._getOptions()}function VisualEditorFieldGroupConfiguration(a){var b=new Map;new List(a).each(function(a){var c=new Map;new List(a.Fields).each(function(a){c.set(a.Name,{xhtml:a.XhtmlRepresentation,xml:a.XhtmlRepresentation})}),b.set(a.GroupName,c)}),this._groups=b}function VisualMultiEditorBinding(){return this.logger=SystemLogger.getLogger("VisualMultiEditorBinding"),this._hasPlaceHolders=!1,this._textareaname=null,this._textareas=null,this._xhtmls=null,this}function VisualMultiTemplateEditorBinding(){return this.logger=SystemLogger.getLogger("VisualMultiTemplateEditorBinding"),this._oldtextareas=null,this._pageId=null,this._templatePreview=null,this}function CodeMirrorEditorPopupBinding(){this.logger=SystemLogger.getLogger("CodeMirrorEditorPopupBinding"),this._editorBinding=null,this._codePressFrame=null,this._codePressEngine=null}function CodeMirrorEditorBinding(){return this.logger=SystemLogger.getLogger("CodeMirrorEditorBinding"),this.action_initialized=CodeMirrorEditorBinding.ACTION_INITIALIZED,this.url_default="${root}/content/misc/editors/codemirroreditor/codemirroreditor.aspx",this._editorWindowBinding=null,this._codemirrorWindow=null,this._codemirrorEditor=null,this._codemirrorWrapperElement=null,this.syntax=new String(CodeMirrorEditorBinding.syntax.TEXT),this._isPlainEditMode=!1,this.isFocusable=!0,this._isEmbedded=!1,this._hasStrictValidation=!1,this._strictSave=!0,this._validator=null,this._startContent="",this}function ProgressBarBinding(){return this.logger=SystemLogger.getLogger("ProgressBarBinding"),this._cover=null,this}function StartMenuItemBinding(){this.logger=SystemLogger.getLogger("StartMenuItemBinding"),this.type=MenuItemBinding.TYPE_CHECKBOX}function KeySetBinding(){return this.logger=SystemLogger.getLogger("KeySetBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function CursorBinding(){return this.logger=SystemLogger.getLogger("CursorBinding"),this._labelBinding=null,this._opacity=1,this.isAccepting=!0,this}function CoverBinding(){return this.logger=SystemLogger.getLogger("CoverBinding"),this._isBusy=!0,this._isTransparent=!1,this.lastTouch=null,this._position=null,this}function UncoverBinding(){this.logger=SystemLogger.getLogger("UncoverBinding"),UncoverBinding._bindingInstance=this}function TheatreBinding(){return this._isPlaying=!1,this._isFading=!1,this._canvas=null,this}function SourceCodeViewerBinding(){this.logger=SystemLogger.getLogger("SourceCodeViewerBinding"),this._syntax=null,this._transformer=null}function PersistanceBinding(){return this.logger=SystemLogger.getLogger("PersistanceBinding"),this._resolver=null,this}function LocalizationSelectorBinding(){return this.logger=SystemLogger.getLogger("LocalizationSelectorBinding"),this._token=null,this}function ResponseBinding(){return this.logger=SystemLogger.getLogger("ResponseBinding"),this}function AddressBarBinding(){return this.logger=SystemLogger.getLogger("AddressBarBinding"),this.pathBinding=null,this._stateKey=null,this}function GenericViewBinding(){this.logger=SystemLogger.getLogger("GenericViewBinding"),this.perspectiveNode=null,this.node=null,this._activePosition=SystemAction.activePositions.NavigatorTree,this._actionGroup=null}function PathBinding(){return this.logger=SystemLogger.getLogger("PathBinding"),this}function BrandSnippetBinding(){return this.logger=SystemLogger.getLogger("BrandSnippetBinding"),this}function UserInterfaceMapping(a){if(this.logger=SystemLogger.getLogger("UserInterfaceMapping"),Client.isExplorer){this.map={};for(var b in a)this.map[b.replace("ui:","")]=a[b]}else this.map=a}function SOAPMessage(){}function SOAPRequest(a){return this.logger=SystemLogger.getLogger("SOAPRequest"),this.action=a,this}function SOAPRequestResponse(){}function SOAPFault(a,b,c){this._operationName=a,this._operationAddress=b,this._faultString=c}function SOAPEncoder(a,b){this.logger=SystemLogger.getLogger("SOAPEncoder"),this._wsdl=a,this._operation=b,this._namespace=a.getTargetNamespace()}function SOAPDecoder(a,b){this._wsdl=a,this._operation=b,this._resolver=new XPathResolver,this._resolver.setNamespacePrefixResolver({result:a.getTargetNamespace()})}function Schema(a){this.logger=SystemLogger.getLogger("Schema"),this._map=this._parseSchema(a)}function SchemaDefinition(a){this.logger=SystemLogger.getLogger("SchemaDefinition"),this.isRequired=null,this.type=null,this._parse(a)}function SchemaType(){}function SchemaElementType(a,b){this.logger=SystemLogger.getLogger("SchemaElementType"),this._definitions=new List,this._parseListedDefinitions(a,b)}function SchemaComplexType(a,b){this._definitions=new List,this._parseListedDefinitions(a,b),this.isArray=b.getAttribute("name").indexOf("ArrayOf")>-1}function SchemaSimpleType(a,b){this.restrictionType=null,this._parse(a,b)}function WebServiceResolver(a){this.logger=SystemLogger.getLogger("WebServiceResolver"),this._root=this._getDocumentElement(a),this._schema=null,this._root&&(this.setNamespacePrefixResolver({wsdl:Constants.NS_WSDL,soap:Constants.NS_SOAP,s:Constants.NS_SCHEMA}),this._schema=new Schema(this.resolve("wsdl:types/s:schema",this._root))),this._WSDLURL=a}function WebServiceOperation(a,b,c,d){this.name=a,this.address=b,this.encoder=c,this.decoder=d}function WebServiceProxy(){this.logger=SystemLogger.getLogger("WebServiceProxy")}function SelectorButtonBinding(){return this.logger=SystemLogger.getLogger("SelectorButtonBinding"),this.isSingle=!1,this.singleValue=null,this}function SlideInViewBinding(){return this.logger=SystemLogger.getLogger("SlideInViewBinding"),this.responseAction=PageBinding.ACTION_RESPONSE,this}function SlideInButtonBinding(){return this.logger=SystemLogger.getLogger("SlideInButtonBinding"),this}var IAcceptable=new function(){this.dragAccept="type1 type2 type3",this.accept=function(a){}},IActionListener=new function(){this.handleAction=function(a){}},IActivatable=new function(){this.isActivatable=!0,this.activate=function(){},this.deActivate=function(){}},IActivationAware=new function(){this.isActivationAware=!0,this.isActivated=!1,this.onActivate=function(){},this.onDeactivate=function(){}},IBroadcastListener=new function(){this.handleBroadcast=function(a,b){}},ICrawlerHandler=new function(){this.handleCrawler=function(a){}},IData=new function(){this.isFocusable=!0,this.validate=function(){},this.manifest=function(){},this.dirty=function(){},this.clean=function(){},this.focus=function(){},this.blur=function(){},this.getName=function(){},this.getValue=function(){},this.setValue=function(a){},this.getResult=function(){},this.setResult=function(a){}},IDialogResponseHandler=new function(){this.handleDialogResponse=function(){response,result}},IDOMHandler=new function(){this.fireOnDOM=function(){}},IDraggable=new function(){this.dragType="type",this.getImage=function(){}},IDragHandler=new function(){this.onDragStart=function(a){},this.onDrag=function(a){},this.onDragStop=function(a){}},IEditorControlBinding=new function(){this.isEditorControlBinding=!0},IEventListener=new function(){this.handleEvent=function(a){}},IFit=new function(){this.isFit=!0,this.fit=function(){return!0}},IFlexible=new function(){this.flex=function(){}},IFocusable=new function(){this.isFocusable=!0,this.isFocused=!1,this.focus=function(){this.dispatchAction(Binding.ACTION_FOCUSED)},this.blur=function(){this.dispatchAction(Binding.ACTION_BLURRED)}},IImageProfile=new function(){this.getDefaultImage=function(){},this.getHoverImage=function(){},this.getActiveImage=function(){},this.getDisabledImage=function(){}},IKeyEventHandler=new function(){this.handleKeyEvent=function(){}},ILabel=new function(){this.getLabel=function(){},this.getImage=function(){},this.getToolTip=function(){}},ILoadHandler=new function(){this.fireOnLoad=function(){}},IMenuContainer=new function(){this.isOpen=function(){},this.setOpenElement=function(a){}},IResizeHandler=new function(){this.fireOnResize=function(){}},ISourceEditorComponent=new function(){this.initializeSourceEditorComponent=function(a,b,c){}},IUpdateHandler=new function(){this.handleElement=function(a,b){},this.updateElement=function(a,b){}},IWysiwygEditorComponent=new function(){this.initializeComponent=function(a,b,c,d){}},IWysiwygEditorContentChangeHandler=new function(){this.handleContentChange=function(){}},IWysiwygEditorNodeChangeHandler=new function(){this.handleNodeChange=function(a){}};List.prototype.init=function(a){var b=void 0!==a&&void 0!==a.splice;if(b)this._array=a;else if(a.length)for(var c=0,c=0;c<a.length;c++)this._array.push(a[c]);else for(var d,c=0;null!=(d=a[c++]);)this._array.push(d);this.reset()},List.prototype.add=function(a){return this._array.push(a),a},List.prototype.addFirst=function(a){return this._array.unshift(a),a},List.prototype.remove=function(a){for(var b,c=0;void 0!==(b=this._array[c++]);)if(b==a){this._array.splice(c-1,1);break}},List.prototype.get=function(a){var b=null;return this._array[a]&&(b=this._array[a]),b},List.prototype.set=function(a,b){this._array[a]=b},List.prototype.del=function(a){this._array.splice(a,1)},List.prototype.has=function(a){for(var b,c=!1,d=0;void 0!==(b=this._array[d++]);)if(b==a){c=!0;break}return c},List.prototype.getLength=function(){return this._array.length},List.prototype.hasEntries=function(){return this.getLength()>0},List.prototype.hasNext=function(){var a=!1;return null!=this._array?a=this._index<this._array.length:SystemLogger.getLogger("List").error("Mysterious List#hasNext exception in IE"),a},List.prototype.getNext=function(){var a=null;return this.hasNext()&&(a=this._array[this._index++]),a},List.prototype.getFollowing=function(a){for(var b=null,c=0,d=null;null!=(d=this._array[c])&&!b;)d==a&&this._array[c+1]&&(b=this._array[c+1]),c++;return b},List.prototype.getPreceding=function(a){for(var b=null,c=1,d=null;null!=(d=this._array[c])&&!b;)d==a&&this._array[c-1]&&(b=this._array[c-1]),c++;return b},List.prototype.getIndex=function(a){var b=-1;if(null!=this._array.indexOf)b=this._array.indexOf(a);else{var c=0;this.each(function(d){var e=!0;return d==a&&(b=c,e=!1),c++,e})}return b},List.prototype.reset=function(){return this._index=0,this},List.prototype.clear=function(){return this._array=[],this.reset()},List.prototype.each=function(a,b){this.reset();for(var c=!0;0!=c&&this.hasNext();){void 0===b&&(b=null);var d=this._index,e=this.getNext();c=a.call(b,e,d)}this.reset()},List.prototype.copy=function(){return new List(this._array)},List.prototype.reverse=function(){return this._array.reverse(),this},List.prototype.extractFirst=function(){return this._array.shift()},List.prototype.extractLast=function(){return this._array.pop()},List.prototype.getFirst=function(){return this.get(0)},List.prototype.getLast=function(){return this.get(this.getLength()-1)},List.prototype.toString=function(){return"undefined"==typeof this._array?null:this._array.toString()},List.prototype.toArray=function(){return this._array.concat([])},List.prototype.merge=function(a){for(a.reset();a.hasNext();)this.add(a.getNext());return this},List.prototype.dispose=function(){for(var a=this._array.length-1;a>=0;)this._array[a--]=null;this._array=null,this._index=null,this._isDisposed=!0},Map.prototype._map={},Map.prototype.get=function(a){var b=null;if(this.has(a))b=this._map[a];else{var c="Map: Invalid key: "+a;SystemLogger.getLogger("Map").error(c),SystemDebug.stack(arguments),Application.isDeveloperMode&&(console.log(c),console.log(arguments))}return b},Map.prototype.set=function(a,b){this._map[a]=b},Map.prototype.del=function(a){delete this._map[a]},Map.prototype.has=function(a){return"undefined"!=typeof this._map[a]},Map.prototype.each=function(a,b){for(var c in this._map){var d=a.call(b,c,this._map[c]);if(0==d)break}},Map.prototype.hasEntries=function(){var a=!1;for(var b in this._map){a=!0;break}return a},Map.prototype.countEntries=function(){var a=0;for(var b in this._map)a++;return a},Map.prototype.toList=function(a){var b=new List;for(var c in this._map)b.add(a?c:this._map[c]);return b},Map.prototype.copy=function(){var a=new Map;for(var b in this._map)a.set(b,this._map[b]);return a},Map.prototype.inverse=function(){var a=new Map;for(var b in this._map)a.set(this._map[b],b);return a},Map.prototype.empty=function(){for(var a in this._map)delete this._map[a]},Map.prototype.dispose=function(){for(var a in this._map)this._map[a]=null},SystemNodeList.prototype.clear=function(){this._entityTokens.clear()},SystemNodeList.prototype.add=function(a){if(a.getEntityToken){var b=a.getEntityToken();this._entityTokens.add(b)}},SystemNodeList.prototype.has=function(a){if(a.getEntityToken){var b=a.getEntityToken();return this._entityTokens.has(b)}return!1},SystemNodeList.prototype.getEntityTokens=function(){return this._entityTokens.copy()},_LocalStorage.prototype={set:function(a,b){window.localStorage&&window.JSON&&a&&localStorage.setItem(a,JSON.stringify(b))},get:function(a){if(!window.localStorage||!window.JSON||!a)return void 0;var b=localStorage.getItem(a);return b?JSON.parse(b):void 0},remove:function(a){window.localStorage&&window.JSON&&a&&localStorage.removeItem(a)},store_data:function(a,b){this.set(b,a)},get_data:function(a){return this.get(a)},remove_data:function(a){this.remove(a)}};var LocalStorage=new _LocalStorage;_BroadcastMessages.prototype={APPLICATION_STARTUP:"application startup",APPLICATION_LOGIN:"application login",APPLICATION_LOGOUT:"application logout",APPLICATION_OPERATIONAL:"application operational",APPLICATION_ONSHUTDOWN:"application onshutdown",APPLICATION_SHUTDOWN:"application shutdown",APPLICATION_ERROR:"application error",APPLICATION_BLURRED:"application blurred",APPLICATION_FOCUSED:"application focused",APPLICATION_KICKSTART:"application kickstart",CODEMIRROR_LOADED:"codemirror loaded",MOUSEEVENT_MOUSEDOWN:"mouseevent mousedown",MOUSEEVENT_MOUSEUP:"mouseevent mouseup",MOUSEEVENT_MOUSEMOVE:"mouseevent mousemove",TOUCHEVENT_TOUCHSTART:"touchevent touchstart",$WINKEY_LOADED:"${windowkey} loaded",$WINKEY_UNLOADED:"${windowkey} unloaded",$WINKEY_EVALUATED:"${windowkey} evaluated",$WINKEY_RESIZED:"${windowkey} resized",$WINKEY_HRESIZED:"${windowkey} horizontally resized",$WINKEY_VRESIZED:"${windowkey} vertically resized",LOADED_NAVIGATOR:"navigator loaded",LOADED_MAINSTAGE:"mainstage loaded",LOCALSTORE_INITIALIZED:"localstore initialized",PERSISTANCE_INITIALIZED:"persistance initialized",STAGE_INITIALIZED:"stage initialized",KEY_SHIFT_DOWN:"shiftkeydown",KEY_SHIFT_UP:"shiftkeyup",KEY_CONTROL_DOWN:"controlkeydown",KEY_CONTROL_UP:"controlkeyup",KEY_ARROW:"arrowkey",KEY_ENTER:"enterkeydown",KEY_ESCAPE:"escapekeydown",KEY_SPACE:"spacekeydown",KEY_TAB:"tabkeydown",KEY_ALT:"altkeydown",KEY_CONTROLTAB:"controltabkeysdown",TYPEDRAG_START:"typedrag start",TYPEDRAG_STOP:"typedrag stop",TYPEDRAG_PAUSE:"typedrag pause",DOCK_MAXIMIZED:"dockmaximized",DOCK_MINIMIZED:"dockminimized",DOCK_NORMALIZED:"docknormalized",DOCKTABBINDING_SELECT:"docktab select",SYSTEMTREEBINDING_REFRESH:"systemtree refresh",SYSTEMTREEBINDING_REFRESHALL:"systemtree refresh all",SYSTEMTREEBINDING_REFRESHING:"systemtree refreshing",SYSTEMTREEBINDING_REFRESHED:"systemtree refreshed",SYSTEMTREEBINDING_REFRESHED_AFTER:"systemtree refreshed after",SYSTEMTREEBINDING_FOCUS:"systemtree focus",SYSTEMTREEBINDING_CUT:"systemtree cut",SYSTEMTREEBINDING_COPY:"systemtree copy",SYSTEMTREEBINDING_PASTE:"systemtree paste",SYSTEMTREEBINDING_COLLAPSEALL:"systemtree collapse all",SYSTEMTREENODEBINDING_FOCUS:"systemtreenode focus",SYSTEMTREEBINDING_LOCKTOEDITOR:"systemtreenode lock to editor",SYSTEMTREENODEBINDING_FORCE_OPEN:"systemtreenode force open",SYSTEMTREENODEBINDING_FORCING_OPEN:"systemtreenode forcing open",SYSTEMTREENODEBINDING_FORCED_OPEN:"systemtreenode forced open",START_COMPOSITE:"startcomposite",STOP_COMPOSITE:"stopcomposite",COMPOSITE_START:"compositestart",COMPOSITE_STOP:"compositestop",VIEW_OPENING:"view opening",VIEW_OPENED:"view opened",VIEW_COMPLETED:"view completed",CLOSE_VIEW:"close view",CLOSE_VIEWS:"close views",VIEW_CLOSED:"view closed",TINYMCE_INITIALIZED:"tinymce initialized",CODEPRESS_INITIALIZED:"codepress initialized",VISUALEDITOR_FOCUSED:"visualeditor focused",VISUALEDITOR_BLURRED:"visualditor blurred",PERSPECTIVE_CHANGED:"perspective changed",PERSPECTIVES_NONE:"no perspectives",SYSTEMLOG_OPENED:"systemlog opened",SYSTEMLOG_CLOSED:"systemlog closed",SYSTEMACTION_INVOKE:"systemaction invoke",SYSTEMACTION_INVOKED:"systemaction invoked",SYSTEM_ACTIONPROFILE_PUBLISHED:"system actionprofile published",NAVIGATOR_TREENODE_SELECTED:"navigator treenode selected",MODAL_DIALOG_OPENED:"modal dialog invoked",MODAL_DIALOG_CLOSED:"modal dialog closed",COVERBINDING_MOUSEDOWN:"userinterfacecoverbinding mousedown",SERVER_OFFLINE:"server offline",SERVER_ONLINE:"server online",OFFLINE_FLASH_INITIALIZED:"offline flash initialized",CLOSE_CURRENT:"close current",CLOSE_ALL:"close all",CLOSE_ALL_DONE:"close all done",SAVE_CURRENT:"save current",CURRENT_SAVED:"current saved",SAVE_ALL:"save all",SAVE_ALL_DONE:"save all done",DOCKTAB_DIRTY:"docktab dirty",DOCKTAB_CLEAN:"docktab clean",BINDING_RELATE:"binding relate",LOCALIZATION_CHANGED:"localization changed",XHTML_MARKUP_ON:"xhtml markup on",XHTML_MARKUP_OFF:"xhtml markup off",XHTML_MARKUP_ACTIVATE:"xhtml markup activate",XHTML_MARKUP_DEACTIVATE:"xhtml markup deactivate",HIGHLIGHT_KEYWORDS:"highlight keywords",BIND_TOKEN_TO_VIEW:"bind entitytoken to view",STAGEDIALOG_OPENED:"stage dialog opened",INVOKE_DEFAULT_ACTION:"invoke default action",STAGEDECK_CHANGED:"stage deck changed",LANGUAGES_UPDATED:"LocalesUpdated",FROMLANGUAGE_UPDATED:"ForeignLocaleChanged",TOLANGUAGE_UPDATED:"ActiveLocaleChanged",MESSAGEQUEUE_REQUESTED:"messagequeue requested",MESSAGEQUEUE_EVALUATED:"messagequeue evaluated",UPDATE_LANGUAGES:"update languages"};var BroadcastMessages=new _BroadcastMessages;_EventBroadcaster.prototype={_broadcasts:{},subscribe:function(a,b){if(null==a)throw SystemDebug.stack(arguments),"Undefined broadcast: "+b;if(!Interfaces.isImplemented(IBroadcastListener,b,!0))throw"IBroadcastListener not implemented: "+a;this._broadcasts[a]?this._broadcasts[a].push(b):this._broadcasts[a]=[b]},unsubscribe:function(a,b){if(null==a)throw"Undefined broadcast"+b;if(Interfaces.isImplemented(IBroadcastListener,b)){var c,d=0,e=this._broadcasts[a];if(e)for(;d<e.length;){if(c=e[d],c==b){e.splice(d,1);break}d++}}},hasSubscribers:function(a){var b=this._broadcasts[a];return null!=b&&b.length>0},broadcast:function(a,b){if(null==a)throw SystemDebug.stack(arguments),"Undefined broadcast";var c=0,d=this._broadcasts[a],e=[];if(null!=d){for(var f=new List;c<d.length;)e.push(d[c++]);for(c=0;c<e.length;){var g=e[c];if(Application.isDeveloperMode)g.handleBroadcast(a,b);else try{g.handleBroadcast(a,b)}catch(b){f.add(g);var h="Exception in "+new String(g)+" on broadcast '"+a+"':"+new String(b);SystemLogger.getLogger("EventBroadcaster").error(h),SystemDebug.stack(arguments)}c++}f.hasEntries()&&f.each(function(b){EventBroadcaster.unsubscribe(a,b)})}}};var EventBroadcaster=new _EventBroadcaster,temppath=document.location.pathname,temproot=temppath.substring(0,temppath.lastIndexOf("/"));_Constants.prototype={COMPOSITE_HOME:"http://www.composite.net",DUMMY_LINK:"javascript:void(false);",APPROOT:temproot,WEBSITEROOT:temproot.substring(0,temproot.length-9),CONFIGROOT:temproot.substring(0,temproot.length-9)+"Frontend/Config/VisualEditor/",TEMPLATESROOT:temproot+"/templates",SKINROOT:temproot+"/skins/system",TINYROOT:temproot+"/content/misc/editors/visualeditor/tinymce",URL_WSDL_SETUPSERVICE:temproot+"/services/Setup/SetupService.asmx?WSDL",URL_WSDL_CONFIGURATION:temproot+"/services/Configuration/ConfigurationService.asmx?WSDL",URL_WSDL_LOGINSERVICE:temproot+"/services/Login/Login.asmx?WSDL",URL_WSDL_INSTALLSERVICE:temproot+"/services/Installation/InstallationService.asmx?WSDL",URL_WSDL_MESSAGEQUEUE:temproot+"/services/ConsoleMessageQueue/ConsoleMessageQueueServices.asmx?WSDL",URL_WSDL_EDITORCONFIG:temproot+"/services/WysiwygEditor/ConfigurationServices.asmx?WSDL",URL_WSDL_FLOWCONTROLLER:temproot+"/services/FlowController/FlowControllerServices.asmx?WSDL",URL_WSDL_STRINGSERVICE:temproot+"/services/StringResource/StringService.asmx?WSDL",URL_WSDL_TREESERVICE:temproot+"/services/Tree/TreeServices.asmx?WSDL",URL_WSDL_XHTMLTRANSFORM:temproot+"/services/WysiwygEditor/XhtmlTransformations.asmx?WSDL",URL_WSDL_PAGETEMPLATE:temproot+"/services/WysiwygEditor/PageTemplate.asmx?WSDL",URL_WSDL_FUNCTIONSERVICE:temproot+"/services/WysiwygEditor/FunctionService.asmx?WSDL",URL_WSDL_SECURITYSERVICE:temproot+"/services/Tree/SecurityServices.asmx?WSDL",URL_WSDL_READYSERVICE:temproot+"/services/Ready/ReadyService.asmx?WSDL",URL_WSDL_LOCALIZATION:temproot+"/services/Localization/LocalizationService.asmx?WSDL",URL_WSDL_SOURCEVALIDATION:temproot+"/services/SourceEditor/SourceValidationService.asmx?WSDL",URL_WSDL_MARKUPFORMAT:temproot+"/services/SourceEditor/MarkupFormatService.asmx?WSDL",URL_WSDL_SEOSERVICE:temproot+"/services/SearchEngineOptimizationKeyword/SearchEngineOptimizationKeyword.asmx?WSDL",URL_WSDL_PAGESERVICE:temproot+"/services/Page/PageService.asmx?WSDL",URL_WSDL_DIFFSERVICE:temproot+"/services/StringResource/DiffService.asmx?WSDL",
NS_XHTML:"http://www.w3.org/1999/xhtml",NS_UI:"http://www.w3.org/1999/xhtml",NX_XUL:"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",NS_XBL:"http://www.mozilla.org/xbl",NS_WSDL:"http://schemas.xmlsoap.org/wsdl/",NS_SOAP:"http://schemas.xmlsoap.org/wsdl/soap/",NS_ENVELOPE:"http://schemas.xmlsoap.org/soap/envelope/",NS_ENCODING:"http://schemas.xmlsoap.org/soap/encoding/",NS_SCHEMA:"http://www.w3.org/2001/XMLSchema",NS_SCHEMA_INSTANCE:"http://www.w3.org/1999/XMLSchema-instance",NS_DOMPARSEERROR:"http://www.mozilla.org/newlayout/xml/parsererror.xml",NS_NS:"http://www.w3.org/2000/xmlns/",NS_PERSISTANCE:"http://www.composite.net/ns/localstore/persistance",NS_FUNCTION:"http://www.composite.net/ns/function/1.0",SCROLLBAR_DIMENSION_HARDCODED_VALUE:19};var Constants=new _Constants;temppath=null,temproot=null,_Client.prototype={isExplorer:!1,isMozilla:!1,isPrism:!1,hasFlash:!1,isWindows:!1,isVista:!1,hasTransitions:!1,_getFlashVersion:function(){var a=null,b=10;try{if(1==this.isMozilla){if("undefined"!=typeof navigator.plugins["Shockwave Flash"]){var c=navigator.plugins["Shockwave Flash"];if(c){var d=c.description;null!=d&&(a=d.charAt(d.indexOf(".")-1))}}}else for(var e=2;b>=e;e++)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+e),a=e}catch(a){continue}}catch(a){}return a},qualifies:function(){var a=!0,b=!1;return!this.isMozilla||this.isWebKit||this.isExplorer11||(b=void 0===document.documentElement.mozMatchesSelector),(null!=window.opera||b||this.isExplorer&&!this.canvas)&&(a=!1),a},fixUI:function(a){return Client.isExplorer&&(a=a.replace(/<ui:/g,"<").replace(/<\/ui:/g,"</"),a=a.replace(/(<(\w+)[^>]*)\/>/g,"$1></$2>")),a}};var Client=new _Client;SystemLogger.TAB_SEQUENCE="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;",SystemLogger.LEVEL_INFO="info",SystemLogger.LEVEL_DEBUG="debug",SystemLogger.LEVEL_ERROR="error",SystemLogger.LEVEL_WARN="warn",SystemLogger.LEVEL_FATAL="fatal",SystemLogger.LEVEL_FINE="fine",SystemLogger.isFlushing=!1,SystemLogger.prototype.info=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_INFO,a)},SystemLogger.prototype.debug=function(a){"page"==a&&alert(arguments.caller.callee),SystemLogger.log(this.identifier,SystemLogger.LEVEL_DEBUG,a)},SystemLogger.prototype.error=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_ERROR,a)},SystemLogger.prototype.warn=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_WARN,a)},SystemLogger.prototype.fatal=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_FATAL,a)},SystemLogger.prototype.fine=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_FINE,a)},SystemLogger.loggers={},SystemLogger.buffer=new List,SystemLogger.suspend=function(){SystemLogger.outputWindow=null,SystemLogger.outputDocument=null,SystemLogger.outputElement=null,SystemLogger.log=SystemLogger.bufferLog},SystemLogger.unsuspend=function(a){SystemLogger.outputWindow=a,SystemLogger.outputDocument=a.document,SystemLogger.outputElement=a.document.body,SystemLogger.log=SystemLogger.outputLog,SystemLogger.flushBuffer()},SystemLogger.getLogger=function(a){var b=SystemLogger.loggers[a];return b||(b=new SystemLogger(a),SystemLogger.loggers[a]=b),b},SystemLogger.flushBuffer=function(){if(SystemLogger.buffer.reset(),SystemLogger.isFlushing=!0,SystemLogger.buffer.hasEntries())for(;SystemLogger.buffer.hasNext();){var a=SystemLogger.buffer.getNext();this.log(a.identifier,a.level,a.message)}SystemLogger.isFlushing=!1},SystemLogger.bufferLog=function(a,b,c){Application.isDeveloperMode&&(c=String(c),SystemLogger.buffer.add({identifier:a,level:b,message:c}))},SystemLogger.outputLog=function(a,b,c){c=String(c),SystemLogger.isFlushing||SystemLogger.bufferLog(a,b,c);var d=SystemLogger.outputWindow,e=SystemLogger.outputDocument,f=SystemLogger.outputElement,g=e.createElement("div"),h=e.createElement("span"),i=e.createElement("pre");Client.isExplorer?(c=c.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),c=c.replace(/\n/g,"<br/>"),c=c.replace(/\t/g,SystemLogger.TAB_SEQUENCE),i.innerHTML=c):i.textContent=c,g.className=b,h.innerHTML=a,g.appendChild(h),g.appendChild(i),f.insertBefore(g,f.firstChild),d.scrollTo(0,0)},SystemLogger.log=SystemLogger.bufferLog,SystemLogger.clear=function(){SystemLogger.buffer=new List;var a=SystemLogger.outputDocument;a&&(a.body.innerHTML="")},SystemTimer.getTimer=function(a){return new SystemTimer(a.toString())},SystemTimer.prototype.reset=function(){this._time=(new Date).getTime()},SystemTimer.prototype.report=function(a){this.logger.debug(this._id+": "+this.getTime()+(a?": "+a:""))},SystemTimer.prototype.getTime=function(){return(new Date).getTime()-this._time},_SystemDebug.prototype={_logger:SystemLogger.getLogger("SystemDebug"),_stacklength:parseInt(5),stack:function(a,b){this._stackMozilla(a,b)},_stackMozilla:function(a,b){if(b=b?b:this._stacklength,Client.isMozilla&&a.callee||a.caller){for(var c=Client.isMozilla?a.callee.caller:a.caller.callee,d="",e=0;null!=c&&e++<b;)d+="\n#"+e+"\n",d+=c.toString(),c=c.caller,d+="\n";this._logger.error(d)}else this._logger.error("(Error stack unreachable!)")}};var SystemDebug=new _SystemDebug,Interfaces=new _Interfaces;_Types.prototype={_logger:SystemLogger.getLogger("Types"),BOOLEAN:"boolean",STRING:"string",NUMBER:"number",FUNCTION:"function",UNDEFINED:"undefined",castFromString:function(a){var b=a;return parseInt(b).toString()===b?b=parseInt(b):parseFloat(b).toString()===b?b=parseFloat(b):("true"===b||"false"===b)&&(b="true"===b),b},isDefined:function(a){return typeof a!=Types.UNDEFINED},isFunction:function(a){return typeof a==Types.FUNCTION}};var Types=new _Types,MimeTypes={JPG:"image/jpeg",GIF:"image/gif",PNG:"image/png",CSS:"text/css",JAVASCRIPT:"text/javascript",TEXT:"text/plain",HTML:"text/html",XHTML:"applcication/xhtml+xml",FLASH:"application/x-shockwave-flash",QUICKTIME:"video/quicktime",SHOCKWAVE:"application/x-director",WINMEDIA:"application/x-mplayer2",COMPOSITEPAGES:"application/x-composite-page",COMPOSITEFUNCTION:"application/x-composite-function"};window.SearchTokens=new function(){var a={"MediaFileElementProvider.WebImages":null,"MediaFileElementProvider.EmbeddableMedia":null,"MediaFileElementProvider.WritableFolders":null,"AllFunctionsElementProvider.VisualEditorFunctions":null,"AllFunctionsElementProvider.XsltFunctionCall":null};this.getToken=function(b){var c=null;if(!this.hasToken(b))throw"Unknown search token key: "+b;return c=a[b]},this.hasToken=function(b){return typeof a[b]!=Types.UNDEFINED},EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,{handleBroadcast:function(){new List(TreeService.GetSearchTokens(!0)).each(function(b){SearchTokens.hasToken(b.Key)?a[b.Key]=b.Value:alert("SearchTokens need updating!")})}})},window.StringBundle=new function(){function a(a,b){var c=new List(StringService.GetLocalisation(a));if(!c.hasEntries())throw"No strings from provider: "+a;c.each(function(a){b[a.Key]=a.Value})}var b=SystemLogger.getLogger("StringBundle");this.UI="Composite.Management";var c={};this.getString=function(d,e){var f=null;if(null!=window.StringService)try{if("ui"==d&&(d=StringBundle.UI),!c[d]){var g=c[d]={};a(d,g)}if(c[d]&&(f=c[d][e]),!f)throw"No such string: "+e}catch(a){var h="StringBundle exception in string "+d+":"+e;b.error(h),Application.isDeveloperMode&&alert(h)}return f}},_KeyMaster.prototype={_uniqueKeys:{},getUniqueKey:function(){var a=new String("key"+Math.random().toString().split(".")[1]);return null!=this._uniqueKeys[a]?this.getUniqueKey():(this._uniqueKeys[a]=!0,a)},hasKey:function(a){var b=!1;return this._uniqueKeys[a]&&(b=!0),b}};var KeyMaster=new _KeyMaster;_ImageProvider.prototype={_logger:SystemLogger.getLogger("ImageProvider"),UI:"Composite.Icons",getImageURL:function(a,b){return"string"==typeof a?a:a.ResourceName?a.ResourceName:""}};var ImageProvider=new _ImageProvider;_Resolver.prototype={_logger:SystemLogger.getLogger("Resolver"),resolve:function(a){return typeof a!=Types.UNDEFINED&&(a=String(a),a=a.replace("${root}",Constants.APPROOT),a=a.replace("${skin}",Constants.SKINROOT),a=a.replace("${tiny}",Constants.TINYROOT),a.indexOf("${icon:")>-1?a=this._resolveImage(a):a.indexOf("${class:")>-1?a=this._resolveClasses(a):a.indexOf("${string:")>-1&&(a=this._resolveString(a))),a},resolveVars:function(a,b){for(var c=0;c<b.length;)a=a.replace("{"+c+"}",b[c]),c++;return a},_resolveString:function(a){var b=null,c=null,d=a.split("${string:")[1].split("}")[0];return d.indexOf(":")>-1?(c=d.split(":")[0],d=d.split(":")[1]):c=StringBundle.UI,b=StringBundle.getString(c,d),b||(b="(?)"),b},_resolveImage:function(a){var b=null,c=null,d=null,e=null;return d=a.split("${icon:")[1].split("}")[0],d.indexOf(":")>-1?(c=d.split(":")[0],d=d.split(":")[1]):c=ImageProvider.UI,d.indexOf("(")>-1&&(e=d.split("(")[1].split(")")[0],d=d.split("(")[0]),b=ImageProvider.getImageURL({ResourceNamespace:c,ResourceName:d},e)},_resolveClasses:function(a){var b={};return resource=a.split("${class:")[1].split("}")[0],b.classes=resource,b}};var Resolver=new _Resolver;_Download.prototype.init=function(a){var b=top.app.bindingMap.downloadwindow;b.setURL(a)};var Download=new _Download;_Cookies.prototype={createCookie:function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}return document.cookie=a+"="+escape(b)+d+"; path=/",this.readCookie(a)},readCookie:function(a){for(var b=null,c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);0==f.indexOf(c)&&(b=unescape(f.substring(c.length,f.length)))}return b},eraseCookie:function(a){this.createCookie(a,"",-1)}};var Cookies=new _Cookies,StatusBar=new _StatusBar;_Localization.prototype={languages:null,source:null,target:null,isUIRtl:!1,isRtl:!1,handleBroadcast:function(a,b){switch(a){case BroadcastMessages.APPLICATION_LOGIN:case BroadcastMessages.LANGUAGES_UPDATED:case BroadcastMessages.TOLANGUAGE_UPDATED:this.isUIRtl="rtl"==LocalizationService.GetUITextDirection(!0),this.isRtl="rtl"==LocalizationService.GetTextDirection(!0);var c=LocalizationService.GetActiveLocales(!0);c.length>=1?this.languages=new List(c):this.languages=null,EventBroadcaster.broadcast(BroadcastMessages.UPDATE_LANGUAGES,this.languages)}switch(a){case BroadcastMessages.APPLICATION_LOGIN:case BroadcastMessages.FROMLANGUAGE_UPDATED:var d=LocalizationService.GetLocales(!0);this.source=d.ForeignLocaleName,this.target=d.ActiveLocaleName,EventBroadcaster.broadcast(BroadcastMessages.LOCALIZATION_CHANGED,{source:d.ForeignLocaleName,target:d.ActiveLocaleName})}},currentLang:function(){if(null!=this.languages)for(var a=this.languages.copy();a.hasNext();){var b=a.getNext();if(b.IsCurrent)return b.IsoName}return null}};var Localization=new _Localization;_Validator.prototype={validate:function(a,b,c){var d=!0,e=SourceValidationService.ValidateSource(a,b);return"True"!=e&&(1==c&&this._dialog(e),d=!1),d},validateInformed:function(a,b){return this.validate(a,b,!0)},_dialog:function(a){setTimeout(function(){Dialog.error("Source Invalid",a)},0)}};var Validator=new _Validator;_DOMEvents.prototype={_logger:SystemLogger.getLogger("DOMEvents"),MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",CLICK:"click",DOUBLECLICK:"dblclick",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",CONTEXTMENU:"contextmenu",SCROLL:"scroll",LOAD:"load",BEFOREUNLOAD:"beforeunload",UNLOAD:"unload",RESIZE:"resize",FOCUS:"focus",BLUR:"blur",SUBMIT:"submit",CUT:"cut",COPY:"copy",PASTE:"paste",DOM:"DOMContentLoaded",DRAGOVER:"dragover",DROP:"drop",WHEEL:"wheel",HASHCHANGE:"hashchange",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",ACTIVATE:"activate",DEACTIVATE:"deactivate",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTSTART:"selectstart",FOCUSIN:"focusin",FOCUSOUT:"focusout",HELP:"help",BEFOREUPDATE:"beforeupdate",AFTERUPDATE:"afterupdate",ERRORUPDATE:"errorupdate",_count:0,addEventListener:function(a,b,c,d){this._count++,this._eventListener(!0,a,b,c,d)},removeEventListener:function(a,b,c,d){this._count--,this._eventListener(!1,a,b,c,d)},getTarget:function(a){return a?a.target?a.target:a.srcElement:null},stopPropagation:function(a){try{null!=a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}catch(a){1==Application.isDeveloperMode&&this._logger.error(a)}},preventDefault:function(a){try{a.preventDefault?a.preventDefault():a.returnValue=!1}catch(a){1==Application.isDeveloperMode&&this._logger.error(a)}},isRightButton:function(a){return 2==a.button?!0:!1},isButtonPressed:function(a){return(Client.isFirefox||Client.isExplorer11)&&0===a.buttons?!1:Client.isWebKit&&0===a.which?!1:void 0},cleanupEventListeners:function(a){this._deleteWrappedHandler(a)},isCurrentTarget:function(a){var b=!1;return 1==Client.isMozilla&&(b=a.target==a.currentTarget),!0},_isChildOf:function(a,b){var c=!0;if(a==b&&(c=!1),1==c){for(;null!=b&&b.nodeType!=Node.DOCUMENT_NODE&&b!=a;)b=b.parentNode;c=b==a}return c},_eventListener:function(a,b,c,d,e,f){if(Interfaces.isImplemented(IEventListener,d,!0)){if(typeof c==Types.UNDEFINED)throw"No such event allowed!";var g=this._getAction(a);if(b[g])if(Client.isPad&&c==DOMEvents.DOUBLECLICK){if(a){var h=null,i={handleEvent:function(a){var b=(new Date).getTime();if(h&&500>b-h){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);var c=new MouseEvent(DOMEvents.DOUBLECLICK,a);return d.handleEvent(c),void(h=null)}h=b}};b[g](DOMEvents.TOUCHSTART,i,e?!0:!1)}}else if(Client.isExplorer||Client.isExplorer11)switch(c){case DOMEvents.MOUSEDOWN:case DOMEvents.MOUSEUP:case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:case DOMEvents.MOUSEMOVE:d=this._getWrappedHandler(b,c,d,f),b[g](c,d,!1);break;default:b[g](c,d,!1)}else switch(c){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSELEAVE:c=c==DOMEvents.MOUSEENTER?DOMEvents.MOUSEOVER:DOMEvents.MOUSEOUT,b[g](c,{handleEvent:function(a){var b=a.relatedTarget;a.currentTarget==b||DOMEvents._isChildOf(a.currentTarget,b)||d.handleEvent(a)}},e?!0:!1);break;default:b[g](c,d,e?!0:!1)}}},_getAction:function(a){var b=null;switch(a){case!0:b="addEventListener";break;case!1:b="removeEventListener"}return b},_getWrappedHandler:function(a,b,c,d){var e=null;try{if(c._domEventHandlers||(c._domEventHandlers={}),c._domEventHandlers[a]||(c._domEventHandlers[a]={}),!c._domEventHandlers[a][b]){var f=a.nodeType?DOMUtil.getParentWindow(a):a;f&&(c._domEventHandlers[a][b]=function(a){null!=f.event&&null!=c?c.handleEvent(f.event):null!=c&&c.handleEvent(a)})}e=c._domEventHandlers[a][b]}catch(e){this._report(a,b,c,d)}return e},_deleteWrappedHandler:function(a){for(var b in a._domEventHandlers){if(b)for(var c in a._domEventHandlers[b])c&&delete a._domEventHandlers[b][c];delete a._domEventHandlers[b]}},_report:function(a,b,c,d){alert("DOMEvents.getWrappedHandler malfunction.\n\n	target: "+(a?a.nodeName:a)+"\n	event: "+b+"\n	handler: "+c+"\n\nOffending invoker: "+(d.callee?d.callee.toString():d.constructor))}};var DOMEvents=new _DOMEvents;_DOMSerializer.prototype={_serializer:window.XMLSerializer?new XMLSerializer:null,serialize:function(a,b){var c=null,d=a;return a.nodeType==Node.DOCUMENT_NODE&&(d=a.documentElement),null!=d.xml?d.xml:(null!=this._serializer&&(1==b&&(d=d.cloneNode(!0),d=DOMFormatter.format(d,DOMFormatter.INDENTED_TYPE_RESULT)),c=this._serializer.serializeToString(d)),c)}};var DOMSerializer=new _DOMSerializer;window.DOMFormatter=new function(){function a(a){var b=a.ownerDocument,f=function(a,g){if(a.hasChildNodes()&&a.firstChild.nodeType!=Node.TEXT_NODE){for(var h="",i=0;i++<g;)h+=d;for(var j=a.firstChild;j;){switch(j.nodeType){case Node.ELEMENT_NODE:j==a.lastChild&&a.appendChild(b.createTextNode(e+h)),a.insertBefore(b.createTextNode(e+h+d),j),f(j,g+1);break;case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.CDATA_SECTION_NODE:a.insertBefore(b.createTextNode(e+h+d),j)}j.nodeType==Node.CDATA_SECTION_NODE&&(this.ignoreCDATASections||c(j,h+d)),j=j.nextSibling}}};f(a,0)}function b(a){for(var b=[],c={acceptNode:function(a){return f.test(a.nodeValue)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},d=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT,c,!0);d.nextNode();)b.push(d.currentNode);for(var e,g=0;null!=(e=b[g++]);)e.parentNode.removeChild(e)}function c(a,b){if(a.textContent.indexOf(e)>-1){for(var c,f=a.textContent.split(e),g="",h=0,i=!0;null!=(c=f.shift());){if(0==h&&c.charAt(0)==d)for(;c.charAt(h++)==d;);c=c.substring(h,c.length),f.length>0?(g+=b+d+c,g+=i?"":"\n"):(g+=b+c,b=b.slice(1,b.length),a.parentNode.appendChild(doc.createTextNode(e+b))),i=!1}a.textContent=g}}var d="	",e="\n",f=new RegExp(/[^\t\n\r ]/);this.ignoreCDATASections=!1,this.format=function(c,d){var e=1;if(document.createTreeWalker&&!Client.isExplorer&&!Client.isExplorer11)try{b(c),d!=e&&a(c)}catch(a){throw new Error(a)}return c}},DOMFormatter.INDENTED_TYPE_RESULT=0,DOMFormatter.STRIPPED_TYPE_RESULT=1,_DOMUtil.prototype={_logger:SystemLogger.getLogger("DOMUtil"),MSXML_MAXVERSION:6,MSXML_MINVERSION:1,MSXML_HTTPREQUEST:"MSXML2.XMLHTTP.{$version}.0",MSXML_DOMDOCUMENT:"MSXML2.DOMDocument.{$version}.0",MSXML_FREETHREADED:"MSXML2.FreeThreadedDOMDocument.{$version}.0",MSXML_XSLTEMPLATE:"MSXML2.XSLTemplate.{$version}.0",getMSComponent:function(a){for(var b,c=null,d=this.MSXML_MAXVERSION;!c&&d>=this.MSXML_MINVERSION;){try{b=a.replace("{$version}",d),c=new ActiveXObject(b)}catch(a){}d--}return c},getXMLHTTPRequest:function(){var a=null;return a=Client.isExplorer||Client.isExplorer11?this.getMSComponent(this.MSXML_HTTPREQUEST):new XMLHttpRequest},getDOMDocument:function(a){var b=null;if(Client.isExplorer||Client.isExplorer11)b=this.getMSComponent(a?this.MSXML_FREETHREADED:this.MSXML_DOMDOCUMENT);else{var c=XMLParser.parse('<?xml version="1.0" encoding="UTF-8"?><ROOT/>');c.removeChild(c.documentElement),b=c}return b},getMSXMLXSLTemplate:function(){var a=null;return Client.isAnyExplorer&&(a=this.getMSComponent(this.MSXML_XSLTEMPLATE)),a},getLocalName:function(a){var b=null;return b=a.localName?a.localName.replace("ui:",""):a.baseName?a.baseName:a.nodeName.toLowerCase()},getComputedStyle:function(a,b){var c=null;if(Client.isExplorer)null!=a.currentStyle?c=a.currentStyle[b]:(this._logger.error("Could not compute style for element "+a.nodeName),SystemDebug.stack(arguments));else{var d=a.ownerDocument.defaultView.getComputedStyle(a,null);null!=d?c=d.getPropertyValue(b):(this._logger.error("Could not compute style for element "+a.nodeName),SystemDebug.stack(arguments))}return c},getMaxIndex:function(a){var b=0,c=new List(a.getElementsByTagName("*"));return c.each(function(a){var c=CSSComputer.getZIndex(a);c>b&&(b=c)}),b},getOrdinalPosition:function(a,b){for(var c=null,d=-1,e=this.getLocalName(a),f=new List(a.parentNode.childNodes);f.hasNext();){var g=f.getNext();if(g.nodeType==Node.ELEMENT_NODE&&(!b||this.getLocalName(g)==e)&&(d++,g==a||""!=g.id&&g.id==a.id)){c=d;break}}return c},isFirstElement:function(a,b){return 0==this.getOrdinalPosition(a,b)},isLastElement:function(a,b){var c=a.parentNode.getElementsByTagName(b?this.getLocalName(a):"*");return this.getOrdinalPosition(a)==c.length},getParentWindow:function(a){var b=a.nodeType==Node.DOCUMENT_NODE?a:a.ownerDocument;return b.defaultView?b.defaultView:b.parentWindow},getTextContent:function(a){var b=null;return b=a.textContent?a.textContent:a.text?a.text:a.innerText},setTextContent:function(a,b){b=String(b),a.textContent?a.textContent=b:a.text?a.text=b:a.innerText=b},getAncestorByLocalName:function(a,b,c){for(var d=null;null==d;){if(b=b.parentNode,b.nodeType==Node.DOCUMENT_NODE){if(1!=c)break;var e=this.getParentWindow(b);b=e.frameElement}this.getLocalName(b)==a&&(d=b)}return d},contains:function(a,b){return a.contains?a!=b&&a.contains(b):!!(16&a.compareDocumentPosition(b))},createElementNS:function(a,b,c){var d=null;return null==c?alert("DOMUtil#createElementNS : Missing argument (DOMDocument)"):d=Client.isExplorer||Client.isExplorer11?null!=c.xml?c.createNode(Node.ELEMENT_NODE,b,a):c.createElement(b.replace("ui:","")):c.createElementNS(a,b),d},getElementsByTagName:function(a,b){var c=null;return c=Client.isMozilla?a.getElementsByTagNameNS(Constants.NS_XHTML,b):a.getElementsByTagName(b)},getChildElementsByLocalName:function(a,b){var c=new List,d=a.childNodes;return new List(d).each(function(a){a.nodeType==Node.ELEMENT_NODE&&("*"==b||DOMUtil.getLocalName(a)==b)&&c.add(a)}),c},getNextElementSibling:function(a){return Client.isExplorer?a.nextSibling:a.nextElementSibling},getPreviousElementSibling:function(a){return Client.isExplorer?a.previousSibling:a.previousElementSibling},cloneNode:function(a){var b=null;return b=1==Client.isMozilla?XMLParser.parse(DOMSerializer.serialize(a)):a.cloneNode(!0)},getLocalPosition:function(a){var b=new Point(a.offsetLeft,a.offsetTop);if(Client.isExplorer&&a.parentNode&&a.parentNode.currentStyle&&"static"==a.parentNode.currentStyle.position){var c=this.getLocalPosition(a.parentNode);b.x+=c.x,b.y+=c.y}return b},getGlobalPosition:function(a){return this._getPosition(a,!1)},getUniversalPosition:function(a){return this._getPosition(a,!0)},_getPosition:function(a,b){var c=null;if(typeof a.getBoundingClientRect!=Types.UNDEFINED){var d=a.getBoundingClientRect();c={x:d.left,y:d.top},Client.isMozilla&&(c.x-=a.scrollLeft,c.y-=a.scrollTop)}else for(c={x:a.offsetLeft-a.scrollLeft,y:a.offsetTop-a.scrollTop};a.offsetParent;)a=a.offsetParent,c.x+=a.offsetLeft-a.scrollLeft,c.y+=a.offsetTop-a.scrollTop;if(b){var e=DOMUtil.getParentWindow(a);if(e){var f=e.frameElement;if(f){var g=DOMUtil.getUniversalPosition(f);c.x+=g.x,c.y+=g.y}}}return new Point(c.x,c.y)},getGlobalMousePosition:function(a){return this._getMousePosition(a,!1)},getUniversalMousePosition:function(a){return this._getMousePosition(a,!0)},_getMousePosition:function(a,b){var c=DOMEvents.getTarget(a),d={x:a.clientX,y:a.clientY};if(b){var e=this.getParentWindow(c).frameElement;if(e){var f=this.getUniversalPosition(e);d.x+=f.x,d.y+=f.y}}return d}};var DOMUtil=new _DOMUtil;_XMLParser.prototype={_logger:SystemLogger.getLogger("XMLParser"),_domParser:null!=window.DOMParser&&null!=window.XPathResult?new DOMParser:null,parse:function(a,b){var c=null;if(null==a)throw"XMLParser: No XML input to parse!";if(null!=this._domParser){try{c=this._domParser.parseFromString(a,"text/xml")}catch(b){alert(a)}c.documentElement.namespaceURI==Constants.NS_DOMPARSEERROR&&(b||(this._logger.error(DOMSerializer.serialize(c.documentElement,!0)),Application.isDeveloperMode&&alert("XMLParser failed: \n\n"+DOMSerializer.serialize(c.documentElement,!0))),c=null)}else c=DOMUtil.getDOMDocument(),c.setProperty("ProhibitDTD",!1),c.validateOnParse=!1,c.async=!1,c.loadXML(a),0!=c.parseError.errorCode&&(b||(this._logger.error("XMLParser failed!"),Application.isDeveloperMode&&alert("XMLParser failed!")),c=null);return c},isWellFormedDocument:function(a,b,c){var d=!0,e='<?xml version="1.0" encoding="UTF-8"?>';-1==a.indexOf("<?xml ")&&(a=e+a);var f=SourceValidationService.IsWellFormedDocument(a);return"True"!=f&&(d=!1,1==b&&(c?confirm("Not well-formed\n"+f+"\nContinue?")&&(d=!0):this._illFormedDialog(f))),d},isWellFormedFragment:function(a,b){var c=!0,d=SourceValidationService.IsWellFormedFragment(a);return"True"!=d&&(c=!1,1==b&&this._illFormedDialog(d)),c},_illFormedDialog:function(a){setTimeout(function(){Dialog.error("Not well-formed",a)},0)}};var XMLParser=new _XMLParser;XPathResolver.prototype.setNamespacePrefixResolver=function(a){this._evaluator?this._nsResolver={lookupNamespaceURI:function(b){return a[b]}}:this._nsResolver=a},XPathResolver.prototype.resolve=function(a,b,c){var d=null;try{d=this._evaluator?this._evaluateDOMXpath(a,b,c?!0:!1):this._evaluateMSXpath(a,b,c?!0:!1)}catch(a){throw alert("XPathResolver#resolve: "+a),a.stack?alert(a.stack):alert(arguments.caller.callee.toString()),a}return d},XPathResolver.prototype.resolveAll=function(a,b){return this.resolve(a,b,!0)},XPathResolver.prototype._evaluateDOMXpath=function(a,b,c){var d=null;if(b){var d=this._evaluator.evaluate(a,b,this._nsResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(c){for(var e=new List;null!=(b=d.iterateNext());)e.add(b);d=e}else d=d.iterateNext()}else{var f="XPathResolver#_evaluateDOMXpath: No DOMNode to evaluate!";Application.isDeveloperMode?alert(f):this.logger.fatal(f)}return d},XPathResolver.prototype._evaluateMSXpath=function(a,b,c){var d=b.nodeType==Node.DOCUMENT_NODE?b:b.ownerDocument,e="";for(var f in this._nsResolver)e+="xmlns:"+f+'="'+this._nsResolver[f]+'" ';if(d.setProperty("SelectionNamespaces",e),c){for(var g=new List,h=0,i=b.selectNodes(a);h<i.length;)g.add(i.item(h++));result=g}else result=b.selectSingleNode(a);return result},XSLTransformer.prototype.importStylesheet=function(a){var b=this._import(Resolver.resolve(a));Client.hasXSLTProcessor?(this._processor=new XSLTProcessor,this._processor.importStylesheet(b)):(this._cache=DOMUtil.getMSXMLXSLTemplate(),this._cache.stylesheet=b)},XSLTransformer.prototype._import=function(a){var b=null;if(Client.hasXSLTProcessor){var c=DOMUtil.getXMLHTTPRequest();c.open("get",Resolver.resolve(a),!1),c.send(null),b=c.responseXML}else{var b=DOMUtil.getDOMDocument(!0);b.async=!1,b.load(a)}return b},XSLTransformer.prototype.transformToDocument=function(a){var b=null;return Client.hasXSLTProcessor?b=this._processor.transformToDocument(a):alert("TODO!"),b},XSLTransformer.prototype.transformToString=function(a,b){var c=null;if(Client.hasXSLTProcessor){var d=this.transformToDocument(a);c=DOMSerializer.serialize(d,b)}else{var e=this._cache.createProcessor();e.input=a,e.transform(),c=e.output}return c},_CSSUtil.prototype={_getCurrent:function(a){var b=a.style?a.className:a.getAttribute("class");return b=b?b:""},_contains:function(a,b){return a.indexOf(b)>-1},_attach:function(a,b){return a+(""==a?"":" ")+b},_detach:function(a,b){return this._contains(a," "+b)&&(b=" "+b),a.replace(b,"")},attachClassName:function(a,b){if(null!=a.classList)a.classList.contains(b)||a.classList.add(b);else{var c=this._getCurrent(a);this._contains(c,b)||(c=this._attach(c,b)),null!=a.style?a.className=c:a.setAttribute("class",c)}},detachClassName:function(a,b){if(null!=a.classList)a.classList.contains(b)&&a.classList.remove(b);else{var c=this._getCurrent(a);this._contains(c,b)&&(c=this._detach(c,b)),null!=a.style?a.className=c:""==c?a.removeAttribute("class"):a.setAttribute("class",c)}},hasClassName:function(a,b){var c=!1;return c=null!=a.classList?a.classList.contains(b):this._contains(this._getCurrent(a),b)}};var CSSUtil=new _CSSUtil;_CSSComputer.prototype={_margins:{top:Client.isExplorer?"marginTop":"margin-top",right:Client.isExplorer?"marginRight":"margin-right",bottom:Client.isExplorer?"marginBottom":"margin-bottom",left:Client.isExplorer?"marginLeft":"margin-left"},_paddings:{top:Client.isExplorer?"paddingTop":"padding-top",right:Client.isExplorer?"paddingRight":"padding-right",bottom:Client.isExplorer?"paddingBottom":"padding-bottom",left:Client.isExplorer?"paddingLeft":"padding-left"},_borders:{top:Client.isExplorer?"borderTopWidth":"border-top-width",right:Client.isExplorer?"borderRightWidth":"border-right-width",bottom:Client.isExplorer?"borderBottomWidth":"border-bottom-width",left:Client.isExplorer?"borderLeftWidth":"border-left-width"},_getComplexResult:function(a,b){var c={};for(var d in a){var e=parseInt(DOMUtil.getComputedStyle(b,a[d]));c[d]=isNaN(e)?0:e}return c},getMargin:function(a){return this._getComplexResult(this._margins,a)},getPadding:function(a){return this._getComplexResult(this._paddings,a)},getBorder:function(a){return this._getComplexResult(this._borders,a)},getPosition:function(a){return DOMUtil.getComputedStyle(a,"position")},getFloat:function(a){return DOMUtil.getComputedStyle(a,Client.isExplorer?"styleFloat":"float")},getZIndex:function(a){return parseInt(DOMUtil.getComputedStyle(a,Client.isExplorer?"zIndex":"z-index"))},getBackgroundColor:function(a){return DOMUtil.getComputedStyle(a,Client.isExplorer?"backgroundColor":"background-color")},getWidth:function(a){return DOMUtil.getComputedStyle(a,"width")}};var CSSComputer=new _CSSComputer,System=new function(){var a=SystemLogger.getLogger("System"),b=null,c=null;this.hasActivePerspectives=!1,this.nodes=new Map,this.parents=new Map,this.getDefaultEntityToken=function(a){return null==c&&(c={},new List(TreeService.GetDefaultEntityTokens(!0)).each(function(a){c[a.Key]=a.Value})),c[a]},this.getRootNode=function(){return null==b&&(b=new SystemNode(TreeService.GetRootElements("")[0])),b},this.getPerspectiveNodes=function(){var a=new List,b=TreeService.GetActivePerspectiveElements("dummy"),c=new List(b);return c.hasEntries()?(this.hasActivePerspectives=!0,c.each(function(b){a.add(new SystemNode(b))})):EventBroadcaster.broadcast(BroadcastMessages.PERSPECTIVES_NONE),a},this.getChildNodes=function(a,b){var c=new List,d=null,e=this;return b?(SearchTokens.hasToken(b)&&(b=SearchTokens.getToken(b)),d=TreeService.GetElementsBySearchToken(a.getData(),b)):d=TreeService.GetElements(a.getData()),new List(d).each(function(d){var f=new SystemNode(d);b&&(f.searchToken=b),c.add(f),b||e.parents.set(f.getHandle(),a)}),this.groupListByBundles(c)},this.getParents=function(a){for(var b=new List,c=new List;this.parents.has(a)&&!b.has(a);){var d=this.parents.get(a);b.add(a),c.add(d),a=d.getHandle()}return c},this.getDescendantBranch=function(a){var b=new Map,c=[];a.each(function(a){c.push({ProviderName:a.getProviderName(),EntityToken:a.getEntityToken(),Piggybag:a.getPiggyBag(),SearchToken:a.searchToken})});for(var d=TreeService.GetMultipleChildren(c),e=new List(d);e.hasNext();)this._listNodesInMap(e.getNext(),b);return this.groupMapByBundles(b)},this.getInvisibleBranch=function(b,c,d){var e=new Map,f=[];d.each(function(a){f.push({ProviderName:a.getProviderName(),EntityToken:a.getEntityToken(),Piggybag:a.getPiggyBag()})});var g=TreeService.FindEntityToken(b,c,f);if(g instanceof SOAPFault)a.error(g.getFaultString()),Application.isDeveloperMode&&alert(g.getFaultString()),e=null;else for(var h=new List(g);h.hasNext();)this._listNodesInMap(h.getNext(),e);return this.groupMapByBundles(e)},this._listNodesInMap=function(a,b){var c=new List,d=a.ElementKey,e=new List(a.ClientElements);for(b.set(d,c);e.hasNext();){var f=e.getNext();c.add(new SystemNode(f))}var g=this;b.each(function(a,b){g.nodes.set(a,b.copy())})},this.getChildNodesBySearchToken=function(a,b){return this.getChildNodes(a,b)},this.getNamedRoots=function(a,b){var c=new List,d=null;return b?(SearchTokens.hasToken(b)&&(b=SearchTokens.getToken(b)),d=TreeService.GetNamedRootsBySearchToken(a,b)):d=TreeService.GetNamedRoots(a),new List(d).each(function(a){var d=new SystemNode(a);b&&(d.searchToken=b),c.add(d)}),c},this.getNamedRootsBySearchToken=function(a,b){return this.getNamedRoots(a,b)},this.groupListByBundles=function(a){for(var b=new List,c=new Map;a.hasEntries();){var d=a.extractFirst(),e=d.getData().ElementBundle;if(e){var f=null;c.has(e)?(f=c.get(e),f.add(d)):(b.add(d),c.set(e,d))}else b.add(d)}return b},this.groupMapByBundles=function(a){var b=new Map;return a.each(function(c){b.set(c,this.groupListByBundles(a.get(c)))},this),b}};SystemNode.dispose=function(a){for(var b in a)a[b]=null},SystemNode.taggedNodes=new Map,SystemNode.prototype.toString=function(){return"[SystemNode]"},SystemNode.prototype._registerSystemActions=function(){var a=this;new List(this._data.ActionKeys).each(function(b){SystemAction.actionMap.has(b)||new List(a._data.Actions).each(function(a){var b=a.ActionCategory.Name;if(!SystemAction.hasCategory(b))throw"No such action category: "+b;var c=new SystemAction(a);SystemAction.actionMap.set(a.ActionKey,c)})})},SystemNode.prototype.getData=function(){return this._data},SystemNode.prototype.getChildren=function(){var a=null;return a=this.searchToken?System.getChildNodesBySearchToken(this,this.searchToken):System.getChildNodes(this)},SystemNode.prototype.getDescendantBranch=function(a){return System.getDescendantBranch(a)},SystemNode.prototype.getLabel=function(){return this._data.Label},SystemNode.prototype.getProviderName=function(){return this._data.ProviderName;
},SystemNode.prototype.getEntityToken=function(){return this._data.EntityToken},SystemNode.prototype.getPiggyBag=function(){var a=this._data.Piggybag;return null==a&&(a=""),a},SystemNode.prototype.getHandle=function(){return this._data.ElementKey},SystemNode.prototype.getHandles=function(){var a=new List;return null!=this._datas?this._datas.each(function(b){a.add(b.ElementKey)}):a.add(this._data.ElementKey),a},SystemNode.prototype.getTag=function(){return this._data.TagValue},SystemNode.prototype.getImageProfile=function(a){return new ImageProfile({image:ImageProvider.getImageURL(this._data.Icon,a),imageActive:ImageProvider.getImageURL(this._data.OpenedIcon?this._data.OpenedIcon:this._data.Icon,a)})},SystemNode.prototype.getToolTip=function(){var a=null;return"undefined"!=typeof this._data.ToolTip&&(a=this._data.ToolTip),a},SystemNode.prototype.getPropertyBag=function(){if(!this._propertyBag&&this._data.PropertyBag&&0!=this._data.PropertyBag.length){var a={};new List(this._data.PropertyBag).each(function(b){a[b.Key]=b.Value}),this._propertyBag=a}return this._propertyBag},SystemNode.prototype.hasChildren=function(){return this._data.HasChildren},SystemNode.prototype.getActionProfile=function(){if(null==this._actionProfile&&null!=this._data.ActionKeys&&this._data.ActionKeys.length>0){var a=new Map;new List(this._data.ActionKeys).each(function(b){if(!SystemAction.actionMap.has(b))throw"No details for action key: "+b;var c=SystemAction.actionMap.get(b),d=!0;if(c.getCategory()==SystemAction.categories.DeveloperMode&&(Application.isDeveloperMode||(d=!1)),d){var e=c.getGroupID();a.has(e)||a.set(e,new List);var f=a.get(e);f.add(c)}}),this._actionProfile=a}return this._actionProfile},SystemNode.prototype.hasDragType=function(){return null!=this._data.DragType},SystemNode.prototype.getDragType=function(){return this._data.DragType},SystemNode.prototype.hasDragAccept=function(){return null!=this._data.DropTypeAccept},SystemNode.prototype.getDragAccept=function(){return new List(this._data.DropTypeAccept)},SystemNode.prototype.hasDetailedDropSupport=function(){return 1==this._data.DetailedDropSupported},SystemNode.prototype.isDisabled=function(){return 1==this._data.IsDisabled},SystemNode.prototype.isTreeLockEnabled=function(){return 1==this._data.TreeLockEnabled},SystemNode.prototype.isMultiple=function(){return null!=this._datas},SystemNode.prototype.getDatas=function(){return this._datas},SystemNode.prototype.select=function(a){null!=this._datas&&this._datas.each(function(b){return b.ElementKey===a?(this._data=b,this._actionProfile=null,this._registerSystemActions(),!1):!0},this)},SystemNode.prototype.selectByToken=function(a){null!=this._datas&&this._datas.each(function(b){return b.EntityToken===a?(this._data=b,this._actionProfile=null,this._registerSystemActions(),!1):!0},this)},SystemNode.prototype.getEntityTokens=function(){var a=new List;return null!=this._datas?this._datas.each(function(b){a.add(b.EntityToken)}):a.add(this._data.EntityToken),a},SystemNode.prototype.add=function(a){return null==this._datas&&(this._datas=new List,this._datas.add(this._data)),this._datas.add(a.getData()),this},SystemNode.prototype.dispose=function(){SystemNode.dispose(this)},SystemAction.OPEN_DOCUMENT="OpenDocument",SystemAction.OPEN_MODAL_DIALOG="OpenModalDialog",SystemAction.TAG_CHANGEFROMLANGUAGE="ChangeFromLocale",SystemAction.TAG_USER="User",SystemAction.categories={Edit:"Edit",Add:"Add",Delete:"Delete",Other:"Other",DeveloperMode:"DeveloperMode"},SystemAction.activePositions={NavigatorTree:1,SelectorTree:2},SystemAction.taggedActions=new Map,SystemAction.actionMap=new Map,SystemAction.invoke=function(a,b){var c=b;if(!(c instanceof SystemNode))throw"Multiple actiontargets not supported.";Application.lock(SystemAction),a.logger.debug('Execute "'+a.getLabel()+'" on "'+c.getLabel()+'".'),TreeService.ExecuteSingleElementAction(c.getData(),a.getHandle(),Application.CONSOLE_ID),MessageQueue.update(a.isSyncedRequest()),Application.unlock(SystemAction)},SystemAction.invokeTagged=function(a,b){action=SystemAction.taggedActions.get(a),node=SystemNode.taggedNodes.get(b),SystemAction.invoke(action,node)},SystemAction.hasCategory=function(a){return SystemAction.categories[a]?!0:!1},SystemAction.prototype.toString=function(){return"[SystemAction]"},SystemAction.prototype.getHandle=function(){return this._data.ActionToken},SystemAction.prototype.getKey=function(){return this._data.ActionKey},SystemAction.prototype.getLabel=function(){return this._data.Label},SystemAction.prototype.getImage=function(){return ImageProvider.getImageURL(this._data.Icon)},SystemAction.prototype.getDisabledImage=function(){return null},SystemAction.prototype.getToolTip=function(){return this._data.ToolTip},SystemAction.prototype.getCategory=function(){return this._data.ActionCategory.Name},SystemAction.prototype.getGroupID=function(){return this._data.ActionCategory.GroupId},SystemAction.prototype.getGroupName=function(){return this._data.ActionCategory.GroupName},SystemAction.prototype.getActivePositions=function(){return this._data.ActivePositions},SystemAction.prototype.isInToolBar=function(){return this._data.ActionCategory.IsInToolbar},SystemAction.prototype.isInFolder=function(){return this._data.ActionCategory.IsInFolder},SystemAction.prototype.isSyncedRequest=function(){return!0},SystemAction.prototype.getBundleName=function(){return this._data.ActionCategory.ActionBundle},SystemAction.prototype.getBulkExecutionDialog=function(){return this._data.BulkExecutionDialog},SystemAction.prototype.getFolderName=function(){var a=null;return this.isInFolder()&&(a=this._data.ActionCategory.FolderName),a},SystemAction.prototype.isDisabled=function(){return this._data.Disabled},SystemAction.prototype.isCheckBox=function(){return typeof this._data.CheckboxStatus!=Types.UNDEFINED},SystemAction.prototype.getTag=function(){var a=null;return"undefined"!=typeof this._data.TagValue&&(a=this._data.TagValue),a},SystemAction.prototype.isChecked=function(){var a=null;if(!this.isCheckBox())throw"Not a checkbox!";return a="Checked"==this._data.CheckboxStatus},_UpdateManager.prototype={version:"0.1",CLASSNAME_FORM:"updateform",CLASSNAME_ZONE:"updatezone",CLASSNAME_GONE:"updategone",EVENT_BEFOREUPDATE:"beforeupdate",EVENT_AFTERUPDATE:"afterupdate",EVENT_ERRORUPDATE:"errorupdate",xhtml:null,summary:null,isEnabled:!0,isDebugging:!1,isUpdating:!1,hasSoftAttributes:!1,hasSoftSiblings:!1,pendingResponse:null,currentDOM:null,errormessage:null,_assistant:null,_updates:null,_replaced:null,_dotnetnames:["__VIEWSTATE","__EVENTVALIDATION","__EVENTTARGET","__EVENTARGUMENT","__LASTFOCUS"],plugins:[],toString:function(){return"[object UpdateManager]"},_construct:function(a){var b=document.documentElement,c=b.namespaceURI;null==c&&(c=new String(b.getAttribute("xmlns"))),"http://www.w3.org/1999/xhtml"==c?(this._addListener(window,"load"),this._addListener(window,"unload")):this.error("Not an XHTML document!")},_setup:function(){if(this.isEnabled&&(this.isEnabled=this.setupForms(),this.isEnabled))if(null!=this.xhtml){if("string"!=typeof this.xhtml)throw new TypeError;var a=decodeURIComponent(this.xhtml);this.currentDOM=UpdateAssistant.parse(a)}else{var b=this;UpdateAssistant.getXMLHttpRequest("get",window.location.toString(),{handleResponse:function(a){b.currentDOM=a}}).send(null)}},setupForms:function(){var a=!1;return Array.forEach(document.forms,function(b){b.className.indexOf(this.CLASSNAME_FORM)>-1&&(b.__isSetup||(this._setupForm(b),b.__isSetup=!0),a=!0)},this),a},_setupForm:function(a){var b=this;this._addListener(a,"submit"),a.__submit=a.submit,a.submit=function(){return b.isEnabled?b._submit(a):a.__submit(),!1}},_addListener:function(a,b){if(null!=a.addEventListener)a.addEventListener(b,this,!1);else{var c=this;a.attachEvent("on"+b,function(){c.handleEvent(window.event)})}},handleEvent:function(a){switch(a.type){case"load":this.isEnabled&&this._setup();break;case"unload":this.isEnabled=!1;break;case"submit":if(this.isEnabled){document.all?a.returnValue=!1:a.preventDefault();var b=a.target?a.target:a.srcElement;this._submit(b)}}},_submit:function(a){this.isUpdating||(this.isUpdating=!0,UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_BEFOREUPDATE),this._postRequest(a))},handleResponse:function(a){if(this.isEnabled&&(this.summary=new String(""),this.errors=new String(""),null!=a)){var b=UpdateAssistant.getUpdateZones(a),c=UpdateAssistant.getUpdateZones(this.currentDOM);this._updates=[],this._replaced={},b.forEach(function(a,b){var d=c[b];this._crawl(a,d)},this),this._updates.forEach(function(a,b){a.update(),a.dispose()},this),this._dotnetnames.forEach(function(b){this._fixdotnet(a,b)},this),this.currentDOM=a}this.isUpdating=!1,UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_AFTERUPDATE)},handleSimilarResponse:function(){UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_AFTERUPDATE)},_crawl:function(a,b,c,d){var e=!0,f=b.getAttribute("class");if(null==f||-1==f.indexOf(this.CLASSNAME_GONE)){if(b.nodeType==Node.ELEMENT_NODE){var g=b.getAttribute("id");null!=g&&(c=a,d=g)}if(e=this._check(a,b,c,d))for(var h=a.firstChild,i=b.firstChild;null!=h&&null!=i&&!this._replaced[d];){switch(h.nodeType){case Node.TEXT_NODE:e=this._check(h,i,c,d);break;case Node.DOCUMENT_NODE:case Node.ELEMENT_NODE:e=this._crawl(h,i,c,d)}this._replaced[d]?e=!1:(h=h.nextSibling,i=i.nextSibling)}}return e},_check:function(a,b,c,d){var e=!0,f=null,g=!1,h=!1;if(null!=a&&null==b||null==a&&null!=b)e=!1;else if(e=a.nodeType==b.nodeType)switch(b.nodeType){case Node.ELEMENT_NODE:if(a.namespaceURI!=b.namespaceURI||a.nodeName!=b.nodeName)e=!1;else if(e=a.nodeName==b.nodeName){var i=b.getAttribute("id"),j=a.getAttribute("id");null!=i&&null!=j&&(i!=j?e=!1:null!=(f=this._getPlugin(a,b))&&f.updateElement(a,b)&&(h=!0,e=!1)),e&&(e=this._checkAttributes(a,b))&&(this.hasSoftSiblings&&this._hasSoftChildren(a)&&this._hasSoftChildren(b)?(this._validateSoftChildren(a,b)&&(this._updateSoftChildren(a,b),g=!0),e=!1):e=a.childNodes.length==b.childNodes.length)}break;case Node.TEXT_NODE:a.data.trim()!=b.data.trim()&&(e=!1)}return 0!=e||g||h||null!=d&&null!=c&&this.addUpdate(new ReplaceUpdate(d,c)),e},_checkAttributes:function(a,b){var c=!0,d=!1,e=a.attributes,f=b.attributes;if(d=e.length!=f.length?!0:!Array.every(e,function(a,b){var c=f.item(b);return a.nodeName==c.nodeName&&a.nodeValue==c.nodeValue})){var g=a.getAttribute("id"),h=b.getAttribute("id");this.hasSoftAttributes&&null!=g&&g==h?this.addUpdate(new AttributesUpdate(h,a,b)):c=!1}return c},_hasSoftChildren:function(a){var b=!0;return a.hasChildNodes()&&(b=Array.every(a.childNodes,function(a){var b=!0;switch(a.nodeType){case Node.TEXT_NODE:b=!/[^\t\n\r ]/.test(a.nodeValue);break;case Node.ELEMENT_NODE:b=null!=a.getAttribute("id")}return b})),b},_validateSoftChildren:function(a,b){var c=!0,d=-1,e=-1,f=-1,g=this._toMap(a.childNodes,!0),h=this._toMap(b.childNodes,!0);for(var i in h){if(c){var j=h[i];c=j>=d,null!=g[i]&&(f=g[i],c=f>=e)}d=j,f>-1&&(e=f)}return c},_updateSoftChildren:function(a,b){var c=this._toMap(a.childNodes),d=this._toMap(b.childNodes);for(var e in d)null==c[e]?this.addUpdate(new SiblingUpdate(Update.TYPE_REMOVE,e,null,null)):this._crawl(c[e],d[e]);var f=null;for(e in c){if(null==d[e]){var g=c[e];if(null==f){var h=b.getAttribute("id");this.addUpdate(new SiblingUpdate(Update.TYPE_INSERT,h,g,!0))}else this.addUpdate(new SiblingUpdate(Update.TYPE_INSERT,f,g,!1))}f=e}},addUpdate:function(a){this._updates.push(a),a instanceof ReplaceUpdate&&(this._replaced[a.id]=!0)},_getPlugin:function(a,b){var c=null;return this.plugins.every(function(d){return d.handleElement(a,b)&&(c=d),null==c}),c},_toMap:function(a,b){var c={};return Array.forEach(a,function(a,d){a.nodeType==Node.ELEMENT_NODE&&(c[a.getAttribute("id")]=b?d:a)}),c},_getPost:function(a){var b=new String("");if(null!=a){var c="";Array.forEach(a.elements,function(a){if(null!=a.name&&""!=a.name){var d=a.name,e=encodeURIComponent(a.value);switch(a.type){case"button":case"submit":var f=UpdateAssistant.getActiveElement();a==f&&""!=d&&(b+=d+"="+e+"&");break;case"radio":a.checked&&(b+=d+"="+e+"&");break;case"checkbox":a.checked&&(a.name==c?(b.lastIndexOf("&")==b.length-1&&(b=b.substr(0,b.length-1)),b+=","+e):b+=d+"="+a.value,c=d,b+="&");break;case"text":case"hidden":case"password":case"textarea":case"select-one":b+=d+"="+e+"&"}}})}return b.substr(0,b.length-1)},_postRequest:function(a){var b=""!=a.method?a.method:"get",c=""!=a.action?a.action:window.location.toString(),d=this._getPost(a);"get"==b&&c.indexOf("?")>-1&&(c=c+"&"+d);var e=UpdateAssistant.getXMLHttpRequest(b,c,this);"post"==b&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send("post"==b?d:null)},_fixdotnet:function(a,b){var c=document.getElementById(b);if(null!=c){var d=UpdateAssistant.getElementById(a,b);if(null!=d){var e=d.getAttribute("value");e!==c.value&&(c.value=e)}}},debug:function(a){this.isDebugging&&alert("UpdateManager dysfunction. \n\n"+a)},error:function(a){this.errorsmessage=a,UpdateAssistant.dispatchEvent(document.documentElement,UpdateManager.EVENT_ERRORUPDATE),this.debug(a)},report:function(a){this.summary+=a+"\n"}};var UpdateManager=new _UpdateManager;_UpdateAssistant.prototype={_serializer:null!=window.XMLSerializer?new XMLSerializer:null,_parser:null!=window.DOMParser&&null!=window.XPathResult?new DOMParser:null,_activeElement:null,_construct:function(){window.Node||(window.Node={ELEMENT_NODE:1,TEXT_NODE:3,DOCUMENT_NODE:9}),Array.every||(Array.every=function(a,b){var c=!0,d=a.length>>>0;if("function"!=typeof b)throw new TypeError;for(var e=arguments[2],f=0;d>f;f++)if("undefined"!=typeof a[f]&&!b.call(e,a[f],f,a)){c=!1;break}return c}),Array.prototype.every||(Array.prototype.every=function(a){var b=arguments[1];return Array.every(this,a,b)}),Array.forEach||(Array.forEach=function(a,b){var c=a.length>>>0;if("function"!=typeof b)throw new TypeError;for(var d=arguments[2],e=0;c>e;e++)"undefined"!=typeof a[e]&&b.call(d,a[e],e,a)}),Array.prototype.forEach||(Array.prototype.forEach=function(a){var b=arguments[1];Array.forEach(this,a,b)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")}),null!=document.addEventListener&&(document.addEventListener("focus",this,!1),document.addEventListener("blur",this,!1),document.addEventListener("mousedown",this,!1))},handleEvent:function(a){switch(a.type){case"focus":case"mousedown":this._activeElement=a.target;break;case"blur":this._activeElement==a.target&&(this._activeElement=null)}},getXMLHttpRequest:function(a,b,c){function d(){if(4==e.readyState){var a=e.getResponseHeader("X-Error-Type");if(a){for(var b="",d=0;10>d;d++){var f=d?d:"",a=e.getResponseHeader("X-Error-Type"+f);if(!a)break;var g=e.getResponseHeader("X-Error-Message"+f);b+=a+"\n"+g+"\n"}Dialog.error("Error",b)}else{var h=e.responseText;UpdateManager.pendingResponse=h;var i=UpdateAssistant.parse(h);null!=i&&c.handleResponse(i)}}}var e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Msxml2.XMLHTTP.3.0");return null!=e&&(e.open(a,b,null!=c?!0:!1),null!=c&&(null!=e.addEventListener?e.addEventListener("readystatechange",{handleEvent:function(){d()}},!1):e.onreadystatechange=d)),e},dispatchEvent:function(a,b){var c=!0,d=document.createEvent("UIEvents");return d.initEvent(b,!0,!0),c=a.dispatchEvent(d)},getUpdateZones:function(a){var b="//*[@id and contains(@class,'updatezone')]",c=[],d=null,e=null;if(null!=window.XPathResult){var f=XPathResult.ORDERED_NODE_ITERATOR_TYPE;for(d=a.evaluate(b,a,null,f,null);null!=(e=d.iterateNext());)c.push(e)}else d=a.documentElement.selectNodes(b),Array.forEach(d,function(a){c.push(a)});return c},getElementById:function(a,b){var c="//*[@id='"+b+"']",d=null,e=null;if(null!=window.XPathResult){var f=XPathResult.FIRST_ORDERED_NODE_TYPE;d=a.evaluate(c,a,null,f,null),e=d.singleNodeValue}else e=a.documentElement.selectNodes(c)[0];return e},_getIds:function(a){var b="//*[@id]",c=null,d=[];if(null!=window.XPathResult){var e=XPathResult.ORDERED_NODE_ITERATOR_TYPE;for(c=a.evaluate(b,a,null,e,null);null!=(element=c.iterateNext());)d.push(element.getAttribute("id"))}else c=a.documentElement.selectNodes(b),Array.forEach(c,function(a){d.push(a.getAttribute("id"))});return d},toHTMLElement:function(a){var b=this.serialize(a),c=document.createElement("temp");return c.innerHTML=b,c.firstChild},getActiveElement:function(){var a=document.activeElement;return(null==a||a==document.body)&&(a=this._activeElement),a},serialize:function(a){var b=null;return null!=a.xml?b=a.xml:null!=this._serializer&&(b=this._serializer.serializeToString(a)),b},hasDifferences:function(a,b){var c=null,d=null;return null!=a.xml?(c=a.xml,d=b.xml):null!=this._serializer&&(c=this._serializer.serializeToString(a),d=this._serializer.serializeToString(b)),c!=d},parse:function(a){var b=null;return null!=this._parser&&null!=window.XPathResult?b=this._parser.parseFromString(a,"text/xml"):(b=new ActiveXObject("Msxml2.DOMDocument.3.0"),b.setProperty("SelectionLanguage","XPath"),b.loadXML(a)),this._validate(b)},_validate:function(a){var b=null;if(null!=a.parseError&&0!=a.parseError.errorCode)b=a.parseError.reason;else{var c=a.getElementsByTagName("parsererror").item(0);null!=c&&(b=c.textContent.replace(/\^/g,"").replace(/\-/g,""))}if(null==b){var d={},e=this._getIds(a);e.every(function(a){var c=!d[a];return d[a]=!0,c||(b='Element "'+a+'" encountered twice.'),c})}return null!=b&&(UpdateManager.error(b),a=null),a}};var UpdateAssistant=new _UpdateAssistant;UpdateManager.plugins.push(new UpdatePlugin),Update.TYPE_REPLACE="replace",Update.TYPE_ATTRIBUTES="attributes",Update.TYPE_REMOVE="remove",Update.TYPE_INSERT="insert",Update.EVENT_BEFOREUPDATE="beforeupdate",Update.EVENT_AFTERUPDATE="afterupdate",Update.prototype={type:null,key:null,id:null,element:null,update:function(){},dispose:function(){this.element=null},_beforeUpdate:function(a){var b=!0;return null!=a&&(a.__updateType=this.type,b=UpdateAssistant.dispatchEvent(a,Update.EVENT_BEFOREUPDATE)),b},_afterUpdate:function(a){var b=!0;return null!=a&&(a.__updateType=this.type,b=UpdateAssistant.dispatchEvent(a,Update.EVENT_AFTERUPDATE)),b}},ReplaceUpdate.prototype=new Update,ReplaceUpdate.superclass=Update.prototype,ReplaceUpdate.prototype.update=function(){var a,b,c=UpdateAssistant.toHTMLElement(this.element);if(null!=(a=document.getElementById(this.id))){if(null!=(b=a.parentNode)){var d=UserInterface.getBinding(a);null!=d&&(c.__isAttached=d.isAttached),this._beforeUpdate(a)&&(b.replaceChild(c,a),this._afterUpdate(c))}}else UpdateManager.error("Element null point: "+this.id)},ReplaceUpdate.prototype._afterUpdate=function(a){var b=ReplaceUpdate.superclass._afterUpdate.call(this,a);return UpdateManager.report('Replaced element id="'+this.id+'"'),("form"==a.nodeName||null!=a.getElementsByTagName("form").item(0))&&UpdateManager.setupForms(),b},SiblingUpdate.prototype=new Update,SiblingUpdate.superclass=Update.prototype,SiblingUpdate.prototype.update=function(){var a=document.getElementById(this.id);switch(this.type){case Update.TYPE_REMOVE:this._remove(a);break;case Update.TYPE_INSERT:this._insert(this.element,a)}},SiblingUpdate.prototype._remove=function(a){var b=a.parentNode;null!=b&&this._beforeUpdate(a)&&(b.removeChild(a),this._afterUpdate(b))},SiblingUpdate.prototype._insert=function(a,b){var c=UpdateAssistant.toHTMLElement(a);if(this.isFirst){var d=b;null!=d&&this._beforeUpdate(d)&&(d.insertBefore(c,d.firstChild),this._afterUpdate(c))}else{var d=b.parentNode;null!=d&&this._beforeUpdate(d)&&(d.insertBefore(c,b.nextSibling),this._afterUpdate(c))}},SiblingUpdate.prototype._beforeUpdate=function(a){var b=SiblingUpdate.superclass._beforeUpdate.call(this,a);return this.type==Update.TYPE_REMOVE&&UpdateManager.report('Removed element id="'+a.id+'"'),b},SiblingUpdate.prototype._afterUpdate=function(a){var b=!0;return null!=a&&(b=SiblingUpdate.superclass._afterUpdate.call(this,a),this.type==Update.TYPE_INSERT&&(UpdateManager.report('Inserted element id="'+a.id+'"'),("form"==a.nodeName||null!=a.getElementsByTagName("form").item(0))&&UpdateManager.setupForms())),b},AttributesUpdate.prototype=new Update,AttributesUpdate.superclass=Update.prototype,AttributesUpdate.prototype.currentElement=null,AttributesUpdate.prototype.update=function(){var a=document.getElementById(this.id);this._beforeUpdate(a)&&(this._updateAttributes(a),this._afterUpdate(a))},AttributesUpdate.prototype._updateAttributes=function(a){Array.forEach(this.element.attributes,function(b){var c=this.currentElement.getAttribute(b.nodeName);(null==c||c!=b.nodeValue)&&(this._setAttribute(a,b.nodeName,b.nodeValue),this._summary.push("@"+b.nodeName))},this),Array.forEach(this.currentElement.attributes,function(b){null==this.element.getAttribute(b.nodeName)&&(this._setAttribute(a,b.nodeName,null),this._summary.push("@"+b.nodeName))},this)},AttributesUpdate.prototype._setAttribute=function(a,b,c){null==a&&(alert(this.id+": "+document.getElementById(this.id)+"\n\n"+b+"="+c),SystemLogger.getLogger("AttributesUpdate").fine(document.body.innerHTML));var d=null==c;if(d?a.removeAttribute(b):a.setAttribute(b,c),null!=document.all)switch(d&&(c=""),b.toLowerCase()){case"class":a.className=c;break;case"disabled":a.disabled=!d;break;case"checked":a.checked=!d;break;case"readonly":a.readOnly=!d}},AttributesUpdate.prototype._afterUpdate=function(a){AttributesUpdate.superclass._afterUpdate.call(this,a),UpdateManager.report('Attributes updated on element id="'+this.id+'": '+this._summary.toString())},AttributesUpdate.prototype.dispose=function(){Update.prototype.dispose.call(this),this.currentElement=null},window.Node||(window.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),window.KeyEventCodes={VK_BACK:8,VK_TAB:9,VK_ENTER:13,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_COMMAND:91,VK_INSERT:null,VK_DELETE:127,VK_PLUS:187,VK_MINUS:189,VK_NUMPLUS:107,VK_NUMMINUS:109,VK_F1:112},window==top?window.app=this:window.app=top.app,window.bindingMap={},window.standardEventHandler=null,window!=window.top&&top.Application.declareTopLocal(window),_WindowManager.prototype={WINDOW_LOADED_BROADCAST:null,WINDOW_UNLOADED_BROADCAST:null,WINDOW_EVALUATED_BROADCAST:null,WINDOW_RESIZED_BROADCAST:null,isWindowLoaded:!1,_logger:SystemLogger.getLogger("WindowManager ["+document.title+"]"),_ondomstatements:new List,_onloadstatements:new List,_onresizestatements:new List,_currentDimensions:null,_newDimensions:null,_broadcastTimeout:null,_isHorizontalResize:!1,_isVerticalResize:!1,_broadcastTimeout:null,_compute:function(a,b){return a.replace("${windowkey}",document.location+":"+b)},_construct:function(a){this.WINDOW_LOADED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_LOADED,a),this.WINDOW_UNLOADED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_UNLOADED,a),this.WINDOW_EVALUATED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_EVALUATED,a),this.WINDOW_RESIZED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_RESIZED,a),DOMEvents.addEventListener(window,DOMEvents.DOM,this),DOMEvents.addEventListener(window,DOMEvents.LOAD,this),DOMEvents.addEventListener(window,DOMEvents.UNLOAD,this)},handleEvent:function(a){switch(a.type){case DOMEvents.DOM:this.onDOMContentLoaded();break;case DOMEvents.LOAD:if(!this.isWindowLoaded){for(this.isWindowLoaded=!0,EventBroadcaster.broadcast(this.WINDOW_LOADED_BROADCAST,this);this._onloadstatements.hasNext();)this._onloadstatements.getNext().fireOnLoad();this._currentDimensions=this.getWindowDimensions(),DOMEvents.addEventListener(window,DOMEvents.RESIZE,this),EventBroadcaster.broadcast(this.WINDOW_EVALUATED_BROADCAST,this),DOMEvents.removeEventListener(window,DOMEvents.LOAD,this),DOMEvents.stopPropagation(a)}break;case DOMEvents.RESIZE:for(window==top&&EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,document.body),this._onresizestatements.reset();this._onresizestatements.hasNext();)this._onresizestatements.getNext().fireOnResize();this._newDimensions=WindowManager.getWindowDimensions();var b=this._newDimensions.w!=this._currentDimensions.w,c=this._newDimensions.h!=this._currentDimensions.h;if(b||c){null!=this._broadcastTimeout&&(clearTimeout(this._broadcastTimeout),this._broadcastTimeout=null);var d=this;this._broadcastTimeout=setTimeout(function(){d._broadcastResizeEvent()},250)}break;case DOMEvents.UNLOAD:EventBroadcaster.broadcast(this.WINDOW_UNLOADED_BROADCAST)}},_broadcastResizeEvent:function(){clearTimeout(this._broadcastTimeout),this._broadcastTimeout=null,EventBroadcaster.broadcast(this.WINDOW_RESIZED_BROADCAST),this._currentDimensions=this._newDimensions},fireOnDOM:function(a){Interfaces.isImplemented(IDOMHandler,a,!0)&&this._ondomstatements.add(a)},fireOnLoad:function(a){Interfaces.isImplemented(ILoadHandler,a,!0)&&this._onloadstatements.add(a)},fireOnResize:function(a){Interfaces.isImplemented(IResizeHandler,a,!0)&&this._onresizestatements.add(a)},onDOMContentLoaded:function(){for(;this._ondomstatements.hasNext();)this._ondomstatements.getNext().fireOnDOM()},getWindowDimensions:function(){return new Dimension(Client.isMozilla?window.innerWidth:document.body.clientWidth,Client.isMozilla?window.innerHeight:document.body.clientHeight)},evaluate:function(string){return eval(string)}};var WindowManager=new _WindowManager;!new function(){Client.isExplorer&&WindowManager.onDOMContentLoaded()},top.app=null,_Application.prototype={CONSOLE_ID:KeyMaster.getUniqueKey(),_TIMEOUT_LOSTFOCUS:250,logger:SystemLogger.getLogger("Application"),timer:SystemTimer.getTimer("Application"),isDeveloperMode:!1,isLocalHost:!1,hasExternalConnection:!1,isLoggedIn:!1,isLoggedOut:!1,isLocked:!1,hasStartPage:!0,isMalFunctional:!1,isOperational:!1,isShuttingDown:!1,isOffLine:!1,isFocused:!0,isBlurred:!1,isTestEnvironment:!0,_isMousePositionTracking:!1,_mousePosition:null,_cursorStartPoint:null,_isDragging:!1,_isShutDownAllowed:!0,_lockers:0,_lockthings:{},_isRegistered:null,_activeBinding:null,_activatedBindings:new List,_dirtyTabs:new Map,_topLevelClasses:"undefined"!=typeof topLevelClassNames?new List(topLevelClassNames):null,_construct:function(){EventBroadcaster.subscribe(WindowManager.WINDOW_EVALUATED_BROADCAST,{handleBroadcast:function(){try{Application.initialize()}catch(a){throw SystemDebug.stack(arguments),a}}}),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMLOG_OPENED,{handleBroadcast:function(a,b){SystemLogger.unsuspend(b)}}),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMLOG_CLOSED,{handleBroadcast:function(){SystemLogger.suspend()}}),EventBroadcaster.subscribe(BroadcastMessages.STAGE_INITIALIZED,{handleBroadcast:function(){setTimeout(function(){ProgressBarBinding.notch(4),Application.isOperational=!0,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_OPERATIONAL)},PageBinding.TIMEOUT)}}),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,{handleBroadcast:function(){Application.isLocked&&Application.unlock(Application,!0)}}),EventBroadcaster.subscribe(BroadcastMessages.SERVER_OFFLINE,{handleBroadcast:function(){Application.isOffLine=!0}}),EventBroadcaster.subscribe(BroadcastMessages.SERVER_ONLINE,{handleBroadcast:function(){Application.isOffLine=!1}}),EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_DIRTY,{handleBroadcast:function(a,b){var c=Application._dirtyTabs;if(c.set(b.key,b),1==c.countEntries()){var d=top.app.bindingMap.broadcasterHasDirtyTabs;d.enable()}}}),EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_CLEAN,{handleBroadcast:function(a,b){var c=Application._dirtyTabs;if(c.del(b.key),0==c.countEntries()){var d=top.app.bindingMap.broadcasterHasDirtyTabs;d.disable()}}})},toString:function(){return"[Application]"},login:function(){function a(){EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_LOGIN)}this.isLoggedIn=!0,ConfigurationService=WebServiceProxy.createProxy(Constants.URL_WSDL_CONFIGURATION),ConsoleMessageQueueService=WebServiceProxy.createProxy(Constants.URL_WSDL_MESSAGEQUEUE),EditorConfigurationService=WebServiceProxy.createProxy(Constants.URL_WSDL_EDITORCONFIG),FlowControllerService=WebServiceProxy.createProxy(Constants.URL_WSDL_FLOWCONTROLLER),StringService=WebServiceProxy.createProxy(Constants.URL_WSDL_STRINGSERVICE),TreeService=WebServiceProxy.createProxy(Constants.URL_WSDL_TREESERVICE),SecurityService=WebServiceProxy.createProxy(Constants.URL_WSDL_SECURITYSERVICE),XhtmlTransformationsService=WebServiceProxy.createProxy(Constants.URL_WSDL_XHTMLTRANSFORM),PageTemplateService=WebServiceProxy.createProxy(Constants.URL_WSDL_PAGETEMPLATE),FunctionService=WebServiceProxy.createProxy(Constants.URL_WSDL_FUNCTIONSERVICE),LocalizationService=WebServiceProxy.createProxy(Constants.URL_WSDL_LOCALIZATION),SourceValidationService=WebServiceProxy.createProxy(Constants.URL_WSDL_SOURCEVALIDATION),MarkupFormatService=WebServiceProxy.createProxy(Constants.URL_WSDL_MARKUPFORMAT),PageService=WebServiceProxy.createProxy(Constants.URL_WSDL_PAGESERVICE),ProgressBarBinding.notch(4),Client.isWebKit?setTimeout(function(){a()},0):a()},logout:function(){var a=!1;return this.isLoggedIn&&(this.isLoggedIn=!1,this.isLoggedOut=!0,a=LoginService.Logout(!0),a||alert("Logout failed.")),a},lock:function(a){if(null==a)throw"Application: No locker specified.";this._lockthings[a]=!0,null!=top.bindingMap.mastercover&&this._lockers>=0&&(this._lockers++,1==this._lockers&&(this.isLocked=!0,top.bindingMap.mastercover.show(),null!=top.app&&null!=top.app.bindingMap.throbber&&top.app.bindingMap.throbber.play()))},unlock:function(a,b){if(null==a)throw"Application: No unlocker specified.";if(delete this._lockthings[a],null!=top.bindingMap.mastercover&&(b||this._lockers>0)){if(b){var c="Unlocked by "+new String(a)+"\n";for(var d in this._lockthings)c+="Locked by "+new String(d)+". ";this.logger.debug(c),this._lockers=0}else this._lockers--;0==this._lockers&&(this.isLocked=!1,top.bindingMap.mastercover.hide(),null!=top.app&&null!=top.app.bindingMap.throbber&&setTimeout(function(){top.app.bindingMap.throbber.stop()},250))}},hasLock:function(a){return 1==this._lockthings[a]},activate:function(a){if(a!==this._activeBinding){var b=this._activeBinding;this._activeBinding=a,this._activatedBindings.add(a),b&&b.isActive&&b.deActivate()}},deActivate:function(a){var b=null,c=null;if(a==this._activeBinding){for(;!c&&this._activatedBindings.hasEntries();)b=this._activatedBindings.extractLast(),b!=a&&b.isActivatable&&(c=b);c&&c.activate()}},focused:function(a){this.isFocused=a,a?this.isBlurred&&(this.isBlurred=!1,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_FOCUSED)):setTimeout(function(){Application.isFocused||(Application.isBlurred=!0,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_BLURRED))},Application._TIMEOUT_LOSTFOCUS)},initialize:function(){DOMEvents.addEventListener(top,DOMEvents.UNLOAD,{handleEvent:function(a){EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_ONSHUTDOWN),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_SHUTDOWN),Application.isShuttingDown||(Application.isShuttingDown=!0,null!=FlowControllerService&&FlowControllerService.ReleaseAllConsoleResources(Application.CONSOLE_ID)),this.isLoggedIn&&!Application.isDeveloperMode&&Application.logout()}}),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_STARTUP)},cancelShutDown:function(){this._isShutDownAllowed=!1},framework:function(a){var b=DOMUtil.getParentWindow(a);null!=b&&(b.standardEventHandler||(b.standardEventHandler=new StandardEventHandler(a)))},normalize:function(a){},handleAction:function(a){switch(a.type){case Application.REFRESH:this.refresh()}},declareTopLocal:function(a){var b=Resolver.resolve("/scripts/source/top/");if(null==this._topLevelClasses){this._topLevelClasses=new List;var c=this;new List(DOMUtil.getElementsByTagName(document,"script")).each(function(a){
var d=a.src;if(d.indexOf(b)>-1){var e=d.substring(d.lastIndexOf("/")+1,d.lastIndexOf(".js"));c._topLevelClasses.add(e)}})}this._topLevelClasses.each(function(b){null!=window[b]&&(a[b]=window[b])})},trackMousePosition:function(a){var b=!1;return this._isMousePositionTracking&&(b=!0,Client.isExplorer&&1!=a.button&&(b=!1),b&&(this._mousePosition=DOMUtil.getUniversalMousePosition(a))),b},enableMousePositionTracking:function(a){if(!a)throw new Error("Application: MouseEvent undefined.");this._isMousePositionTracking=!0,this._mousePosition=DOMUtil.getUniversalMousePosition(a)},disableMousePositionTracking:function(){this._isMousePositionTracking=!1,this._mouseposition=null},getMousePosition:function(){return this._mousePosition},onDragStart:function(a){var b=BindingDragger.draggedBinding;1==Interfaces.isImplemented(IDraggable,b,!0)&&(this._isDragging||(app.bindingMap.dragdropcursor.setImage(b.getImage()),this._cursorStartPoint=a,app.bindingMap.dragdropcursor.setPosition(this._cursorStartPoint),CursorBinding.fadeIn(app.bindingMap.dragdropcursor),b.showDrag&&b.showDrag(),EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_START,b.dragType),this._isDragging=!0))},onDrag:function(a){if(this._isDragging){var b=new Point(this._cursorStartPoint.x+a.x,this._cursorStartPoint.y+a.y);app.bindingMap.dragdropcursor.setPosition(b)}},onDragStop:function(a){if(this._isDragging){var b=BindingDragger.draggedBinding;if(b.hideDrag&&b.hideDrag(),EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_STOP,b.dragType),this._isDragging=!1,b=BindingAcceptor.acceptingBinding,null!=b){if(1!=Interfaces.isImplemented(IAcceptable,b,!0))throw new Error("Application: IAcceptable not implemented "+b);b.accept(BindingDragger.draggedBinding),BindingAcceptor.acceptingBinding=null,CursorBinding.fadeOut(app.bindingMap.dragdropcursor)}else app.bindingMap.dragdropcursor.hide()}},reload:function(a){this.isDeveloperMode||a?(this.isDeveloperMode&&Client.isPrism&&Prism.clearCache(),Application.lock(Application),setTimeout(function(){top.window.location.reload(!0)},0)):Application.isOperational?Dialog.question(StringBundle.getString("ui","Website.Application.DialogReload.Title"),StringBundle.getString("ui","Website.Application.DialogReload.Text"),Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(a){a==Dialog.RESPONSE_ACCEPT&&Application.reload(!0)}}):Application.reload(!0)},quit:function(){Application.isShuttingDown=!0,null!=FlowControllerService&&FlowControllerService.ReleaseAllConsoleResources(Application.CONSOLE_ID),this.logout()&&(top.close(),location.reload())},hasDirtyDockTabs:function(){return this._dirtyTabs.countEntries()>0},getDirtyDockTabsTabs:function(){return this._dirtyTabs}};var Application=new _Application;_Installation.prototype={applicationName:null,versionString:null,versionPrettyString:null,installationID:null,passwordExpirationTimeInDays:null,handleBroadcast:function(a){switch(a){case BroadcastMessages.APPLICATION_KICKSTART:var b=new List(InstallationService.GetInstallationInfo(!0));b.each(function(a){switch(a.Key){case"ApplicationName":this.applicationName=a.Value;break;case"ProductVersion":this.versionString=a.Value;break;case"ProductTitle":this.versionPrettyString=a.Value;break;case"InstallationId":this.installationID=a.Value;break;case"PasswordExpirationTimeInDays":this.passwordExpirationTimeInDays=a.Value}},this)}}};var Installation=new _Installation;_Keyboard.prototype={_logger:SystemLogger.getLogger("Keyboard"),isShiftPressed:!1,isControlPressed:!1,keyEnter:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ENTER)},keyEscape:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ESCAPE)},keySpace:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_SPACE)},keyShift:function(){this.isShiftPressed=!0,EventBroadcaster.broadcast(BroadcastMessages.KEY_SHIFT_DOWN)},keyControl:function(){this.isControlPressed=!0,EventBroadcaster.broadcast(BroadcastMessages.KEY_CONTROL_DOWN)},keyArrow:function(a){EventBroadcaster.broadcast(BroadcastMessages.KEY_ARROW,a)},keyAlt:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ALT)},keyTab:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_TAB)},keyUp:function(a){this.isShiftPressed&&a.keyCode==window.KeyEventCodes.VK_SHIFT?(this.isShiftPressed=!1,EventBroadcaster.broadcast(BroadcastMessages.KEY_SHIFT_UP)):this.isControlPressed&&a.keyCode==window.KeyEventCodes.VK_CONTROL&&(this.isControlPressed=!1,EventBroadcaster.broadcast(BroadcastMessages.KEY_CONTROL_UP))}};var Keyboard=new _Keyboard;window.Preferences=new function(){function a(a){var d=a?"Persisted preferences":"No persisted preferences. Using defaults";d+=":\n";for(var e in c){var f=c[e];d+="\n	"+e+": "+f+" ["+typeof f+"]"}b.fine(d)}var b=SystemLogger.getLogger("Preferences");this.LOGIN="login";var c={login:!0};EventBroadcaster.subscribe(BroadcastMessages.LOCALSTORE_INITIALIZED,{handleBroadcast:function(){if(LocalStore.isEnabled){var b=LocalStore.getProperty(LocalStore.PREFERENCES);if(b){for(var d in b)c[d]=b[d];a(!0)}else a(!1)}else a(!1)}}),EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,{handleBroadcast:function(){LocalStore.isEnabled&&LocalStore.setProperty(LocalStore.PREFERENCES,c)}}),this.getPref=function(a){var b=null;if(!a)throw"No such preference.";return b=c[a]},this.setPref=function(a,b){if(!a)throw"No such preference.";c[a]=b}},_Persistance.prototype={_logger:SystemLogger.getLogger("Persistance"),_persistance:null,_isEnabled:!1,isInitialized:!1,isEnabled:!1,getPersistedProperty:function(a,b){var c=null;if(1!=this.isInitialized)throw"Persistance not initialized!";if(this._persistance){var d=this._persistance[a];d&&(c=d[b])}return c},setPersistedProperty:function(a,b,c){if(1!=this.isInitialized)throw"Persistance not initialized!";this._persistance&&(null!=c?(this._persistance[a]||(this._persistance[a]={}),this._persistance[a][b]=String(c)):this._logger.error("Cannot persist "+b+" with value: null"))},clearAllPersistedProperties:function(){this._logger.debug("TODO: clearAllPersistedProperties")},handleBroadcast:function(a){switch(a){case BroadcastMessages.APPLICATION_SHUTDOWN:var b=top.bindingMap.persistance;b.persist(this._persistance)}},initialize:function(){if(!this.isInitialized){if(this.isInitialized=!0,1==this._isEnabled){var a=top.bindingMap.persistance,b=a.getPersistanceMap();b&&(this.isEnabled=!0,this._persistance=b,EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,this))}else this.isEnabled=!1;EventBroadcaster.broadcast(BroadcastMessages.PERSISTANCE_INITIALIZED)}}};var Persistance=new _Persistance,LocalStore=new function(){this.isInitialized=!0,this.isEnabled=!1,this.openedNodes=new SystemNodeList,this.focuseNodes=new SystemNodeList};StandardEventHandler.isBackAllowed=!1,StandardEventHandler.prototype._addListeners=function(){var a=this._contextDocument;if(DOMEvents.addEventListener(a,DOMEvents.MOUSEDOWN,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEUP,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEMOVE,this),DOMEvents.addEventListener(a,DOMEvents.TOUCHSTART,this),(Client.isExplorer||Client.isExplorer11)&&(DOMEvents.addEventListener(this._contextDocument,DOMEvents.HELP,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}}),DOMEvents.addEventListener(this._contextWindow,DOMEvents.HELP,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}})),!this._isMouseHandlerOnly){DOMEvents.addEventListener(a,DOMEvents.KEYDOWN,this),DOMEvents.addEventListener(a,DOMEvents.KEYUP,this),null==this._contextWindow.WindowManager&&(Client.isExplorer?(DOMEvents.addEventListener(a,DOMEvents.FOCUSIN,this),DOMEvents.addEventListener(a,DOMEvents.FOCUSOUT,this)):"on"!=this._contextDocument.designMode&&(DOMEvents.addEventListener(a,DOMEvents.FOCUS,this,!0),DOMEvents.addEventListener(a,DOMEvents.BLUR,this,!0)));var b={handleEvent:function(a){switch(a.type){case DOMEvents.BLUR:Application.focused(!1);break;case DOMEvents.FOCUS:Application.focused(!0)}}};DOMEvents.addEventListener(this._contextWindow,DOMEvents.BLUR,b),DOMEvents.addEventListener(this._contextWindow,DOMEvents.FOCUS,b)}Client.isMozilla&&a.addEventListener(DOMEvents.KEYDOWN,{handleEvent:function(a){var b=83;Client.isMac?a.metaKey&&a.keyCode==b&&!a.altKey&&a.preventDefault():a.ctrlKey&&a.keyCode==b&&!a.altKey&&a.preventDefault()}},!0)},StandardEventHandler.prototype.handleEvent=function(a){switch(a.type){case DOMEvents.MOUSEDOWN:this._handleMouseDown(a);break;case DOMEvents.MOUSEUP:this._handleMouseUp(a);break;case DOMEvents.MOUSEMOVE:this._handleMouseMove(a);break;case DOMEvents.TOUCHSTART:this._handleTouchStart(a);break;case DOMEvents.KEYDOWN:this._handleKeyDown(a);break;case DOMEvents.KEYUP:this._handleKeyUp(a);break;case DOMEvents.FOCUS:case DOMEvents.BLUR:case DOMEvents.FOCUSIN:case DOMEvents.FOCUSOUT:this._handleFocus(a)}},StandardEventHandler.prototype._handleMouseDown=function(a){if(Application.trackMousePosition(a),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),a.button!=ButtonStateManager.RIGHT_BUTTON)for(var b=DOMEvents.getTarget(a);null!=b;)switch(b.nodeType){case Node.ELEMENT_NODE:var c=UserInterface.getBinding(b);null!=c&&c.dispatchAction(Binding.ACTION_ACTIVATED),b=null!=c?null:b.parentNode;break;case Node.DOCUMENT_NODE:b=DOMUtil.getParentWindow(b).frameElement;break;default:b=null}},StandardEventHandler.prototype._handleMouseUp=function(a){Application.trackMousePosition(a),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,a)},StandardEventHandler.prototype._handleMouseMove=function(a){try{var b=Application.trackMousePosition(a);b&&EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,a)}catch(a){throw DOMEvents.removeEventListener(this._contextDocument,DOMEvents.MOUSEMOVE,this),a}},StandardEventHandler.prototype._handleTouchStart=function(a){EventBroadcaster.broadcast(BroadcastMessages.TOUCHEVENT_TOUCHSTART,a)},StandardEventHandler.prototype._handleKeyDown=function(a,b,c){if(a.keyCode==KeyEventCodes.VK_TAB&&(this._isAllowTabs?(a.shiftKey||a.ctrlKey)&&DOMEvents.preventDefault(a):b||(this._handleTab(a),DOMEvents.preventDefault(a)),b=!0),!(this.hasNativeKeys||a.shiftKey||a.ctrlKey||c))switch(a.keyCode){case KeyEventCodes.VK_UP:case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_LEFT:case KeyEventCodes.VK_RIGHT:case KeyEventCodes.VK_SPACE:case KeyEventCodes.VK_PAGE_UP:case KeyEventCodes.VK_PAGE_DOWN:DOMEvents.preventDefault(a)}a.keyCode==KeyEventCodes.VK_BACK&&(!StandardEventHandler.isBackAllowed||UserInterface.hasBinding(a.target))&&DOMEvents.preventDefault(a);var d=KeySetBinding.handleKey(this._contextDocument,a);if(!d)switch(a.keyCode){case KeyEventCodes.VK_PAGE_UP:case KeyEventCodes.VK_PAGE_DOWN:break;default:var e=this._contextWindow.frameElement;if(null!=e){var f=DOMUtil.getParentWindow(e);null!=f.standardEventHandler&&f.standardEventHandler._handleKeyDown(a,b,c?c:this.hasNativeKeys)}}},StandardEventHandler.prototype._handleTab=function(a){this._isAllowTabs||a.ctrlKey||(a.shiftKey?FocusBinding.navigatePrevious():FocusBinding.navigateNext())},StandardEventHandler.prototype._handleFocus=function(a){var b=!1,c=DOMEvents.getTarget(a),d=c.nodeName.toLowerCase();switch(d){case"input":case"textarea":case"select":b=a.type==DOMEvents.FOCUS||a.type==DOMEvents.FOCUSIN,("input"==d||"textarea"==d)&&(StandardEventHandler.isBackAllowed=b),b?this.hasNativeKeys||this.enableNativeKeys():this.hasNativeKeys&&this.disableNativeKeys()}},StandardEventHandler.prototype._handleKeyUp=function(a){Keyboard.keyUp(a)},StandardEventHandler.prototype.enableNativeKeys=function(a){this._isAllowTabs=1==a?!0:!1;var b=this;top.setTimeout(function(){b.hasNativeKeys=!0,StandardEventHandler.isBackAllowed=!0},0)},StandardEventHandler.prototype.disableNativeKeys=function(){this._isAllowTabs=!1,this.hasNativeKeys=!1,StandardEventHandler.isBackAllowed=!1},Action.isValid=function(a){return typeof a!=Types.UNDEFINED},Action.prototype.consume=function(){this.isConsumed=!0},Action.prototype.cancel=function(){this.isCancelled=!0},Animation.DEFAULT_TIME=parseInt(250),Animation.prototype.play=function(){if(this.isPlaying)if(this.modifier>0?this.iterator>=this.endcount:this.iterator<=this.endcount)this.stop();else{var a=this.iterator,b=this.onstep(this.iterator);b&&b!=a?this.iterator=b:this.iterator+=this.modifier,this._nextframe()}else{var c=this;this._nextframe=function(){window[this.id]=setTimeout(function(){c.play()},this.interval)},this.onstart(this.iterator),this._nextframe(),this.isPlaying=!0}},Animation.prototype.stop=function(){this.onstop(this.iterator),this.isPlaying=!1},Animation.prototype.onstart=function(a){},Animation.prototype.onstep=function(a){},Animation.prototype.onstop=function(a){},Point.isEqual=function(a,b){var c=!1;return a&&b&&(c=a.x==b.x&&a.y==b.y),c},Point.prototype={x:0,y:0},Dimension.isEqual=function(a,b){var c=!1;return a&&b&&(c=a.w==b.w&&a.h==b.h),c},Dimension.prototype={w:0,h:0},BindingAcceptor.acceptingBinding=null,BindingAcceptor.prototype._initialize=function(){if(EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_START,this),EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_STOP,this),this._binding.dragAccept){EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_PAUSE,this);for(var a=new List(this._binding.dragAccept.split(" "));a.hasNext();){var b=a.getNext();this._acceptedList[b]=!0}}},BindingAcceptor.prototype.handleBroadcast=function(a,b){var c=b;try{switch(a){case BroadcastMessages.TYPEDRAG_START:null==this._cursor&&(this._cursor=app.bindingMap.dragdropcursor),this._binding.addEventListener(DOMEvents.MOUSEENTER,this),this._binding.addEventListener(DOMEvents.MOUSELEAVE,this),this.isAccepting(c)&&(this._isAccepting=!0,this._startAccepting());break;case BroadcastMessages.TYPEDRAG_STOP:this._binding.removeEventListener(DOMEvents.MOUSEENTER,this),this._binding.removeEventListener(DOMEvents.MOUSELEAVE,this),this.isAccepting(c)&&(this._isAccepting=!1,this._stopAccepting());break;case BroadcastMessages.TYPEDRAG_PAUSE:this.isAccepting(c)&&this._pauseAccepting()}}catch(a){this.logger.debug(a)}},BindingAcceptor.prototype.isAccepting=function(a){return Types.isDefined(this._acceptedList[a])},BindingAcceptor.prototype._startAccepting=function(){Types.isFunction(this._binding.showGeneralAcceptance)&&this._binding.showGeneralAcceptance()},BindingAcceptor.prototype._pauseAccepting=function(){this._binding.hideAcceptance&&this._binding.hideAcceptance(),this._cursor.hideAcceptance(),BindingAcceptor.acceptingBinding=null},BindingAcceptor.prototype._stopAccepting=function(){this._binding.hideGeneralAcceptance&&this._binding.hideGeneralAcceptance(),this._binding.hideAcceptance&&this._binding.hideAcceptance()},BindingAcceptor.prototype.handleEvent=function(a){switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this._isAccepting?BindingAcceptor.acceptingBinding!=this._binding&&(BindingAcceptor.acceptingBinding=this._binding,this._cursor.showAcceptance(),Types.isFunction(this._binding.showAcceptance)&&this._binding.showAcceptance()):(EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_PAUSE),DOMEvents.stopPropagation(a));break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this._isAccepting?(BindingAcceptor.acceptingBinding=null,this._cursor.hideAcceptance(),Types.isFunction(this._binding.hideAcceptance)&&this._binding.hideAcceptance()):DOMEvents.stopPropagation(a)}DOMEvents.stopPropagation(a)},BindingAcceptor.prototype.dispose=function(){EventBroadcaster.unsubscribe(BroadcastMessages.TYPEDRAG_START,this),EventBroadcaster.unsubscribe(BroadcastMessages.TYPEDRAG_STOP,this)},BindingBoxObject.prototype.getUniversalPosition=function(){return DOMUtil.getUniversalPosition(this._domElement)},BindingBoxObject.prototype.getGlobalPosition=function(){return DOMUtil.getGlobalPosition(this._domElement)},BindingBoxObject.prototype.getLocalPosition=function(){return DOMUtil.getLocalPosition(this._domElement)},BindingBoxObject.prototype.getDimension=function(){var a=this._domElement.getBoundingClientRect();return new Dimension(a.right-a.left,a.bottom-a.top)},BindingBoxObject.prototype.dispose=function(){this._domElement=null},BindingDragger.isDragging=!1,BindingDragger.draggedBinding=null,BindingDragger.bindingDragger=null,BindingDragger.prototype.handleEvent=function(a){if(a.type==DOMEvents.MOUSEUP)this.isDragReady=!1;else if(!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEDOWN:DOMEvents.isRightButton(a)||(this.isDragReady=!0,DOMEvents.preventDefault(a));break;case DOMEvents.MOUSEMOVE:1==this.isDragReady&&(this.binding.dispatchAction(Binding.ACTION_DRAG),this.handler&&this.onDragStart(a),this.isDragReady=!1)}},BindingDragger.prototype.registerHandler=function(a){if(1!=Interfaces.isImplemented(IDragHandler,a))throw new Error("BindingDragger: Interface IDraghandler not implemented.");this.handler=a},BindingDragger.prototype.onDragStart=function(a){this.isDragging||(Application.enableMousePositionTracking(a),this.startPoint=Application.getMousePosition(),this.isDragging=!0,BindingDragger.isDragging=!0,BindingDragger.draggedBinding=this.binding,this.handler.onDragStart(this.startPoint),EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,this),EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))},BindingDragger.prototype.onDrag=function(a){if(1==this.isDragging){var b=a.button==(a.target?0:1);b?this.handler.onDrag(this.getDiff()):this.onDragStop(a)}},BindingDragger.prototype.onDragStop=function(a){1==this.isDragging&&(Application.disableMousePositionTracking(),this.handler.onDragStop(this.getDiff()),this.isDragging=!1,BindingDragger.isDragging=!1,BindingDragger.draggedBinding=null,EventBroadcaster.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,this),EventBroadcaster.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))},BindingDragger.prototype.getDiff=function(){var a=Application.getMousePosition(),b=a.x-this.startPoint.x,c=a.y-this.startPoint.y;return new Point(b,c)},BindingDragger.prototype.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.MOUSEEVENT_MOUSEMOVE:this.onDrag(b);break;case BroadcastMessages.MOUSEEVENT_MOUSEUP:this.onDragStop(b)}},BindingDragger.prototype.dispose=function(){this.binding=null},BindingParser.XML='<div xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://www.w3.org/1999/xhtml">${markup}</div>',BindingParser.prototype.parseFromString=function(a){var b=new List,c=(BindingParser.XML.replace("${markup}",a),XMLParser.parse(a));if(c){var d=DOMUtil.createElementNS(Constants.NS_XHTML,"div",this._ownerDocument);this._iterate(c.documentElement,d);for(var e=d.firstChild;e;)e.nodeType==Node.ELEMENT_NODE&&b.add(e),e=e.nextSibling}return b},BindingParser.prototype._iterate=function(a,b){var c=null;switch(a.nodeType){case Node.ELEMENT_NODE:c=this._cloneElement(a),UserInterface.registerBinding(c);break;case Node.TEXT_NODE:c=this._ownerDocument.createTextNode(a.nodeValue)}if(c&&b.appendChild(c),c&&a.hasChildNodes())for(var d=a.firstChild;d;)this._iterate(d,c),d=d.nextSibling},BindingParser.prototype._cloneElement=function(a){for(var b=DOMUtil.createElementNS(a.namespaceURI?a.namespaceURI:Constants.NS_XHTML,a.nodeName,this._ownerDocument),c=0;c<a.attributes.length;){var d=a.attributes.item(c++);b.setAttribute(d.nodeName,String(d.nodeValue))}return b},BindingSerializer.activeInstance=null,BindingSerializer.KEYPOINTER="bindingserializerkeypointer",BindingSerializer.filter=function(a){var b=null,c=!1,d=a.parentNode.getAttribute(BindingSerializer.KEYPOINTER);if(UserInterface.hasBinding(a)){var e=UserInterface.getBinding(a);c=BindingSerializer.activeInstance.indexBinding(e),c&&(b=e.key,a.setAttribute(BindingSerializer.KEYPOINTER,b))}b=b?b:d;var f=new List(a.childNodes);f.each(function(a){a.nodeType==Node.ELEMENT_NODE&&a.setAttribute(BindingSerializer.KEYPOINTER,b)}),c&&BindingSerializer.activeInstance.append(b,d)},BindingSerializer.prototype.serializeBinding=function(a){return BindingSerializer.activeInstance=this,a.bindingWindow.ElementIterator.iterate(a.bindingElement,BindingSerializer.filter),DOMSerializer.serialize(this._dom,!0)},BindingSerializer.prototype.indexBinding=function(a){var b=!1,c=a.serialize();if(0!=c){b=!0;var d="ui:"+DOMUtil.getLocalName(a.bindingElement),e=DOMUtil.createElementNS(Constants.NS_UI,d,this._dom);this._pointers[a.key]=e;for(var f in c)null!=c[f]&&e.setAttribute(f,String(c[f]))}return b},BindingSerializer.prototype.append=function(a,b){var c=this._pointers[a],d=b?this._pointers[b]:this._dom;d.appendChild(c)},ImageProfile.prototype.getDefaultImage=function(){return this._default},ImageProfile.prototype.setDefaultImage=function(a){this._default=a},ImageProfile.prototype.getHoverImage=function(){return this._default},ImageProfile.prototype.setHoverImage=function(a){this._hover=a},ImageProfile.prototype.getActiveImage=function(){return this._active},ImageProfile.prototype.setActiveImage=function(a){this._active=a},ImageProfile.prototype.getDisabledImage=function(){return this._default},ImageProfile.prototype.setDisabledImage=function(a){this._disabled=a},_BindingFinder.prototype={getDescendantBindingsByLocalName:function(a,b,c){var d=null;if(a.isAttached){d=new List;var e=c?a.getChildElementsByLocalName(b):a.getDescendantElementsByLocalName(b);e.each(function(a){var b=UserInterface.getBinding(a);b&&d.add(b)})}else{var f="Could not resolve descendants of unattached binding "+a.toString();if(Application.isDeveloperMode)throw f}return d},getAncestorBindingByType:function(a,b,c){var d=null;if(Binding.exists(a))for(var e=a.bindingElement;null==d&&null!=e;)if(e=e.parentNode,null!=e)if(UserInterface.hasBinding(e)){var f=UserInterface.getBinding(e);f instanceof b&&(d=f)}else if(c&&e.nodeType==Node.DOCUMENT_NODE){var g=DOMUtil.getParentWindow(e);if(null==g){SystemDebug.stack(arguments);break}e=g.frameElement}return d},getAncestorBindingByLocalName:function(a,b,c){var d=null;if("*"==b)for(var e=a.bindingElement;!d&&null!=(e=e.parentNode);)UserInterface.hasBinding(e)&&(d=UserInterface.getBinding(e));else d=UserInterface.getBinding(DOMUtil.getAncestorByLocalName(b,a.bindingElement,c));return d},getChildElementsByLocalName:function(a,b){var c=new List,d=new List(a.bindingElement.childNodes);return d.each(function(a){a.nodeType==Node.ELEMENT_NODE&&("*"==b||DOMUtil.getLocalName(a)==b)&&c.add(a)}),c},getChildBindingByType:function(a,b){var c=null;return a.getChildElementsByLocalName("*").each(function(a){var d=UserInterface.getBinding(a);return null!=d&&d instanceof b?(c=d,!1):!0}),c},getDescendantBindingByType:function(a,b){var c=null;return a.getDescendantElementsByLocalName("*").each(function(a){var d=UserInterface.getBinding(a);return null!=d&&d instanceof b?(c=d,!1):!0}),c},getDescendantBindingsByType:function(a,b,c){var d=new List;return a.getDescendantElementsByLocalName("*").each(function(a){var e=UserInterface.getBinding(a);return null!=e&&e instanceof b?d.add(e):c&&e instanceof WindowBinding&&e.getRootBinding()&&this.getDescendantBindingsByType(e.getRootBinding(),b,c).each(function(a){d.add(a)}),!0},this),d},getNextBindingByLocalName:function(a,b){for(var c=null,d=a.bindingElement;null!=(d=DOMUtil.getNextElementSibling(d))&&DOMUtil.getLocalName(d)!=b;);return null!=d&&(c=UserInterface.getBinding(d)),c},getPreviousBindingByLocalName:function(a,b){for(var c=null,d=a.bindingElement;null!=(d=DOMUtil.getPreviousElementSibling(d))&&DOMUtil.getLocalName(d)!=b;);return null!=d&&(c=UserInterface.getBinding(d)),c}};var BindingFinder=new _BindingFinder;NodeCrawler.NORMAL=1,NodeCrawler.SKIP_NODE=2,NodeCrawler.SKIP_CHILDREN=4,NodeCrawler.STOP_CRAWLING=8,NodeCrawler.TYPE_DESCENDING="descending",NodeCrawler.TYPE_ASCENDING="ascending",NodeCrawler.prototype={logger:SystemLogger.getLogger("NodeCrawler"),type:NodeCrawler.TYPE_DESCENDING,currentNode:null,previousNode:null,contextDocument:null,_filters:null,_construct:function(){this.currentNode=null,this.previousNode=null,this.nextNode=null,this._filters=new List,this.type=NodeCrawler.TYPE_DESCENDING},addFilter:function(a){this._filters.add(a)},removeFilter:function(a){var b=-1;this._filters.each(function(c){b++;var d=!0;return c==a&&(d=!1),d}),b>-1&&this._filters.del(b)},_applyFilters:function(a,b){var c=null,d=NodeCrawler.STOP_CRAWLING,e=NodeCrawler.SKIP_NODE,f=NodeCrawler.SKIP_CHILDREN;this._filters.reset();for(var g=!0;this._filters.hasNext()&&1==g;){var h=this._filters.getNext(),i=h.call(this,a,b);if(null!=i)switch(c=i,i){case d:case e:case e+f:g=!1}}return c},crawl:function(a,b){this.contextDocument=a.ownerDocument,this.onCrawlStart();var c=this.type==NodeCrawler.TYPE_ASCENDING,d=this._applyFilters(a,b);if(d!=NodeCrawler.STOP_CRAWLING)if(c&&d==NodeCrawler.SKIP_CHILDREN);else{var e=null;null!=this.nextNode?(e=this.nextNode,this.nextNode=null):e=c?a.parentNode:a,this._crawl(e,b)}this.onCrawlStop()},onCrawlStart:function(){},onCrawlStop:function(){},_crawl:function(a,b){var c=null;switch(this.type){case NodeCrawler.TYPE_DESCENDING:c=this._crawlDescending(a,b);break;case NodeCrawler.TYPE_ASCENDING:c=this._crawlAscending(a,b)}return c},_crawlDescending:function(a,b){var c=NodeCrawler.SKIP_NODE,d=NodeCrawler.SKIP_CHILDREN,e=NodeCrawler.STOP_CRAWLING,f=null;if(a.hasChildNodes())for(var g=a.firstChild;null!=g&&f!=e;){switch(this.currentNode=g,f=this._applyFilters(g,b)){case e:case d:case c+d:break;default:if(g.nodeType==Node.ELEMENT_NODE&&null==this.nextNode){var h=this._crawl(g,b);if(h==e){f=e;break}}f!=e&&f!=c&&(this.previousNode=g)}f!=e&&(g=this.nextNode?this.nextNode:g.nextSibling,this.nextNode=null)}return f},_crawlAscending:function(a,b){var c=null,d=(NodeCrawler.SKIP_CHILDREN,NodeCrawler.STOP_CRAWLING);if(null!=a){if(this.currentNode=a,c=this._applyFilters(a,b),c!=d){var e=this.nextNode?this.nextNode:a.parentNode;this.nextNode=null,e&&e.nodeType!=Node.DOCUMENT_NODE&&(this.previousNode=a,c=this._crawl(e,b))}}else c=d;return c}},NodeCrawler.prototype.dispose=function(){this._filters.dispose();for(var a in this)this[a]=null},ElementCrawler.prototype=new NodeCrawler,ElementCrawler.prototype.constructor=ElementCrawler,ElementCrawler.superclass=NodeCrawler.prototype,ElementCrawler.prototype._construct=function(){ElementCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;return a.nodeType!=Node.ELEMENT_NODE&&(c=NodeCrawler.SKIP_NODE),c})},BindingCrawler.prototype=new ElementCrawler,BindingCrawler.prototype.constructor=BindingCrawler,BindingCrawler.superclass=ElementCrawler.prototype,BindingCrawler.prototype._construct=function(){BindingCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;return UserInterface.hasBinding(a)||(c=NodeCrawler.SKIP_NODE),c})},Crawler.prototype=new BindingCrawler,Crawler.prototype.constructor=Crawler,Crawler.superclass=BindingCrawler.prototype,Crawler.prototype._construct=function(){Crawler.superclass._construct.call(this),this.response=null;var a=this;this.addFilter(function(b,c){var d=null,e=UserInterface.getBinding(b);return 1==Interfaces.isImplemented(ICrawlerHandler,e)&&(a.response=null,e.handleCrawler(a),d=a.response),d})},FlexBoxCrawler.prototype=new Crawler,FlexBoxCrawler.prototype.constructor=FlexBoxCrawler,FlexBoxCrawler.superclass=Crawler.prototype,FlexBoxCrawler.ID="flexboxcrawler",FlexBoxCrawler.MODE_FORCE="force",FlexBoxCrawler.MODE_NORMAL="normal",FlexBoxCrawler.prototype._construct=function(){FlexBoxCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b,c){var d=null,e=UserInterface.getBinding(b);if(1==Interfaces.isImplemented(IFlexible,e))switch(a.mode){case FlexBoxCrawler.MODE_FORCE:c.add(e);break;case FlexBoxCrawler.MODE_NORMAL:1==e.isFlexSuspended?d=NodeCrawler.SKIP_CHILDREN:c.add(e)}return d})},FocusCrawler.prototype=new Crawler,FocusCrawler.prototype.constructor=FocusCrawler,FocusCrawler.superclass=Crawler.prototype,FocusCrawler.ID="focuscrawler",FocusCrawler.MODE_INDEX="index",FocusCrawler.MODE_FOCUS="focus",FocusCrawler.MODE_BLUR="blur",FocusCrawler.prototype._construct=function(){FocusCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null,d=UserInterface.getBinding(a);if(1==d.isAttached&&1==Interfaces.isImplemented(IFocusable,d)&&d.isFocusable&&d.isVisible)switch(this.mode){case FocusCrawler.MODE_INDEX:b.add(d);break;case FocusCrawler.MODE_FOCUS:d.isFocused||d.focus(),c=NodeCrawler.STOP_CRAWLING;break;case FocusCrawler.MODE_BLUR:1==d.isFocused&&(d.blur(),c=NodeCrawler.STOP_CRAWLING)}return c})},FitnessCrawler.prototype=new Crawler,FitnessCrawler.prototype.constructor=FitnessCrawler,FitnessCrawler.superclass=Crawler.prototype,FitnessCrawler.ID="fitnesscrawler",FitnessCrawler.MODE_BRUTAL="brutal fitness",FitnessCrawler.MODE_TRAINING="train fitness",FitnessCrawler.prototype._construct=function(){FitnessCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null,d=UserInterface.getBinding(a);return d.isVisible||(c=NodeCrawler.SKIP_NODE+NodeCrawler.SKIP_CHILDREN),c}),this.addFilter(function(a,b){var c=UserInterface.getBinding(a);return c.isAttached&&Interfaces.isImplemented(IFit,c)&&(c.isFit&&this.mode!=FitnessCrawler.MODE_BRUTAL||b.add(c)),null})},_DocumentUpdatePlugin.prototype={toString:function(){return"[DocumentUpdatePlugin]"},_logger:SystemLogger.getLogger("DocumentUpdatePlugin ["+document.title+"]"),_isUpdating:!1,_attributesbuffer:null,_elementsbuffer:null,isDebugging:Application.isDeveloperMode,_oldDOM:null,_focusID:null,_setup:function(){UpdateManager.isDebugging=Application.isDeveloperMode,UpdateManager.hasSoftAttributes=!0,UpdateManager.hasSoftSiblings=!0,DOMEvents.addEventListener(document,DOMEvents.BEFOREUPDATE,this),DOMEvents.addEventListener(document,DOMEvents.AFTERUPDATE,this),DOMEvents.addEventListener(document,DOMEvents.ERRORUPDATE,this),DOMEvents.addEventListener(window,DOMEvents.UNLOAD,this),Client.isFirefox&&(UpdateAssistant.serialize=function(a){return a=a.cloneNode(!0),a.setAttributeNS(Constants.NS_NS,"xmlns",Constants.NS_XHTML),a.setAttributeNS(Constants.NS_NS,"xmlns:ui",Constants.NS_UI),this._serializer.serializeToString(a)})},handleEvent:function(a){var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.BEFOREUPDATE:this._beforeUpdate(b);break;case DOMEvents.AFTERUPDATE:this._afterUpdate(b);break;case DOMEvents.ERRORUPDATE:this._errorUpdate();break;case DOMEvents.UNLOAD:Application.hasLock(this)&&Application.unlock(this)}},_beforeUpdate:function(a){var b=a==document.documentElement;if(b){this._elementsbuffer=new List,this._isUpdating=!0,Application.lock(this);var c=UserInterface.getBinding(document.body);if(null!=c){var d=c.getDescendantBindingByType(PageBinding);null!=d&&d.onBeforeUpdates()}var e=FocusBinding.focusedBinding;null!=e&&(this._focusID=e.getID()),this.isDebugging&&(this._oldDOM=DOMSerializer.serialize(UpdateManager.currentDOM,!0))}else switch(a.__updateType){case Update.TYPE_REPLACE:case Update.TYPE_REMOVE:DocumentManager.detachBindings(a);break;case Update.TYPE_ATTRIBUTES:this._backupattributes(a,!1)}},_afterUpdate:function(a){var b=a==document.documentElement;if(b){var c=this._elementsbuffer;c.hasEntries()&&c.each(function(a){DocumentManager.attachBindings(a)}),this._isUpdating=!1,Application.unlock(this);var d=UserInterface.getBinding(document.body);if(null!=d){var e=d.getDescendantBindingByType(PageBinding);null!=e&&e.onAfterUpdates()}var f=FocusBinding.focusedBinding;if(null==f){var g=document.getElementById(this._focusID);if(null!=g){var f=UserInterface.getBinding(g);null!=f&&f.focus()}}if(this._focusID=null,""!=UpdateManager.summary){if(this.isDebugging){var h=DOMSerializer.serialize(UpdateManager.currentDOM,!0),i="NEW DOM: "+document.title+"\n\n"+h+"\n\n";i+="OLD DOM: "+document.title+"\n\n"+this._oldDOM,this._logger.debug(i),this._oldDOM=null}this._logger.fine(UpdateManager.summary)}}else{switch(a.__updateType){case Update.TYPE_REPLACE:case Update.TYPE_INSERT:a.__isAttached!==!1&&this._elementsbuffer.add(a);break;case Update.TYPE_ATTRIBUTES:this._backupattributes(a,!0)}switch(a.id){case"__VIEWSTATE":case"__EVENTTARGET":case"__EVENTARGUMENT":case"__EVENTVALIDATION":
case"__LASTFOCUS":case"__REQUEST":case"__RESPONSE":case"__CONSOLEID":break;default:for(var f=UserInterface.getBinding(a);null==f&&null!=a;)f=UserInterface.getBinding(a),a=a.parentNode;null!=f&&f.dispatchAction(Binding.ACTION_UPDATED)}}},_errorUpdate:function(){Application.unlock(this);var a="UpdateManager dysfunction:\n\n"+UpdateManager.errorsmessage;this._logger.error(a+"\n\n"+UpdateManager.pendingResponse),Application.isDeveloperMode&&alert(a)},_backupattributes:function(a,b){var c=UserInterface.getBinding(a);if(null!=c)if(b){var d=this._attributesbuffer,e=new Map;d.each(function(b,c){var d=a.getAttribute(b);null!=d?d!=c&&e.set(b,Types.castFromString(d)):e.set(b,null)}),new List(a.attributes).each(function(a){a.specified&&(d.has(a.nodeName)||e.set(a.nodeName,Types.castFromString(a.nodeValue)))}),e.each(function(a,b){var d=c.propertyMethodMap[a];null!=d&&d.call(c,b)})}else{var e=new Map;new List(a.attributes).each(function(a){a.specified&&e.set(a.nodeName,a.nodeValue)}),this._attributesbuffer=e}},handleElement:function(a,b){var c=window.bindingMap[a.getAttribute("id")];return null!=c?c.handleElement(a,b):void 0},updateElement:function(a,b){var c=window.bindingMap[a.getAttribute("id")];return null!=c?c.updateElement(a,b):void 0}};var DocumentUpdatePlugin=new _DocumentUpdatePlugin;DocumentCrawler.prototype=new ElementCrawler,DocumentCrawler.prototype.constructor=DocumentCrawler,DocumentCrawler.superclass=ElementCrawler.prototype,DocumentCrawler.ID="documentcrawler",DocumentCrawler.MODE_REGISTER="register",DocumentCrawler.MODE_ATTACH="attach",DocumentCrawler.MODE_DETACH="detach",DocumentCrawler.prototype._construct=function(){DocumentCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b,c){var d=UserInterface.getBinding(b),e=null;switch(a.mode){case DocumentCrawler.MODE_REGISTER:null==d&&UserInterface.registerBinding(b);break;case DocumentCrawler.MODE_ATTACH:null!=d&&(d.isAttached||c.add(d),1==d.isLazy&&(e=NodeCrawler.SKIP_CHILDREN));break;case DocumentCrawler.MODE_DETACH:null!=d&&c.add(d)}return e})},_DocumentManager.prototype={_logger:SystemLogger.getLogger("DocumentManager ["+document.title+"]"),_maxIndex:-1,customUserInterfaceMapping:null,isDocumentSelectable:!1,hasNativeContextMenu:!1,_construct:function(){Application.framework(document),EventBroadcaster.subscribe(WindowManager.WINDOW_LOADED_BROADCAST,this),Client.isExplorer&&DOMEvents.addEventListener(document,DOMEvents.CLICK,this)},handleBroadcast:function(a,b){this.isDocumentSelectable||this._makeDocumentUnselectable(),this.hasNativeContextMenu||DOMEvents.addEventListener(document,DOMEvents.CONTEXTMENU,this),Application.isMalFunctional||(this._resolveCustomBindingMappings(),this.attachBindings(document.documentElement))},handleEvent:function(a){var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.SELECTSTART:case DOMEvents.CONTEXTMENU:this._isTextInputElement(b)||DOMEvents.preventDefault(a);break;case DOMEvents.CLICK:Client.isExplorer&&null!=b&&null!=b.href&&b.href.indexOf(Constants.DUMMY_LINK)>-1&&DOMEvents.preventDefault(a)}},_resolveCustomBindingMappings:function(){var bindingset=DOMUtil.getElementsByTagName(document.documentElement,"bindingmappingset").item(0);if(null!=bindingset){var map={},mappings=DOMUtil.getElementsByTagName(bindingset,"bindingmapping");new List(mappings).each(function(mapping){var element=mapping.getAttribute("element"),binding=mapping.getAttribute("binding");map[element]=eval(binding)}),this.setCustomUserInterfaceMapping(new UserInterfaceMapping(map))}},setCustomUserInterfaceMapping:function(a){null==this.customUserInterfaceMapping?this.customUserInterfaceMapping=a:this.customUserInterfaceMapping.merge(a)},_registerBindings:function(a){var b=new DocumentCrawler;b.mode=DocumentCrawler.MODE_REGISTER,b.crawl(a),b.dispose()},_attachBindings:function(a){var b=new DocumentCrawler;b.mode=DocumentCrawler.MODE_ATTACH;var c=new List;b.crawl(a,c);for(var d=!1;c.hasNext();){var e=c.getNext();e.isAttached||(e.onBindingAttach(),e.memberDependencies||e.onBindingInitialize(),Interfaces.isImplemented(IData,e)&&(d=!0))}if(d){var f=UserInterface.getBinding(document.body);null!=f&&setTimeout(function(){Binding.exists(f)&&f.dispatchAction(FocusBinding.ACTION_UPDATE)},250)}b.dispose(),c.dispose()},attachBindings:function(a){this._registerBindings(a),this._attachBindings(a)},detachBindings:function(a,b){var c=new DocumentCrawler;c.mode=DocumentCrawler.MODE_DETACH;var d=new List;c.crawl(a,d),1==b&&d.extractFirst();var e=!1;if(d.reverse().each(function(a){Interfaces.isImplemented(IData,a)&&(e=!0),a.dispose(!0)}),e){var f=UserInterface.getBinding(document.body);null!=f&&setTimeout(function(){Binding.exists(f)&&f.dispatchAction(FocusBinding.ACTION_UPDATE)},250)}c.dispose(),d.dispose()},detachAllBindings:function(){this.detachBindings(document.documentElement)},computeMaxIndex:function(){return-1==this._maxIndex&&(this._maxIndex=DOMUtil.getMaxIndex(document)),this._maxIndex++},_isTextInputElement:function(a){return/textarea|input/.test(DOMUtil.getLocalName(a))},_makeDocumentUnselectable:function(){Client.isExplorer&&DOMEvents.addEventListener(document,DOMEvents.SELECTSTART,this)}};var DocumentManager=new _DocumentManager;_DataManager.prototype={isPostBackFun:!1,_logger:SystemLogger.getLogger("DataManager ["+document.title+"]"),_dataBindings:{},isDirty:!1,dirty:function(a){this.isDirty=!0;var b=!1;return null==a||a.isDirty||(a.isDirty=!0,a.dispatchAction(Binding.ACTION_DIRTY),b=!0),b},clean:function(a){a.isDirty&&(a.isDirty=!1)},registerDataBinding:function(a,b){if(!Interfaces.isImplemented(IData,b,!0))throw"Invalid DataBinding: "+b;if(null!=this._dataBindings[a])throw"no proper support for checkbox multiple values! "+a;this._dataBindings[a]=b},unRegisterDataBinding:function(a){null!=this._dataBindings[a]&&delete this._dataBindings[a]},getDataBinding:function(a){var b=null;return null!=this._dataBindings[a]&&(b=this._dataBindings[a]),b},getAllDataBindings:function(a){var b=new List;for(var c in this._dataBindings){var d=this._dataBindings[c];if(b.add(d),a&&d instanceof WindowBinding){var e=d.getContentWindow().DataManager;null!=e&&b.merge(e.getAllDataBindings())}}return b},hasDataBindings:function(){var a=!1;for(var b in this._dataBindings){a=!0;break}return a},populateDataBindings:function(a){a instanceof DataBindingMap&&a.each(function(b,c){var d=this._dataBindings[b];if(null!=d)switch(a.type){case DataBindingMap.TYPE_RESULT:try{d.setResult(c)}catch(a){throw Application.isDeveloperMode&&alert(d),a}break;case DataBindingMap.TYPE_VALUE:throw"Not implemented!"}})},getDataBindingValueMap:function(){var a=new DataBindingMap;a.type=DataBindingMap.TYPE_VALUE;for(var b in this._dataBindings){var c=this._dataBindings[b];if(c instanceof DataDialogBinding)throw"DataDialogBinding valuemap not supported!";a[b]=c.getValue()}return a},getDataBindingResultMap:function(){var a=new DataBindingMap;a.type=DataBindingMap.TYPE_RESULT;for(var b in this._dataBindings){var c=this._dataBindings[b],d=c.getResult();d instanceof DataBindingMap?d.each(function(b,c){a.set(b,c)}):a.set(b,d)}return a},getPostBackString:function(){var a="",b=document.forms[0];if(null!=b){var c="";new List(b.elements).each(function(b){var d=b.name,e=encodeURIComponent(b.value);switch(b.type){case"text":case"hidden":case"password":case"textarea":case"select-one":a+=d+"="+e+"&";break;case"submit":document.activeElement==b&&(a+=d+"="+e+"&");break;case"radio":b.checked&&(a+=d+"="+e+"&");break;case"checkbox":b.checked&&(b.name==c?(a.lastIndexOf("&")==a.length-1&&(a=a.substr(0,a.length-1)),a+=","+e):a+=d+"="+b.value,c=d,a+="&")}})}return a.substr(0,a.length-1)}};var DataManager=new _DataManager;_Templates.prototype={_logger:SystemLogger.getLogger("Templates"),_cache:{},_mode:null,_modes:{MODE_PLAINTEXT:0,MODE_DOCUMENT:1,MODE_ELEMENT:2,MODE_DOCUMENTTEXT:3,MODE_ELEMENTTEXT:4},getTemplateDocument:function(a){return this._mode=this._modes.MODE_DOCUMENT,this._getIt(a)},getTemplateElement:function(a){return this._mode=this._modes.MODE_ELEMENT,this._getIt(a)},getTemplateDocumentText:function(a){return this._mode=this._modes.MODE_DOCUMENTTEXT,this._getIt(a)},getTemplateElementText:function(a){return this._mode=this._modes.MODE_ELEMENTTEXT,this._getIt(a)},getTemplateBodyText:function(a){var b=this.getTemplateDocumentText(a);return b=b.split("<body>")[1].split("</body>")[0]},getPlainText:function(a){return this._mode=this._modes.MODE_PLAINTEXT,this._getIt(a)},_getIt:function(a){var b=null,c=null,d=!1;if(!this._cache[a]){d=!0;var e=Constants.TEMPLATESROOT+"/"+a,f=DOMUtil.getXMLHTTPRequest();switch(f.open("get",e,!1),f.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),f.send(null),this._mode){case this._modes.MODE_PLAINTEXT:c=f.responseText;break;default:c=f.responseXML}if(null==c)throw new Error("Templates: Could not read template. Malformed XML?");this._cache[a]=c}switch(c=this._cache[a],this._mode){case this._modes.MODE_PLAINTEXT:b=c;break;case this._modes.MODE_DOCUMENT:b=DOMUtil.cloneNode(c,!0);break;case this._modes.MODE_ELEMENT:b=DOMUtil.cloneNode(c.documentElement,!0);break;case this._modes.MODE_DOCUMENTTEXT:b=DOMSerializer.serialize(c,!0);break;case this._modes.MODE_ELEMENTTEXT:b=DOMSerializer.serialize(c.documentElement,!0)}return d&&Application.isDeveloperMode,b}};var Templates=new _Templates;_Dialog.prototype={_logger:SystemLogger.getLogger("Dialog"),_URL_STANDARDDIALOG:"${root}/content/dialogs/standard/standard.aspx",MODAL:"modal",NON_MODAL:"nonmodal",URL_TREESELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_TREESEARCH:"${root}/content/dialogs/treesearch/treeSearchForm.aspx",URL_IMAGESELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_TREEACTIONSELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_SERVICEFAULT:"${root}/content/dialogs/webservices/error.aspx",BUTTONS_YES_NO_CANCEL:["yes:default","no","cancel"],BUTTONS_ACCEPT_CANCEL:["accept:default","cancel"],BUTTONS_ACCEPT:["accept:default"],RESPONSE_YES:"yes",RESPONSE_NO:"no",RESPONSE_ACCEPT:"accept",RESPONSE_CANCEL:"cancel",RESPONSE_DEFAULT:"default",_TYPE_WARNING:"warning",_TYPE_MESSAGE:"message",_TYPE_ERROR:"error",_TYPE_QUESTION:"question",_dialogImages:{warning:"${icon:warning}",message:"${icon:message}",error:"${icon:error}",question:"${icon:question}"},dialogButton:function(a){return void 0==this._dialogButtons&&(this._dialogButtons={yes:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelYes"),response:this.RESPONSE_YES}),no:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelNo"),response:this.RESPONSE_NO}),accept:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelAccept"),response:this.RESPONSE_ACCEPT}),cancel:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelCancel"),response:this.RESPONSE_CANCEL})}),Dialog._dialogButtons[a]},invoke:function(a,b,c){this._logger.error("Not implemented")},invokeModal:function(a,b,c){var d=new DialogViewDefinition({handle:KeyMaster.getUniqueKey(),position:Dialog.MODAL,url:a,handler:b,argument:c});return StageBinding.presentViewDefinition(d),d},invokeDefinition:function(a){return a instanceof DialogViewDefinition&&StageBinding.presentViewDefinition(a),a},question:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT_CANCEL),this._standardDialog(this._TYPE_QUESTION,a,b,c,d)},message:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_MESSAGE,a,b,c,d)},error:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_ERROR,a,b,c,d)},warning:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_WARNING,a,b,c,d)},_standardDialog:function(a,b,c,d,e){var f=null;d?(f=new List,new List(d).each(function(a){var b=null;switch(typeof a){case"object":b=a;break;case"string":var c=!1;a.indexOf(":")>-1&&(a=a.split(":")[0],c=!0),b=Dialog.dialogButton(a),c&&(b.isDefault=!0)}f.add(b)})):f=new List(Dialog.BUTTONS_ACCEPT);var g={title:b,text:c,type:a,image:this._dialogImages[a],buttons:f},h=new DialogViewDefinition({handle:"standarddialog:"+a,position:Dialog.MODAL,url:this._URL_STANDARDDIALOG,handler:e,argument:g});StageBinding.presentViewDefinition(h)}};var Dialog=new _Dialog;_Commands.prototype={_URL_ABOUTDIALOG:"${root}/content/dialogs/about/about.aspx",_URL_PREFERENCES:"${root}/content/dialogs/preferences/preferences.aspx",_construct:function(){var a=this;EventBroadcaster.subscribe(BroadcastMessages.SAVE_ALL,{handleBroadcast:function(b,c){a.saveAll(c)}})},about:function(){this._dialog(this._URL_ABOUTDIALOG)},preferences:function(){this._dialog(this._URL_PREFERENCES)},_dialog:function(a){Client.hasTransitions?setTimeout(function(){Dialog.invokeModal(a)},Animation.DEFAULT_TIME):Dialog.invokeModal(a)},close:function(){EventBroadcaster.broadcast(BroadcastMessages.CLOSE_CURRENT)},closeAll:function(){this.saveAll(!0)},save:function(){EventBroadcaster.broadcast(BroadcastMessages.SAVE_CURRENT)},saveAll:function(a){var b=this,c=Application.getDirtyDockTabsTabs();c.hasEntries()?Dialog.invokeModal("${root}/content/dialogs/save/saveall.aspx",{handleDialogResponse:function(c,d){switch(c){case Dialog.RESPONSE_ACCEPT:b._handleSaveAllResult(d,a);break;case Dialog.RESPONSE_CANCEL:EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE)}}},c):a&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_ALL)},_handleSaveAllResult:function(a,b){var c=!1,d=new List;if(a.each(function(a,b){0!=b&&d.add(b)}),d.hasEntries()){c=!0;var e=d.getLength(),f={handleBroadcast:function(a,c){0==--e&&(EventBroadcaster.unsubscribe(BroadcastMessages.DOCKTAB_CLEAN,this),EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE),b&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_ALL))}};EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_CLEAN,f),d.each(function(a){a.saveContainedEditor()})}else EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE);return c},systemLog:function(){if(Application.isOperational)StageBinding.handleViewPresentation("Composite.Management.SystemLog");else{var a=window.open(Constants.APPROOT+"/content/views/dev/systemlog/systemlogoutput.html");a.onload=function(){EventBroadcaster.broadcast(BroadcastMessages.SYSTEMLOG_OPENED,this)}}},help:function(){var a="Composite.Management.Help";StageBinding.isViewOpen(a)||StageBinding.handleViewPresentation(a)}};var Commands=new _Commands;_Prism.prototype={_logger:SystemLogger.getLogger("Prism"),clearCache:function(){this._logger.fine("Clearing the cache"),this._dispatchToPrism("contenttochrome-clearcache")},disableCache:function(){this._logger.fine("Disabling cache"),this._dispatchToPrism("contenttochrome-cache-disable")},enableCache:function(){this._logger.fine("Enabling cache"),this._dispatchToPrism("contenttochrome-cache-enable")},_dispatchToPrism:function(a){if(Client.isPrism){var b=document.createEvent("Events");b.initEvent(a,!0,!0),window.dispatchEvent(b)}else this._logger.warn("Prism methods should only be invoked in Prism! ("+a+")")}};var Prism=new _Prism;Uri.isMedia=function(a){return new Uri(a).isMedia},Uri.prototype.getPath=function(){return this.path},Uri.prototype.getQueryString=function(){return new Map(this.queryString)},Uri.prototype.hasParam=function(a){return null!=this.queryString[a]},Uri.prototype.getParam=function(a){return this.queryString[a]},Uri.prototype.setParam=function(a,b){void 0==b?delete this.queryString[a]:this.queryString[a]=b},Uri.prototype.toString=function(){var a=this.path,b=[];for(var c in this.queryString)b.push(c+"="+this.queryString[c]);return b.length>0&&(a+="?"+b.join("&")),a},ViewDefinition.DEFAULT_URL="${root}/blank.aspx",ViewDefinition.clone=function(a,b){var c=null,d=ViewDefinitions[a];if(!d.isMutable)throw"Cannot clone non-mutable definition";var e=null;if(e=d instanceof DialogViewDefinition?DialogViewDefinition:HostedViewDefinition,null==b||null==e)throw"Cannot clone without newhandle";var f=new e;for(var g in d)f[g]=ViewDefinition.cloneProperty(d[g]);return f.handle=b,c=f},ViewDefinition.cloneProperty=function(a){if(null==a)return a;if("object"==typeof a){var b=a.constructor===Array?[]:{};for(var c in a)b[c]=ViewDefinition.cloneProperty(a[c]);return b}return a},ViewDefinition.prototype={url:ViewDefinition.DEFAULT_URL,argument:null,handle:null,entityToken:null,flowHandle:null,label:null,image:null,toolTip:null},SystemViewDefinition.prototype=new ViewDefinition,SystemViewDefinition.prototype.constructor=SystemViewDefinition,SystemViewDefinition.superclass=ViewDefinition.prototype,SystemViewDefinition.DEFAULT_URL="${root}/content/views/systemview/systemview.aspx",HostedViewDefinition.prototype=new ViewDefinition,HostedViewDefinition.prototype.constructor=HostedViewDefinition,HostedViewDefinition.superclass=ViewDefinition.prototype,HostedViewDefinition.POSTBACK_URL="${root}/postback.aspx",DialogViewDefinition.prototype=new ViewDefinition,DialogViewDefinition.prototype.constructor=HostedViewDefinition,DialogViewDefinition.superclass=ViewDefinition.prototype,Binding.prototype.constructor=Binding,Binding.CALLBACKID="callbackid",Binding.CALLBACKARG="callbackarg",Binding.CLASSNAME_CLEARFLOAT="clearfix",Binding.CLASSNAME_FOCUSED="focused",Binding.SNOOZE=1==Client.isMozilla?125:250,Binding.ACTION_DRAG="bindingdrag",Binding.ACTION_DROP="bindingdrop",Binding.ACTION_DIRTY="bindingdirty",Binding.ACTION_VALID="bindingvalid",Binding.ACTION_UPDATED="bindingupdated",Binding.ACTION_INVALID="bindinginvalid",Binding.ACTION_RESIZED="bindingresized",Binding.ACTION_FOCUSED="bindingfocused",Binding.ACTION_BLURRED="bindingblurred",Binding.ACTION_ATTACHED="bindingattached",Binding.ACTION_DETACHED="bindingdetached",Binding.ACTION_DISPOSED="bindingdisposed",Binding.ACTION_MOVETOTOP="bindingmovetotop",Binding.ACTION_ACTIVATED="bindingactivated",Binding.ACTION_REGISTERED="bindingregistered",Binding.ACTION_MOVEDONTOP="bindingmovedontop",Binding.ACTION_INITIALIZED="bindinginitialized",Binding.ACTION_FORCE_REFLEX="bindingforcereflex",Binding.ACTION_DIMENSIONCHANGED="bindingdimensionchanged",Binding.ACTION_VISIBILITYCHANGED="bindingvisibilitychanged",Binding.ABSTRACT_METHOD=function(){throw SystemDebug.stack(arguments),this.toString()+" abstract method not implemented"},Binding.evaluate=function(a,b){var c=null,d=b.bindingWindow.WindowManager;if(null!=d){var e=Binding.parseScriptStatement(a,b.key);c=d.evaluate(e)}return c},Binding.parseScriptStatement=function(a,b){if(null!=a&&null!=b){var c='UserInterface.getBindingByKey ( "'+b+'" )';a=a.replace(/(\W|^)this(,| +|\)|;)/g,c),a=a.replace(/(\W|^)this(\.)/g,c+".")}return a},Binding.exists=function(a){var b=!1;try{a&&a.bindingElement&&a.bindingElement.nodeType&&0==a.isDisposed&&(b=!0)}catch(a){b=!1}finally{return b}},Binding.destroy=function(a){if(!a.isDisposed){null!=a.acceptor&&a.acceptor.dispose(),null!=a.dragger&&a.disableDragging(),null!=a.boxObject&&a.boxObject.dispose(),null!=a._domEventHandlers&&DOMEvents.cleanupEventListeners(a);for(var b in a.shadowTree){var c=a.shadowTree[b];c instanceof Binding&&Binding.exists(c)&&c.dispose(!0),a.shadowTree[b]=null}a.isDisposed=!0,a=null}},Binding.dotnetify=function(a,b){var c=a.getCallBackID();if(null==c)throw a.toString()+": Missing callback ID";var d=DOMUtil.createElementNS(Constants.NS_XHTML,"input",a.bindingDocument);d.type="hidden",d.id=c,d.name=c,d.value=null!=b?b:"",a.bindingElement.appendChild(d),a.shadowTree.dotnetinput=d},Binding.imageProfile=function(a){var b=a.getProperty("image"),c=a.getProperty("image-hover"),d=a.getProperty("image-active"),e=a.getProperty("image-disabled");null==a.imageProfile&&(null==a.image&&null!=b&&(a.image=b),null==a.imageHover&&null!=c&&(a.imageHover=c),null==a.imageActive&&null!=d&&(a.imageActive=d),null==a.imageDisabled&&null!=e&&(a.imageDisabled=e),(a.image||a.imageHover||a.imageActive||a.imageDisabled)&&(a.imageProfile=new ImageProfile(a)))},Binding.prototype.toString=function(){return"[Binding]"},Binding.prototype.onBindingRegister=function(){this.isRegistered||(this.bindingElement=UserInterface.getElement(this),this.bindingDocument=this.bindingElement.ownerDocument,this.bindingWindow=DOMUtil.getParentWindow(this.bindingDocument),this.shadowTree={},this.actionListeners={},this.propertyMethodMap={},this.isRegistered=!0,this._subscriptions=new Map,this._updateBindingMap(!0),this.getProperty("lazy")&&(this.isLazy=!0))},Binding.prototype.onBindingAttach=function(){this.isAttached||(this.bindingElement.parentNode?(this.boxObject=new BindingBoxObject(this),this._initializeBindingTestFeatures(),this._initializeBindingPersistanceFeatures(),this._initializeBindingGeneralFeatures(),this._initializeBindingDragAndDropFeatures(),this._updateBindingMap(!0),this.isAttached=!0):alert(this+" onBindingAttach: Binding must be positioned in document structure before attachment can be invoked."))},Binding.prototype.onBindingInitialize=function(){if(null!=this.dependentBindings)for(var a in this.dependentBindings){var b=this.dependentBindings[a];b.onMemberInitialize(this)}this.isInitialized=!0},Binding.prototype.onMemberInitialize=function(a){if(!a)throw new Error(this+" onMemberInitialize: Expected argument.");this.memberDependencies[a.key]=!0;var b=!0;for(var c in this.memberDependencies)if(0==this.memberDependencies[c]){b=!1;break}b&&this.onBindingInitialize()},Binding.prototype.attach=function(){return this.isAttached||(this.onBindingAttach(),null==this.memberDependencies&&this.onBindingInitialize()),this},Binding.prototype.attachRecursive=function(){this.bindingWindow.DocumentManager.attachBindings(this.bindingElement)},Binding.prototype.detachRecursive=function(a){null==a&&(a=!1),this.bindingWindow.DocumentManager.detachBindings(this.bindingElement,!a)},Binding.prototype.addMember=function(a){if(!this.isAttached)throw"Cannot add members to unattached binding";return a.isInitialized||(this.memberDependencies||(this.memberDependencies={}),this.memberDependencies[a.key]=!1,a.registerDependentBinding(this)),a},Binding.prototype.addMembers=function(a){for(;a.hasNext();){var b=a.getNext();b.isInitialized||this.addMember(b)}return a},Binding.prototype.registerDependentBinding=function(a){this.dependentBindings||(this.dependentBindings={}),this.dependentBindings[a.key]=a},Binding.prototype._initializeBindingTestFeatures=function(){if(Application.isTestEnvironment){var a=this.getProperty("label");a&&a.indexOf&&a.indexOf("${string:")>-1&&this.setProperty("data-qa",a)}},Binding.prototype._initializeBindingPersistanceFeatures=function(){var a=this.getProperty("persist");if(a&&Persistance.isEnabled){var b=this.bindingElement.id;if(KeyMaster.hasKey(b))throw"Persistable bindings must have a specified ID.";this._persist={};for(var c=new List(a.split(" "));c.hasNext();){var d=c.getNext(),e=Persistance.getPersistedProperty(b,d);null!=e?(this._persist[d]=e,this.setProperty(d,e)):(e=this.getProperty(d),null!=e&&(this._persist[d]=e))}}},Binding.prototype._initializeBindingGeneralFeatures=function(){var a=this.getProperty("disabled"),b=this.getProperty("contextmenu"),c=this.getProperty("observes"),d=this.getProperty("onattach"),e=this.getProperty("hidden"),f=this.getProperty("blockactionevents");if(1==e&&1==this.isVisible&&this.hide(),a&&null!=this.logger&&this.logger.error("The 'disabled' property has been renamed 'isdisbaled'"),b&&this.setContextMenu(b),c&&this.observe(this.getBindingForArgument(c)),1==f&&(this.isBlockingActions=!0),1==this.isActivationAware){var g=UserInterface.getBinding(this.bindingDocument.body);g.makeActivationAware(this),this._hasActivationAwareness=!0}null!=d&&Binding.evaluate(d,this)},Binding.prototype._initializeBindingDragAndDropFeatures=function(){var a=this.getProperty("draggable"),b=this.getProperty("dragtype"),c=this.getProperty("dragaccept"),d=this.getProperty("dragreject");if(null!=a&&(this.isDraggable=a),null!=b&&(this.dragType=b,0!=a&&(this.isDraggable=!0)),null!=c&&(this.dragAccept=c),null!=d&&(this.dragReject=d),this.isDraggable&&this.enableDragging(),null!=this.dragger&&null!=this.dragType&&this.dragger.registerHandler(Application),null!=this.dragAccept&&1==this.dragReject)throw new Error("Binding cannot both accept and reject "+this);(null!=this.dragAccept||null!=this.dragReject)&&(this.acceptor=new BindingAcceptor(this))},Binding.prototype._updateBindingMap=function(a){try{if(null!=this.bindingWindow){var b=this.bindingElement.id,c=this.bindingWindow.bindingMap,d=null;if(a)if(d=c[b],null!=d&&d!=this){var e=this.toString()+" duplicate binding ID: "+b;if(this.logger.error(e),Application.isDeveloperMode)throw e}else c[b]=this;else d=c[b],null!=d&&d==this&&delete c[b]}else{var f=new String("Binding#_updateBindingMap odd dysfunction: "+this.toString()+": "+a);1==Application.isDeveloperMode?alert(f):this.logger.error(f)}}catch(a){this.logger.error(a)}},Binding.prototype.handleEvent=function(a){},Binding.prototype.handleAction=function(a){},Binding.prototype.handleBroadcast=function(a,b){},Binding.prototype.handleElement=function(a){return!1},Binding.prototype.updateElement=function(a){return!1},Binding.prototype.getBindingForArgument=function(a){var b=null;switch(typeof a){case"object":b=a;break;case"string":b=this.bindingDocument.getElementById(a),null==b&&(b=Binding.evaluate(a,this))}return null!=b&&null!=b.nodeType&&(b=UserInterface.getBinding(b)),b},Binding.prototype.serialize=function(){var a={},b=this.bindingElement.id;b&&b!=this.key&&(a.id=b);var c=this.getProperty("binding");return c&&(a.binding=c),a},Binding.prototype.serializeToString=function(){var a=null;if(!this.isAttached)throw"cannot serialize unattached binding";return a=(new BindingSerializer).serializeBinding(this)},Binding.prototype.subTreeFromString=function(a){this.detachRecursive(),this.bindingElement.innerHTML=Client.fixUI(a),this.attachRecursive()},Binding.prototype.getProperty=function(a){var b=this.bindingElement.getAttribute(a);return b&&(b=Types.castFromString(b)),b},Binding.prototype.setProperty=function(a,b){if(null!=b){if(b=b.toString(),String(this.bindingElement.getAttribute(a))!=b&&(this.bindingElement.setAttribute(a,b),1==this.isAttached)){Persistance.isEnabled&&null!=b&&null!=this._persist&&this._persist[a]&&(this._persist[a]=b,Persistance.setPersistedProperty(this.bindingElement.id,a,b));var c=this.propertyMethodMap[a];c&&c.call(this,this.getProperty(a))}}else this.deleteProperty(a)},Binding.prototype.deleteProperty=function(a){this.bindingElement.removeAttribute(a)},Binding.prototype.getID=function(){var a=null;return Binding.exists(this)?a=this.bindingElement.id:SystemDebug.stack(arguments),a},Binding.prototype.attachClassName=function(a){CSSUtil.attachClassName(this.bindingElement,a)},Binding.prototype.detachClassName=function(a){CSSUtil.detachClassName(this.bindingElement,a)},Binding.prototype.hasClassName=function(a){return CSSUtil.hasClassName(this.bindingElement,a)},Binding.prototype.addActionListener=function(a,b){if(b=null!=b?b:this,Action.isValid(a)){if(!Interfaces.isImplemented(IActionListener,b))throw new Error("Could not add action-event listener. Method handleAction not implemented.");this.actionListeners[a]||(this.actionListeners[a]=[]),this.actionListeners[a].push(b)}else alert(this+"\nCould not add undefined Action ("+b+")")},Binding.prototype.removeActionListener=function(a,b){if(b=b?b:this,Action.isValid(a)){var c=this.actionListeners[a];if(c)for(var d,e=0;null!=(d=c[e]);){if(d==b){c.splice(e,1);break}e++}}},Binding.prototype.addEventListener=function(a,b){b=b?b:this,DOMEvents.addEventListener(this.bindingElement,a,b)},Binding.prototype.removeEventListener=function(a,b){b=b?b:this,DOMEvents.removeEventListener(this.bindingElement,a,b)},Binding.prototype.subscribe=function(a){this.hasSubscription(a)?this.logger.error("Dubplicate subscription aborted:"+a):(this._subscriptions.set(a,!0),EventBroadcaster.subscribe(a,this))},Binding.prototype.unsubscribe=function(a){this.hasSubscription(a)&&(this._subscriptions.del(a),EventBroadcaster.unsubscribe(a,this))},Binding.prototype.hasSubscription=function(a){return this._subscriptions.has(a)},Binding.prototype.observe=function(a,b){a.addObserver(this,b)},Binding.prototype.unObserve=function(a,b){a.removeObserver(this,b)},Binding.prototype.handleContextEvent=function(a){var b=this,c=this.contextMenuBinding;if(1==Interfaces.isImplemented(IActionListener,b)){var d={handleAction:function(){c.removeActionListener(MenuItemBinding.ACTION_COMMAND,b),c.removeActionListener(PopupBinding.ACTION_HIDE,d)}};c.addActionListener(MenuItemBinding.ACTION_COMMAND,b),c.addActionListener(PopupBinding.ACTION_HIDE,d)}c.snapToMouse(a)},Binding.prototype.setContextMenu=function(a){if(this.contextMenuBinding=this.getBindingForArgument(a),!this.contextMenuBinding)throw"No such contextmenu: "+a;var b=this;if(Client.isPad){var c=!1,d=!1;this.addEventListener(DOMEvents.TOUCHSTART,{handleEvent:function(a){d=setTimeout(function(){b.handleContextEvent(a)},800),c=!0}}),this.addEventListener(DOMEvents.TOUCHMOVE,{handleEvent:function(a){c&&(clearTimeout(d),c=!1)}}),this.addEventListener(DOMEvents.TOUCHEND,{handleEvent:function(a){c&&(clearTimeout(d),c=!1)}})}else this.addEventListener(DOMEvents.CONTEXTMENU,{handleEvent:function(a){b.handleContextEvent(a)}})},Binding.prototype.getContextMenu=function(){return this.contextMenuBinding},Binding.prototype.dispatchAction=function(a){var b=null,c=null,d=!1;if(a instanceof Action?b=a:Action.isValid(a)&&(b=new Action(this,a),d=!0),null!=b&&1==Action.isValid(b.type))if(1==b.isConsumed)c=b;else{var e=this.actionListeners[b.type];if(null!=e){b.listener=this;for(var f,g=0;null!=(f=e[g++]);)f&&f.handleAction&&f.handleAction(b)}var h=!0;if(1==this.isBlockingActions)switch(b.type){case Binding.ACTION_FOCUSED:case Binding.ACTION_BLURRED:case Binding.ACTION_ACTIVATED:case Binding.ACTION_FORCE_REFLEX:case DockTabBinding.ACTION_UPDATE_VISUAL:case PageBinding.ACTION_DOPOSTBACK:break;default:d||(h=!1)}c=h?this.migrateAction(b):b}return c},Binding.prototype.migrateAction=function(a){var b=null,c=null,d=this.getMigrationParent();if(d){for(;d&&!b&&d.nodeType!=Node.DOCUMENT_NODE;)b=UserInterface.getBinding(d),d=d.parentNode;c=b?b.dispatchAction(a):a}return c},Binding.prototype.reflex=function(a){1==Application.isOperational&&FlexBoxBinding.reflex(this,a)},Binding.prototype.getMigrationParent=function(){var a=null;try{var b=this.bindingElement.parentNode;null!=b&&(a=b)}catch(b){this.logger.error("Binding#getMigrationParent exception"),SystemDebug.stack(arguments),a=null}return a},Binding.prototype.add=function(a){if(a.bindingDocument!=this.bindingDocument)throw"Could not add "+a.toString()+" of different document origin.";return this.bindingElement.appendChild(a.bindingElement),a},Binding.prototype.addFirst=function(a){if(a.bindingDocument!=this.bindingDocument)throw"Could not add "+a.toString()+" of different document origin.";return this.bindingElement.insertBefore(a.bindingElement,this.bindingElement.firstChild),a},Binding.prototype.getAncestorBindingByLocalName=function(a,b){return BindingFinder.getAncestorBindingByLocalName(this,a,b)},Binding.prototype.getAncestorBindingByType=function(a,b){return BindingFinder.getAncestorBindingByType(this,a,b)},Binding.prototype.getChildBindingByType=function(a){return BindingFinder.getChildBindingByType(this,a)},Binding.prototype.getChildElementsByLocalName=function(a){return BindingFinder.getChildElementsByLocalName(this,a)},Binding.prototype.getChildElementByLocalName=function(a){return this.getChildElementsByLocalName(a).getFirst()},Binding.prototype.getDescendantElementsByLocalName=function(a){return new List(DOMUtil.getElementsByTagName(this.bindingElement,a))},Binding.prototype.getChildBindingsByLocalName=function(a){return this.getDescendantBindingsByLocalName(a,!0)},Binding.prototype.getChildBindingByLocalName=function(a){return this.getChildBindingsByLocalName(a).getFirst()},Binding.prototype.getDescendantBindingsByLocalName=function(a,b){return BindingFinder.getDescendantBindingsByLocalName(this,a,b)},Binding.prototype.getDescendantBindingByLocalName=function(a){return this.getDescendantBindingsByLocalName(a,!1).getFirst();
},Binding.prototype.getDescendantBindingsByType=function(a,b){return BindingFinder.getDescendantBindingsByType(this,a,b)},Binding.prototype.getDescendantBindingByType=function(a){return BindingFinder.getDescendantBindingByType(this,a)},Binding.prototype.getNextBindingByLocalName=function(a){return BindingFinder.getNextBindingByLocalName(this,a)},Binding.prototype.getPreviousBindingByLocalName=function(a){return BindingFinder.getPreviousBindingByLocalName(this,a)},Binding.prototype.getBindingElement=function(){return this.bindingDocument.getElementById(this.bindingElement.id)},Binding.prototype.getOrdinalPosition=function(a){return DOMUtil.getOrdinalPosition(this.bindingElement,a)},Binding.prototype.isFirstBinding=function(a){return 0==this.getOrdinalPosition(a)},Binding.prototype.isLastBinding=function(a){return DOMUtil.isLastElement(this.bindingElement,a)},Binding.prototype.hasCallBackID=function(){return null!=this.getProperty(Binding.CALLBACKID)},Binding.prototype.getCallBackID=function(){return this.getProperty(Binding.CALLBACKID)},Binding.prototype.setCallBackID=function(a){this.setProperty(Binding.CALLBACKID,a)},Binding.prototype.hasCallBackArg=function(){return null!=this.getCallBackArg()},Binding.prototype.getCallBackArg=function(){return this.getProperty(Binding.CALLBACKARG)},Binding.prototype.setCallBackArg=function(a){this.setProperty(Binding.CALLBACKARG,a)},Binding.prototype.dispose=function(a){if(!this.isDisposed)if(a){if(this._subscriptions.hasEntries()){var b=this,c=new List;this._subscriptions.each(function(a){c.add(a)}),c.each(function(a){b.unsubscribe(a)})}this.onBindingDispose(),UserInterface.unRegisterBinding(this)}else{this.bindingWindow.DocumentManager.detachBindings(this.bindingElement);var d=this.bindingDocument.getElementById(this.bindingElement.id);d&&(Client.isExplorer?d.outerHTML="":d.parentNode.removeChild(d))}},Binding.prototype.onBindingDispose=function(){if(this._hasActivationAwareness){var a=UserInterface.getBinding(this.bindingDocument.body);a.makeActivationAware(this,!1),this._hasActivationAwareness=!1}this._updateBindingMap(!1)},Binding.prototype.enableDragging=function(){null==this.dragger&&(this.dragger=new BindingDragger(this),this.addEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.addEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.addEventListener(DOMEvents.MOUSEUP,this.dragger)),this.isDraggable=!0},Binding.prototype.disableDragging=function(){null!=this.dragger&&(this.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.dragger.dispose(),this.dragger=null),this.isDraggable=!1},Binding.prototype.show=function(){this.isVisible||(this.bindingElement.style.display="block",this.setProperty("hidden",!0),this.isVisible=!0)},Binding.prototype.hide=function(){1==this.isVisible&&(this.bindingElement.style.display="none",this.deleteProperty("hidden"),this.isVisible=!1)},Binding.prototype.wakeUp=function(a,b){if(b=b?b:Binding.SNOOZE,1==this.isLazy){this.deleteProperty("lazy"),this.isLazy=!1,Application.lock(this),this.dispatchAction(FocusBinding.ACTION_UPDATE);var c=this;setTimeout(function(){c.attachRecursive(),setTimeout(function(){"string"==typeof a?c[a]():"function"==typeof a&&a(),LazyBindingBinding.wakeUp(c),Application.unlock(c)},b)},0)}},Binding.prototype.handleCrawler=function(a){if(null==a.response&&1==this.isLazy&&(a.id==DocumentCrawler.ID&&a.mode==DocumentCrawler.MODE_REGISTER?a.response=NodeCrawler.NORMAL:a.response=NodeCrawler.SKIP_CHILDREN),null==a.response&&null!=this.crawlerFilters&&this.crawlerFilters.has(a.id)&&(a.response=NodeCrawler.SKIP_CHILDREN),null==a.response)switch(a.id){case FlexBoxCrawler.ID:case FocusCrawler.ID:this.isVisible||(a.response=NodeCrawler.SKIP_CHILDREN)}},Binding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:binding",a);return UserInterface.registerBinding(b,Binding)},DataBinding.prototype=new Binding,DataBinding.prototype.constructor=DataBinding,DataBinding.superclass=Binding.prototype,DataBinding.AUTOGENERATED="autogenerateddatabindingname",DataBinding.TYPE_NUMBER="number",DataBinding.TYPE_INTEGER="integer",DataBinding.TYPE_STRING="string",DataBinding.CLASSNAME_INVALID="invalid",DataBinding.CLASSNAME_INFOBOX="infobox",DataBinding.CLASSNAME_WARNING="warning",DataBinding.CLASSNAME_FOCUSED="focused",DataBinding.CLASSNAME_DISABLED="disabled",EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,{handleBroadcast:function(){var a=new List(ConfigurationService.GetValidatingRegularExpressions("dummy"));a.each(function(a){DataBinding.expressions[a.Key]=new RegExp(a.Value)});var b={required:StringBundle.getString("ui","Validation.Required"),number:StringBundle.getString("ui","Validation.InvalidField.Number"),integer:StringBundle.getString("ui","Validation.InvalidField.Integer"),programmingidentifier:StringBundle.getString("ui","Validation.InvalidField.ProgrammingIdentifier"),programmingnamespace:StringBundle.getString("ui","Validation.InvalidField.ProgrammingNamespace"),url:StringBundle.getString("ui","Validation.InvalidField.Url"),minlength:StringBundle.getString("ui","Validation.StringLength.Min"),maxlength:StringBundle.getString("ui","Validation.StringLength.Max"),currency:StringBundle.getString("ui","Validation.InvalidField.Currency"),email:StringBundle.getString("ui","Validation.InvalidField.Email"),guid:StringBundle.getString("ui","Validation.InvalidField.Guid")};for(var c in b)DataBinding.warnings[c]=b[c]}}),DataBinding.expressions={},DataBinding.warnings={required:"Required",number:"Numbers only",integer:"Integers only",programmingidentifier:"Invalid identifier",programmingnamespace:"Invalid namespace",url:"Invalid URL",minlength:"{0} characters minimum",maxlength:"{0} characters maximum",currency:"Invalid notation",email:"Invalid e-mail",guid:"Invalid GUID"},DataBinding.errors={programmingidentifier:"An identifier must not contain spaces or special characters. Only characters a-z, A-Z, 0-9 and '_' are allowed. An identifier must begin with a letter (not a number).",programmingnamespace:"A namespace must take the form Example.Name.Space where only characters a-z, A-Z, 0-9, '_' and dots (.) are allowed. Each part of the namespace must begin with a letter (not a number).",url:"A valid URL must begin with a forward slash, designating the site root, or an URL scheme name such as http://. Simpliefied addresses such as www.example.com cannot be resolved reliably by the browser. Relative URLs are not supported."},DataBinding.getAssociatedLabel=function(a){var b=null,c=a.getAncestorBindingByLocalName("field");if(c&&c instanceof FieldBinding){var d=c.getDescendantBindingByLocalName("fielddesc");d&&d instanceof FieldDescBinding&&(b=d.getLabel())}return b},DataBinding.prototype.toString=function(){return"[DataBinding]"},DataBinding.prototype.onBindingRegister=function(){DataBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled;var a=this._name?this._name:this.getProperty("name");null==a&&(a=DataBinding.AUTOGENERATED+KeyMaster.getUniqueKey()),this.setName(a)},DataBinding.prototype.onBindingAttach=function(){DataBinding.superclass.onBindingAttach.call(this),this.getProperty("error")&&(this.error=this.getProperty("error"))},DataBinding.prototype.onBindingDispose=function(){DataBinding.superclass.onBindingDispose.call(this),1==this.isFocused&&this.blur();var a=this.bindingWindow.DataManager;a.unRegisterDataBinding(this._name)},DataBinding.prototype.setName=function(a){var b=this.bindingWindow.DataManager;b.getDataBinding(a)&&b.unRegisterDataBinding(a),b.registerDataBinding(a,this),this.setProperty("name",a),this._name=a},DataBinding.prototype.getName=function(){return this._name},DataBinding.prototype.focus=function(){this.isFocusable&&!this.isFocused&&(this.isFocused=!0,this.dispatchAction(Binding.ACTION_FOCUSED),this.attachClassName(DataBinding.CLASSNAME_FOCUSED))},DataBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.dispatchAction(Binding.ACTION_BLURRED),this.detachClassName(DataBinding.CLASSNAME_FOCUSED))},DataBinding.prototype.dirty=function(){this.bindingWindow.DataManager.dirty(this)},DataBinding.prototype.clean=function(){this.bindingWindow.DataManager.clean(this)},DataBinding.prototype.validate=Binding.ABSTRACT_METHOD,DataBinding.prototype.manifest=Binding.ABSTRACT_METHOD,DataBinding.prototype.getValue=Binding.ABSTRACT_METHOD,DataBinding.prototype.setValue=Binding.ABSTRACT_METHOD,DataBinding.prototype.getResult=Binding.ABSTRACT_METHOD,DataBinding.prototype.setResult=Binding.ABSTRACT_METHOD,RootBinding.prototype=new Binding,RootBinding.prototype.constructor=RootBinding,RootBinding.superclass=Binding.prototype,RootBinding.ACTION_PHASE_1="root init phase 1",RootBinding.ACTION_PHASE_2="root init phase 2",RootBinding.ACTION_PHASE_3="root init phase 3",RootBinding.ACTION_ACTIVATED="root activated",RootBinding.ACTION_DEACTIVATED="root deactivated",RootBinding.CLASSNAME_WEBKIT_DESKTOP="webkit-d",RootBinding.prototype.toString=function(){return"[RootBinding]"},RootBinding.prototype.onBindingRegister=function(){RootBinding.superclass.onBindingRegister.call(this),this.logger=SystemLogger.getLogger(this.bindingDocument.title.toString()),this.bindingWindow.WindowManager&&this.subscribe(this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST),this._activationawares=new List,this.isActivated=!1,this._setupActivationAwareness(!0),Localization.isUIRtl&&(this.setProperty("dir","rtl"),this.attachClassName("rtl")),Client.isWebKit&&!Client.isPad&&this.attachClassName(RootBinding.CLASSNAME_WEBKIT_DESKTOP)},RootBinding.prototype.onBindingDispose=function(){RootBinding.superclass.onBindingDispose.call(this),this._setupActivationAwareness(!1),EventBroadcaster.unsubscribe(this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST,this)},RootBinding.prototype.handleBroadcast=function(a,b){RootBinding.superclass.handleBroadcast.call(this,a,b);var c=this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST;switch(a){case c:this.dispatchAction(RootBinding.ACTION_PHASE_1),this.dispatchAction(RootBinding.ACTION_PHASE_2),this.dispatchAction(RootBinding.ACTION_PHASE_3),this.unsubscribe(c)}},RootBinding.prototype.onActivate=function(){this._onActivationChanged(!0)},RootBinding.prototype.onDeactivate=function(){this._onActivationChanged(!1)},RootBinding.prototype._onActivationChanged=function(a){var b=a?RootBinding.ACTION_ACTIVATED:RootBinding.ACTION_DEACTIVATED;if(a!=this.isActivated){this.isActivated=a,this.dispatchAction(b);var c=new List,d=this;this._activationawares.each(function(b){if(b.isActivationAware)try{a?b.isActivated||b.onActivate():b.isActivated&&b.onDeactivate()}catch(a){d.logger.error(a),c.add(b)}}),c.each(function(a){this._activationawares.del(a)}),c.dispose()}else{var e="Activation dysfunction: "+this.bindingDocument.title;1==Application.isDeveloperMode?this.logger.error(e):this.logger.error(e)}},RootBinding.prototype.makeActivationAware=function(a,b){1==Interfaces.isImplemented(IActivationAware,a,!0)?0==b?this._activationawares.del(a):(this._activationawares.add(a),1==this.isActivated&&a.onActivate()):1==Application.isDeveloperMode&&alert("RootBinding: IActivationAware not implemented ("+a+")")},RootBinding.prototype._setupActivationAwareness=function(a){var b=this.getMigrationParent();if(null!=b){var c=b.ownerDocument.body,d=UserInterface.getBinding(c);null!=d&&d.makeActivationAware(this,a)}},RootBinding.prototype.handleCrawler=function(a){RootBinding.superclass.handleCrawler.call(this,a),a.type==NodeCrawler.TYPE_ASCENDING&&(a.nextNode=this.bindingWindow.frameElement)},RootBinding.prototype.getMigrationParent=function(){var a=null;try{this.bindingWindow.parent&&(a=this.bindingWindow.frameElement)}catch(a){}return a},StyleBinding.prototype=new Binding,StyleBinding.prototype.constructor=StyleBinding,StyleBinding.superclass=Binding.prototype,StyleBinding.prototype.toString=function(){return"[StyleBinding]"},StyleBinding.prototype.onBindingAttach=function(){StyleBinding.superclass.onBindingAttach.call(this),console.log("StyleBinding.prototype.onBindingAttach"),this.href=this.getProperty("link"),this.style=document.createElement("link"),this.style.rel="stylesheet",this.style.type="text/css",this.style.href=Resolver.resolve(this.href),this.bindingDocument.getElementsByTagName("head")[0].appendChild(this.style)},StyleBinding.prototype.handleElement=function(a){return!0},StyleBinding.prototype.updateElement=function(a){var b=a.getAttribute("link");return this.href!=b&&this.style&&(this.href=b,this.style.href=Resolver.resolve(this.href)),!0},StyleBinding.prototype.onBindingDispose=function(){StyleBinding.superclass.onBindingDispose.call(this),this.style&&this.style.parentNode&&this.style.parentNode.removeChild(this.style),this.href=null,this.style=null},FlexBoxBinding.prototype=new Binding,FlexBoxBinding.prototype.constructor=FlexBoxBinding,FlexBoxBinding.superclass=Binding.prototype,FlexBoxBinding.CLASSNAME="flexboxelement",FlexBoxBinding.TIMEOUT=250,FlexBoxBinding.reflex=function(a,b){var c=new List,d=new FlexBoxCrawler;d.mode=b?FlexBoxCrawler.MODE_FORCE:FlexBoxCrawler.MODE_NORMAL,d.startBinding=a,d.crawl(a.bindingElement,c),c.each(function(a){a.flex()}),Client.isExplorer&&setTimeout(function(){c.each(function(a){Binding.exists(a)&&a.flex()})},.5*FlexBoxBinding.TIMEOUT),setTimeout(function(){c.each(function(a){Binding.exists(a)&&(a.isFlexSuspended=!1)}),c.dispose()},FlexBoxBinding.TIMEOUT),d.dispose()},FlexBoxBinding.prototype.toString=function(){return"[FlexBoxBinding]"},FlexBoxBinding.prototype.onBindingRegister=function(){FlexBoxBinding.superclass.onBindingRegister.call(this),0==this.getProperty("flex")&&(this.isFlexible=!1),this.isFlexible&&(this.attachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&(this.bindingElement.style.overflow="auto"))},FlexBoxBinding.prototype.onBindingAttach=function(){FlexBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_UPDATED)},FlexBoxBinding.prototype.handleAction=function(a){switch(FlexBoxBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_UPDATED:this.isFit=!1}},FlexBoxBinding.prototype._getSiblingsSpan=function(a){for(var b=0,c=new List(this.bindingElement.parentNode.childNodes);c.hasNext();){var d=c.getNext();if(d.nodeType==Node.ELEMENT_NODE&&d!=this.bindingElement&&!this._isOutOfFlow(d)){var e=d.getBoundingClientRect();a?height+=e.right-e.left:b+=e.bottom-e.top}}return b},FlexBoxBinding.prototype._isOutOfFlow=function(a){var b=CSSComputer.getPosition(a),c=CSSComputer.getFloat(a);return"absolute"==b||"none"!=c?!0:!1},FlexBoxBinding.prototype._getCalculatedHeight=function(){var a=this.bindingElement.parentNode,b=a.getBoundingClientRect(),c=b.bottom-b.top,d=CSSComputer.getPadding(a),e=CSSComputer.getBorder(a);c-=d.top+d.bottom,c-=e.top+e.bottom;var f=CSSComputer.getMargin(this.bindingElement);return c-=f.top+f.bottom},FlexBoxBinding.prototype._getCalculatedWidth=function(){var a=this.bindingElement.parentNode,b=a.getBoundingClientRect(),c=b.right-b.left,d=CSSComputer.getPadding(a),e=CSSComputer.getBorder(a);return c-=d.left+d.right,c-=e.left+e.right},FlexBoxBinding.prototype.setFlexibility=function(a){a!=this.isFlexible&&(a?(this.attachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&(this.bindingElement.style.overflow="auto"),this.deleteProperty("flex")):(this.detachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&this.bindingElement.style.removeProperty("overflow"),this.setProperty("flex",!1)),this.isFlexible=a)},FlexBoxBinding.prototype.flex=function(){if(Binding.exists(this)&&1==this.isFlexible){var a=this._getSiblingsSpan();a=this._getCalculatedHeight()-a,!isNaN(a)&&a>=0&&(this.bindingElement.style.height=String(a)+"px")}},FlexBoxBinding.prototype.fit=function(a){if(!this.isFit||a){var b=0;new List(this.bindingElement.childNodes).each(function(a){if(a.nodeType==Node.ELEMENT_NODE&&!this._isOutOfFlow(a)){var c=a.getBoundingClientRect();b+=c.bottom-c.top}},this),this._setFitnessHeight(b),this.isFit=!0}},FlexBoxBinding.prototype._setFitnessHeight=function(a){var b=CSSComputer.getPadding(this.bindingElement),c=CSSComputer.getBorder(this.bindingElement);a+=b.top+b.bottom,a+=c.top+c.bottom,this.bindingElement.style.height=a+"px"},ScrollBoxBinding.prototype=new FlexBoxBinding,ScrollBoxBinding.prototype.constructor=ScrollBoxBinding,ScrollBoxBinding.superclass=FlexBoxBinding.prototype,ScrollBoxBinding.prototype.toString=function(){return"[ScrollBoxBinding]"},ScrollBoxBinding.prototype.onBindingRegister=function(){ScrollBoxBinding.superclass.onBindingRegister.call(this),this.addActionListener(BalloonBinding.ACTION_INITIALIZE)},ScrollBoxBinding.prototype.handleAction=function(a){switch(ScrollBoxBinding.superclass.handleAction.call(this,a),a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},ScrollBoxBinding.prototype.setPosition=function(a){this.bindingElement.scrollLeft=a.x,this.bindingElement.scrollTop=a.y},ScrollBoxBinding.prototype.getPosition=function(){return new Point(this.bindingElement.scrollLeft,this.bindingElement.scrollTop)},LabelBinding.prototype=new Binding,LabelBinding.prototype.constructor=LabelBinding,LabelBinding.superclass=Binding.prototype,LabelBinding.DIALOG_INDECATOR_SUFFIX=String.fromCharCode(8230),LabelBinding.DEFAULT_IMAGE="blank",LabelBinding.SPRITE_PATH="${root}/images/sprite.svg",LabelBinding.CLASSNAME_GRAYTEXT="graytext",LabelBinding.CLASSNAME_FLIPPED="flipped",LabelBinding.DOCKTABLABEL_OVERFLOWED_CLASSNAME="overflowed",LabelBinding.DOCKTABLABEL_WIDTH=110,LabelBinding.sprites=null,LabelBinding.spritesQueue=new Map,LabelBinding.spriteLoading=!1,LabelBinding.spriteLoad=function(){function a(){var a=this,b=document.createElement("x");b.innerHTML=a.responseText;for(var c=b.querySelectorAll("use"),d=0;d<c.length;++d){var e=c[d],f=e.parentNode,g=e.getAttribute("xlink:href").split("#")[1],h=b.querySelector("#"+g);if(h){var i=h.cloneNode(!0);i.id=f.id,f.parentNode.replaceChild(i,f)}}LabelBinding.sprites=b,LabelBinding.spriteLoading=!1,LabelBinding.spritesQueue.each(function(a,b){var c=UserInterface.getBindingByKey(a);null!=c&&LabelBinding.setImageSvg(c,b)}),LabelBinding.spritesQueue.empty()}if(!LabelBinding.spriteLoading){LabelBinding.spriteLoading=!0;var b=new XMLHttpRequest;b.open("GET",Resolver.resolve(LabelBinding.SPRITE_PATH)),b.onload=a,b.send()}},LabelBinding.setImageSvg=function(a,b){if(b&&"string"==typeof b&&/^[A-Za-z]+[\w\-\.]*$/.test(b)){if(a.shadowTree.labelBody)if(b)if(LabelBinding.sprites){var c=b.toLowerCase().indexOf("-disabled")>0;b=b.toLowerCase().replace("-disabled","");var d=LabelBinding.sprites.querySelector("#"+b);if(d){var e="http://www.w3.org/2000/svg";a.shadowTree.svg||(a.shadowTree.svg=a.bindingDocument.createElementNS(e,"svg"),a.shadowTree.labelBody.insertBefore(a.shadowTree.svg,a.shadowTree.labelBody.firstChild));var f=a.shadowTree.svg;f.setAttribute("viewBox","0 0 24 24"),c&&f.setAttribute("class","disabled");var g=d.getAttribute("viewBox"),h=document.createDocumentFragment(),i=d.cloneNode(!0);for(g&&f.setAttribute("viewBox",g),h.appendChild(i);f.lastChild;)f.removeChild(f.lastChild);f.appendChild(h)}}else LabelBinding.spritesQueue.set(a.getID(),b),LabelBinding.spriteLoad();else;}else{var f=a.shadowTree.svg;f&&(f.parentNode&&f.parentNode.removeChild(f),a.shadowTree.svg=null)}},LabelBinding.prototype.toString=function(){return"[LabelBinding]"},LabelBinding.prototype.onBindingRegister=function(){LabelBinding.superclass.onBindingRegister.call(this),this.isBindingBuild?this.shadowTree.labelBody=this._getBuildElement("labelbody"):(this.shadowTree.labelBody=DOMUtil.createElementNS(Constants.NS_UI,"ui:labelbody",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.labelBody))},LabelBinding.prototype.onBindingAttach=function(){if(LabelBinding.superclass.onBindingAttach.call(this),this.isBindingBuild){var a=this._getBuildElement("labeltext");a&&(this.shadowTree.labelText=a,this.shadowTree.text=a.firstChild,this.hasLabel=!0)}else{var b=this.getProperty("label"),c=this.getProperty("image"),d=this.getProperty("tooltip");b&&this.setLabel(b,!1),c&&this.setImage(c,!1),d&&this.setToolTip(d),this.buildClassName()}},LabelBinding.prototype.setLabel=function(a,b){a=null!=a?a:"",this.hasLabel||this.buildLabel(),this.shadowTree.text.data=Resolver.resolve(a),this.setProperty("label",a),b||this.buildClassName();var c=this.getAncestorBindingByType(DockTabBinding,!0);if(null!=c){var d=this.shadowTree.labelText,e=CSSComputer.getWidth(d);d.style.width="auto";var f=d.clientWidth,g=Number(e.replace(/[^\d\.\-]/g,""));f>g&&this.attachClassName(LabelBinding.DOCKTABLABEL_OVERFLOWED_CLASSNAME),d.style.width=e}},LabelBinding.prototype.getLabel=function(){return this.getProperty("label")},LabelBinding.prototype.setImage=function(a,b){if(0!=a&&void 0!=a){a=a?a:LabelBinding.DEFAULT_IMAGE;var c=Resolver.resolve(a);c.classes?(this.setAlphaTransparentBackdrop(),this.setImageSvg(),this.setImageClasses(c.classes)):"string"==typeof c&&"/"==c[0]?(this.setAlphaTransparentBackdrop(c),this.setImageSvg(),this.setImageClasses()):(this.setAlphaTransparentBackdrop(),this.setImageSvg(c),this.setImageClasses()),"string"==typeof c&&this.setProperty("image",a),this.hasImage=!0,b||this.buildClassName()}else this.setImageSvg(),this.setImageClasses(),this.deleteProperty("image"),this.hasImage=!1,this.buildClassName()},LabelBinding.prototype.setImageClasses=function(a){this.shadowTree.labelBody&&(a?(this.shadowTree.icon||(this.shadowTree.icon=DOMUtil.createElementNS(Constants.NS_UI,"ui:icon",this.bindingDocument),this.shadowTree.labelBody.insertBefore(this.shadowTree.icon,this.shadowTree.labelBody.firstChild)),this.shadowTree.icon.className=a):this.shadowTree.icon&&(this.shadowTree.labelBody.removeChild(this.shadowTree.icon),this.shadowTree.icon=null))},LabelBinding.prototype.setImageSvg=function(a){LabelBinding.setImageSvg(this,a)},LabelBinding.prototype.setDefaultImage=function(a){this.setImage(LabelBinding.DEFAULT_IMAGE)},LabelBinding.prototype.setAlphaTransparentBackdrop=function(a){this.shadowTree.labelBody&&(a?(a=Resolver.resolve(a),this.shadowTree.labelBody.style.backgroundImage="url('"+a+"')"):this.shadowTree.labelBody.style.removeProperty("background-image"))},LabelBinding.prototype.getImage=function(){return this.getProperty("image")},LabelBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),a!=this.getLabel()&&this.setProperty("title",Resolver.resolve(a))},LabelBinding.prototype.getToolTip=function(a){return this.getProperty("tooltip")},LabelBinding.prototype.flip=function(a){a=null==a?!0:a;var b=LabelBinding.CLASSNAME_FLIPPED;Client.isExplorer6||(this.isFlipped=a,a?this.attachClassName(b):this.detachClassName(b))},LabelBinding.prototype.buildLabel=function(){this.hasLabel||(this.shadowTree.labelText=DOMUtil.createElementNS(Constants.NS_UI,"ui:labeltext",this.bindingDocument),this.shadowTree.text=this.bindingDocument.createTextNode(""),this.shadowTree.labelText.appendChild(this.shadowTree.text),this.shadowTree.labelBody.appendChild(this.shadowTree.labelText),this.hasLabel=!0)},LabelBinding.prototype.buildClassName=function(){var a="textonly",b="imageonly",c="image-and-text";this.hasLabel&&this.hasImage?(this.detachClassName(a),this.detachClassName(b),this.attachClassName(c)):this.hasLabel?(this.detachClassName(c),this.detachClassName(b),this.attachClassName(a)):this.hasImage&&(this.detachClassName(c),this.detachClassName(a),this.attachClassName(b))},LabelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:labelbox",a);return UserInterface.registerBinding(b,LabelBinding)},TextBinding.prototype=new Binding,TextBinding.prototype.constructor=TextBinding,TextBinding.superclass=Binding.prototype,TextBinding.prototype.toString=function(){return"[TextBinding]"},TextBinding.prototype.onBindingAttach=function(){TextBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("label");a||(a=DOMUtil.getTextContent(this.bindingElement));var b=this.bindingDocument.createTextNode(Resolver.resolve(a));this.bindingElement.parentNode.replaceChild(b,this.bindingElement),this.dispose()},TextBinding.prototype.setLabel=function(a){this.setProperty("label",a)},TextBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:text",a);return UserInterface.registerBinding(b,TextBinding)},BroadcasterSetBinding.prototype=new Binding,BroadcasterSetBinding.prototype.constructor=BroadcasterSetBinding,BroadcasterSetBinding.superclass=Binding.prototype,BroadcasterSetBinding.prototype.toString=function(){return"[BroadcasterSetBinding]"},BroadcasterBinding.prototype=new Binding,BroadcasterBinding.prototype.constructor=BroadcasterBinding,BroadcasterBinding.superclass=Binding.prototype,BroadcasterBinding.prototype.toString=function(){return"[BroadcasterBinding]"},BroadcasterBinding.prototype.onBindingRegister=function(){BroadcasterBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled,this._observers=new List},BroadcasterBinding.prototype.setProperty=function(a,b){function c(c){c&&c.each(function(c){c.setProperty(a,b)})}BroadcasterBinding.superclass.setProperty.call(this,a,b),null!=this._observers["*"]&&c(this._observers["*"]);var d=this._observers[a];d&&c(d)},BroadcasterBinding.prototype.deleteProperty=function(a){function b(b){b&&b.each(function(b){b.deleteProperty(a)})}BroadcasterBinding.superclass.deleteProperty.call(this,a),null!=this._observers["*"]&&b(this._observers["*"]);var c=this._observers[a];c&&b(c)},BroadcasterBinding.prototype.addObserver=function(a,b){for(b=b?b:"*",b=new List(b.split(" "));b.hasNext();){var c=b.getNext();switch(c){case"*":this._setAllProperties(a);break;default:var d=this.getProperty(c);a.setProperty(c,d)}this._observers[c]||(this._observers[c]=new List),this._observers[c].add(a)}},BroadcasterBinding.prototype._setAllProperties=function(a){for(var b=new List(this.bindingElement.attributes);b.hasNext();){var c=b.getNext();if(c.specified){var d=c.nodeName;switch(d){case"id":case"key":break;default:var e=this.getProperty(d);a.setProperty(d,e)}}}},BroadcasterBinding.prototype.removeObserver=function(a,b){for(b=b?b:"*",b=new List(b.split(" "));b.hasNext();){var c=this._observers[b.getNext()];if(c)for(;c.hasNext();){var d=c.getNext();d==a&&c.del(d)}}},BroadcasterBinding.prototype.disable=function(){this.setDisabled(!0)},BroadcasterBinding.prototype.enable=function(){this.setDisabled(!1)},BroadcasterBinding.prototype.setDisabled=function(a){this.setProperty("isdisabled",a)},BroadcasterBinding.prototype.isDisabled=function(){return 1==this.getProperty("isdisabled")},ButtonBinding.prototype=new Binding,ButtonBinding.prototype.constructor=ButtonBinding,ButtonBinding.superclass=Binding.prototype,ButtonBinding.ACTION_COMMAND="buttoncommand",ButtonBinding.ACTION_RADIOBUTTON_ATTACHED="radiobutton attached",ButtonBinding.TYPE_CHECKBUTTON="checkbox",ButtonBinding.TYPE_RADIOBUTTON="radio",ButtonBinding.CLASSNAME_FOCUSABLE="focusable",ButtonBinding.CLASSNAME_FOCUSED="focused",ButtonBinding.CLASSNAME_DEFAULT="primary",ButtonBinding.prototype.toString=function(){return"[ButtonBinding]"},ButtonBinding.prototype.onBindingRegister=function(){ButtonBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled},ButtonBinding.prototype.onBindingAttach=function(){ButtonBinding.superclass.onBindingAttach.call(this),this.parseDOMProperties(),this.buildDOMContent(),1==this.isRadioButton&&this.dispatchAction(ButtonBinding.ACTION_RADIOBUTTON_ATTACHED)},ButtonBinding.prototype.onBindingDispose=function(){ButtonBinding.superclass.onBindingDispose.call(this),null!=this._stateManager&&(this._stateManager.dispose(),this._stateManager=null);var a=this.getProperty("callbackid");null!=a&&this.bindingWindow.DataManager.unRegisterDataBinding(a)},ButtonBinding.prototype.parseDOMProperties=function(){Binding.imageProfile(this)},ButtonBinding.prototype.buildDOMContent=function(){var a=(this.shadowTree,this.getProperty("width")),b=this.getProperty("label"),c=this.getProperty("type"),d=this.getProperty("popup"),e=this.getProperty("tooltip"),f=this.getProperty("isdisabled"),g=this.getProperty("response"),h=this.getProperty("oncommand"),i=this.getProperty("value"),j=this.getProperty("ischecked"),k=this.getProperty("callbackid"),l=this.getProperty("focusable"),m=this.getProperty("focused"),n=this.getProperty("default"),o=this.getProperty("url"),p=this.getProperty("flip");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.add(this.labelBinding),this.labelBinding.attach(),this.shadowTree.labelBinding=this.labelBinding,p&&this.flip(!0),this._stateManager||(this._stateManager=new ButtonStateManager(this)),null!=this.imageProfile&&null!=this.imageProfile.getDefaultImage()&&this.setImage(this.imageProfile.getDefaultImage()),null!=b&&this.setLabel(b),null!=c&&this.setType(c),null!=e&&this.setToolTip(e),null!=a&&this.setWidth(a),null!=d&&this.setPopup(d),null!=g&&(this.response=g),1==j&&(this.isCheckButton||this.isRadioButton)&&this.check(!0),null!=h&&null==this.oncommand&&(this.oncommand=function(){Binding.evaluate(h,this)}),(l||this.isFocusable)&&(this._makeFocusable(),(n||this.isDefault)&&(this.isDefault=!0),m&&this.focus()),1==f&&this.disable(),null!=o&&this.setURL(o),null!=k&&(this.bindingWindow.DataManager.registerDataBinding(k,this),null!=i&&Binding.dotnetify(this,i),null==this.oncommand&&(this.oncommand=function(){this.dirty(),1==this.getProperty("validate")?this.dispatchAction(PageBinding.ACTION_DOVALIDATEDPOSTBACK):this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)}))},ButtonBinding.prototype._makeFocusable=function(){this.isFocusable=!0,this.attachClassName(ButtonBinding.CLASSNAME_FOCUSABLE),this._isFocusableButton=!0},ButtonBinding.prototype.setImage=function(a){this.isAttached&&this.labelBinding.setImage(a),this.setProperty("image",a)},ButtonBinding.prototype.getImage=function(){return this.getProperty("image")},ButtonBinding.prototype.setLabel=function(a){this.isAttached&&this.labelBinding.setLabel(a),this.setProperty("label",a)},ButtonBinding.prototype.getLabel=function(){return this.getProperty("label")},ButtonBinding.prototype.setType=function(a){switch(a){case ButtonBinding.TYPE_CHECKBUTTON:this.isCheckButton=!0;break;case ButtonBinding.TYPE_RADIOBUTTON:this.isRadioButton=!0}this.setProperty("type",a)},ButtonBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),1==this.isAttached&&this.setProperty("title",Resolver.resolve(a))},ButtonBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},ButtonBinding.prototype.setImageProfile=function(a){this.imageProfile=new a(this)},ButtonBinding.prototype.setPopup=function(a){if(this.popupBinding=this.getBindingForArgument(a),this.popupBinding){this.setType(ButtonBinding.TYPE_CHECKBUTTON),this.popupBindingTargetElement||(this.popupBindingTargetElement=this.bindingElement);var b=this;this.popupBinding.addActionListener(PopupBinding.ACTION_HIDE,{handleAction:function(){1==b.isChecked&&b.uncheck(!0)}})}},ButtonBinding.prototype.setURL=function(a){if(1==this.isAttached){if(!this.shadowTree.buttonurl){var b=this.bindingDocument.createElement("a");b.className="buttonurl",b.target="_blank",this.shadowTree.buttonurl=b,this.bindingElement.appendChild(b)}this.shadowTree.buttonurl.href=a}this.setProperty("url",a)},ButtonBinding.prototype.getURL=function(){return this.getProperty("url")},ButtonBinding.prototype.flip=function(a){a=null==a?!0:a,this.isFlipped=a,this.setProperty("flip",a),this.isAttached&&this.labelBinding.flip(a)},ButtonBinding.prototype.fireCommand=function(){this.isDisabled||(null!=this.oncommand&&this.oncommand(),this.dispatchAction(this.commandAction),this.invokePopup())},ButtonBinding.prototype.invokePopup=function(){this.isDisabled||this.popupBinding&&(!this.isCheckButton||this.isChecked?(this.popupBinding.snapTo(this.popupBindingTargetElement),this.popupBinding.show(),
this.popupBinding.grabKeyboard()):(this.popupBinding.hide(),this.popupBinding.releaseKeyboard()))},ButtonBinding.prototype.oncommand=null,ButtonBinding.prototype.invoke=function(){this.isCheckButton?this.isChecked?this.uncheck():this.check():this.fireCommand()},ButtonBinding.prototype.check=function(a){!this.isCheckButton&&!this.isRadioButton||this.isChecked||(1==this.isAttached?(this._check(),1==!a&&this.fireCommand()):this.setProperty("ischecked",!0))},ButtonBinding.prototype._check=function(a){this.isActive=!0,this.isChecked=!0,a||this._stateManager.invokeActiveState(),this.setProperty("ischecked",!0)},ButtonBinding.prototype.uncheck=function(a){(this.isCheckButton||this.isRadioButton)&&this.isChecked&&(1!=this.isAttached||this.isDisposed?this.setProperty("ischecked",!1):(this._uncheck(),1==!a&&this.fireCommand()))},ButtonBinding.prototype._uncheck=function(a){this.isActive=!1,this.isChecked=!1,a||this._stateManager.invokeNormalState(),this.setProperty("ischecked",!1)},ButtonBinding.prototype.setChecked=function(a,b){if(this.isCheckButton||this.isRadioButton)switch(a){case!0:this.check(b);break;case!1:this.uncheck(b)}},ButtonBinding.prototype.setDisabled=function(a){switch(null==a&&(a=!1),this.isDisabled=a,a){case!0:this.bindingElement.setAttribute("title",""),this.setProperty("isdisabled",!0),null!=this._stateManager&&this._stateManager.invokeDisabledState();break;case!1:this.deleteProperty("isdisabled");var b=this.getProperty("tooltip");b&&this.setToolTip(b),null!=this._stateManager&&this._stateManager.invokeNormalState()}1==this._isFocusableButton&&(this.isFocusable=!this.isDisabled,this.dispatchAction(FocusBinding.ACTION_UPDATE))},ButtonBinding.prototype.disable=function(){this.setDisabled(!0)},ButtonBinding.prototype.enable=function(){this.setDisabled(!1)},ButtonBinding.prototype.focus=function(){this.isFocusable&&!this.isFocused&&(this.isFocused=!0,FocusBinding.focusElement(this.bindingElement),this.dispatchAction(Binding.ACTION_FOCUSED))},ButtonBinding.prototype.blur=function(){this.isFocusable&&this.isFocused&&(this.isFocused=!1,this.dispatchAction(Binding.ACTION_BLURRED))},ButtonBinding.prototype.onMouseDown=function(){EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,this),this.dispatchAction(Binding.ACTION_ACTIVATED)},ButtonBinding.prototype.onMouseUp=function(){EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,this)},ButtonBinding.prototype.getEqualSizeWidth=function(){var a=null;if(1!=this.isAttached)throw"ButtonBinding: getEqualSizeWidth failed for non-attached button.";return this.labelBinding.shadowTree.labelBody.style.marginLeft="0",this.labelBinding.shadowTree.labelBody.style.marginRight="0",a=this.labelBinding.bindingElement.offsetWidth,a},ButtonBinding.prototype.setEqualSizeWidth=function(a){if(1==this.isAttached){var b=this.getEqualSizeWidth();if(a>b){var c=a-b,d=Math.floor(.5*c);this.labelBinding.shadowTree.labelBody.style.setProperty("margin-left",d+"px","important"),this.labelBinding.shadowTree.labelBody.style.setProperty("margin-right",d+"px","important")}}},ButtonBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},ButtonBinding.prototype.setWidth=function(a){a>=0&&(this.bindingElement.style.width=new String(a+"px")),this.setProperty("width",a)},ButtonBinding.prototype.validate=function(){return!0},ButtonBinding.prototype.manifest=function(){},ButtonBinding.prototype.dirty=DataBinding.prototype.dirty,ButtonBinding.prototype.clean=DataBinding.prototype.clean,ButtonBinding.prototype.getName=function(){},ButtonBinding.prototype.getValue=function(){return this.shadowTree.dotnetinput.value},ButtonBinding.prototype.setValue=function(a){this.shadowTree.dotnetinput.value=a},ButtonBinding.prototype.getResult=function(){return this.getValue()},ButtonBinding.prototype.setResult=function(a){this.setValue(a)},ButtonStateManager.STATE_NORMAL=0,ButtonStateManager.STATE_HOVER=1,ButtonStateManager.STATE_ACTIVE=2,ButtonStateManager.RIGHT_BUTTON=2,ButtonStateManager.prototype.assignDOMEvents=function(a){var b=a?"addEventListener":"removeEventListener";this.binding[b](DOMEvents.MOUSEENTER,this),this.binding[b](DOMEvents.MOUSELEAVE,this),this.binding[b](DOMEvents.MOUSEDOWN,this),this.binding[b](DOMEvents.MOUSEUP,this)},ButtonStateManager.prototype.dispose=function(){this.assignDOMEvents(!1),this.binding=null,this.imageProfile=null},ButtonStateManager.prototype.handleEvent=function(a){if(Binding.exists(this.binding)&&!this.binding.isDisabled&&!BindingDragger.isDragging){var b=!1,c=!1,d=null;if(a.button==ButtonStateManager.RIGHT_BUTTON);else if(this.binding.isCheckBox)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSEUP:this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),b=!0}else if(this.binding.isComboButton)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:d=ButtonStateManager.STATE_NORMAL;var e=UserInterface.getBinding(a.target?a.target:a.srcElement);e instanceof ComboBoxBinding?(this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),c=!0):(this.binding.isChecked&&this.binding._uncheck(!0),d=ButtonStateManager.STATE_NORMAL,b=!0)}else if(this.binding.isCheckButton||this.binding.isRadioButton)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this.binding.isChecked||(d=ButtonStateManager.STATE_HOVER);break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this.binding.isChecked||(d=ButtonStateManager.STATE_NORMAL);break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:(this.binding.isCheckButton||!this.binding.isChecked)&&(this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),b=!0)}else switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:d=ButtonStateManager.STATE_NORMAL,b=!0}switch(d){case ButtonStateManager.STATE_NORMAL:this.invokeNormalState();break;case ButtonStateManager.STATE_HOVER:this.invokeHoverState();break;case ButtonStateManager.STATE_ACTIVE:this.invokeActiveState()}if(b&&this.binding.fireCommand(),c&&this.binding.invokePopup(),1==Binding.exists(this.binding))switch(DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEDOWN:this.binding.onMouseDown();break;case DOMEvents.MOUSEUP:this.binding.onMouseUp()}}},ButtonStateManager.prototype.invokeNormalState=function(){this.binding.detachClassName("hover"),this.binding.detachClassName("active"),this.binding.detachClassName("isdisabled")},ButtonStateManager.prototype.invokeHoverState=function(){this.binding.attachClassName("hover"),this.binding.detachClassName("active")},ButtonStateManager.prototype.invokeActiveState=function(){this.binding.attachClassName("active"),this.binding.detachClassName("hover")},ButtonStateManager.prototype.invokeDisabledState=function(){this.binding.detachClassName("hover"),this.binding.detachClassName("active"),this.binding.attachClassName("isdisabled")},ClickButtonBinding.prototype=new ButtonBinding,ClickButtonBinding.prototype.constructor=ClickButtonBinding,ClickButtonBinding.superclass=ButtonBinding.prototype,ClickButtonBinding.prototype.toString=function(){return"[ClickButtonBinding]"},ClickButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:clickbutton",a);return UserInterface.registerBinding(b,ClickButtonBinding)},RadioButtonBinding.prototype=new ButtonBinding,RadioButtonBinding.prototype.constructor=RadioButtonBinding,RadioButtonBinding.superclass=ButtonBinding.prototype,RadioButtonBinding.prototype.toString=function(){return"[RadioButtonBinding]"},RadioButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:radiobutton",a);return UserInterface.registerBinding(b,RadioButtonBinding)},CheckButtonBinding.prototype=new ButtonBinding,CheckButtonBinding.prototype.constructor=CheckButtonBinding,CheckButtonBinding.superclass=ButtonBinding.prototype,CheckButtonBinding.prototype.toString=function(){return"[CheckButtonBinding]"},CheckButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkbutton",a);return UserInterface.registerBinding(b,CheckButtonBinding)},ViewButtonBinding.prototype=new ButtonBinding,ViewButtonBinding.prototype.constructor=ViewButtonBinding,ViewButtonBinding.superclass=ButtonBinding.prototype,ViewButtonBinding.prototype.toString=function(){return"[ViewButtonBinding]"},ViewButtonBinding.prototype.oncommand=function(){alert(this)},ControlGroupBinding.prototype=new Binding,ControlGroupBinding.prototype.constructor=ControlGroupBinding,ControlGroupBinding.superclass=Binding.prototype,ControlGroupBinding.prototype.toString=function(){return"[ControlGroupBinding]"},ControlGroupBinding.prototype.onBindingAttach=function(){ControlGroupBinding.superclass.onBindingAttach.call(this),this.assignDOMEvents()},ControlGroupBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP)},ControlGroupBinding.prototype.onActivate=function(){var a=this.getDescendantBindingsByLocalName("control");a.each(function(a){a.setControlType(a.controlType)})},ControlGroupBinding.prototype.onDeactivate=ControlGroupBinding.prototype.onActivate,ControlGroupBinding.prototype.handleEvent=function(a){switch(ControlGroupBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEDOWN:EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),this.dispatchAction(Binding.ACTION_ACTIVATED);break;case DOMEvents.MOUSEUP:EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,a)}},ControlGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:controlgroup",a);return UserInterface.registerBinding(b,ControlGroupBinding)},ControlBinding.prototype=new ButtonBinding,ControlBinding.prototype.constructor=ControlBinding,ControlBinding.superclass=ButtonBinding.prototype,ControlBinding.ACTION_COMMAND="controlcommand",ControlBinding.TYPE_MINIMIZE="minimize",ControlBinding.TYPE_MAXIMIZE="maximize",ControlBinding.TYPE_UNMAXIMIZE="unmaximize",ControlBinding.TYPE_UNMINIMIZE="unminimize",ControlBinding.TYPE_CLOSE="close",ControlBinding.TOOLTIP={minimize:"${string:Website.App.ToolTipMinimize}",maximize:"${string:Website.App.ToolTipMaximize}",unmaximize:"${string:Website.App.ToolTipUnMaximize}",unminimize:"${string:Website.App.ToolTipUnMinimize}",close:"${string:Website.App.ToolTipClose}"},ControlBinding.prototype.toString=function(){return"[ControlBinding]"},ControlBinding.prototype.onBindingAttach=function(){if(this.controlType=this.getProperty("controltype"),this.setProperty("tooltip",ControlBinding.TOOLTIP[this.controlType]),!this.isAttached){if(!this.controlType)throw"ControlBinding: type not specified.";this.containingControlBoxBinding=this.getAncestorBindingByType(ControlBoxBinding),this.containingControlBoxBinding&&this.containingControlBoxBinding.addActionListener(ControlBoxBinding.ACTION_STATECHANGE,this),ControlBinding.superclass.onBindingAttach.call(this),this.addEventListener(DOMEvents.MOUSEDOWN)}},ControlBinding.prototype.handleEvent=function(a){switch(ControlBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.MOUSEDOWN:DOMEvents.stopPropagation(a)}},ControlBinding.prototype.setControlType=function(a){this.controlType=a,this.setProperty("controltype",a),this.setToolTip(ControlBinding.TOOLTIP[a])},ControlBinding.prototype.handleAction=function(a){switch(ControlBinding.superclass.handleAction.call(this,a),a.type){case ControlBoxBinding.ACTION_STATECHANGE:this._handleStateChange()}},ControlBinding.prototype._handleStateChange=function(){switch(this.containingControlBoxBinding.getState()){case ControlBoxBinding.STATE_MAXIMIZED:this.controlType==ControlBinding.TYPE_MAXIMIZE&&this.setControlType(ControlBinding.TYPE_UNMAXIMIZE),this.controlType==ControlBinding.TYPE_UNMINIMIZE&&this.setControlType(ControlBinding.TYPE_MINIMIZE);break;case ControlBoxBinding.STATE_MINIMIZED:this.controlType==ControlBinding.TYPE_MINIMIZE&&this.setControlType(ControlBinding.TYPE_UNMINIMIZE),this.controlType==ControlBinding.TYPE_UNMAXIMIZE&&this.setControlType(ControlBinding.TYPE_MAXIMIZE);break;case ControlBoxBinding.STATE_NORMAL:this.controlType==ControlBinding.TYPE_UNMAXIMIZE&&this.setControlType(ControlBinding.TYPE_MAXIMIZE),this.controlType==ControlBinding.TYPE_UNMINIMIZE&&this.setControlType(ControlBinding.TYPE_MINIMIZE)}},ControlBinding.prototype.onMouseDown=function(){},ControlBinding.prototype.onMouseUp=function(){},ControlBoxBinding.prototype=new FlexBoxBinding,ControlBoxBinding.prototype.constructor=ControlBoxBinding,ControlBoxBinding.superclass=FlexBoxBinding.prototype,ControlBoxBinding.STATE_NORMAL="normal",ControlBoxBinding.STATE_MAXIMIZED="maximized",ControlBoxBinding.STATE_MINIMIZED="minimized",ControlBoxBinding.ACTION_NORMALIZE="controlbox normalizeaction",ControlBoxBinding.ACTION_MAXIMIZE="controlbox maximizeaction",ControlBoxBinding.ACTION_MINIMIZE="controlbox minimizeaction",ControlBoxBinding.ACTION_STATECHANGE="controlbox statechangeacton",ControlBoxBinding.prototype.toString=function(){return"[ControlBoxBinding]"},ControlBoxBinding.prototype.onBindingAttach=function(){ControlBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(ControlBinding.ACTION_COMMAND,this),this.attachClassName(ControlBoxBinding.STATE_NORMAL)},ControlBoxBinding.prototype.handleAction=function(a){switch(ControlBoxBinding.superclass.handleAction.call(this,a),a.type){case ControlBinding.ACTION_COMMAND:var b=a.target;Application.lock(this);var c=this;setTimeout(function(){c.handleInvokedControl(b),Application.unlock(c)},0),a.consume()}},ControlBoxBinding.prototype.handleInvokedControl=function(a){switch(a.controlType){case ControlBinding.TYPE_MAXIMIZE:this.maximize();break;case ControlBinding.TYPE_MINIMIZE:this.minimize();break;case ControlBinding.TYPE_UNMAXIMIZE:case ControlBinding.TYPE_UNMINIMIZE:this.normalize()}},ControlBoxBinding.prototype.maximize=function(){this.dispatchAction(ControlBoxBinding.ACTION_MAXIMIZE),this.setState(ControlBoxBinding.STATE_MAXIMIZED),this.isNormalized=!1,this.isMaximized=!0,this.isMinimized=!1},ControlBoxBinding.prototype.minimize=function(){this.dispatchAction(ControlBoxBinding.ACTION_MINIMIZE),this.setState(ControlBoxBinding.STATE_MINIMIZED),this.isNormalized=!1,this.isMaximized=!1,this.isMinimized=!0},ControlBoxBinding.prototype.normalize=function(){this.dispatchAction(ControlBoxBinding.ACTION_NORMALIZE),this.setState(ControlBoxBinding.STATE_NORMAL),this.isNormalized=!0,this.isMaximized=!1,this.isMinimized=!1},ControlBoxBinding.prototype.setState=function(a){var b=this.getState();this.setProperty("state",a),this.detachClassName(b),this.attachClassName(a),this.dispatchAction(ControlBoxBinding.ACTION_STATECHANGE)},ControlBoxBinding.prototype.getState=function(){var a=this.getProperty("state");return a||(a=ControlBoxBinding.STATE_NORMAL),a},MenuContainerBinding.prototype=new Binding,MenuContainerBinding.prototype.constructor=MenuContainerBinding,MenuContainerBinding.superclass=Binding.prototype,MenuContainerBinding.prototype.toString=function(){return"[MenuContainerBinding]"},MenuContainerBinding.prototype.isOpen=function(a){var b=null;return b=a?a==this._openElement:this._isOpen},MenuContainerBinding.prototype.setOpenElement=function(a){a?(this._openElement&&this._openElement.hide(),this._openElement=a,this._isOpen=!0):(this._openElement=null,this._isOpen=!1)},MenuContainerBinding.prototype.getMenuContainerBinding=function(){return this.menuContainerBinding||(this.menuContainerBinding=this.getAncestorBindingByType(MenuContainerBinding)),this.menuContainerBinding},MenuContainerBinding.prototype.getMenuPopupBinding=function(){var a=this.getChildBindingByLocalName("menupopup");return a&&a!=this.menuPopupBinding&&(this.menuPopupBinding=a,this.menuPopupBinding.addActionListener(PopupBinding.ACTION_HIDE,this)),this.menuPopupBinding},MenuContainerBinding.prototype.show=function(){var a=this.getMenuContainerBinding();a.setOpenElement(this);var b=this.getMenuPopupBinding();b.snapTo(this.bindingElement),b.show()},MenuContainerBinding.prototype.hide=function(){this.reset(),this.getMenuPopupBinding().hide(),this._isOpen&&this._openElement.hide()},MenuContainerBinding.prototype.reset=Binding.ABSTRACT_METHOD,MenuContainerBinding.prototype.handleAction=function(a){if(MenuContainerBinding.superclass.handleAction.call(this,a),a.type==PopupBinding.ACTION_HIDE){var b=this.getMenuContainerBinding();b.setOpenElement(!1),this.reset(),a.consume()}},MenuBarBinding.prototype=new MenuContainerBinding,MenuBarBinding.prototype.constructor=MenuBarBinding,MenuBarBinding.superclass=MenuContainerBinding.prototype,MenuBarBinding.prototype.toString=function(){return"[MenuBarBinding]"},MenuBarBinding.prototype.onBindingRegister=function(){MenuBarBinding.superclass.onBindingRegister.call(this),this.addActionListener(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},MenuBarBinding.prototype.handleAction=function(a){switch(MenuBarBinding.superclass.handleAction.call(this,a),a.type){case MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY:for(var b=a.target,c=this.getChildBindingsByLocalName("menu");c.hasNext();){c.getNext()}switch(b.arrowKey){case KeyEventCodes.VK_LEFT:this.logger.debug("LEFTG");break;case KeyEventCodes.VK_RIGHT:this.logger.debug("RIGHT")}}},MenuBinding.prototype=new MenuContainerBinding,MenuBinding.prototype.constructor=MenuBinding,MenuBinding.superclass=MenuContainerBinding.prototype,MenuBinding.prototype.toString=function(){return"[MenuBinding]"},MenuBinding.prototype.onBindingAttach=function(){MenuBinding.superclass.onBindingAttach.call(this),this.buildDOMContent(),this.assignDOMEvents()},MenuBinding.prototype.buildDOMContent=function(){var a=this.getProperty("image"),b=this.getProperty("label"),c=this.getProperty("tooltip");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.attachClassName("menulabel"),this.add(this.labelBinding),b&&this.setLabel(b),a&&this.setImage(a),c&&this.setToolTip(c)},MenuBinding.prototype.reset=function(){this.detachClassName("hover")},MenuBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},MenuBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(Resolver.resolve(a))},MenuBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(Resolver.resolve(a))},MenuBinding.prototype.getImage=function(){return this.getProperty("image")},MenuBinding.prototype.getLabel=function(){return this.getProperty("label")},MenuBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},MenuBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT),this.addEventListener(DOMEvents.MOUSEUP)},MenuBinding.prototype.handleEvent=function(a){MenuBinding.superclass.handleEvent.call(this,a);var b=this.getMenuContainerBinding();if(!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEDOWN:b.isOpen(this)&&DOMEvents.stopPropagation(a);break;case DOMEvents.MOUSEOVER:b.isOpen()&&!b.isOpen(this)&&(this.show(),this.menuPopupBinding.grabKeyboard()),this.attachClassName("hover"),this.isFocused=!0;break;case DOMEvents.MOUSEOUT:b.isOpen()||this.hide(),this.isFocused=!1;break;case DOMEvents.MOUSEUP:b.isOpen(this)||(this.show(),this.menuPopupBinding.grabKeyboard()),DOMEvents.stopPropagation(a)}DOMEvents.stopPropagation(a)},MenuBodyBinding.prototype=new Binding,MenuBodyBinding.prototype.constructor=MenuBodyBinding,MenuBodyBinding.superclass=Binding.prototype,MenuBodyBinding.CLASSNAME_CHECKBOXED="checkboxed",MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY="menubody unhandled arrowkey",MenuBodyBinding.activeInstance=null,MenuBodyBinding.handleBroadcast=function(a,b){var c=MenuBodyBinding.activeInstance,d=b;if(c)switch(a){case BroadcastMessages.KEY_ARROW:c.handleArrowKey(d);break;case BroadcastMessages.KEY_ENTER:c.handleEnterKey()}},EventBroadcaster.subscribe(BroadcastMessages.KEY_ARROW,MenuBodyBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ENTER,MenuBodyBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,MenuBodyBinding),MenuBodyBinding.prototype.toString=function(){return"[MenuBodyBinding]"},MenuBodyBinding.prototype.onBindingAttach=function(){MenuBodyBinding.superclass.onBindingAttach.call(this),this._focused={},this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT),this.addEventListener(DOMEvents.MOUSEUP),this.addEventListener(DOMEvents.KEYDOWN),this.addEventListener(DOMEvents.TOUCHSTART);var a=this;this.addActionListener(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY,{handleAction:function(b){switch(b.target){case a:a.releaseKeyboard(),a._containingPopupBinding.hide();break;default:;a._lastFocused.focus(),a.grabKeyboard(),b.consume()}}}),this._containingPopupBinding=UserInterface.getBinding(this.bindingElement.parentNode),this._containingPopupBinding.addActionListener(PopupBinding.ACTION_HIDE,{handleAction:function(){a.resetFocusedItems(!0),a.releaseKeyboard()}})},MenuBodyBinding.prototype.onBindingDispose=function(){MenuBodyBinding.superclass.onBindingDispose.call(this),MenuBodyBinding.activeInstance==this&&(MenuBodyBinding.activeInstance=null)},MenuBodyBinding.prototype.handleEvent=function(a){switch(MenuBodyBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.MOUSEOUT&&this.resetFocusedItems(),a.type){case DOMEvents.MOUSEDOWN:case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:case DOMEvents.MOUSEUP:case DOMEvents.TOUCHSTART:DOMEvents.stopPropagation(a);break;case DOMEvents.KEYDOWN:switch(a.keyCode){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:case KeyEventCodes.VK_LEFT:case KeyEventCodes.VK_RIGHT:DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a),this.handleArrowKey(a.keyCode)}}},MenuBodyBinding.prototype.handleFocusedItem=function(a){for(var b in this._focused)if(b!=a.key){var c=this._focused[b];c.blur()}this._focused[a.key]=a,this._lastFocused=a,MenuBodyBinding.activeInstance!=this&&this.grabKeyboard()},MenuBodyBinding.prototype.handleBlurredItem=function(a){delete this._focused[a.key]},MenuBodyBinding.prototype.resetFocusedItems=function(a){for(var b in this._focused){var c=this._focused[b];c.blur(a)}a&&(this._lastFocused=null)},MenuBodyBinding.prototype.refreshMenuGroups=function(){if(!this.isAttached)throw"refreshMenuGroups: MenuBodyBinding not attached!";for(var a=this.getChildBindingsByLocalName("menugroup"),b=null,c=null;a.hasNext();){var d=a.getNext();d.isDefaultContent||(d.setLayout(MenuGroupBinding.LAYOUT_DEFAULT),!b&&d.isVisible&&(b=d),d.isVisible&&(c=d))}b&&c&&(b.setLayout(MenuGroupBinding.LAYOUT_FIRST),c.setLayout(MenuGroupBinding.LAYOUT_LAST))},MenuBodyBinding.prototype.grabKeyboard=function(a){if(MenuBodyBinding.activeInstance=this,a){var b=this._getMenuItems().getFirst();b&&b.focus()}},MenuBodyBinding.prototype.releaseKeyboard=function(){MenuBodyBinding.activeInstance==this&&(MenuBodyBinding.activeInstance=null)},MenuBodyBinding.prototype.handleEnterKey=function(){var a=this._lastFocused;null==a||a.isMenuContainer||(a.fireCommand(),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN))},MenuBodyBinding.prototype.handleArrowKey=function(a){this.arrowKey=a;var b=this._getMenuItems(),c=null,d=null;if(this._lastFocused)switch(c=this._lastFocused,a){case KeyEventCodes.VK_UP:d=b.getPreceding(c);break;case KeyEventCodes.VK_DOWN:d=b.getFollowing(c);break;case KeyEventCodes.VK_LEFT:this.dispatchAction(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY);break;case KeyEventCodes.VK_RIGHT:this._lastFocused.isMenuContainer?(this.releaseKeyboard(),this._lastFocused.show(),this._lastFocused.menuPopupBinding.grabKeyboard(!0)):this.dispatchAction(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY)}else d=b.getFirst();d&&d.focus()},MenuBodyBinding.prototype._getMenuItems=function(){if(!this._menuItemsList||this.isDirty){var a=new List,b=null;this.getChildBindingsByLocalName("menugroup").each(function(c){b=c.getChildBindingsByLocalName("menuitem"),b.each(function(b){a.add(b)})}),b=this.getChildBindingsByLocalName("menuitem"),b.each(function(b){a.add(b)}),this._menuItemsList=a,this.isDirty=!1}return this._menuItemsList},MenuBodyBinding.prototype.invokeCheckBoxLayout=function(){this.hasClassName(MenuBodyBinding.CLASSNAME_CHECKBOXED)||this.attachClassName(MenuBodyBinding.CLASSNAME_CHECKBOXED)},MenuBodyBinding.prototype.invokeImageLayout=function(){this._hasImageLayout||(this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._hasImageLayout=!0)},MenuBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menubody",a);return UserInterface.registerBinding(b,MenuBodyBinding)},MenuGroupBinding.prototype=new Binding,MenuGroupBinding.prototype.constructor=MenuGroupBinding,MenuGroupBinding.superclass=Binding.prototype,MenuGroupBinding.LAYOUT_DEFAULT=0,MenuGroupBinding.LAYOUT_FIRST=1,MenuGroupBinding.LAYOUT_LAST=2,MenuGroupBinding.prototype.toString=function(){return"[MenuGroupBinding]"},MenuGroupBinding.prototype.setLayout=function(a){switch(a){case MenuGroupBinding.LAYOUT_DEFAULT:this.detachClassName("first"),this.detachClassName("last");break;case MenuGroupBinding.LAYOUT_FIRST:this.attachClassName("first");break;case MenuGroupBinding.LAYOUT_LAST:this.attachClassName("last")}},MenuGroupBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.display="block",this.bindingElement.style.visibility="visible",this.isVisible=!0)},MenuGroupBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.display="none",this.bindingElement.style.visibility="hidden",this.isVisible=!1)},MenuGroupBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},MenuGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menugroup",a);return UserInterface.registerBinding(b,MenuGroupBinding)},MenuItemBinding.prototype=new MenuContainerBinding,MenuItemBinding.prototype.constructor=MenuItemBinding,MenuItemBinding.superclass=MenuContainerBinding.prototype,MenuItemBinding.ACTION_COMMAND="menuitemcommand",MenuItemBinding.TYPE_CHECKBOX="checkbox",MenuItemBinding.TYPE_MENUCONTAINER="menucontainer",MenuItemBinding.CLASSNAME_CHECKBOX="checkboxindicator",MenuItemBinding.CLASSNAME_HOVER="hover",MenuItemBinding.CHAR_CHECKBOX="V",MenuItemBinding.TIMEOUT=150,MenuItemBinding.prototype.toString=function(){return"[MenuItemBinding]"},MenuItemBinding.prototype.onBindingRegister=function(){MenuItemBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled,this.type&&this.setProperty("type",this.type)},MenuItemBinding.prototype.onBindingAttach=function(){MenuItemBinding.superclass.onBindingAttach.call(this),this._containingMenuBodyBinding=this.getAncestorBindingByLocalName("menubody"),this._containingMenuBodyBinding.isDirty=!0,this.parseDOMProperties(),this.buildDOMContent(),this.assignDOMEvents(),this.dispatchAction(Binding.ACTION_ATTACHED)},MenuItemBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("image"),b=this.getProperty("image-hover"),c=this.getProperty("image-active"),d=this.getProperty("image-disabled");!this.image&&a&&(this.image=a),!this.imageHover&&b&&(this.imageHover=a),!this.imageActive&&c&&(this.imageActive=c),!this.imageDisabled&&d&&(this.imageDisabled=d)},MenuItemBinding.prototype.buildDOMContent=function(){var a=this.getProperty("label"),b=this.getProperty("tooltip"),c=this.getProperty("type"),d=this.getProperty("isdisabled"),e=this.getProperty("image"),f=this.getProperty("image-hover"),g=this.getProperty("image-active"),h=this.getProperty("image-disabled"),i=this.getProperty("hasaction");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.attachClassName("menuitemlabel"),this.add(this.labelBinding);var j=this.getMenuPopupBinding();j&&(this.isMenuContainer=!0,this.setType(MenuItemBinding.TYPE_MENUCONTAINER),this.hasAction=i===!0),this.imageProfile||(!this.image&&e&&(this.image=e),!this.imageHover&&f&&(this.imageHover=e),!this.imageActive&&g&&(this.imageActive=g),!this.imageDisabled&&h&&(this.imageDisabled=h),(this.image||this.imageHover||this.imageActive||this.imageDisabled)&&(this.imageProfile=new ImageProfile(this))),this.imageProfile?this.setImage(this.imageProfile.getDefaultImage()):this.setImage(null),null!=a&&this.setLabel(a),b&&this.setToolTip(b),c&&this.setType(c),this.type==MenuItemBinding.TYPE_CHECKBOX&&1==this.getProperty("ischecked")&&this.check(!0),1==d&&this.disable();var k=this.getProperty("oncommand");k&&(this.oncommand=function(){this.bindingWindow.eval(k)})},MenuItemBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEUP)},MenuItemBinding.prototype.handleEvent=function(a){if(MenuItemBinding.superclass.handleEvent.call(this,a),!this.isDisabled&&!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEOVER:this.focus(a);break;case DOMEvents.MOUSEUP:DOMEvents.stopPropagation(a),this.hasAction&&(this.type==MenuItemBinding.TYPE_CHECKBOX?this.setChecked(!this.isChecked):this.fireCommand(),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,this),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))}},MenuItemBinding.prototype.fireCommand=function(){this.hasAction&&(this.oncommand&&this.oncommand(),this.dispatchAction(MenuItemBinding.ACTION_COMMAND))},MenuItemBinding.prototype.setImage=function(a){a=a?a:LabelBinding.DEFAULT_IMAGE,this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},MenuItemBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(Resolver.resolve(a))},MenuItemBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(Resolver.resolve(a))},MenuItemBinding.prototype.reset=function(){this.labelBinding.hasClassName("hover")&&this.labelBinding.detachClassName("hover")},MenuItemBinding.prototype.setType=function(a){if(this.isAttached){if(this.isTypeSet)throw new Error("MenuItemBinding: Cannot set type twice.");switch(a){case MenuItemBinding.TYPE_CHECKBOX:if(!this.hasAction)throw new Error("MenuItemBinding: checkboxes cannot contain menus");this._containingMenuBodyBinding.invokeCheckBoxLayout();var b=this.bindingDocument.createElement("div");b.className=MenuItemBinding.CLASSNAME_CHECKBOX,b.appendChild(this.bindingDocument.createTextNode(MenuItemBinding.CHAR_CHECKBOX));var c=this.labelBinding.bindingElement;c.insertBefore(b,c.firstChild),b.style.display="none",this.shadowTree.checkBoxIndicator=b;break;
case MenuItemBinding.TYPE_MENUCONTAINER:}this.type=a,this.isTypeSet=!0}this.setProperty("type",a)},MenuItemBinding.prototype.getImage=function(){return this.getProperty("image")},MenuItemBinding.prototype.getLabel=function(){return this.getProperty("label")},MenuItemBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},MenuItemBinding.prototype.disable=function(){this.setDisabled(!0)},MenuItemBinding.prototype.enable=function(){this.setDisabled(!1)},MenuItemBinding.prototype.setDisabled=function(a){if(this.isDisabled=a,this.isDisabled?this.setProperty("isdisabled",!0):this.deleteProperty("isdisabled"),this.isAttached)if(this.isDisabled){if(this.labelBinding.detachClassName("hover"),this.attachClassName("isdisabled"),this.imageProfile){var b=this.imageProfile.getDisabledImage();b&&this.setImage(b)}}else if(this.detachClassName("isdisabled"),this.imageProfile){var b=this.imageProfile.getDefaultImage();b&&this.setImage(b)}},MenuItemBinding.prototype.focus=function(a){this.labelBinding.attachClassName(MenuItemBinding.CLASSNAME_HOVER);var b=this.getMenuContainerBinding();if(b.isOpen()&&!b.isOpen(this)&&(b._openElement.hide(),b.setOpenElement(!1)),this.isMenuContainer&&a&&a.type==DOMEvents.MOUSEOVER){var b=this.getMenuContainerBinding();if(!b.isOpen(this)){var c=this;this._showSubMenuTimeout=window.setTimeout(function(){c.show(),c._showSubMenuTimeout=null},MenuItemBinding.TIMEOUT)}}if((!a||a.type!=DOMEvents.MOUSEOVER)&&-1!=this.bindingElement.tabIndex)if(Client.isMozilla)FocusBinding.focusElement(this.bindingElement);else{var c=this;setTimeout(function(){FocusBinding.focusElement(c.bindingElement)},0)}this.isFocused=!0,this._containingMenuBodyBinding.handleFocusedItem(this)},MenuItemBinding.prototype.blur=function(a){if(this._showSubMenuTimeout&&(window.clearTimeout(this._showSubMenuTimeout),this._showSubMenuTimeout=null),this.isFocused){var b=this.getMenuContainerBinding();b&&b.isOpen(this)&&!a||(this.labelBinding.detachClassName(MenuItemBinding.CLASSNAME_HOVER),this.isFocused=!1,this._containingMenuBodyBinding.handleBlurredItem(this))}},MenuItemBinding.prototype.check=function(a){this.setChecked(!0,a)},MenuItemBinding.prototype.uncheck=function(a){this.setChecked(!1,a)},MenuItemBinding.prototype.show=function(){this.menuPopupBinding.position=PopupBinding.POSITION_RIGHT,MenuItemBinding.superclass.show.call(this)},MenuItemBinding.prototype.setChecked=function(a,b){this.setProperty("ischecked",a),this.isAttached&&this.type==MenuItemBinding.TYPE_CHECKBOX&&this.isChecked!=a&&(this.isChecked=a,this.shadowTree.checkBoxIndicator.style.display=a?"block":"none",b||this.fireCommand())},MenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,MenuItemBinding),UserInterface.getBinding(b)},PopupSetBinding.prototype=new MenuContainerBinding,PopupSetBinding.prototype.constructor=PopupSetBinding,PopupSetBinding.superclass=MenuContainerBinding.prototype,PopupSetBinding.getPopupSet=function(a,b){var c=UserInterface.getBinding(a.body),d=null;return c.getDescendantBindingsByType(PopupSetBinding).each(function(a){return a.getProperty("rel")===b?(d=a,!1):!0}),null==d&&(d=c.addFirst(PopupSetBinding.newInstance(a)),d.setProperty("rel",b),d.attach()),d},PopupSetBinding.prototype.toString=function(){return"[PopupSetBinding]"},PopupSetBinding.prototype.onBindingAttach=function(){PopupSetBinding.superclass.onBindingAttach.call(this),"body"!==this.bindingElement.parentNode.nodeName.toLowerCase()&&this.bindingDocument.body.appendChild(this.bindingElement)},PopupSetBinding.prototype.getPopupByRel=function(a){var b=null;return this.getDescendantBindingsByType(PopupBinding).each(function(c){return c.getProperty("rel")===a?(b=c,!1):!0}),b},PopupSetBinding.prototype.createNewPopupByRel=function(a){var b=this.getPopupByRel(a);return b?b.empty():(b=this.add(PopupBinding.newInstance(this.bindingDocument)),b.add(MenuBodyBinding.newInstance(this.bindingDocument)),b.setProperty("rel",a),b.attachRecursive()),b},PopupSetBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupset",a);return UserInterface.registerBinding(b,PopupSetBinding)},PopupBinding.prototype=new Binding,PopupBinding.prototype.constructor=PopupBinding,PopupBinding.superclass=Binding.prototype,PopupBinding.ACTION_SHOW="popupshow",PopupBinding.ACTION_HIDE="popuphide",PopupBinding.POSITION_TOP="top",PopupBinding.POSITION_RIGHT="right",PopupBinding.POSITION_BOTTOM="bottom",PopupBinding.POSITION_LEFT="left",PopupBinding.TYPE_NORMAL="normal",PopupBinding.TYPE_FIXED="fixed",PopupBinding.FIXED_MAX=12,PopupBinding.CLASSNAME_OVERFLOW="overflow",PopupBinding.CLASSNAME_TEXTONLY="textonly",PopupBinding.activeInstances=new Map,PopupBinding.hasActiveInstances=function(){return PopupBinding.activeInstances.hasEntries()},PopupBinding.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.MOUSEEVENT_MOUSEDOWN:case BroadcastMessages.TOUCHEVENT_TOUCHSTART:if(PopupBinding.activeInstances.hasEntries()){var c=new List;PopupBinding.activeInstances.each(function(a){var d=PopupBinding.activeInstances.get(a),e=b&&b instanceof ButtonBinding&&b.popupBinding==d;e||c.add(d)}),c.each(function(a){a.hide()})}break;case BroadcastMessages.KEY_ESCAPE:PopupBinding.activeInstances.hasEntries()&&PopupBinding.activeInstances.each(function(a){var b=PopupBinding.activeInstances.get(a);b.hide()})}},EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,PopupBinding),EventBroadcaster.subscribe(BroadcastMessages.TOUCHEVENT_TOUCHSTART,PopupBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,PopupBinding),PopupBinding.prototype.toString=function(){return"[PopupBinding]"},PopupBinding.prototype.onBindingAttach=function(){PopupBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_ATTACHED),this.geometry={x:0,y:0,w:0,h:0},this.buildDOMContent(),this.parseDOMProperties(),this.assignDOMEvents()},PopupBinding.prototype.onBindingDispose=function(){PopupBinding.superclass.onBindingDispose.call(this),PopupBinding.activeInstances.has(this.key)&&PopupBinding.activeInstances.del(this.key)},PopupBinding.prototype.buildDOMContent=function(){var a=DOMUtil.getElementsByTagName(this.bindingElement,"menubody").item(0),b=DOMUtil.getElementsByTagName(this.bindingElement,"popupbody").item(0);if(a)this._bodyBinding=UserInterface.getBinding(a);else if(b)this._bodyBinding=UserInterface.getBinding(b);else{if(this.bindingElement.childElementCount>0)throw new Error(this+": DOM structure invalid.");this._bodyBinding=this.add(MenuBodyBinding.newInstance(this.bindingDocument)).attach()}},PopupBinding.prototype.parseDOMProperties=function(){if(!this.position){var a=this.getProperty("position");this.position=a?a:PopupBinding.POSITION_BOTTOM}},PopupBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP)},PopupBinding.prototype.add=function(a){var b=null;return this._bodyBinding?(this._bodyBinding.add(a),b=a):b=PopupBinding.superclass.add.call(this,a),b},PopupBinding.prototype.addFirst=function(a){var b=null;return this._bodyBinding?(this._bodyBinding.addFirst(a),b=a):b=PopupBinding.superclass.addFirst.call(this,a),b},PopupBinding.prototype.handleAction=function(a){PopupBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ATTACHED:b instanceof MenuItemBinding&&(this._count(!0),a.consume());break;case Binding.ACTION_DETACHED:b instanceof MenuItemBinding&&(this._count(!1),a.consume())}},PopupBinding.prototype._count=function(a){this.type==PopupBinding.TYPE_FIXED&&(this._menuItemCount=this._menuItemCount+(a?1:-1),this._isOverflow?this._menuItemCount<PopupBinding.FIXED_MAX&&(this.bindingElement.style.height="auto",this.detachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!1):this._menuItemCount>=PopupBinding.FIXED_MAX&&(this.bindingElement.style.height="",this.attachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!0))},PopupBinding.prototype.snapTo=function(a){var b=this._getElementPosition(a);switch(this.position){case PopupBinding.POSITION_TOP:b.y-=this.bindingElement.offsetHeight;break;case PopupBinding.POSITION_RIGHT:b.x+=a.offsetWidth;break;case PopupBinding.POSITION_BOTTOM:b.y+=a.offsetHeight;break;case PopupBinding.POSITION_LEFT:b.x-=this.bindingElement.offsetWidth}this.targetElement=a,this.bindingElement.style.display="block",this.setPosition(b.x,b.y)},PopupBinding.prototype.snapToMouse=function(a){this.snapToPoint(this._getMousePosition(a))},PopupBinding.prototype.snapToPoint=function(a){this.bindingElement.style.display="block",this.setPosition(a.x,a.y),this.show()},PopupBinding.prototype.setPosition=function(a,b){this.geometry.x=a,this.geometry.y=b,this.bindingElement.style.left=this.geometry.x+"px",this.bindingElement.style.top=this.geometry.y+"px"},PopupBinding.prototype.getPosition=function(a,b){return new Point(this.geometry.x,this.geometry.y)},PopupBinding.prototype.getDimension=function(){return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},PopupBinding.prototype._getElementPosition=function(a){return a.ownerDocument==this.bindingDocument?DOMUtil.getGlobalPosition(a):DOMUtil.getUniversalPosition(a)},PopupBinding.prototype._getMousePosition=function(a){var b=DOMEvents.getTarget(a);return b.ownerDocument==this.bindingDocument?DOMUtil.getGlobalMousePosition(a):DOMUtil.getUniversalMousePosition(a)},PopupBinding.prototype.show=function(){1==this.isVisible&&this.hide(),this.isVisible||(PopupBinding.activeInstances.set(this.key,this),this.bindingElement.style.display="block",this.dispatchAction(PopupBinding.ACTION_SHOW),this.fitOnScreen(),this._makeVisible(!0),this._bodyBinding instanceof MenuBodyBinding&&this._bodyBinding.refreshMenuGroups(),this._enableTab(!0))},PopupBinding.prototype._makeVisible=function(a){var b=this.bindingElement;a?b.style.visibility="visible":(b.style.visibility="hidden",b.style.display="none"),this.isVisible=a},PopupBinding.prototype._enableTab=function(a){var b=this,c=this.getDescendantBindingsByLocalName("menuitem");setTimeout(function(){1==Binding.exists(b)&&c.each(function(b){b.bindingElement.tabIndex=a?0:-1})},0)},PopupBinding.prototype.hide=function(){if(this.releaseKeyboard(),this.isVisible){this._makeVisible(!1),this.targetElement=null,this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED),this.dispatchAction(PopupBinding.ACTION_HIDE),this._enableTab(!1);var a=this;setTimeout(function(){a.isVisible||PopupBinding.activeInstances.del(a.key)},0)}},PopupBinding.prototype.fitOnScreen=function(){var a=this.bindingElement.offsetLeft,b=this.bindingElement.offsetTop,c=this.bindingElement.offsetWidth,d=this.bindingElement.offsetHeight,e=this.bindingWindow.WindowManager.getWindowDimensions(),f=this.boxObject.getGlobalPosition();if(null!=this.targetElement){if(f.y+d>=e.h)switch(CSSComputer.getPosition(this.bindingElement.offsetParent)){case"absolute":b=b-d-this.targetElement.offsetHeight,0>b&&(b=0);break;case"relative":b=b-d+this.targetElement.offsetHeight+9;var g=DOMUtil.getGlobalPosition(this.targetElement);b+g.y<0&&(b=-g.y)}if(f.x+c>=e.w)switch(a-=c,this.position){case PopupBinding.POSITION_RIGHT:a-=this.targetElement.offsetWidth;break;case PopupBinding.POSITION_BOTTOM:a+=this.targetElement.offsetWidth}}else f.y+d>=e.h&&(b-=d,0>b&&(b=0)),f.x+c>=e.w&&(a-=c,0>a&&(a=0));this.setPosition(a,b)},PopupBinding.prototype.handleEvent=function(a){PopupBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a)},PopupBinding.prototype.empty=function(){this._bodyBinding.detachRecursive(),this._bodyBinding.bindingElement.innerHTML=""},PopupBinding.prototype.grabKeyboard=function(a){},PopupBinding.prototype.releaseKeyboard=function(){null!=this._bodyBinding&&this._bodyBinding instanceof MenuBodyBinding&&this._bodyBinding.releaseKeyboard()},PopupBinding.prototype._indexMenuContent=function(){this._menuItems={},this._menuGroups={};for(var a=this.getDescendantBindingsByLocalName("menugroup");a.hasNext();){var b=a.getNext(),c=b.getProperty("rel");c&&(this._menuGroups[c]||(this._menuGroups[c]=new List),this._menuGroups[c].add(b))}for(a=this.getDescendantBindingsByLocalName("menuitem");a.hasNext();){var b=a.getNext(),d=b.getProperty("cmd");this._menuItems[d]=b}},PopupBinding.prototype.getMenuItemForCommand=function(a){var b=null;if(!this._menuItems)throw"Must invoke _indexMenuContent method first!";if(!this._menuItems[a])throw"PopupBinding.getMenuItemForCommand: No binding for command "+a;return b=this._menuItems[a]},PopupBinding.prototype.showTextOnly=function(){this._bodyBinding&&(this._bodyBinding.attachClassName(PopupBinding.CLASSNAME_TEXTONLY),this.hasImages=!1)},PopupBinding.prototype.showBoth=function(){this._bodyBinding&&(this._bodyBinding.detachClassName(PopupBinding.CLASSNAME_TEXTONLY),this.hasImages=!0)},PopupBinding.prototype.clear=function(){var a=this._bodyBinding;a&&(a.detachRecursive(),a.bindingElement.innerHTML=""),this.bindingElement.style.height="auto",this.detachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!1,this._menuItemCount=0},PopupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popup",a);return UserInterface.registerBinding(b,PopupBinding)},PopupBodyBinding.prototype=new Binding,PopupBodyBinding.prototype.constructor=PopupBodyBinding,PopupBodyBinding.superclass=Binding.prototype,PopupBodyBinding.prototype.toString=function(){return"[PopupBodyBinding]"},PopupBodyBinding.prototype.setDimension=function(a){this.getBindingElement().style.width=new String(a.w)+"px"},PopupBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupbody",a);return UserInterface.registerBinding(b,PopupBodyBinding)},MenuPopupBinding.prototype=new PopupBinding,MenuPopupBinding.prototype.constructor=MenuPopupBinding,MenuPopupBinding.superclass=PopupBinding.prototype,MenuPopupBinding.prototype.toString=function(){return"[MenuPopupBinding]"},MenuPopupBinding.prototype._getElementPosition=function(a){return new Point(a.offsetLeft,0)},MenuPopupBinding.prototype.fitOnScreen=function(){switch(this.position){case PopupBinding.POSITION_BOTTOM:var a=this.bindingElement.offsetLeft,b=this.bindingElement.offsetTop,c=this.bindingElement.offsetWidth,d=(this.bindingElement.offsetHeight,this.bindingWindow.WindowManager.getWindowDimensions());this.boxObject.getGlobalPosition();a=this.targetElement.offsetLeft+this.targetElement.offsetWidth/2-this.bindingElement.offsetWidth/2,this.detachClassName("bottomright"),a+c>=d.w&&(a=this.targetElement.offsetLeft+this.targetElement.offsetWidth-this.bindingElement.offsetWidth,this.attachClassName("bottomright")),this.setPosition(a,b);break;default:MenuPopupBinding.superclass.fitOnScreen.call(this)}},MenuPopupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menupopup",a);return UserInterface.registerBinding(b,MenuPopupBinding)},DialogBinding.prototype=new ControlBoxBinding,DialogBinding.prototype.constructor=DialogBinding,DialogBinding.superclass=ControlBoxBinding.prototype,DialogBinding.MODE_DRAGGING="dialogdragging",DialogBinding.MODE_RESIZING="dialogresizing",DialogBinding.ACTION_OPEN="dialogopen",DialogBinding.ACTION_CLOSE="dialogclose",DialogBinding.DEFAULT_WIDTH=540,DialogBinding.DEFAULT_HEIGHT=100,DialogBinding.prototype.toString=function(){return"[DialogBinding]"},DialogBinding.prototype.onBindingRegister=function(){DialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_DRAG,this),this.addActionListener(FocusBinding.ACTION_ACTIVATED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.buildDescendantBindings()},DialogBinding.prototype.onBindingAttach=function(){DialogBinding.superclass.onBindingAttach.call(this),this.geometry=this.computeDefaultGeometry(),this.parseDOMProperties(),this.buildControlBindings(),this.buildBorderBindings(),this.attachRecursive(),this._isResizable&&this.attachClassName("resizable"),this._hasTransitions&&(this.bindingElement.style.opacity="0"),this.setPosition(new Point(0,0)),this.setDimension(new Dimension(DialogBinding.DEFAULT_WIDTH,DialogBinding.DEFAULT_HEIGHT)),this.getProperty("open")&&this.open()},DialogBinding.prototype.buildDescendantBindings=function(){this._head=DialogHeadBinding.newInstance(this.bindingDocument),this._titlebar=DialogTitleBarBinding.newInstance(this.bindingDocument),this.addFirst(this._head),this._head.add(this._titlebar);var a=DOMUtil.getElementsByTagName(this.bindingElement,"dialogbody").item(0);a?this._body=UserInterface.getBinding(a):(this._body=DialogBodyBinding.newInstance(this.bindingDocument),this.add(this._body))},DialogBinding.prototype.buildBorderBindings=function(){for(var a=new List([DialogBorderBinding.TYPE_NORTH,DialogBorderBinding.TYPE_SOUTH,DialogBorderBinding.TYPE_EAST,DialogBorderBinding.TYPE_WEST]);a.hasNext();){var b=DialogBorderBinding.newInstance(this.bindingDocument);b.setType(a.getNext()),this.add(b)}},DialogBinding.prototype.buildControlBindings=function(){var a=this.getProperty("controls");if(a)for(var b=new List(a.split(" "));b.hasNext();){var c=b.getNext();switch(c){case ControlBinding.TYPE_MAXIMIZE:case ControlBinding.TYPE_MINIMIZE:case ControlBinding.TYPE_CLOSE:var d=DialogControlBinding.newInstance(this.bindingDocument);d.setControlType(c),this._titlebar.addControl(d),this.controlBindings[c]=d;break;default:throw new Error("DialogBinding: Control not added: "+c)}}},DialogBinding.prototype.buildDialogCoverBinding=function(){this._cover=DialogCoverBinding.newInstance(this.bindingDocument),this.getAncestorBindingByLocalName("dialogset").add(this._cover),this._cover.cover(this)},DialogBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("image"),b=this.getProperty("label"),c=this.getProperty("draggable"),d=this.getProperty("resizable"),e=this.getProperty("modal");a&&this.setImage(a),b&&this.setLabel(b),0==c&&(this.isDialogDraggable=!1),0==d&&(this.isPanelResizable=!1),1==e&&this.setModal(!0)},DialogBinding.prototype.setModal=function(a){this.isModal=a},DialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),1==this.isAttached&&this._titlebar.setLabel(Resolver.resolve(a))},DialogBinding.prototype.getLabel=function(){return this.getProperty("label")},DialogBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this._titlebar.setImage(Resolver.resolve(a))},DialogBinding.prototype.handleAction=function(a){switch(DialogBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DRAG:var b=a.target;if(this.getState()==ControlBoxBinding.STATE_NORMAL)switch(b.constructor){case DialogTitleBarBinding:this.mode=DialogBinding.MODE_DRAGGING,b.dragger.registerHandler(this);break;case DialogBorderBinding:this._isResizable&&(this.mode=DialogBinding.MODE_RESIZING,this._border=b,b.dragger.registerHandler(this))}a.consume();break;case Binding.ACTION_ACTIVATED:this.isActive||this.activate(),a.consume()}},DialogBinding.prototype.handleBroadcast=function(a,b){switch(DialogBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.startPoint=this.getPosition(),this._setComputedPosition(new Point(0,0))}},DialogBinding.prototype.handleInvokedControl=function(a){switch(DialogBinding.superclass.handleInvokedControl.call(this,a),a.controlType){case ControlBinding.TYPE_CLOSE:this.close()}},DialogBinding.prototype.open=function(a){this.isModal&&null==this._cover&&this.buildDialogCoverBinding(),this.isVisible||(this.setProperty("open","true"),this.isVisible=!0,this.isActivatable=!0,this.activate(),a||(this.centerOnScreen(),this.reflex(!0)),this.bindingElement.style.marginTop="0",this.dispatchAction(DialogBinding.ACTION_OPEN),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED),this._hasTransitions&&(this.bindingElement.style.opacity="1"))},DialogBinding.prototype.close=function(){function a(){b.dispatchAction(DialogBinding.ACTION_CLOSE),b.isVisible=!1,b.deleteProperty("open"),b.bindingElement.style.marginTop="-10000px"}if(this.isVisible){this.isActivatable=!1,this.deActivate();var b=this;if(this._hasTransitions){var c=b.bindingElement;setTimeout(function(){c.style.opacity="0",setTimeout(function(){a()},Animation.DEFAULT_TIME)},Animation.DEFAULT_TIME)}else setTimeout(function(){a()},0)}},DialogBinding.prototype.activate=function(){this.isActive||(this.isActive=!0,this.attachClassName("active"),this.moveToTop(),this._titlebar.onActivate(),Application.activate(this))},DialogBinding.prototype.deActivate=function(){1==this.isActive&&(this.isActive=!1,this.detachClassName("active"),this._titlebar.onDeactivate(),Application.deActivate(this))},DialogBinding.prototype.moveToTop=function(){this.dispatchAction(Binding.ACTION_MOVETOTOP),this.dispatchAction(Binding.ACTION_MOVEDONTOP)},DialogBinding.prototype.getZIndex=function(){return CSSComputer.getZIndex(this.bindingElement)},DialogBinding.prototype.setZIndex=function(a){this.bindingElement.style.zIndex=new String(a)},DialogBinding.prototype.onDragStart=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:case DialogBinding.MODE_RESIZING:this.startPoint=new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop),this.startDimension=new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)}},DialogBinding.prototype.onDrag=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:this._setComputedPosition(a);break;case DialogBinding.MODE_RESIZING:switch(this._border.getType()){case DialogBorderBinding.TYPE_NORTH:this.resizeNorth(a);break;case DialogBorderBinding.TYPE_SOUTH:this.resizeSouth(a);break;case DialogBorderBinding.TYPE_EAST:this.resizeEast(a);break;case DialogBorderBinding.TYPE_WEST:this.resizeWest(a)}this.reflex(!0)}},DialogBinding.prototype.onDragStop=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:this._setComputedPosition(a);break;case DialogBinding.MODE_RESIZING:}this.mode=null},DialogBinding.prototype.resizeNorth=function(a){this.setPosition(new Point(this.startPoint.x,this.startPoint.y+a.y)),this.setDimension(new Dimension(this.startDimension.w,this.startDimension.h-a.y))},DialogBinding.prototype.resizeSouth=function(a){this.setDimension(new Dimension(this.startDimension.w,this.startDimension.h+a.y))},DialogBinding.prototype.resizeEast=function(a){this.setDimension(new Dimension(this.startDimension.w+a.x,this.startDimension.h))},DialogBinding.prototype.resizeWest=function(a){this.setPosition(new Point(this.startPoint.x+a.x,this.startPoint.y)),this.setDimension(new Dimension(this.startDimension.w-a.x,this.startDimension.h))},DialogBinding.prototype._setComputedPosition=function(a){var b=this.bindingWindow.WindowManager.getWindowDimensions(),c=this.getDimension(),d=this.startPoint.x+a.x,e=this.startPoint.y+a.y;d=0>d?0:d+c.w>b.w?b.w-c.w:d,e=0>e?0:e+c.h>b.h?b.h-c.h:e,this.setPosition(new Point(d,e))},DialogBinding.prototype.setPosition=function(a){var b=a.x,c=a.y;b=Math.round(b),this.bindingElement.style.left=b+"px",this.geometry.x=b,c=Math.round(c),this.bindingElement.style.top=c+"px",this.geometry.y=c},DialogBinding.prototype.getPosition=function(){return new Point(this.geometry.x,this.geometry.y)},DialogBinding.prototype.setDimension=function(a){a||SystemDebug.stack(arguments);var b=a.w,c=a.h;b=Math.round(b),this.bindingElement.style.width=b+"px",this.geometry.w=b,c=Math.round(c),this.bindingElement.style.height=c+"px",this.geometry.h=c},DialogBinding.prototype.getDimension=function(){return new Dimension(this.geometry.w,this.geometry.h)},DialogBinding.prototype.setResizable=function(a){this._isResizable!=a&&(a?this.attachClassName("resizable"):this.detachClassName("resizable"),this._isResizable=a)},DialogBinding.prototype.computeDefaultGeometry=function(){var a=null,b=this.bindingDocument.body.offsetWidth,c=this.bindingDocument.body.offsetHeight;return a={x:.125*b,y:.125*c,w:.75*b,h:.5*c}},DialogBinding.prototype.centerOnScreen=function(){var a=this.bindingWindow.WindowManager.getWindowDimensions(),b=this.getDimension();this.setPosition(new Point(.5*(a.w-b.w),.5*(a.h-b.h)))},DialogBinding.prototype.alert=function(){function a(){c%2==0?b.detachClassName("active"):b.attachClassName("active"),c++<7&&setTimeout(a,50)}var b=this,c=0;a()},DialogBinding.prototype.setControls=function(a){for(var b in this.controlBindings)this.controlBindings[b].dispose();for(var c="";a.hasNext();){var b=a.getNext();c+=b+a.hasNext()?" ":""}this.setProperty("controls",c),this.isAttached&&this.buildControlBindings()},DialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialog",a);return UserInterface.registerBinding(b,DialogBinding)},DialogHeadBinding.prototype=new Binding,DialogHeadBinding.prototype.constructor=DialogHeadBinding,DialogHeadBinding.superclass=Binding.prototype,DialogHeadBinding.prototype.toString=function(){return"[DialogHeadBinding]"},DialogHeadBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialoghead",a);return UserInterface.registerBinding(b,DialogHeadBinding)},DialogBodyBinding.prototype=new FlexBoxBinding,DialogBodyBinding.prototype.constructor=DialogBodyBinding,DialogBodyBinding.superclass=FlexBoxBinding.prototype,DialogBodyBinding.prototype.toString=function(){return"[DialogBodyBinding]"},DialogBodyBinding.prototype.onBindingAttach=function(){DialogBodyBinding.superclass.onBindingAttach.call(this),this._dialogBinding=UserInterface.getBinding(this.bindingElement.parentNode)},DialogBodyBinding.prototype.getPosition=function(){var a=this._dialogBinding.getPosition();return new Position(a.x+this.offsetLeft+DialogBorderBinding.DIMENSION,a.y+this.offsetTop)},DialogBodyBinding.prototype.getDimension=function(){var a=this.boxObject.getDimension();return new Dimension(a.w-2*DialogBorderBinding.DIMENSION,a.h-DialogBorderBinding.DIMENSION)},DialogBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogbody",a);return UserInterface.registerBinding(b,DialogBodyBinding)},DialogSetBinding.prototype=new Binding,DialogSetBinding.prototype.constructor=DialogSetBinding,DialogSetBinding.superclass=Binding.prototype,DialogSetBinding.prototype.toString=function(){return"[DialogSetBinding]"},DialogSetBinding.prototype.onBindingAttach=function(){DialogSetBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_MOVETOTOP,this),this.addActionListener(Binding.ACTION_MOVEDONTOP,this)},DialogSetBinding.prototype.handleAction=function(a){DialogSetBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_MOVETOTOP:b instanceof DialogBinding&&this._moveToTop(b);break;case Binding.ACTION_MOVEDONTOP:a.consume()}},DialogSetBinding.prototype._moveToTop=function(a){var b=0,c=this.getChildBindingsByLocalName("dialog");c.each(function(a){var c=a.getZIndex();b=c>b?c:b}),a.setZIndex(b+2)},DialogBorderBinding.prototype=new Binding,DialogBorderBinding.prototype.constructor=DialogBorderBinding,DialogBorderBinding.superclass=Binding.prototype,DialogBorderBinding.TYPE_NORTH="n",DialogBorderBinding.TYPE_SOUTH="s",DialogBorderBinding.TYPE_EAST="e",DialogBorderBinding.TYPE_WEST="w",DialogBorderBinding.DIMENSION=4,DialogBorderBinding.prototype.toString=function(){return"[DialogBorderBinding]"},DialogBorderBinding.prototype.setType=function(a){this.attachClassName(a),this._type=a},DialogBorderBinding.prototype.getType=function(){return this._type},DialogBorderBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogborder",a);return UserInterface.registerBinding(b,DialogBorderBinding)},DialogCoverBinding.prototype=new Binding,DialogCoverBinding.prototype.constructor=DialogCoverBinding,DialogCoverBinding.superclass=Binding.prototype,DialogCoverBinding.prototype.toString=function(){return"[DialogCoverBinding]"},DialogCoverBinding.prototype.cover=function(a){this._dialogBinding=a,this._dialogBinding.addActionListener(DialogBinding.ACTION_OPEN,this),this._dialogBinding.addActionListener(DialogBinding.ACTION_CLOSE,this),this._dialogBinding.addActionListener(Binding.ACTION_MOVEDONTOP,this),this.addEventListener(DOMEvents.MOUSEDOWN)},DialogCoverBinding.prototype.handleEvent=function(a){DialogCoverBinding.superclass.handleEvent.call(this,a),this._dialogBinding.alert()},DialogCoverBinding.prototype.handleAction=function(a){DialogCoverBinding.superclass.handleAction.call(this,a);var b=a.target;if(this._dialogBinding.isModal)switch(a.type){case DialogBinding.ACTION_OPEN:this.show();break;case DialogBinding.ACTION_CLOSE:this.hide();break;case Binding.ACTION_MOVEDONTOP:b==this._dialogBinding&&(this.bindingElement.style.zIndex=new String(b.getZIndex()-1))}},DialogCoverBinding.prototype.handleBroadcast=function(a,b){switch(DialogCoverBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this._max()}},DialogCoverBinding.prototype._max=function(){var a=this.bindingWindow.WindowManager.getWindowDimensions();this.bindingElement.style.width=a.w+"px",this.bindingElement.style.height=a.h+"px"},DialogCoverBinding.prototype.show=function(){this._max();var a=this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST;this.subscribe(a),DialogCoverBinding.superclass.show.call(this)},DialogCoverBinding.prototype.hide=function(){var a=this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST;this.unsubscribe(a),DialogCoverBinding.superclass.hide.call(this)},DialogCoverBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogcover",a);return UserInterface.registerBinding(b,DialogCoverBinding)},DialogTitleBarBinding.prototype=new Binding,DialogTitleBarBinding.prototype.constructor=DialogTitleBarBinding,DialogTitleBarBinding.superclass=Binding.prototype,DialogTitleBarBinding.prototype.toString=function(){return"[DialogTitleBarBinding]"},DialogTitleBarBinding.prototype.onBindingRegister=function(){DialogTitleBarBinding.superclass.onBindingRegister.call(this),this.bodyBinding=this.add(DialogTitleBarBodyBinding.newInstance(this.bindingDocument)),this.labelBinding=this.bodyBinding.add(LabelBinding.newInstance(this.bindingDocument)),this.labelBinding.attachClassName("dialogtitle")},DialogTitleBarBinding.prototype.onBindingAttach=function(){DialogTitleBarBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image");a&&this.setImage(a);var b=this.getProperty("label");b&&this.setLabel(b)},DialogTitleBarBinding.prototype.setLabel=function(a){this.isAttached&&this.labelBinding.setLabel(a),this.setProperty("label",a)},DialogTitleBarBinding.prototype.setImage=function(a){this.labelBinding.setImage(a),this.setProperty("image",a)},DialogTitleBarBinding.prototype.addControl=function(a){this._controlGroupBinding||(this._controlGroupBinding=this.bodyBinding.addFirst(ControlGroupBinding.newInstance(this.bindingDocument))),this._controlGroupBinding.add(a)},DialogTitleBarBinding.prototype.onActivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onActivate()},DialogTitleBarBinding.prototype.onDeactivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onDeactivate()},DialogTitleBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:titlebar",a);return UserInterface.registerBinding(b,DialogTitleBarBinding)},DialogTitleBarBodyBinding.prototype=new Binding,DialogTitleBarBodyBinding.prototype.constructor=DialogTitleBarBodyBinding,DialogTitleBarBodyBinding.superclass=Binding.prototype,DialogTitleBarBodyBinding.prototype.toString=function(){return"[DialogTitleBarBodyBinding]"},DialogTitleBarBodyBinding.prototype.onBindingRegister=function(){DialogTitleBarBodyBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},DialogTitleBarBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:titlebarbody",a);return UserInterface.registerBinding(b,DialogTitleBarBodyBinding);
},DialogControlBinding.prototype=new ControlBinding,DialogControlBinding.prototype.constructor=DialogControlBinding,DialogControlBinding.superclass=ControlBinding.prototype,DialogControlBinding.CLASSNAME="dialogcontrol",DialogControlBinding.prototype.toString=function(){return"[DialogControlBinding]"},DialogControlBinding.prototype.onBindingRegister=function(){DialogControlBinding.superclass.onBindingRegister.call(this),this.attachClassName(DialogControlBinding.CLASSNAME)},DialogControlBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:control",a);return UserInterface.registerBinding(b,DialogControlBinding)},DialogTitleBarPopupBinding.prototype=new PopupBinding,DialogTitleBarPopupBinding.prototype.constructor=DialogTitleBarPopupBinding,DialogTitleBarPopupBinding.superclass=PopupBinding.prototype,DialogTitleBarPopupBinding.CMD_RESTORE="restore",DialogTitleBarPopupBinding.CMD_MINIMIZE="minimize",DialogTitleBarPopupBinding.CMD_MAXIMIZE="maximize",DialogTitleBarPopupBinding.CMD_REFRESH="refreshview",DialogTitleBarPopupBinding.CMD_CLOSE="closedialog",DialogTitleBarPopupBinding.CMD_VIEWSOURCE="viewsource",DialogTitleBarPopupBinding.CMD_VIEWGENERATED="viewgenerated",DialogTitleBarPopupBinding.CMD_VIEWSERIALIZED="viewserialized",DialogTitleBarPopupBinding.prototype.toString=function(){return"[DialogTitleBarPopupBinding]"},DialogTitleBarPopupBinding.prototype.onBindingAttach=function(){DialogTitleBarPopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},WindowBindingHighlightNodeCrawler.prototype=new NodeCrawler,WindowBindingHighlightNodeCrawler.prototype.constructor=WindowBindingHighlightNodeCrawler,WindowBindingHighlightNodeCrawler.superclass=NodeCrawler.prototype,WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT="compositec1generatedhighlight",WindowBindingHighlightNodeCrawler.prototype._construct=function(){ElementCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;if(a.nodeType==Node.ELEMENT_NODE){var d=a.nodeName.toLowerCase();switch(d){case"script":case"style":case"textarea":c=NodeCrawler.SKIP_NODE+NodeCrawler.SKIP_CHILDREN}}return c});var a=this;this.addFilter(function(b,c){if(b.nodeType==Node.TEXT_NODE){var d=b.nodeValue.toLowerCase();a._map.each(function(c,e){var f=!0;return e.test(d)&&(a._textnodes.add(b),f=!1),f})}})},WindowBindingHighlightNodeCrawler.prototype.crawl=function(a,b){this._textnodes=new List,WindowBindingHighlightNodeCrawler.superclass.crawl.call(this,a,b)},WindowBindingHighlightNodeCrawler.prototype.setKeys=function(a){for(a.reset(),this._map.empty();a.hasNext();){var b=a.getNext(),c=b.toLowerCase().replace(/ /g,"\\W"),d=new RegExp("("+c+")");this._map.set(b,d)}},WindowBindingHighlightNodeCrawler.prototype.onCrawlStop=function(){var a=this;this._textnodes.hasEntries()&&this._textnodes.each(function(b){var c=a.contextDocument.createElement("div"),d=a.contextDocument.createDocumentFragment();for(c.innerHTML=a._getMarkup(b.nodeValue);c.hasChildNodes();)d.appendChild(c.firstChild);b.parentNode.replaceChild(d,b)})},WindowBindingHighlightNodeCrawler.prototype._getMarkup=function(a){function b(a){var g=-1,h=null;if(f._map.each(function(b,c){var d=a.toLowerCase(),e=d.search(c);e>-1&&(-1==g&&(g=e),g>=e&&(g=e,h=b))}),g>-1&&null!=h){var i=a.substring(0,g),j=a.substring(g,g+h.length),k=a.substring(g+h.length,a.length);c+=i+d+j+e,b(k)}else c+=a}var c="",d='<span class="'+WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT+'" style="background-color:yellow;color:black;">',e="</span>",f=this;return b(a),c},WindowBindingHighlightNodeCrawler.prototype.reset=function(a){var b=new List(a.getElementsByTagName("span"));b.each(function(b){if(b.className==WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT){var c=a.ownerDocument.createTextNode(DOMUtil.getTextContent(b));b.parentNode.replaceChild(c,b)}})},WindowBinding.prototype=new FlexBoxBinding,WindowBinding.prototype.constructor=WindowBinding,WindowBinding.superclass=FlexBoxBinding.prototype,WindowBinding.ACTION_LOADED="window loaded",WindowBinding.ACTION_ONLOAD="alien window loaded",WindowBinding.DEFAULT_URL="${root}/blank.aspx",WindowBinding.DEFAULT_TITLE="Composite.Management.Blank",WindowBinding.POSTBACK_URL="${root}/postback.aspx",WindowBinding.POSTBACK_TITLE="Composite.Management.DefaultPostBack",WindowBinding.getMarkup=function(a){var b=null;if(a.isAttached){var c=a.getContentDocument();null!=c&&(b=Client.isAnyExplorer?c.documentElement.outerHTML:(new XMLSerializer).serializeToString(c))}return b},WindowBinding.highlightKeywords=function(a,b){if(null==WindowBinding._highlightcrawler&&(WindowBinding._highlightcrawler=new WindowBindingHighlightNodeCrawler),a.isAttached){var c=a.getContentDocument();if(null!=c){var d=WindowBinding._highlightcrawler;d.reset(c.body),null!=b&&(d.setKeys(b),d.crawl(c.body))}}},WindowBinding._highlightcrawler=null,WindowBinding.prototype.toString=function(){return"[WindowBinding]"},WindowBinding.prototype.serialize=function(){var a=WindowBinding.superclass.serialize.call(this);return a&&(a.url=this.getURL()),a},WindowBinding.prototype.onBindingRegister=function(){WindowBinding.superclass.onBindingRegister.call(this),this.addActionListener(RootBinding.ACTION_PHASE_3),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(RootBinding.ACTION_ACTIVATED),this.addActionListener(RootBinding.ACTION_DEACTIVATED)},WindowBinding.prototype.onBindingAttach=function(){this.getProperty("native")&&(this._native=this.getProperty("native")),this.buildDOMContent(),WindowBinding.superclass.onBindingAttach.call(this),this.setURL(this.getURL())},WindowBinding.prototype.onBindingDispose=function(){WindowBinding.superclass.onBindingDispose.call(this),this._disposeContentDocument()},WindowBinding.prototype._disposeContentDocument=function(){if(null!=this._pageBinding){var a=this.getContentWindow();if(null!=a){var b=this.getContentWindow().DocumentManager;null!=b&&(b.detachAllBindings(),this._pageBinding=null)}}},WindowBinding.prototype.handleAction=function(a){WindowBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_3:b.bindingDocument==this.getContentDocument()&&(1==this._isReloading&&(this._isReloading=!1,1==Client.isPrism&&Prism.enableCache()),this.dispatchAction(WindowBinding.ACTION_LOADED));break;case PageBinding.ACTION_INITIALIZED:this._onPageInitialize(b);break;case RootBinding.ACTION_ACTIVATED:case RootBinding.ACTION_DEACTIVATED:a.consume()}},WindowBinding.prototype.fit=function(a){(!this.isFit||a)&&null!=this._pageBinding&&(this.setHeight(this._pageBinding.getHeight()),this.isFit=!0)},WindowBinding.prototype._onPageInitialize=function(a){null==this._pageBinding&&a.bindingWindow==this.getContentWindow()&&(this._pageBinding=a)},WindowBinding.prototype.buildDOMContent=function(){this.shadowTree.iframe=DOMUtil.createElementNS(Constants.NS_XHTML,"iframe",this.bindingDocument),this.shadowTree.iframe.setAttribute("frameborder","0"),this.shadowTree.iframe.frameBorder=0,this.shadowTree.iframe.id=KeyMaster.getUniqueKey(),this.shadowTree.iframe.name=this.shadowTree.iframe.id,this.bindingElement.appendChild(this.shadowTree.iframe),this._registerOnloadListener(!0)},WindowBinding.prototype._registerOnloadListener=function(a){var b=this.shadowTree.iframe,c=a?"addEventListener":"removeEventListener";if(null==this._onloadHandler){var d=this;this._onloadHandler={handleEvent:function(a){var c=!0;Client.isExplorer&&(c="complete"==b.readyState),1==c&&d.getURL()!=WindowBinding.DEFAULT_URL&&(d._hasLoadActionFired||d.onWindowLoaded(d.getContentWindow()))}}}DOMEvents[c](this.shadowTree.iframe,1==Client.isExplorer?"readystatechange":DOMEvents.LOAD,this._onloadHandler)},WindowBinding.prototype._registerUnloadListener=function(a){var b=a?"addEventListener":"removeEventListener";if(null==this._unloadHandler){var c=this;this._unloadHandler={handleEvent:function(){c._disposeContentDocument(),c._hasLoadActionFired=!1}}}DOMEvents[b](this.getContentWindow(),DOMEvents.UNLOAD,this._unloadHandler)},WindowBinding.prototype.onWindowLoaded=function(a){null==a?this.logger.error("WindowBinding#onWindowLoaded: Bad argument: "+this.getURL()):this.getURL()!=WindowBinding.DEFAULT_URL&&(this._hasLoadActionFired||(null!=a&&null!=a.document&&null!=a.document.body&&(a.document.body.style.border="none",void 0!=a.WindowManager||this._native||Application.framework(a.document),1==this._isReloading&&(this._isReloading=!1,Client.isPrism&&Prism.enableCache())),this._registerUnloadListener(!0),this.dispatchAction(WindowBinding.ACTION_ONLOAD),this._hasLoadActionFired=!0,this.fitContentWindow()))},WindowBinding.prototype.setURL=function(a,b){if(this.setProperty("url",a),this._hasLoadActionFired=!1,1==this.isAttached){if(this._disposeContentDocument(),a.length>1900){var c=new Uri(Resolver.resolve(a));b||(b=new Map),c.getQueryString().each(function(a,d){d.length>512&&(b.set(a,d),c.setParam(a,null))}),a=c.toString()}if(b){var d=this,e=this.getFrameElement();"undefined"==typeof this.shadowTree.form&&(this.shadowTree.form=DOMUtil.createElementNS(Constants.NS_XHTML,"form",this.bindingDocument),this.shadowTree.form.style.display="none",this.shadowTree.form.enctype="application/x-www-form-urlencoded",this.shadowTree.form.method="POST",this.bindingElement.appendChild(this.shadowTree.form));var f=this.shadowTree.form;for(f.action=a,f.target=e.id,f.setAttribute("target",e.id);f.firstChild;)f.removeChild(f.firstChild);b.each(function(a,b){var c=d.bindingDocument.createElement("input");c.name=a,c.value=b,c.type="hidden",f.appendChild(c)}),f.submit()}else this.getFrameElement().src=Resolver.resolve(a)}},WindowBinding.prototype.getURL=function(){var a=WindowBinding.DEFAULT_URL,b=this.getProperty("url");return b&&(a=b),a},WindowBinding.prototype.reload=function(a){this._disposeContentDocument(),Client.isPrism&&Prism.disableCache(),this._isReloading=!0,this.getContentDocument().location.reload()},WindowBinding.prototype.getFrameElement=function(){var a=null;return null!=this.shadowTree.iframe&&(a=this.shadowTree.iframe),a},WindowBinding.prototype.getContentWindow=function(){var a=null,b=this.getFrameElement();if(null!==b)try{a=b.contentWindow}catch(a){this.logger.error("WindowBinding#getContentWindow: strange IE9 error")}return a},WindowBinding.prototype.getContentDocument=function(){var a=null,b=this.getContentWindow();return b&&(a=b.document),a},WindowBinding.prototype.getRootBinding=function(){var a=null,b=this.getContentDocument();return b&&b.body&&(a=UserInterface.getBinding(b.body)),a},WindowBinding.prototype.getPageBinding=function(){return this._pageBinding},WindowBinding.prototype.setHeight=function(a){this.bindingElement.style.height=a+"px"},WindowBinding.prototype.hide=function(){1==this.isVisible&&(this.bindingElement.style.visibility="hidden",this.isVisible=!1)},WindowBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.visibility="visible",this.isVisible=!0)},WindowBinding.prototype.handleCrawler=function(a){if(WindowBinding.superclass.handleCrawler.call(this,a),a.type==NodeCrawler.TYPE_DESCENDING){var b=this.getRootBinding();null!=b?a.nextNode=b.bindingElement:a.response=NodeCrawler.SKIP_CHILDREN}},WindowBinding.prototype.post=function(a,b){var c=this.getContentWindow();if(!c.isPostBackDocument)throw"Post aborted";c.submit(a,b)},WindowBinding.prototype.flex=function(){this.fitContentWindow(),WindowBinding.superclass.flex.call(this)},WindowBinding.prototype.fitContentWindow=function(){if(Client.isPad){var a=this.getContentWindow();null!=a&&null!=a.document&&null!=a.document.body&&(this.bindingElement.offsetHeight&&(a.document.body.style.height=this.bindingElement.offsetHeight+"px"),this.bindingElement.offsetWidth&&(a.document.body.style.width=this.bindingElement.offsetWidth+"px"))}},WindowBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:window",a),c=UserInterface.registerBinding(b,WindowBinding);return c},PreviewWindowBinding.prototype=new WindowBinding,PreviewWindowBinding.prototype.constructor=PreviewWindowBinding,PreviewWindowBinding.superclass=WindowBinding.prototype,PreviewWindowBinding.URL_FULL_STOP="${root}/content/misc/preview/stop.aspx",PreviewWindowBinding.URL_ERROR="${root}/content/misc/preview/error.aspx",PreviewWindowBinding.ACTION_RETURN="return",PreviewWindowBinding.TIMEOUT_RETURN=parseInt(2300),PreviewWindowBinding.prototype.toString=function(){return"[PreviewWindowBinding]"},PreviewWindowBinding.prototype.onBindingAttach=function(){PreviewWindowBinding.superclass.onBindingAttach.call(this),this.bindingElement.style.backgroundColor="white",this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)),this._coverBinding.attach()},PreviewWindowBinding.prototype.onWindowLoaded=function(a){if(this.getURL()!=WindowBinding.DEFAULT_URL&&!this._hasFullStop&&(a.isPostBackDocument?this._isReturning&&(a.submit(this._postBackList,this._postBackURL),this._isReturning=!1):this._coverBinding.hide(),!a.isDefaultDocument)){var b=this;this._loadhandler={handleEvent:function(c){a.isPostBackDocument?(b._postBackList=a.postBackList,b._postBackURL=a.postBackURL):a.isDefaultDocument||b._fullStop()}},DOMEvents.addEventListener(a,DOMEvents.BEFOREUNLOAD,this._loadhandler)}PreviewWindowBinding.superclass.onWindowLoaded.call(this,a)},PreviewWindowBinding.prototype._fullStop=function(){this._coverBinding.show(),null==this._windowBinding?(this._windowBinding=this._getWindowBinding(),this._windowBinding.setURL(PreviewWindowBinding.URL_FULL_STOP),this._windowBinding.hide(),this._windowBinding.attach(),this._windowBinding.addActionListener(WindowBinding.ACTION_LOADED,{handleAction:function(a){a.target.show(),a.consume()}})):this._windowBinding.show(),this._hasFullStop=!0,this.addActionListener(PreviewWindowBinding.ACTION_RETURN),this.setURL(WindowBinding.DEFAULT_URL);var a=this;this._timeout=setTimeout(function(){a._return()},PreviewWindowBinding.TIMEOUT_RETURN)},PreviewWindowBinding.prototype.error=function(){this._coverBinding.show(),null==this._errorBinding?(this._errorBinding=this._getWindowBinding(),this._errorBinding.setURL(PreviewWindowBinding.URL_ERROR),this._errorBinding.hide(),this._errorBinding.attach(),this._errorBinding.addActionListener(WindowBinding.ACTION_LOADED,{handleAction:function(a){a.target.show(),a.consume()}})):this._errorBinding.show(),this._hasError=!0,this.setURL(WindowBinding.DEFAULT_URL)},PreviewWindowBinding.prototype._getWindowBinding=function(){var a=this._coverBinding.add(WindowBinding.newInstance(this.bindingDocument));return a.isFlexible=!1,a.bindingElement.style.position="absolute",a.bindingElement.style.width="100%",a.bindingElement.style.height="100%",a},PreviewWindowBinding.prototype.handleAction=function(a){switch(PreviewWindowBinding.superclass.handleAction.call(this,a),a.type){case PreviewWindowBinding.ACTION_RETURN:this._return()}},PreviewWindowBinding.prototype._return=function(){clearTimeout(this._timeout),this._timeout=null,this.removeActionListener(PreviewWindowBinding.ACTION_RETURN),this._windowBinding.hide(),this._hasFullStop=!1,this._isReturning=!0,this.setURL(WindowBinding.POSTBACK_URL)},PreviewWindowBinding.prototype.reset=function(){null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),null!=this._errorBinding&&this._errorBinding.isVisible&&this._errorBinding.hide(),null!=this._windowBinding&&this._windowBinding.isVisible&&this._windowBinding.hide(),null!=this._loadhandler&&this.getURL()!=WindowBinding.DEFAULT_URL&&(DOMEvents.removeEventListener(this.getContentWindow(),DOMEvents.BEFOREUNLOAD,this._loadhandler),this._loadhandler=null),this._hasError=!1,this._hasFullStop=!1,this._isReturning=!1,this.setURL(WindowBinding.DEFAULT_URL)},RadioGroupBinding.prototype=new Binding,RadioGroupBinding.prototype.constructor=RadioGroupBinding,RadioGroupBinding.superclass=Binding.prototype,RadioGroupBinding.ACTION_SELECTIONCHANGED="radiogroupselectionchanged",RadioGroupBinding.prototype.toString=function(){return"[RadioGroupBinding]"},RadioGroupBinding.prototype.onBindingRegister=function(){RadioGroupBinding.superclass.onBindingRegister.call(this),this.addActionListener(ButtonBinding.ACTION_RADIOBUTTON_ATTACHED,this),this.addActionListener(ButtonBinding.ACTION_COMMAND,this)},RadioGroupBinding.prototype.onBindingInitialize=function(){var a=null;this._getRadioButtonBindings().each(function(b){return b.getProperty("ischecked")?(a=b,!1):!0}),a&&(this._checkedRadioBinding=a),RadioGroupBinding.superclass.onBindingInitialize.call(this)},RadioGroupBinding.prototype.handleAction=function(a){RadioGroupBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case ButtonBinding.ACTION_RADIOBUTTON_ATTACHED:this._isUpToDate=!1,a.consume();break;case ButtonBinding.ACTION_COMMAND:b.isRadioButton&&!b.isDisabled&&(this._checkedRadioBinding&&this._unCheckRadioBindingsExcept(b),this._checkedRadioBinding=b,this.dispatchAction(RadioGroupBinding.ACTION_SELECTIONCHANGED),a.consume())}},RadioGroupBinding.prototype.setCheckedButtonBinding=function(a,b){if(a instanceof RadioDataBinding&&(a=a.getButton()),a.isRadioButton)switch(b){case!0:this._unCheckRadioBindingsExcept(a),this._checkedRadioBinding=a,a.check(!0);break;default:a.check()}},RadioGroupBinding.prototype.getCheckedButtonBinding=function(){return this._checkedRadioBinding},RadioGroupBinding.prototype._unCheckRadioBindingsExcept=function(a){var b=this._getRadioButtonBindings();b.each(function(b){b.isChecked&&b!=a&&b.uncheck(!0)})},RadioGroupBinding.prototype._getRadioButtonBindings=function(){if(null===this._radioButtonBindings||!this._isUpToDate){var a=new Crawler,b=new List;a.addFilter(function(a){var c=!0,d=UserInterface.getBinding(a);return d instanceof RadioGroupBinding?c=NodeCrawler.SKIP_CHILDREN:d instanceof ButtonBinding&&d.isRadioButton&&b.add(d),c}),a.crawl(this.bindingElement),this._radioButtonBindings=b}return this._radioButtonBindings},RadioGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:radiogroup",a);return UserInterface.registerBinding(b,RadioGroupBinding)},DataBindingMap.prototype=new Map,DataBindingMap.prototype.constructor=DataBindingMap,DataBindingMap.superclass=Map.prototype,DataBindingMap.TYPE_VALUE="databindingmap valuetype",DataBindingMap.TYPE_RESULT="databindingmap resulttype",DataInputBinding.prototype=new DataBinding,DataInputBinding.prototype.constructor=DataInputBinding,DataInputBinding.superclass=DataBinding.prototype,DataInputBinding.prototype.toString=function(){return"[DataInputBinding]"},DataInputBinding.prototype.onBindingRegister=function(){DataInputBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.value=this.setValue},DataInputBinding.prototype.onBindingAttach=function(){DataInputBinding.superclass.onBindingAttach.call(this),this._parseDOMProperties(),this._buildDOMContent(),this._attachDOMEvents()},DataInputBinding.prototype.onBindingDispose=function(){DataInputBinding.superclass.onBindingDispose.call(this),this._dirtyinterval&&window.clearInterval(this._dirtyinterval),this._isValid||this.dispatchAction(Binding.ACTION_VALID)},DataInputBinding.prototype._parseDOMProperties=function(){this.type=this.getProperty("type"),this.isRequired=this.getProperty("required"),this.isPassword=1==this.getProperty("password"),this.minlength=this.getProperty("minlength"),this.maxlength=this.getProperty("maxlength"),this._isAutoPost=1==this.getProperty("autopost"),this.spellcheck=this.getProperty("spellcheck")!==!1,"programmingidentifier"==this.type&&(this.spellcheck=!1),"programmingnamespace"==this.type&&(this.spellcheck=!1);var a=this.getProperty("regexrule");null!=a&&(this.expression=new RegExp(a));var b=this.getProperty("onbindingblur");null!=b&&(this.onblur=function(){Binding.evaluate(b,this)});var c=this.getProperty("onvaluechange");if(null!=c&&(this.onValueChange=function(){Binding.evaluate(c,this)}),null==this.error&&null!=this.type){var d=DataBinding.errors[this.type];null!=d&&(this.error=d)}},DataInputBinding.prototype._buildDOMContent=function(){this.shadowTree.input=this._getInputElement(),this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),1==Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this.getProperty("value");null!=a&&this.setValue(String(a));var b=this.getProperty("name");null!=b&&this.setName(b);var c=this.getProperty("isdisabled");1==c&&this.setDisabled(!0);var d=this.getProperty("readonly");1==d&&this.setReadOnly(!0);var e=this.getProperty("autoselect");1==e&&(this._isAutoSelect=!0),this.shadowTree.box.appendChild(this.shadowTree.input),this.bindingElement.appendChild(this.shadowTree.box);var f=this.getProperty("placeholder");if(f&&this.shadowTree.input.setAttribute("placeholder",Resolver.resolve(f)),this.spellcheck&&Client.hasSpellcheck){var g=Localization.currentLang();null!=g?(this.shadowTree.input.setAttribute("spellcheck","true"),this.shadowTree.input.setAttribute("lang",Localization.currentLang())):this.shadowTree.input.setAttribute("spellcheck","false")}else this.shadowTree.input.setAttribute("spellcheck","false");Localization.isRtl!==Localization.isUIRtl&&this.shadowTree.input.setAttribute("dir",Localization.isRtl?"rtl":"ltr"),this.hasCallBackID()||this._isAutoPost&&this.logger.warn("Autopost "+this.toString()+" without a callbackid?")},DataInputBinding.prototype._getInputElement=function(){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);return a.type=1==this.isPassword?"password":"text",a.tabIndex=-1,a},DataInputBinding.prototype._attachDOMEvents=function(){DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.FOCUS,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.BLUR,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.KEYDOWN,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.KEYPRESS,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DRAGOVER,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DROP,this)},DataInputBinding.prototype.handleEvent=function(a){if(DataInputBinding.superclass.handleEvent.call(this,a),1==this.isFocusable)switch(a.type){case DOMEvents.DRAGOVER:DOMEvents.preventDefault(a);break;case DOMEvents.DROP:a.dataTransfer&&(this.setValue(a.dataTransfer.getData("Text")),this.checkDirty(),this.validate(!0)),DOMEvents.preventDefault(a);break;case DOMEvents.FOCUS:case DOMEvents.BLUR:this._handleFocusAndBlur(a.type==DOMEvents.FOCUS);break;case DOMEvents.KEYPRESS:switch(a.keyCode){case KeyEventCodes.VK_BACK:case KeyEventCodes.VK_INSERT:case KeyEventCodes.VK_DELETE:this._testDirty()}break;case DOMEvents.KEYDOWN:switch(this._testDirty(),a.keyCode){case KeyEventCodes.VK_ENTER:this._handleEnterKey(a);break;case KeyEventCodes.VK_ESCAPE:DOMEvents.preventDefault(a)}if(this.isFocusable&&this._isAutoPost){null!=this._timeout&&top.window.clearTimeout(this._timeout);var b=this;this._timeout=top.window.setTimeout(function(){Binding.exists(b)&&b.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},this._time)}}},DataInputBinding.prototype._handleFocusAndBlur=function(a){a?(this.focus(!0),this.bindingWindow.standardEventHandler.enableNativeKeys()):(this.blur(!0),this.bindingWindow.standardEventHandler.disableNativeKeys())},DataInputBinding.prototype._handleEnterKey=function(a){DOMEvents.preventDefault(a),DOMEvents.stopPropagation(a),EventBroadcaster.broadcast(BroadcastMessages.KEY_ENTER)},DataInputBinding.prototype.focus=function(a){if(!this.isFocused&&!this.isReadOnly&&!this.isDisabled&&(DataInputBinding.superclass.focus.call(this),1==this.isFocused)){if(this._focus(),1==this._isAutoSelect)if(a){var b=this,c=this.bindingElement,d={handleEvent:function(){b.select(),DOMEvents.removeEventListener(c,DOMEvents.MOUSEUP,this)}};DOMEvents.addEventListener(c,DOMEvents.MOUSEUP,d)}else this.select();if(this.onfocus(),!a){var e=this.shadowTree.input;setTimeout(function(){FocusBinding.focusElement(e)},0)}}},DataInputBinding.prototype.select=function(){var a=this.shadowTree.input;setTimeout(function(){if(1==Client.isExplorer){var b=a.createTextRange();b.moveStart("character",0),b.moveEnd("character",a.value.length),b.select()}else a.setSelectionRange(0,a.value.length)},0)},DataInputBinding.prototype.blur=function(a){1==this.isFocused&&(DataInputBinding.superclass.blur.call(this),a||this.shadowTree.input.blur(),this._blur())},DataInputBinding.prototype._focus=function(){this._isValid||(this.isPassword?Client.isMozilla&&(this.shadowTree.input.type="password",this.setValue(this._value)):this.setValue(this._value),this.shadowTree.input.className=""),this._sessionResult=this.getResult();var a=this;this._dirtyinterval=window.setInterval(function(){1==Binding.exists(a)?(a.checkDirty(),a._isValid||a.validate(!0)):(window.clearInterval(a._dirtyinterval),a._dirtyinterval=null)},500)},DataInputBinding.prototype._blur=function(){this._dirtyinterval&&(window.clearInterval(this._dirtyinterval),this._dirtyinterval=null),this.checkDirty(),this._isValid=!0,this._normalizeToValid(),this.validate(!0),Types.isFunction(this.onblur)&&this.onblur(),this._isValid&&this.getResult()!=this._sessionResult&&this.onValueChange()},DataInputBinding.prototype.onfocus=function(){},DataInputBinding.prototype.onblur=function(){},DataInputBinding.prototype.checkDirty=function(){this.isDirty||this.getResult()!=this._sessionResult&&this.dirty()},DataInputBinding.prototype._testDirty=function(){var a=this.getValue(),b=this;setTimeout(function(){Binding.exists(b)&&b.getValue()!=a&&b.dirty()},0)},DataInputBinding.prototype.onValueChange=function(){},DataInputBinding.prototype.validate=function(a){if(1==a||this._isValid){var b=this.isValid();if(b!=this._isValid)if(this._isValid=b,b)this._normalizeToValid();else if(this.attachClassName(DataBinding.CLASSNAME_INVALID),this._value=this.getValue(),this.dispatchAction(Binding.ACTION_INVALID),!this.isFocused){var c=null;1==this._isInvalidBecauseRequired?c=DataBinding.warnings.required:1==this._isInvalidBecauseMinLength?(c=DataBinding.warnings.minlength,c=c.replace("{0}",String(this.minlength))):1==this._isInvalidBecauseMaxLength?(c=DataBinding.warnings.maxlength,c=c.replace("{0}",String(this.maxlength))):c=DataBinding.warnings[this.type],this.shadowTree.input.className=DataBinding.CLASSNAME_WARNING,null!=c&&(this.isPassword?Client.isMozilla&&(this.shadowTree.input.type="text",this.setValue(c)):this.setValue(c))}}return this._isValid},DataInputBinding.prototype._normalizeToValid=function(){this._isValid&&(this.hasClassName(DataBinding.CLASSNAME_INVALID)&&this.detachClassName(DataBinding.CLASSNAME_INVALID),this.shadowTree.input.className="",this.dispatchAction(Binding.ACTION_VALID))},DataInputBinding.prototype.isValid=function(){var a=!0;this._isInvalidBecauseRequired=!1,this._isInvalidBecauseMinLength=!1,this._isInvalidaBecuaseMaxLength=!1;var b=this.getValue();if(""==b)1==this.isRequired&&(a=!1,this._isInvalidBecauseRequired=!0);else if(null!=this.type){var c=DataBinding.expressions[this.type];c.test(b)||(a=!1)}else null!=this.expression&&(this.expression.test(b)||(a=!1));return a&&null!=this.minlength&&b.length<this.minlength&&(this._isInvalidBecauseMinLength=!0,a=!1),a&&null!=this.maxlength&&b.length>this.maxlength&&(this._isInvalidBecauseMaxLength=!0,a=!1),a},DataInputBinding.prototype.setDisabled=function(a){if(a!=this.isDisabled){a?this.attachClassName("isdisabled"):this.detachClassName("isdisabled");var b=this.shadowTree.input;a?(this._disabledHandler={handleEvent:function(a){DOMEvents.preventDefault(a),DOMEvents.stopPropagation(a)}},DOMEvents.addEventListener(b,DOMEvents.MOUSEDOWN,this._disabledHandler)):(DOMEvents.removeEventListener(b,DOMEvents.MOUSEDOWN,this._disabledHandler),this._disabledHandler=null),Client.isExplorer&&(this.shadowTree.input.disabled=a,this.shadowTree.input.unselectable=a?"on":"off"),this.isDisabled=a,this.isFocusable=!a,this.dispatchAction(FocusBinding.ACTION_UPDATE)}},DataInputBinding.prototype.setReadOnly=function(a){a!=this.isReadOnly&&(a?this.attachClassName("readonly"):this.detachClassName("readonly"),this.shadowTree.input.readOnly=a,this.isReadOnly=a)},DataInputBinding.prototype.disable=function(){this.isDisabled||this.setDisabled(!0)},DataInputBinding.prototype.enable=function(){this.isDisabled&&this.setDisabled(!1)},DataInputBinding.prototype.handleElement=function(a){return!0},DataInputBinding.prototype.updateElement=function(a){var b=a.getAttribute("value"),c=a.getAttribute("type"),d=a.getAttribute("maxlength"),e=a.getAttribute("minlength"),f="true"===a.getAttribute("required"),g="true"===a.getAttribute("readonly");null==b&&(b=""),this.isReadOnly!=g&&this.setReadOnly(g);var h=this.bindingWindow.UpdateManager;return this.getValue()!=b&&(h.report('Property [value] updated on binding "'+this.getID()+'"'),this.setValue(b)),this.type!=c&&(h.report('Property [type] updated on binding "'+this.getID()+'"'),this.type=c),this.maxlength!=d&&(h.report('Property [maxlength] updated on binding "'+this.getID()+'"'),this.maxlength=d),this.minlength!=e&&(h.report('Property [minlength] updated on binding "'+this.getID()+'"'),this.minlength=e),this.isRequired!=f&&(h.report('Property [required] updated on binding "'+this.getID()+'"'),this.isRequired=f),!0},DataInputBinding.prototype.manifest=function(){null!=this._timeout&&top.window.clearTimeout(this._timeout),this._isValid||(this.setValue(""),this._isValid=!0,this._normalizeToValid())},DataInputBinding.prototype.clean=function(){DataInputBinding.superclass.clean.call(this),this._sessionResult=this.getResult()},DataInputBinding.prototype.setValue=function(a){null===a&&(a=""),a!=this.getValue()&&(this.setProperty("value",a),null!=this.shadowTree.input&&(this.shadowTree.input.value=String(a)))},DataInputBinding.prototype.getValue=function(){var a=null;return a=null!=this.shadowTree.input?this.shadowTree.input.value:this.getProperty("value")},DataInputBinding.prototype.setName=function(a){DataInputBinding.superclass.setName.call(this,a),1==this.isAttached&&(this.shadowTree.input.name=a)},DataInputBinding.prototype.getResult=function(){var a=this.getValue();switch(this.type){case DataBinding.TYPE_NUMBER:case DataBinding.TYPE_INTEGER:a=Number(a)}return a},DataInputBinding.prototype.setResult=DataInputBinding.prototype.setValue,DataInputBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datainput",a);return UserInterface.registerBinding(b,DataInputBinding)},TextBoxBinding.prototype=new DataInputBinding,TextBoxBinding.prototype.constructor=TextBoxBinding,TextBoxBinding.superclass=DataInputBinding.prototype,TextBoxBinding.prototype.toString=function(){return"[TextBoxBinding]"},TextBoxBinding.prototype._buildDOMContent=function(){var a=DOMUtil.getElementsByTagName(this.bindingElement,"textarea").item(0);null!=a&&(this.setValue(a.value),a.parentNode.removeChild(a)),TextBoxBinding.superclass._buildDOMContent.call(this),this._hasWordWrap||this.shadowTree.input.setAttribute("wrap","off")},TextBoxBinding.prototype._getInputElement=function(){var a;if(Client.isExplorer||Client.isExplorer11){var b=this.bindingDocument.createElement("div");b.innerHTML="<textarea></textarea>",a=b.firstChild}else a=DOMUtil.createElementNS(Constants.NS_XHTML,"textarea",this.bindingDocument);return a.tabIndex=-1,a},TextBoxBinding.prototype.handleElement=function(a){return!0},TextBoxBinding.prototype.updateElement=function(a){var b,c=a.getElementsByTagName("textarea").item(0);null!=c&&c.hasChildNodes()&&(b=DOMUtil.getTextContent(c)),null==b&&(b="");var d=this.bindingWindow.UpdateManager;this.getValue()!=b&&(d.report('Property [value] updated on binding "'+this.getID()+'"'),this.setValue(b));var e=a.getAttribute("type");return this.type!=e&&(d.report('Property [type] updated on binding "'+this.getID()+'"'),this.type=e),!0},TextBoxBinding.prototype._handleEnterKey=function(a){DOMEvents.stopPropagation(a)},EditorTextBoxBinding.prototype=new TextBoxBinding,EditorTextBoxBinding.prototype.constructor=EditorTextBoxBinding,EditorTextBoxBinding.superclass=TextBoxBinding.prototype,
EditorTextBoxBinding.prototype.toString=function(){return"[EditorTextBoxBinding]"},EditorTextBoxBinding.prototype.handleEvent=function(a){if(1==this.isFocusable)switch(a.type){case DOMEvents.FOCUS:case DOMEvents.BLUR:this._handleFocusAndBlur(a.type==DOMEvents.FOCUS);break;case DOMEvents.KEYDOWN:this._handleKeyEvent(a)}},EditorTextBoxBinding.prototype._handleKeyEvent=function(a){switch(a.keyCode){case KeyEventCodes.VK_TAB:this._handleTabKey(a.shiftKey),DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);break;case KeyEventCodes.VK_ENTER:this._handleEnterKey(),DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);break;case KeyEventCodes.VK_ESCAPE:DOMEvents.preventDefault(a)}},EditorTextBoxBinding.prototype._handleTabKey=Binding.ABSTRACT_METHOD,EditorTextBoxBinding.prototype._handleEnterKey=Binding.ABSTRACT_METHOD,IEEditorTextBoxBinding.prototype=new EditorTextBoxBinding,IEEditorTextBoxBinding.prototype.constructor=IEEditorTextBoxBinding,IEEditorTextBoxBinding.superclass=EditorTextBoxBinding.prototype,IEEditorTextBoxBinding.prototype.toString=function(){return"[IEEditorTextBoxBinding]"},IEEditorTextBoxBinding.prototype._handleTabKey=function(a){var b=this.bindingDocument.selection.createRange(),c=""==b.text;if(c&&!a)b.text="	";else{for(var d="",e=b.text.length;b.moveStart("word",-1)&&"\n"!=b.text.charAt(1););b.moveStart("character",1);for(var f,g=0,h=0,i=b.text.split("\n");null!=(f=i[h++]);)a?(f=f.replace(/^(\s)/gm,""),g++):f=f.replace(/^(.)/gm,"	$1"),d+=f+(i[h+1]?"\n":"");b.text=d,b.moveStart("character",-e),a&&b.moveStart("character",2*i.length-2),b.select()}},IEEditorTextBoxBinding.prototype._handleEnterKey=function(){for(var a=this.bindingDocument.selection.createRange(),b=a.duplicate();b.moveStart("word",-1)&&-1==b.text.indexOf("\n"););b.moveStart("character",1),a.text="\n"+b.text.match(/^(\s)*/)[0]+"!",a.moveStart("character",-1),a.select(),a.text="",a.select()},MozEditorTextBoxBinding.prototype=new EditorTextBoxBinding,MozEditorTextBoxBinding.prototype.constructor=MozEditorTextBoxBinding,MozEditorTextBoxBinding.superclass=EditorTextBoxBinding.prototype,MozEditorTextBoxBinding.prototype.toString=function(){return"[MozEditorTextBoxBinding]"},MozEditorTextBoxBinding.prototype._handleTabKey=function(a){var b,c,d,e,f,g,h=this._getSelectedText(),i=this.shadowTree.input;if(b=i.scrollLeft,c=i.scrollTop,h.match(/\n/)){for(d=i.selectionStart,e=i.selectionEnd,g=0,f=d-1;f>=0;f--)if("\n"==i.value.charAt(f)){d=f+1,g=1;break}for(0==g&&(d=0),g=0,f=e;f<i.value.length;f++)if("\n"==i.value.charAt(f)){e=f,g=1;break}0==g&&(e=i.value.length),i.selectionStart=d,i.selectionEnd=e,h=this._getSelectedText(),a?ntext=h.replace(/^(\s)/gm,""):ntext=h.replace(/^(.)/gm,"	$1"),i.value=i.value.substr(0,i.selectionStart)+ntext+i.value.substr(i.selectionEnd),i.selectionStart=d,i.selectionEnd=e+(ntext.length-h.length)}else d=i.selectionStart,i.value=i.value.substr(0,i.selectionStart)+"	"+i.value.substr(i.selectionEnd),i.selectionStart=d+1,i.selectionEnd=d+1;i.scrollLeft=b,i.scrollTop=c},MozEditorTextBoxBinding.prototype._handleEnterKey=function(){var a,b,c,d,e=this.shadowTree.input;a=e.scrollLeft,b=e.scrollTop,c=e.selectionStart,d=e.selectionEnd;var f=e.value.substr(0,e.selectionStart),g=f.split(/\r|\n/g),h=g[g.length-1].match(/^(\s)*/);e.value=e.value.substr(0,e.selectionStart)+"\n"+h[0]+e.value.substr(e.selectionEnd),e.selectionStart=c+1+h[0].length,e.selectionEnd=c+1+h[0].length,e.scrollLeft=a,e.scrollTop=b},MozEditorTextBoxBinding.prototype._getSelectedText=function(){var a=this.shadowTree.input.value,b=this.shadowTree.input.selectionStart,c=this.shadowTree.input.selectionEnd;return a.substr(b,c-b)},SelectorBinding.prototype=new DataBinding,SelectorBinding.prototype.constructor=SelectorBinding,SelectorBinding.superclass=DataBinding.prototype,SelectorBinding.ACTION_SELECTIONCHANGED="selectorselectionchanged",SelectorBinding.ACTION_COMMAND="selectorcommand",SelectorBinding.CLASSNAME_POPUP="selectorpopup",SelectorBinding.prototype.toString=function(){return"[SelectorBinding]"},SelectorBinding.prototype.onBindingAttach=function(){SelectorBinding.superclass.onBindingAttach.call(this),this.selections=new List,this.parseDOMProperties(),this.buildDOMContent(),this.addEventListener(DOMEvents.FOCUS),this.addEventListener(DOMEvents.KEYPRESS),this.addEventListener(DOMEvents.KEYDOWN),this.addActionListener(ButtonBinding.ACTION_COMMAND);var a=this.getProperty("isdisabled");(this.isDisabled||a)&&this.disable()},SelectorBinding.prototype.onBindingDispose=function(){SelectorBinding.superclass.onBindingDispose.call(this),this._popupBinding&&Binding.exists(this._popupBinding)&&this._popupBinding.dispose(),1==this._hasKeyboard&&this._releaseKeyboard()},SelectorBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("type"),b=this.getProperty("label"),c=this.getProperty("value"),d=this.getProperty("width"),e=this.getProperty("onchange"),f=1==this.getProperty("required"),g=this.getProperty("local");!this.type&&a&&(this.type=a),this.label||null==b||(this.label=b),this.value||null==c||(this.value=c),!this.width&&d&&(this.width=d),f&&(this.isRequired=!0),g&&(this._isLocal=!0),e&&(this.onValueChange=function(){Binding.evaluate(e,this)}),this._computeImageProfile()},SelectorBinding.prototype._computeImageProfile=function(){Binding.imageProfile(this)},SelectorBinding.prototype.buildDOMContent=function(){this.buildButton(),this.buildPopup(),this.buildSelections(),this.bindingElement.tabIndex=0,1==Client.isExplorer&&(this.bindingElement.hideFocus=!0),Client.isEdge&&(this.isSearchSelectionEnabled=!1)},SelectorBinding.prototype.buildFormField=function(){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.name=this.getName(),a.value=this.getValue(),a.type="hidden",this.hasCallBackID()&&(a.id=this.getCallBackID()),this.shadowTree.input=a,this.bindingElement.appendChild(a)},SelectorBinding.prototype.buildButton=function(){var a=this.BUTTON_IMPLEMENTATION,b=this.add(a.newInstance(this.bindingDocument));null!=this.imageProfile&&(b.imageProfile=this.imageProfile),null!=this.width&&b.setWidth(this.width),this._buttonBinding=b,this.shadowTree.button=b,b.attach()},SelectorBinding.prototype.buildPopup=function(){var a;if(this._isLocal)if(this.bindingWindow.bindingMap.selectorpopupset)a=this.bindingWindow.bindingMap.selectorpopupset;else{var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupset",this.bindingDocument);b.id="selectorpopupset",a=UserInterface.registerBinding(b,PopupSetBinding),this.bindingDocument.body.appendChild(a.bindingElement)}else a=top.app.bindingMap.selectorpopupset;var c=a.bindingDocument,d=a.add(PopupBinding.newInstance(c)),e=this.getProperty("popupclass");e&&d.setProperty("class",e);var f=d.add(MenuBodyBinding.newInstance(c));this._popupBinding=d,this._menuBodyBinding=f,this._popupBinding.attachClassName(SelectorBinding.CLASSNAME_POPUP),this._popupBinding.attachRecursive(),this.getProperty("textonly")===!0&&this._popupBinding.showTextOnly(),this._popupBinding.type=PopupBinding.TYPE_FIXED,d.attachClassName("selectorpopup"),d.addActionListener(PopupBinding.ACTION_SHOW,this),d.addActionListener(MenuItemBinding.ACTION_COMMAND,this),d.addActionListener(PopupBinding.ACTION_HIDE,this),this._buttonBinding.setPopup(d)},SelectorBinding.prototype.buildSelections=function(){null==this.defaultSelection&&(this.label||this.value)&&(this.defaultSelection=new SelectorBindingSelection(this.label,this.value,!0,null));var a=this._getSelectionsList();this.populateFromList(a)},SelectorBinding.prototype._getSelectionsList=function(){var a=new List,b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");return new List(b).each(function(b){var c=b.getAttribute("label"),d=b.getAttribute("value"),e=b.getAttribute("selected"),f=b.getAttribute("image"),g=b.getAttribute("image-hover"),h=b.getAttribute("image-active"),i=b.getAttribute("image-disabled"),j=null;(f||g||h||i)&&(j=new ImageProfile({image:f,imageHover:g,imageActive:h,imageDisabled:i})),a.add(new SelectorBindingSelection(c?c:null,d?d:null,e&&"true"==e,j))}),a},SelectorBinding.prototype.populateFromList=function(a){if(!this.isAttached)throw"Could not populate unattached selector";if(this.clear(),a.hasEntries()){for(var b=null;a.hasNext();){var c=a.getNext(),d=this.addSelection(c);c.isSelected&&this.select(d,!0),b||(b=d)}this._selectedItemBinding||this.select(b,!0)}},SelectorBinding.prototype.addSelection=function(a,b){var c=this.MENUITEM_IMPLEMENTATION,d=this._menuBodyBinding,e=d.bindingDocument,f=c.newInstance(e);return f.imageProfile=a.imageProfile,f.setLabel(a.label),null!=a.tooltip&&f.setToolTip(a.tooltip),f.selectionValue=a.value,a.menuItemBinding=f,b?(d.addFirst(f),this.selections.addFirst(a)):(d.add(f),this.selections.add(a)),this._isUpToDate=!1,f},SelectorBinding.prototype.addSelectionFirst=function(a){return this.addSelection(a,!0)},SelectorBinding.prototype.clear=function(a){if(this._selectedItemBinding=null,this._popupBinding&&(this._popupBinding.clear(),this.selections.clear(),!a&&null!=this.defaultSelection)){var b=this.addSelection(this.defaultSelection);this.select(b,!0)}},SelectorBinding.prototype.clearAll=function(){this.clear(!0)},SelectorBinding.prototype.disable=function(){this.setDisabled(!0)},SelectorBinding.prototype.enable=function(){this.setDisabled(!1)},SelectorBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),1==this.isFocused&&(FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()))},SelectorBinding.prototype.blur=function(){1==this.isFocused&&(DataBinding.prototype.blur.call(this),this._releaseKeyboard(),this._popupBinding.isVisible&&this._popupBinding.hide())},SelectorBinding.prototype._grabKeyboard=function(){this._hasKeyboard||(this.subscribe(BroadcastMessages.KEY_ARROW),this._hasKeyboard=!0)},SelectorBinding.prototype._releaseKeyboard=function(){1==this._hasKeyboard&&(this.unsubscribe(BroadcastMessages.KEY_ARROW),this._hasKeyboard=!1)},SelectorBinding.prototype.setDisabled=function(a){if(1==this.isAttached){var b=this._buttonBinding;b.setDisabled(a)}a?this.setProperty("isdisabled",!0):this.deleteProperty("isdisabled")},SelectorBinding.prototype.reset=function(a){null!=this.defaultSelection&&this.selectByValue(this.defaultSelection.value,a)},SelectorBinding.prototype.handleAction=function(a){switch(SelectorBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:this._onButtonCommand(),a.consume();break;case PopupBinding.ACTION_SHOW:this._onPopupShowing(),a.consume();break;case MenuItemBinding.ACTION_COMMAND:this._onMenuItemCommand(a.target),a.consume();break;case PopupBinding.ACTION_HIDE:var b=this;setTimeout(function(){b.isFocused&&b._grabKeyboard()},0),this._clearSearchSelection&&this._clearSearchSelection(),a.consume()}},SelectorBinding.prototype._onButtonCommand=function(){this.focus(),this._attachSelections(),this._restoreSelection(),this.dispatchAction(SelectorBinding.ACTION_COMMAND)},SelectorBinding.prototype._onPopupShowing=function(){this._fitMenuToSelector(),this._releaseKeyboard()},SelectorBinding.prototype._onMenuItemCommand=function(a){this.select(a),FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()},SelectorBinding.prototype._restoreSelection=function(){this._selectedItemBinding&&this._selectedItemBinding.focus()},SelectorBinding.prototype._fitMenuToSelector=function(){var a=this._buttonBinding.bindingElement.offsetWidth+"px",b=this._popupBinding.bindingElement;b.style.minWidth=a},SelectorBinding.prototype.handleEvent=function(a){switch(SelectorBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.FOCUS:this.focus();break;case DOMEvents.KEYDOWN:var b=Client.isExplorer?a.keyCode:a.which;8==b&&this._popSearchSelection();break;case DOMEvents.KEYPRESS:var b=Client.isExplorer?a.keyCode:a.which;if(b>=32){this._buttonBinding.check();var c=String.fromCharCode(b);this._pushSearchSelection(c)}}},SelectorBinding.prototype._pushSearchSelection=function(a){this._searchString+=a.toLowerCase(),this._applySearchSelection()},SelectorBinding.prototype._popSearchSelection=function(a){this._searchString=this._searchString.substring(0,this._searchString.length-1),this._applySearchSelection()},SelectorBinding.prototype._clearSearchSelection=function(){null!=this._searchString&&""!=this._searchString&&(this._searchString="",this._applySearchSelection())},SelectorBinding.prototype._applySearchSelection=function(){if(this.isSearchSelectionEnabled){var a=this._menuBodyBinding;if(null!=a){var b=this.MENUITEM_IMPLEMENTATION,c=a.bindingDocument,d=this._getSelectionsList();if(null!=this._searchString&&""!=this._searchString){if(this._popupBinding.clear(),this._buttonBinding.setLabel(this._searchString),d.hasEntries())for(;d.hasNext();){var e=d.getNext();e.label.toLowerCase().indexOf(this._searchString)>-1&&this.addSelection(e)}this._attachSelections();var f=new RegExp(this._searchString.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"gi"),g=a.getDescendantBindingsByType(b);if(g.hasEntries()){for(;g.hasNext();){var h=g.getNext(),i=h.labelBinding;null!=i&&null!=i.shadowTree&&null!=i.shadowTree.labelText&&(i.shadowTree.labelText.innerHTML=i.shadowTree.labelText.innerHTML.replace(f,"<b>$&</b>"))}g.getFirst().focus(),this.attachClassName(DataBinding.CLASSNAME_INFOBOX),this.detachClassName(DataBinding.CLASSNAME_INVALID)}else i=LabelBinding.newInstance(c),i.setLabel(StringBundle.getString("ui","AspNetUiControl.Selector.NoMatchesFor").replace("{0}",this._searchString)),a.add(i),this._attachSelections(),this.detachClassName(DataBinding.CLASSNAME_INFOBOX),this.attachClassName(DataBinding.CLASSNAME_INVALID)}else{if(this._popupBinding.clear(),this._buttonBinding.setLabel(this._selectionLabel),d.hasEntries())for(;d.hasNext();){var e=d.getNext(),j=this.addSelection(e);this._selectionValue==e.value&&(this._selectedItemBinding=j)}this._attachSelections(),this._restoreSelection(),this.detachClassName(DataBinding.CLASSNAME_INFOBOX),this.detachClassName(DataBinding.CLASSNAME_INVALID)}this._bodyBinding instanceof MenuBodyBinding&&this._bodyBinding.refreshMenuGroups(),this._popupBinding._enableTab(!0)}}},SelectorBinding.prototype.handleBroadcast=function(a,b){switch(SelectorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ARROW:this.logger.debug(this._buttonBinding.getLabel()),this._handleArrowKey(b)}},SelectorBinding.prototype._handleArrowKey=function(a){if(!this._popupBinding.isVisible)switch(a){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:this._buttonBinding.check()}},SelectorBinding.prototype.select=function(a,b){var c=!1;if(a!=this._selectedItemBinding){this._selectedItemBinding=a,c=!0;var d=this._buttonBinding;this._selectionValue=a.selectionValue,this._selectionLabel=a.getLabel(),d.setLabel(a.getLabel()),null!=a.imageProfile&&(d.imageProfile=a.imageProfile),null!=d.imageProfile&&d.setImage(1==this.isDisabled?d.imageProfile.getDisabledImage():d.imageProfile.getDefaultImage()),this._updateImageLayout(),b||(this.onValueChange(),this.dispatchAction(SelectorBinding.ACTION_SELECTIONCHANGED),this.dirty()),(!this._isValid||this.isRequired&&!b)&&this.validate()}return c},SelectorBinding.prototype._relate=function(){var a=this.getProperty("relate");if(a){var b=this.bindingDocument.getElementById(a);if(b){var c=UserInterface.getBinding(b);c&&(this.isChecked?c.show():c.hide())}}},SelectorBinding.prototype._updateImageLayout=function(){null==this._buttonBinding.getImage()?1==this._isImageLayout&&(this._buttonBinding.attachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._isImageLayout=!1):this._isImageLayout||(this._buttonBinding.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._isImageLayout=!0)},SelectorBinding.prototype.onValueChange=function(){},SelectorBinding.prototype.selectByValue=function(a,b){for(var c=!1,d=this._menuBodyBinding,e=d.getDescendantElementsByLocalName("menuitem");e.hasNext();){var f=UserInterface.getBinding(e.getNext());if(f.selectionValue==a){c=this.select(f,b);break}}return c},SelectorBinding.prototype.getValue=function(){var a=this._selectionValue;return null!=a&&(a=String(a)),a},SelectorBinding.prototype.setValue=function(a){this.selectByValue(String(a),!0)},SelectorBinding.prototype.getResult=function(){var a=this._selectionValue;if("null"==a&&(a=null),a)switch(this.type){case DataBinding.TYPE_NUMBER:case DataBinding.TYPE_INTEGER:a=Number(a)}return a},SelectorBinding.prototype.setResult=function(a){this.selectByValue(a,!0)},SelectorBinding.prototype.validate=function(){var a=!0;if(1==this.isRequired&&null!=this.defaultSelection){var b=this.getValue();b==this.defaultSelection.value&&(a=!1),a!=this._isValid&&(a?(this.dispatchAction(Binding.ACTION_VALID),this.detachClassName(DataBinding.CLASSNAME_INVALID)):(this.dispatchAction(Binding.ACTION_INVALID),this.attachClassName(DataBinding.CLASSNAME_INVALID),this._buttonBinding.setLabel(DataBinding.warnings.required))),this._isValid=a}return a},SelectorBinding.prototype.manifest=function(){1==this.isAttached&&(this.getResult()?(this.shadowTree.input||this.buildFormField(),this.shadowTree.input.value=this.getValue()):this.shadowTree.input&&(this.shadowTree.input.parentNode.removeChild(this.shadowTree.input),this.shadowTree.input=null))},SelectorBinding.prototype._attachSelections=function(){var a=this._popupBinding;this._isUpToDate||(a.attachRecursive(),this._isUpToDate=!0)},SelectorBinding.prototype.handleElement=function(){return!0},SelectorBinding.prototype.updateElement=function(a,b){return this.bindingWindow.UpdateManager.addUpdate(new this.bindingWindow.ReplaceUpdate(this.getID(),a)),!0},SelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:selector",a);return UserInterface.registerBinding(b,SelectorBinding)},SimpleSelectorBinding.prototype=new DataBinding,SimpleSelectorBinding.prototype.constructor=SimpleSelectorBinding,SimpleSelectorBinding.superclass=DataBinding.prototype,SimpleSelectorBinding.prototype.toString=function(){return"[SimpleSelectorBinding]"},SimpleSelectorBinding.prototype.onBindingRegister=function(){SimpleSelectorBinding.superclass.onBindingRegister.call(this);var a=this.getProperty("name");null!=a&&this.setName(a)},SimpleSelectorBinding.prototype.onBindingAttach=function(){SimpleSelectorBinding.superclass.onBindingAttach.call(this),this._select=this.getChildElementByLocalName("select");var a=this.getName();null!=a&&(this._select.name=a),this._parseDOMProperties(),this._buildDOMContent()},SimpleSelectorBinding.prototype._parseDOMProperties=function(){var a=this.getProperty("onchange");this.isRequired=1==this.getProperty("required"),this.hasCallBackID()&&(this._select.id=this.getCallBackID()),a&&(this.onValueChange=function(){Binding.evaluate(a,this)})},SimpleSelectorBinding.prototype._buildDOMContent=function(){this.bindingElement.tabIndex=0,1==Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this;this._select.onchange=function(){a.onValueChange(),a.dirty(),a._isValid||a.validate()},this._select.onfocus=function(){a.focus(!0)},Client.isExplorer&&this._buildDOMContentIE()},SimpleSelectorBinding.prototype._buildDOMContentIE=function(){if(Client.isExplorer){this.bindingElement.style.height=this.bindingElement.offsetHeight+"px",this._cachewidth=this._select.offsetWidth,this._select.style.position="absolute";var a=this;this._select.onmouseover=function(){a.isFocused||a._hack(!0)},this._select.onmouseout=function(){a.isFocused||a._hack(!1)}}},SimpleSelectorBinding.prototype.onValueChange=function(){},SimpleSelectorBinding.prototype.focus=function(a){SimpleSelectorBinding.superclass.focus.call(this),this.isFocused&&(a||(FocusBinding.focusElement(this._select),Client.isExplorer&&this._hack(!0)),this.bindingWindow.standardEventHandler.enableNativeKeys(!1))},SimpleSelectorBinding.prototype.blur=function(){SimpleSelectorBinding.superclass.blur.call(this),this.isFocused||(this._select.blur(),this.bindingWindow.standardEventHandler.disableNativeKeys(),Client.isExplorer&&this._hack(!1),this.isRequired&&this.validate())},SimpleSelectorBinding.prototype._hack=function(a){Client.isExplorer&&(this._select.style.width=a?"auto":this._cachewidth+"px",a&&this._select.offsetWidth<=this._cachewidth&&this._hack(!1))},SimpleSelectorBinding.prototype.validate=function(){var a=!0;if(this.isRequired&&null==this.getValue()&&(a=!1),a!=this._isValid){if(a)this.detachClassName(DataBinding.CLASSNAME_INVALID);else{this.attachClassName(DataBinding.CLASSNAME_INVALID);var b=this._select,c=b.options[b.selectedIndex],d=DOMUtil.getTextContent(c);b.blur(),b.style.color="#A40000",b.style.fontWeight="bold",Client.isExplorer6||DOMUtil.setTextContent(c,DataBinding.warnings.required),b.onfocus=function(){this.style.color="black",this.style.fontWeight="normal",this.onfocus=null,Client.isExplorer6||DOMUtil.setTextContent(c,d)}}this._isValid=a}return a},SimpleSelectorBinding.prototype.manifest=function(){},SimpleSelectorBinding.prototype.getValue=function(){var a=null,b=this._select,c=b.options[b.selectedIndex],d=!0;if(Client.isExplorer){var e=c.outerHTML.toLowerCase();-1==e.indexOf("value=")&&(d=!1)}return d&&(a=c.getAttribute("value")),a},SimpleSelectorBinding.prototype.setValue=function(a){},SimpleSelectorBinding.prototype.getResult=function(){return this.getValue()},SimpleSelectorBinding.prototype.setResult=function(a){this.setValue(a)},SimpleSelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_XHTML,"select",a);return UserInterface.registerBinding(b,SimpleSelectorBinding)},SelectorBindingSelection.prototype={label:null,value:null,tooltip:null,isSelected:null,imageProfile:null,menuItemBinding:null,_init:function(a,b,c,d,e){null!=a&&(this.label=String(a)),null!=b&&(this.value=String(b)),null!=d&&(this.imageProfile=d),null!=e&&(this.tooltip=e),this.isSelected=c?!0:!1}},DataInputSelectorBinding.prototype=new DataInputBinding,DataInputSelectorBinding.prototype.constructor=DataInputSelectorBinding,DataInputSelectorBinding.superclass=DataInputBinding.prototype,DataInputSelectorBinding.INDICATOR_IMAGE="popup",DataInputSelectorBinding.ACTION_SELECTIONCHANGED="datainputselectorselectionchanged",DataInputSelectorBinding.prototype.toString=function(){return"[DataInputSelectorBinding]"},DataInputSelectorBinding.prototype.onBindingDispose=SelectorBinding.prototype.onBindingDispose,DataInputSelectorBinding.prototype._buildDOMContent=function(){DataInputSelectorBinding.superclass._buildDOMContent.call(this),this.buildButton(),this.buildPopup(),this.buildSelections()},DataInputSelectorBinding.prototype.onBindingAttach=function(){DataInputSelectorBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image");a&&this.setImage(a);var b=this;DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DOUBLECLICK,{handleEvent:function(a){b.isReadOnly&&(b.shadowTree.input.value=b.value,b.setReadOnly(!1),b.focus())}})},DataInputSelectorBinding.prototype.buildButton=function(){var a=this.addFirst(ToolBarButtonBinding.newInstance(this.bindingDocument));a.popupBindingTargetElement=this.shadowTree.box,a.setImage(DataInputSelectorBinding.INDICATOR_IMAGE),a.attach();var b=this;a.oncommand=function(){b._attachSelections()},this._buttonBinding=a},DataInputSelectorBinding.prototype.buildPopup=SelectorBinding.prototype.buildPopup,DataInputSelectorBinding.prototype.buildSelections=function(){var a=new List,b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");new List(b).each(function(b){if(b.getAttribute("label"))throw"label not supported - use value property!";var c=b.getAttribute("value"),d=b.getAttribute("selected"),e=b.getAttribute("tooltip");a.add({value:c?c:null,toolTip:e?e:null,isSelected:d&&"true"==d?!0:!1})}),this.populateFromList(a)},DataInputSelectorBinding.prototype.populateFromList=function(a){for(var b=this._menuBodyBinding,c=b.bindingDocument;b.bindingElement.hasChildNodes();){var d=b.bindingElement.lastChild;d.nodeType==Node.ELEMENT_NODE&&UserInterface.hasBinding(d)?UserInterface.getBinding(d).dispose():b.removeChild(d)}if(a.hasEntries()){this._isUpToDate=!1,this._buttonBinding.isVisible||this._buttonBinding.show();var e=this.getProperty("emptyentrylabel");if(e){var f=MenuItemBinding.newInstance(c);f.setLabel(e),f.selectionValue="",b.add(f)}for(;a.hasNext();){var g=a.getNext(),f=MenuItemBinding.newInstance(c);f.setLabel(g.label?g.label:g.value),f.selectionValue=g.value,g.image&&f.setImage(g.image),g.toolTip&&f.setToolTip(g.toolTip),g.isSelected?this.select(_selectedItemBinding,!0):g.value&&g.value===this.getValue()&&(this._selectedItemBinding=f),b.add(f)}}else this._buttonBinding.hide()},DataInputSelectorBinding.prototype.handleAction=SelectorBinding.prototype.handleAction,DataInputSelectorBinding.prototype._onButtonCommand=function(){this.focus(),this._restoreSelection(),this.dispatchAction(SelectorBinding.ACTION_COMMAND)},DataInputSelectorBinding.prototype._onPopupShowing=function(){this._fitMenuToSelector(),this._restoreSelection(),this._releaseKeyboard()},DataInputSelectorBinding.prototype._onMenuItemCommand=function(a){this.select(a),FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()},DataInputSelectorBinding.prototype.handleBroadcast=function(a,b){switch(SelectorBinding.prototype.handleBroadcast.call(this,a,b),a){case BroadcastMessages.MOUSEEVENT_MOUSEDOWN:b!=this._buttonBinding&&DataInputSelectorBinding.superclass.handleBroadcast.call(this,a,b)}},DataInputSelectorBinding.prototype._grabKeyboard=SelectorBinding.prototype._grabKeyboard,DataInputSelectorBinding.prototype._releaseKeyboard=SelectorBinding.prototype._releaseKeyboard,DataInputSelectorBinding.prototype._handleArrowKey=SelectorBinding.prototype._handleArrowKey,DataInputSelectorBinding.prototype.focus=function(a){this.isFocused||(DataInputSelectorBinding.superclass.focus.call(this,a),1==this.isFocused&&this._grabKeyboard())},DataInputSelectorBinding.prototype.blur=function(a){1==this.isFocused&&(DataInputSelectorBinding.superclass.blur.call(this,a),this._releaseKeyboard(),this._popupBinding.isVisible&&this._popupBinding.hide())},DataInputSelectorBinding.prototype._fitMenuToSelector=function(){var a=this.bindingElement.offsetWidth+"px",b=this._popupBinding.bindingElement;b.style.minWidth=a},DataInputSelectorBinding.prototype._restoreSelection=function(){this._isUpToDate||this._attachSelections();var a=this._menuBodyBinding.getDescendantBindingsByLocalName("menuitem"),b=this.getValue(),c=null;a.each(function(a){a.getLabel()==b&&(c=a)}),c&&c.focus()},DataInputSelectorBinding.prototype.select=function(a,b){if(a!=this._selectedItemBinding&&(this._selectedItemBinding=a,this.setValue(a.selectionValue),this.validate(!0),!b)){this.dirty();var c=this.getProperty("onselectionchange");c&&Binding.evaluate(c,this),this.dispatchAction(DataInputSelectorBinding.ACTION_SELECTIONCHANGED)}this.shadowTree.input.focus()},DataInputSelectorBinding.prototype._attachSelections=SelectorBinding.prototype._attachSelections,DataInputSelectorBinding.prototype.setResult=DataInputSelectorBinding.prototype.setValue,DataInputSelectorBinding.prototype.onblur=function(){DataInputSelectorBinding.superclass.onblur.call(this),self.isReadOnly||this.setValue(this.getValue())},DataInputSelectorBinding.prototype.setValue=function(a){var b=(this.isReadOnly,null);if(null!=a&&""!=a&&this._menuBodyBinding)for(var c=this._menuBodyBinding.getDescendantBindingsByLocalName("menuitem");c.hasNext();){var d=c.getNext();if(d.selectionValue===a){b=d.getLabel();break}}null!=b?(this.value=a,this.shadowTree.input.value=b,this.isReadOnly||this.setReadOnly(!0)):(DataInputSelectorBinding.superclass.setValue.call(this,a),this.isReadOnly&&this.setReadOnly(!1))},DataInputSelectorBinding.prototype.getValue=function(){return this.isReadOnly?result=this.value:result=DataInputSelectorBinding.superclass.getValue.call(this),result},DataInputSelectorBinding.prototype.setImage=function(a){var b="with-image";if(0!=a){a=a?a:LabelBinding.DEFAULT_IMAGE;var c=LabelBinding.newInstance(this.bindingDocument);c.setImage(a),this.shadowTree.box.appendChild(c.bindingElement),c.attach(),this.setProperty("image",a),this.hasImage=!0,this.attachClassName(b)}else this.deleteProperty("image"),this.hasImage=!1,this.detachClassName(b)},DataInputDialogBinding.prototype=new DataInputBinding,DataInputDialogBinding.prototype.constructor=DataInputDialogBinding,DataInputDialogBinding.superclass=DataInputBinding.prototype,DataInputDialogBinding.prototype.toString=function(){return"[DataInputDialogBinding]"},DataInputDialogBinding.prototype._buildDOMContent=function(){DataInputSelectorBinding.superclass._buildDOMContent.call(this),this.buildButton()},DataInputDialogBinding.prototype.buildButton=function(){var a=ToolBarButtonBinding.newInstance(this.bindingDocument);a.setImage("${icon:popup}"),this.addFirst(a),a.attach();var b=this;a.oncommand=function(){b._isButtonClicked=!0,setTimeout(function(){b._isButtonClicked=!1},1e3);var a=b.getProperty("handle"),c=ViewDefinition.clone(a,"Generated.ViewDefinition.Handle."+KeyMaster.getUniqueKey());if(!(c instanceof DialogViewDefinition))throw"Definition was either undefine or of a non-dialog type.";c.handler={handleDialogResponse:function(a,c){if(b._isButtonClicked=!1,a==Dialog.RESPONSE_ACCEPT){b.logger.debug("Usecase scenario was hardcoded into DataInputDialogBinding#buildButton");var d=c.getFirst();b.setValue(d),b.validate(!0),b.checkDirty()}b.focus()}},c.argument.selectedResult=b.getValue(),StageBinding.presentViewDefinition(c)},DOMEvents.addEventListener(a.getBindingElement(),DOMEvents.MOUSEDOWN,{handleEvent:function(a){b._isButtonClicked=!0}}),this._dialogButtonBinding=a},DataInputDialogBinding.prototype.oncommand=function(){var a=this._dialogButtonBinding;null!=a&&a.oncommand()},DataInputDialogBinding.prototype.validate=function(a){var b=!0;return 1==this._isButtonClicked?this._isButtonClicked=!1:b=DataInputDialogBinding.superclass.validate.call(this,a),b},UrlInputDialogBinding.prototype=new DataInputDialogBinding,UrlInputDialogBinding.prototype.constructor=UrlInputDialogBinding,UrlInputDialogBinding.superclass=DataInputDialogBinding.prototype,UrlInputDialogBinding.URL_SELECTED="input link selected",UrlInputDialogBinding.prototype.toString=function(){return"[UrlInputDialogBinding]"},UrlInputDialogBinding.prototype.onBindingRegister=function(){UrlInputDialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_DOPOSTBACK)},UrlInputDialogBinding.prototype._buildDOMContent=function(){UrlInputDialogBinding.superclass._buildDOMContent.call(this)},UrlInputDialogBinding.prototype.buildButtonAndLabel=function(){if(null==this.shadowTree.labelInput){this.shadowTree.labelInput=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument),this.shadowTree.box.appendChild(this.shadowTree.labelInput),this.shadowTree.labelInput.style.display="none",this.shadowTree.labelInput.readOnly=!0;var a=this;DOMEvents.addEventListener(this.shadowTree.labelInput,DOMEvents.DOUBLECLICK,{handleEvent:function(b){a.clearLabel(),a.focus()}})}if(null==this.editButtonBinding){var b=ToolBarButtonBinding.newInstance(this.bindingDocument);b.setImage("${icon:editor-sourceview}"),b.bindingElement.style.left="3px",b.bindingElement.style.width="29px",this.addFirst(b),b.attach(),b.hide();var a=this;b.oncommand=function(){a.clearLabel(),a.focus()},this.editButtonBinding=b}},UrlInputDialogBinding.prototype.onblur=function(){UrlInputDialogBinding.superclass.onblur.call(this),this.setValue(this.getValue())},UrlInputDialogBinding.prototype.setValue=function(a){if(UrlInputDialogBinding.superclass.setValue.call(this,a),this.isAttached){if(this.compositeUrl=new Uri(a),this.compositeUrl.isMedia||this.compositeUrl.isPage||this.compositeUrl.isInternalUrl){var b=TreeService.GetCompositeUrlLabel(a);b!=a&&this.setLabel(b)}else this.clearLabel();this.dispatchAction(UrlInputDialogBinding.URL_SELECTED)}},UrlInputDialogBinding.prototype.setLabel=function(a){this.buildButtonAndLabel(),this.shadowTree.labelInput&&(a?(this.setReadOnly(!0),this.editButtonBinding.show(),
this.shadowTree.input.style.display="none",this.shadowTree.labelInput.style.display="block",this.shadowTree.labelInput.value=a):(this.setReadOnly(!1),this.editButtonBinding.hide(),this.shadowTree.input.style.display="block",this.shadowTree.labelInput.style.display="none"))},UrlInputDialogBinding.prototype.clearLabel=function(){this.setLabel()},DataInputButtonBinding.prototype=new DataInputBinding,DataInputButtonBinding.prototype.constructor=DataInputButtonBinding,DataInputButtonBinding.superclass=DataInputBinding.prototype,DataInputButtonBinding.prototype.toString=function(){return"[DataInputButtonBinding]"},DataInputButtonBinding.prototype.onBindingAttach=function(){DataInputButtonBinding.superclass.onBindingAttach.call(this),this.hasCallBackID()&&Binding.dotnetify(this)},DataInputButtonBinding.prototype._buildDOMContent=function(){DataInputButtonBinding.superclass._buildDOMContent.call(this),this.buildButton()},DataInputButtonBinding.prototype.buildButton=function(){var a=ToolBarButtonBinding.newInstance(this.bindingDocument),b=this.getProperty("image");null!=b?a.setImage(b):a.setImage("${icon:popup}"),this.addFirst(a),a.attach();var c=this;a.oncommand=function(){c.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},this.isReadOnly&&a.hide(),this._dialogButtonBinding=a},DataInputButtonBinding.prototype.oncommand=function(){var a=this._dialogButtonBinding;null!=a&&a.oncommand()},DataInputButtonBinding.prototype.setReadOnly=function(a){DataInputButtonBinding.superclass.setReadOnly.call(this,a);var b=this._dialogButtonBinding;null!=b&&(a?b.hide():b.show())},DataDialogBinding.prototype=new DataBinding,DataDialogBinding.prototype.constructor=DataDialogBinding,DataDialogBinding.superclass=DataBinding.prototype,DataDialogBinding.ACTION_COMMAND="datadialog command",DataDialogBinding.prototype.toString=function(){return"[DataDialogBinding]"},DataDialogBinding.prototype.onBindingRegister=function(){DataDialogBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.image=this.setImage,this.propertyMethodMap.label=this.setLabel,this.propertyMethodMap.tooltip=this.setToolTip,this.propertyMethodMap.handle=this.setHandle,this.propertyMethodMap.url=this.setURL,this.propertyMethodMap.value=this.setValue},DataDialogBinding.prototype.parseDOMProperties=function(){var a=1==this.getProperty("required");a&&(this.isRequired=!0)},DataDialogBinding.prototype.onBindingAttach=function(){DataDialogBinding.superclass.onBindingAttach.call(this),Binding.imageProfile(this),this._buildButton(),this.parseDOMProperties(),(null!=this.getProperty("handle")||this.getProperty("url"))&&(this._buttonBinding.setImage("${icon:popup}"),this._buttonBinding.labelBinding.attachClassName("flipped")),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0)},DataDialogBinding.prototype._buildButton=function(){var a=this.getProperty("label"),b=this.getProperty("tooltip");this._buttonBinding=this.add(ClickButtonBinding.newInstance(this.bindingDocument)),null!=a&&(null!=this.getProperty("handle")||null!=this.getProperty("url")?this._buttonBinding.setLabel(a+LabelBinding.DIALOG_INDECATOR_SUFFIX):this._buttonBinding.setLabel(a)),this.imageProfile&&(this._buttonBinding.imageProfile=this.imageProfile),null!=b&&this._buttonBinding.setToolTip(b),this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,this),this._buttonBinding.attach()},DataDialogBinding.prototype._buildIndicator=function(){var a="http://www.w3.org/2000/svg";this.shadowTree.indicatorimage=this.bindingDocument.createElementNS(a,"svg"),this.shadowTree.indicatorimage.setAttribute("viewBox","0 0 24 24"),this.shadowTree.indicatorimage.setAttribute("class","dialogindicatorimage");var b=KickStart.sprites.querySelector("#popup");if(b){var c=b.getAttribute("viewBox"),d=document.createDocumentFragment(),e=b.cloneNode(!0);c&&this.shadowTree.indicatorimage.setAttribute("viewBox",c),d.appendChild(e),this.shadowTree.indicatorimage.appendChild(d)}this._buttonBinding.bindingElement.appendChild(this.shadowTree.indicatorimage)},DataDialogBinding.prototype.handleAction=function(a){DataDialogBinding.superclass.handleAction.call(this,a);var b=a.target,c=this;switch(a.type){case ButtonBinding.ACTION_COMMAND:null==this._handler&&(this._handler={handleDialogResponse:function(a,b){if(a==Dialog.RESPONSE_ACCEPT){if(!(b instanceof DataBindingMap))throw"Invalid dialog result";c._map=b}}}),b==this._buttonBinding&&(a.consume(),this.focus(),this.fireCommand())}},DataDialogBinding.prototype.handleBroadcast=function(a,b){switch(DataDialogBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:this.fireCommand()}},DataDialogBinding.prototype.fireCommand=function(a){this.dispatchAction(this.constructor.ACTION_COMMAND);var b=this.getProperty("handle"),c=this.getURL(),d=null;null!=b||null!=a?(d=null!=a?a:ViewDefinitions[b],d instanceof DialogViewDefinition&&(d.handler=this._handler,null!=this._map&&(d.argument=this._map),StageBinding.presentViewDefinition(d))):null!=c&&(d=Dialog.invokeModal(c,this._handler,this._map)),null!=d&&(this._dialogViewHandle=d.handle,this._releaseKeyboard())},DataDialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this._buttonBinding.setLabel(a+LabelBinding.DIALOG_INDECATOR_SUFFIX)},DataDialogBinding.prototype.getLabel=function(){return this.getProperty("label")},DataDialogBinding.prototype.setImage=function(a){this.setProperty("image",a),null!=this.imageProfile&&(this.imageProfile.setDefaultImage(a),null!=this._buttonBinding&&(this._buttonBinding.imageProfile=this.imageProfile,this._buttonBinding.setImage(this._buttonBinding.imageProfile.getDefaultImage())))},DataDialogBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this._buttonBinding.setToolTip(a)},DataDialogBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},DataDialogBinding.prototype.setURL=function(a){this.setProperty("url",a)},DataDialogBinding.prototype.getURL=function(){return this.getProperty("url")},DataDialogBinding.prototype.setHandler=function(a){this._handler=a},DataDialogBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),FocusBinding.focusElement(this.bindingElement),this.isFocused&&this._grabKeyboard())},DataDialogBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this._hasKeyboard&&this._releaseKeyboard())},DataDialogBinding.prototype._grabKeyboard=function(){this._hasKeyboard||(this.subscribe(BroadcastMessages.KEY_SPACE),this._hasKeyboard=!0)},DataDialogBinding.prototype._releaseKeyboard=function(){this._hasKeyboard&&(this.unsubscribe(BroadcastMessages.KEY_SPACE),this._hasKeyboard=!1)},DataDialogBinding.prototype.validate=function(){var a=!0;if(1==this.isRequired){var b=this.getValue();(null==b||""==b)&&(a=!1),a!=this._isValid&&(a?(this.dispatchAction(Binding.ACTION_VALID),this.detachClassName(DataBinding.CLASSNAME_INVALID)):(this.dispatchAction(Binding.ACTION_INVALID),this.attachClassName(DataBinding.CLASSNAME_INVALID),this._buttonBinding.setLabel(DataBinding.warnings.required))),this._isValid=a}return a},DataDialogBinding.prototype.manifest=function(){},DataDialogBinding.prototype.getValue=function(){return null},DataDialogBinding.prototype.getResult=function(){return this._map},DataDialogBinding.prototype.setResult=function(a){if(!(a instanceof DataBindingMap))throw"Invalid argument";this._map=a},DataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datadialog",a);return UserInterface.registerBinding(b,DataDialogBinding)},PostBackDataDialogBinding.prototype=new DataDialogBinding,PostBackDataDialogBinding.prototype.constructor=PostBackDataDialogBinding,PostBackDataDialogBinding.superclass=DataDialogBinding.prototype,PostBackDataDialogBinding.ACTION_COMMAND="postbackdialog command",PostBackDataDialogBinding.prototype.onBindingAttach=function(){PostBackDataDialogBinding.superclass.onBindingAttach.call(this),Binding.dotnetify(this);var a=this;this._handler={handleDialogResponse:function(b,c){b==Dialog.RESPONSE_ACCEPT?a._onDialogAccept(c):a._onDialogCancel()}}},PostBackDataDialogBinding.prototype._onDialogAccept=function(a){a=new String(a),this.dirty(),this.setValue(encodeURIComponent(a)),this.validate(!0);var b=this;setTimeout(function(){null!=b.ondialogaccept&&b.ondialogaccept(),b.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},0)},PostBackDataDialogBinding.prototype._onDialogCancel=function(){null!=this.ondialogcancel&&this.ondialogcancel()},PostBackDataDialogBinding.prototype.getURL=function(){var a=this.getProperty("url"),b=this.getValue();return null==b&&(b=this.getProperty("defaultValue")),new String(a+b)},PostBackDataDialogBinding.prototype.manifest=function(){var a=this.getValue();null==a&&(a=""),this.shadowTree.dotnetinput.value=a},PostBackDataDialogBinding.prototype.setValue=function(a){this.setProperty("value",a)},PostBackDataDialogBinding.prototype.getValue=function(){return this.getProperty("value")},PostBackDataDialogBinding.prototype.getResult=function(){return null},PostBackDataDialogBinding.prototype.setResult=function(a){},PostBackDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:postbackdialog",a);return UserInterface.registerBinding(b,PostBackDataDialogBinding)},ViewDefinitionPostBackDataDialogBinding.prototype=new PostBackDataDialogBinding,ViewDefinitionPostBackDataDialogBinding.prototype.constructor=ViewDefinitionPostBackDataDialogBinding,ViewDefinitionPostBackDataDialogBinding.superclass=PostBackDataDialogBinding.prototype,ViewDefinitionPostBackDataDialogBinding.prototype.toString=function(){return"[ViewDefinitionPostBackDataDialogBinding]"},ViewDefinitionPostBackDataDialogBinding.prototype.fireCommand=function(){var a=this.getProperty("dialoglabel"),b=this.getProperty("providersearch"),c=this.getProperty("providerkey"),d=this.getProperty("handle"),e=this.getProperty("selectedtoken");if(null==d)throw'Attribute "handle" required.';var f=ViewDefinition.clone(d,"Generated.ViewDefinition.Handle."+KeyMaster.getUniqueKey());null!=a&&(null==f.argument&&(f.argument={}),f.argument.label=a),null!=b&&(null==f.argument&&(f.argument={}),null==f.argument.nodes&&(f.argument.nodes=[]),f.argument.nodes[0].search=b),null!=c&&(null==f.argument&&(f.argument={}),null==f.argument.nodes&&(f.argument.nodes=[]),f.argument.nodes[0].key=c),null!=e&&(null==f.argument&&(f.argument={}),f.argument.selectedToken=e),ViewDefinitionPostBackDataDialogBinding.superclass.fireCommand.call(this,f)},ViewDefinitionPostBackDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:postbackdialog",a);return UserInterface.registerBinding(b,ViewDefinitionPostBackDataDialogBinding)},NullPostBackDataDialogBinding.prototype=new DataBinding,NullPostBackDataDialogBinding.prototype.constructor=NullPostBackDataDialogBinding,NullPostBackDataDialogBinding.superclass=DataBinding.prototype,NullPostBackDataDialogBinding.LABEL_NULL="(No selection)",NullPostBackDataDialogBinding.LABEL_DEFAULT="Select",NullPostBackDataDialogBinding.VALUE_NULL="null",NullPostBackDataDialogBinding.VALUE_SELECTED="selected",NullPostBackDataDialogBinding.ACTION_COMMAND="nullpostbackdatadialog command",NullPostBackDataDialogBinding.prototype.toString=function(){return"[NullPostBackDataDialogBinding]"},NullPostBackDataDialogBinding.prototype.onBindingAttach=function(){NullPostBackDataDialogBinding.superclass.onBindingAttach.call(this),this.propertyMethodMap.label=this.setLabel;var a=this;this.propertyMethodMap.value=function(b){a._datathing.setValue(b)},this.propertyMethodMap.selectorlabel=function(){Application.isDeveloperMode&&alert("Selectorlabel property not supported yet!")},this.addActionListener(PageBinding.ACTION_DOPOSTBACK),this._buildDataDialog(),this._buildSelector()},NullPostBackDataDialogBinding.prototype._buildDataDialog=function(){this._datathing=this.add(ViewDefinitionPostBackDataDialogBinding.newInstance(this.bindingDocument)),new List(["callbackid","handle","name","providersearch","providerkey","value"]).each(function(a){this._datathing.setProperty(a,this.getProperty(a)),this.setProperty(a,null)},this);var a=this;this._datathing.ondialogcancel=function(){var b=a.getValue();""==b||null==b?a._selector.setLabel(NullPostBackDataDialogBinding.LABEL_NULL):a._selector.setLabel(a.getLabel())},this._datathing.hide(),this._datathing.attach()},NullPostBackDataDialogBinding.prototype._buildSelector=function(){this._selector=this.add(NullPostBackDataDialogSelectorBinding.newInstance(this.bindingDocument));var a=this.getProperty("value"),b=this.getProperty("selectorlabel");null==b&&(b=NullPostBackDataDialogBinding.LABEL_DEFAULT);var c=new List;c.add(new SelectorBindingSelection(NullPostBackDataDialogBinding.LABEL_NULL,NullPostBackDataDialogBinding.VALUE_NULL,null==a)),c.add(new SelectorBindingSelection(b+LabelBinding.DIALOG_INDECATOR_SUFFIX,NullPostBackDataDialogBinding.VALUE_SELECTED,null!=a,new ImageProfile({image:"${icon:popup}"}))),this._selector.master=this,this._selector.attach(),this._selector.populateFromList(c);var a=this.getValue();""==a||null==a?this._selector.setLabel(NullPostBackDataDialogBinding.LABEL_NULL):this._selector.setLabel(this.getLabel())},NullPostBackDataDialogBinding.prototype.handleAction=function(a){switch(NullPostBackDataDialogBinding.superclass.handleAction.call(this,a),a.type){case PageBinding.ACTION_DOPOSTBACK:if(a.target==this._datathing){var b=this.getProperty("label");this._selector.setLabel(""),this.dispatchAction(PageBinding.ACTION_DOPOSTBACK);var c=this;setTimeout(function(){c.getProperty("label")==b&&c._selector.setLabel(b)},500),a.consume()}}},NullPostBackDataDialogBinding.prototype.getLabel=function(){return this.getProperty("label")},NullPostBackDataDialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),null!=this._selector&&this._selector.setLabel(a)},NullPostBackDataDialogBinding.prototype.getValue=function(){return this._datathing.getValue()},NullPostBackDataDialogBinding.prototype.setValue=function(a){this._datathing.setValue(a),this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},NullPostBackDataDialogBinding.prototype.action=function(){new List(["selectedtoken"]).each(function(a){this._datathing.setProperty(a,this.getProperty(a))},this),this._datathing.fireCommand()},NullPostBackDataDialogBinding.prototype.validate=function(){return!0},NullPostBackDataDialogBinding.prototype.manifest=function(){},NullPostBackDataDialogBinding.prototype.getResult=function(){},NullPostBackDataDialogBinding.prototype.setResult=function(){},NullPostBackDataDialogSelectorBinding.prototype=new SelectorBinding,NullPostBackDataDialogSelectorBinding.prototype.constructor=NullPostBackDataDialogSelectorBinding,NullPostBackDataDialogSelectorBinding.superclass=SelectorBinding.prototype,NullPostBackDataDialogSelectorBinding.prototype.toString=function(){return"[NullPostBackDataDialogSelectorBinding]"},NullPostBackDataDialogSelectorBinding.prototype.select=function(a,b){NullPostBackDataDialogSelectorBinding.superclass.select.call(this,a,!0)&&(this._buttonBinding.setImage(null),this._updateImageLayout(),this._selectionValue==NullPostBackDataDialogBinding.VALUE_SELECTED&&null!=this.master.getValue())},NullPostBackDataDialogSelectorBinding.prototype.setLabel=function(a){this._buttonBinding.setLabel(a)},NullPostBackDataDialogSelectorBinding.prototype.setToolTip=function(a){this._buttonBinding.setToolTip(a)},NullPostBackDataDialogSelectorBinding.prototype.handleAction=function(a){switch(NullPostBackDataDialogSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target,c=this.master;b.selectionValue==NullPostBackDataDialogBinding.VALUE_SELECTED?(this.setLabel(b.getLabel()),setTimeout(function(){c.action()},0)):(c.getValue()&&c.dirty(),c.setValue(""))}},NullPostBackDataDialogSelectorBinding.prototype.manifest=function(){},NullPostBackDataDialogSelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:selector",a);return UserInterface.registerBinding(b,NullPostBackDataDialogSelectorBinding)},MultiSelectorBinding.prototype=new DataBinding,MultiSelectorBinding.prototype.constructor=MultiSelectorBinding,MultiSelectorBinding.superclass=DataBinding.prototype,MultiSelectorBinding.DISPLAY_SELECTED="selected",MultiSelectorBinding.DISPLAY_UNSELECTED="unselected",MultiSelectorBinding.ACTION_COMMAND="multiselector command",MultiSelectorBinding.ACTION_SELECTIONCHANGED="multiselector selection changed",MultiSelectorBinding.prototype.toString=function(){return"[MultiSelectorBinding]"},MultiSelectorBinding.prototype.onBindingAttach=function(){MultiSelectorBinding.superclass.onBindingAttach.call(this),this.selections=this._getSelectionsList(),this.addActionListener(DataDialogBinding.ACTION_COMMAND),this.addActionListener(MultiSelectorDataDialogBinding.ACTION_RESULT),this.addEventListener(DOMEvents.MOUSEDOWN),this._buildDOMContent(),this._parseDOMProperties(),this.populateFromList(this.selections);var a=this._dataDialogBinding;null!=a&&DOMEvents.addEventListener(this.shadowTree.box,DOMEvents.DOUBLECLICK,{handleEvent:function(){a.fireCommand()}})},MultiSelectorBinding.prototype._buildDOMContent=function(){this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.box)},MultiSelectorBinding.prototype._parseDOMProperties=function(){var a=this.getProperty("editable"),b=this.getProperty("selectable"),c=this.getProperty("display");0!=a?this._buildEditorButton():this.isEditable=!1,b&&(this.isSelectable=!0,this._selectionMap=new Map),c&&(this._display=c)},MultiSelectorBinding.prototype._buildEditorButton=function(){if(this.isEditable){var a=MultiSelectorDataDialogBinding.newInstance(this.bindingDocument);a.selections=this.selections,this.add(a),a.attach(),this._dataDialogBinding=a,this.shadowTree.datadialog=a}},MultiSelectorBinding.prototype.populateFromList=function(a){a.reset();var b=!1;for(this.shadowTree.box.innerHTML="";a.hasNext();){var c=a.getNext();switch(this._display){case MultiSelectorBinding.DISPLAY_SELECTED:b=c.isSelected;break;case MultiSelectorBinding.DISPLAY_UNSELECTED:b=1!=c.isSelected}b&&this.shadowTree.box.appendChild(this._getElementForSelection(c))}this.selections=a,this._dataDialogBinding&&(this._dataDialogBinding.selections=this.selections)},MultiSelectorBinding.prototype.cumulateFromList=function(a,b){var c=this.shadowTree.box,d=!1;if(a.hasEntries()){for(a.reverse().reset();a.hasNext();){var e=a.getNext();if(b)e.isSelected=this._display==MultiSelectorBinding.DISPLAY_SELECTED,d=!0;else switch(this._display){case MultiSelectorBinding.DISPLAY_SELECTED:d=e.isSelected;break;case MultiSelectorBinding.DISPLAY_UNSELECTED:d=1!=e.isSelected}if(d){var f=this._getElementForSelection(e);c.insertBefore(f,c.firstChild),CSSUtil.attachClassName(f,"selected"),this._selectionMap.set(e.value,f)}}this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED)}},MultiSelectorBinding.prototype._getElementForSelection=function(a){var b=DOMUtil.createElementNS(Constants.NS_XHTML,"div",this.bindingDocument);return b.appendChild(this.bindingDocument.createTextNode(a.label)),b.setAttribute("label",a.label),b.setAttribute("value",a.value),b},MultiSelectorBinding.prototype.hasHighlight=function(){return this._selectionMap&&this._selectionMap.hasEntries()},MultiSelectorBinding.prototype.handleEvent=function(a){switch(MultiSelectorBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.MOUSEDOWN:if(this.isFocused||this.focus(),this.isSelectable){var b=DOMEvents.getTarget(a),c=DOMUtil.getLocalName(b);"div"==c&&(this._handleMouseDown(b),this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED))}}},MultiSelectorBinding.prototype._handleMouseDown=function(a){if(Keyboard.isShiftPressed&&this._lastSelectedElement)for(var b=this._getElements(),c=a.getAttribute("value"),d=this._lastSelectedElement.getAttribute("value"),e=!1;b.hasNext();){var f=b.getNext();switch(f.getAttribute("value")){case c:case d:e=!e}e?this._hilite(f):this._unhilite(f),this._hilite(this._lastSelectedElement),this._hilite(a)}else if(Keyboard.isControlPressed&&this._isHilited(a)?this._unhilite(a):this._hilite(a),!Keyboard.isControlPressed){var g=this;this._getElements().each(function(b){b!=a&&g._unhilite(b)})}this._lastSelectedElement=a},MultiSelectorBinding.prototype._hilite=function(a){var b=a.getAttribute("value");this._selectionMap.has(b)||(CSSUtil.attachClassName(a,"selected"),this._selectionMap.set(b,a))},MultiSelectorBinding.prototype._unhilite=function(a){var b=a.getAttribute("value");this._selectionMap.has(b)&&(CSSUtil.detachClassName(a,"selected"),this._selectionMap.del(b))},MultiSelectorBinding.prototype._isHilited=function(a){return CSSUtil.hasClassName(a,"selected")},MultiSelectorBinding.prototype.handleAction=function(a){MultiSelectorBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case DataDialogBinding.ACTION_COMMAND:b==this._dataDialogBinding&&(this.isFocused||this.focus(),this.dispatchAction(MultiSelectorBinding.ACTION_COMMAND),a.consume());break;case MultiSelectorDataDialogBinding.ACTION_RESULT:this.populateFromList(b.result),this.dirty(),b.result=null,a.consume()}},MultiSelectorBinding.prototype.extractSelected=function(){var a=null;if(this.isSelectable&&(a=new List,this._selectionMap&&this._selectionMap.hasEntries())){var b=this;this._getElements().each(function(c){b._isHilited(c)&&(c.parentNode.removeChild(c),a.add(new SelectorBindingSelection(c.getAttribute("label"),c.getAttribute("value"),!0)))}),this._selectionMap=new Map,this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED)}return a},MultiSelectorBinding.prototype.reposition=function(a){var b=this._getElements();a||b.reverse();for(var c=!0;c&&b.hasNext();){var d=b.getNext();if(this._isHilited(d))switch(a){case!0:d.previousSibling?d.parentNode.insertBefore(d,d.previousSibling):c=!1;break;case!1:d.nextSibling?d.parentNode.insertBefore(d,d.nextSibling.nextSibling):c=!1}}},MultiSelectorBinding.prototype.toSelectionList=function(){var a=new List,b=this._display==MultiSelectorBinding.DISPLAY_SELECTED,c=this;return this._getElements().each(function(d){var e=new SelectorBindingSelection(d.getAttribute("label"),d.getAttribute("value"),b);e.isHighlighted=c._isHilited(d),a.add(e)}),a},MultiSelectorBinding.prototype._getElements=function(){return this.shadowTree.box?new List(DOMUtil.getElementsByTagName(this.shadowTree.box,"div")):new List},MultiSelectorBinding.prototype._getSelectionsList=SelectorBinding.prototype._getSelectionsList,MultiSelectorBinding.prototype.validate=function(){return!0},MultiSelectorBinding.prototype.manifest=function(){var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"input"));for(a.hasEntries()&&a.each(function(a){a.parentNode.removeChild(a)}),this.selections.reset();this.selections.hasNext();){var b=this.selections.getNext();if(b.isSelected){var c=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);c.name=this._name,c.value=b.value,this.bindingElement.appendChild(c)}}},MultiSelectorBinding.prototype.getValue=function(){return"HEJ!"},MultiSelectorBinding.prototype.setValue=function(a){alert(a)},MultiSelectorBinding.prototype.getResult=function(){return alert("TODO: MultiSelectorBinding#getResult"),new Array},MultiSelectorBinding.prototype.setResult=function(a){alert("TODO: MultiSelectorBinding#setResult")},HierarchicalSelectorBinding.prototype=new DataBinding,HierarchicalSelectorBinding.prototype.constructor=HierarchicalSelectorBinding,HierarchicalSelectorBinding.superclass=DataBinding.prototype,HierarchicalSelectorBinding.DISPLAY_SELECTED="selected",HierarchicalSelectorBinding.DISPLAY_UNSELECTED="unselected",HierarchicalSelectorBinding.ACTION_COMMAND="HierarchicalSelector command",HierarchicalSelectorBinding.ACTION_SELECTIONCHANGED="HierarchicalSelector selection changed",HierarchicalSelectorBinding.prototype.toString=function(){return"[HierarchicalSelectorBinding]"},HierarchicalSelectorBinding.prototype.onBindingAttach=function(){HierarchicalSelectorBinding.superclass.onBindingAttach.call(this),this.addActionListener(CheckTreeNodeBinding.ACTION_COMMAND),this._buildDOMContent(),this._parseDOMProperties(),this._populate();var a=UserInterface.getBinding(this.bindingElement.parentNode);null!=a&&a instanceof DialogPageBodyBinding&&1===a.bindingElement.children.length&&a.attachClassName(DialogPageBodyBinding.FILLED_CLASSNAME)},HierarchicalSelectorBinding.prototype.onBindingInitialize=function(){HierarchicalSelectorBinding.superclass.onBindingInitialize.call(this),this.shadowTree.tree.attachRecursive()},HierarchicalSelectorBinding.prototype._buildDOMContent=function(){this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.box)},HierarchicalSelectorBinding.prototype._parseDOMProperties=function(){this.autoSelectChildren=this.getProperty("autoselectchildren")===!0,this.isRequired=this.getProperty("required")===!0},HierarchicalSelectorBinding.prototype._populate=function(){this.shadowTree.tree=CheckTreeBinding.newInstance(this.bindingDocument),this.shadowTree.box.appendChild(this.shadowTree.tree.bindingElement),this._populateFromSelections(this.shadowTree.tree,this.bindingElement),this.shadowTree.tree.attachRecursive(),this.shadowTree.tree.addActionListener(TreeNodeBinding.ACTION_OPEN,this)},HierarchicalSelectorBinding.prototype._populateFromSelections=function(a,b){var c=DOMUtil.getChildElementsByLocalName(b,"selection"),d=null;c.each(function(b){d=CheckTreeNodeBinding.newInstance(this.bindingDocument);var c=b.getAttribute("label"),e=b.getAttribute("value"),f="true"===b.getAttribute("selected"),g=b.getAttribute("image"),h="true"===b.getAttribute("selectable"),i="true"===b.getAttribute("readonly");d.setLabel(c),d.setImage(g),d.imageProfile=new ImageProfile({image:g,imageHover:null,imageActive:null,imageDisabled:null}),d.setProperty("selected",f),d.selectionElement=b,d.selectionValue=e,d.isSelectable=h,d.isReadOnly=i,d.isContainer=b.hasChildNodes(),a.add(d)},this),a instanceof CheckTreeBinding&&1===c.getLength()&&(d.setProperty("open",!0),d.setProperty("pin",!0),this._populateFromSelections(d,d.selectionElement),d.hasBeenOpened=!0)},HierarchicalSelectorBinding.prototype.handleAction=function(a){HierarchicalSelectorBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case CheckTreeNodeBinding.ACTION_COMMAND:this.dirty();var b=a.target,c=b.isChecked();if(b.selectionElement.setAttribute("selected",c),(this.autoSelectChildren||this.autoSelectParents&&!c)&&(this.checkChildrenLazySelections(b,c),b.getDescendantBindingsByType(CheckTreeNodeBinding).each(function(a){a.isSelectable&&!a.isReadOnly&&(a.setChecked(c,!0),a.selectionElement.setAttribute("selected",c),this.checkChildrenLazySelections(a,c))},this)),this.autoSelectParents&&c)for(var d=b;(d=UserInterface.getBinding(d.bindingElement.parentNode))&&d instanceof CheckTreeNodeBinding;)d.isSelectable&&!d.isReadOnly&&(d.setChecked(c,!0),d.selectionElement.setAttribute("selected",c));this.hasClassName(DataBinding.CLASSNAME_INVALID)&&this.detachClassName(DataBinding.CLASSNAME_INVALID),a.consume();break;case TreeNodeBinding.ACTION_OPEN:var e=a.target;e.hasBeenOpened||(this._populateFromSelections(e,e.selectionElement),e.attachRecursive()),a.consume()}},HierarchicalSelectorBinding.prototype.checkChildrenLazySelections=function(a,b){if(a.isContainer&&!a.hasBeenOpened){var c=DOMUtil.getElementsByTagName(a.selectionElement,"selection");new List(c).each(function(a){var c="true"===a.getAttribute("selectable"),d="true"===a.getAttribute("readonly");c&&!d&&a.setAttribute("selected",b)})}},HierarchicalSelectorBinding.prototype.handleElement=function(a){return!0},HierarchicalSelectorBinding.prototype.updateElement=function(a){return!0},HierarchicalSelectorBinding.prototype.validate=function(){var a=!0;return this.isRequired&&(a=!1,this.getDescendantBindingsByType(CheckTreeNodeBinding).each(function(b){return b.isSelectable&&!b.isReadOnly&&b.isChecked()?(a=!0,!1):!0}),a===!1&&this.attachClassName(DataBinding.CLASSNAME_INVALID)),a},HierarchicalSelectorBinding.prototype.manifest=function(){var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"input"));a.hasEntries()&&a.each(function(a){a.parentNode.removeChild(a)});var b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");new List(b).each(function(a){var b="true"===a.getAttribute("selectable"),c="true"===a.getAttribute("selected"),d=a.getAttribute("value");if(b&&c){var e=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);e.name=this._name,e.value=d,this.bindingElement.appendChild(e)}},this)},HierarchicalSelectorBinding.prototype.getValue=function(){return null},HierarchicalSelectorBinding.prototype.setValue=function(a){},HierarchicalSelectorBinding.prototype.getResult=function(){return new Array},HierarchicalSelectorBinding.prototype.setResult=function(a){},HTMLDataDialogBinding.prototype=new PostBackDataDialogBinding,HTMLDataDialogBinding.prototype.constructor=HTMLDataDialogBinding,HTMLDataDialogBinding.superclass=PostBackDataDialogBinding.prototype,HTMLDataDialogBinding.prototype.toString=function(){return"[HTMLDataDialogBinding]"},HTMLDataDialogBinding.prototype.onBindingAttach=function(){null==this.getProperty("label")&&this.setProperty("label","Edit HTML"),HTMLDataDialogBinding.superclass.onBindingAttach.call(this)},HTMLDataDialogBinding.prototype.fireCommand=function(){this.dispatchAction(DataDialogBinding.ACTION_COMMAND);var a={label:DataBinding.getAssociatedLabel(this),value:decodeURIComponent(this.getValue()),configuration:{formattingconfiguration:this.getProperty("formattingconfiguration"),embedablefieldstypenames:this.getProperty("embedablefieldstypenames"),previewtemplateid:this.getProperty("previewtemplateid"),previewplaceholder:this.getProperty("previewplaceholder"),previewpageid:this.getProperty("previewpageid")}},b=ViewDefinitions["Composite.Management.VisualEditorDialog"];b.handler=this._handler,b.argument=a,StageBinding.presentViewDefinition(b),this._releaseKeyboard()},MultiSelectorDataDialogBinding.prototype=new DataDialogBinding,MultiSelectorDataDialogBinding.prototype.constructor=MultiSelectorDataDialogBinding,MultiSelectorDataDialogBinding.superclass=DataDialogBinding.prototype,MultiSelectorDataDialogBinding.ACTION_RESULT="multiselectordatadialog result",MultiSelectorDataDialogBinding.prototype.toString=function(){return"[MultiSelectorDataDialogBinding]"},MultiSelectorDataDialogBinding.prototype.onBindingAttach=function(){this.setProperty("label",StringBundle.getString("ui","Website.Misc.MultiSelector.LabelEditSelections")),MultiSelectorDataDialogBinding.superclass.onBindingAttach.call(this)},MultiSelectorDataDialogBinding.prototype.fireCommand=function(){this.dispatchAction(DataDialogBinding.ACTION_COMMAND);var a={label:DataBinding.getAssociatedLabel(this),selections:this.selections},b=this,c={handleDialogResponse:function(a,c){a==Dialog.RESPONSE_ACCEPT&&(b.result=c,b.dispatchAction(MultiSelectorDataDialogBinding.ACTION_RESULT))}},d=ViewDefinitions[this._dialogViewHandle];d.handler=c,d.argument=a,StageBinding.presentViewDefinition(d)},MultiSelectorDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datadialog",a);return UserInterface.registerBinding(b,MultiSelectorDataDialogBinding)},LazyBindingSetBinding.prototype=new Binding,LazyBindingSetBinding.prototype.constructor=LazyBindingSetBinding,LazyBindingSetBinding.superclass=Binding.prototype,LazyBindingSetBinding.prototype.toString=function(){return"[LazyBindingSetBinding]"},LazyBindingBinding.prototype=new DataBinding,LazyBindingBinding.prototype.constructor=LazyBindingBinding,LazyBindingBinding.superclass=DataBinding.prototype,LazyBindingBinding.ID_APPENDIX="lazybinding",LazyBindingBinding.wakeUp=function(a){
var b=a.bindingElement.id+LazyBindingBinding.ID_APPENDIX,c=a.bindingDocument.getElementById(b);if(null!=c){var d=UserInterface.getBinding(c);d.setResult(!0)}},LazyBindingBinding.prototype.toString=function(){return"[LazyBindingBinding]"},LazyBindingBinding.prototype.onBindingRegister=function(){LazyBindingBinding.superclass.onBindingRegister.call(this);var a=this.getProperty("bindingid");if(null!=a){var b=this.bindingDocument.getElementById(a);if(null!=b){var c=UserInterface.getBinding(b);c&&!c.isAttached?c.isLazy=!0:b.setAttribute("lazy",!0)}}},LazyBindingBinding.prototype.validate=function(){return!0},LazyBindingBinding.prototype.manifest=function(){this.isAttached&&(null==this.shadowTree.input&&(this.shadowTree.input=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument),this.shadowTree.input.type="hidden",this.shadowTree.input.name=this.getName(),this.bindingElement.appendChild(this.shadowTree.input)),this.shadowTree.input.value=this.getValue())},LazyBindingBinding.prototype.getValue=function(){return String(this._isLazy)},LazyBindingBinding.prototype.setValue=function(){throw"Not implemented"},LazyBindingBinding.prototype.getResult=function(){return this._isLazy},LazyBindingBinding.prototype.setResult=function(a){this._isLazy=a},EditorDataBinding.prototype=new WindowBinding,EditorDataBinding.prototype.constructor=EditorDataBinding,EditorDataBinding.superclass=WindowBinding.prototype,EditorDataBinding.prototype.toString=function(){return"[EditorDataBinding]"},EditorDataBinding.prototype.onBindingRegister=function(){EditorDataBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)).attach();var a=this._url,b=this.getProperty("stateprovider"),c=this.getProperty("handle");a=null!=b&&null!=c?a.replace("${stateprovider}",b).replace("${handle}",c):a.split("?")[0],this.logger.debug("Loading URL: "+a),this.setURL(a)},EditorDataBinding.prototype.onBindingAttach=function(){EditorDataBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_DIRTY),Application.lock(this)},EditorDataBinding.prototype._onPageInitialize=function(a){EditorDataBinding.superclass._onPageInitialize.call(this,a),null!=this._pageBinding&&(Application.unlock(this),this._coverBinding.hide())},EditorDataBinding.prototype.setName=DataBinding.prototype.setName,EditorDataBinding.prototype.validate=function(){return this._pageBinding.validateAllDataBindings()},EditorDataBinding.prototype.handleAction=function(a){switch(EditorDataBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DIRTY:a.target!=this&&(this.isDirty||this.dirty(),a.consume())}},EditorDataBinding.prototype.manifest=function(){},EditorDataBinding.prototype.dirty=function(){this.isDirty||(this.isDirty=!0,this.dispatchAction(Binding.ACTION_DIRTY))},EditorDataBinding.prototype.clean=function(){this._pageBinding.cleanAllDataBindings(),DataBinding.prototype.clean.call(this)},EditorDataBinding.prototype.focus=function(){},EditorDataBinding.prototype.blur=function(){},EditorDataBinding.prototype.getName=function(){},EditorDataBinding.prototype.getValue=function(){},EditorDataBinding.prototype.setValue=function(a){},EditorDataBinding.prototype.getResult=function(){return null},EditorDataBinding.prototype.setResult=function(a){},FunctionEditorDataBinding.prototype=new EditorDataBinding,FunctionEditorDataBinding.prototype.constructor=FunctionEditorDataBinding,FunctionEditorDataBinding.superclass=EditorDataBinding.prototype,FunctionEditorDataBinding.prototype.toString=function(){return"[FunctionEditorDataBinding]"},FunctionEditorDataBinding.prototype.onBindingAttach=function(){FunctionEditorDataBinding.superclass.onBindingAttach.call(this),this.getProperty("hasbasic")&&(this.hasBasic=this.getProperty("hasbasic"))},FunctionEditorDataBinding.prototype._onPageInitialize=function(a){if(FunctionEditorDataBinding.superclass._onPageInitialize.call(this,a),this.hasBasic===!1){var b=this.getContentWindow().bindingMap.basicgroup;b&&b.hide()}},ParameterEditorDataBinding.prototype=new EditorDataBinding,ParameterEditorDataBinding.prototype.constructor=ParameterEditorDataBinding,ParameterEditorDataBinding.superclass=EditorDataBinding.prototype,ParameterEditorDataBinding.prototype.toString=function(){return"[ParameterEditorDataBinding]"},ParameterEditorDataBinding.prototype.getValue=function(){return Math.random()},FilePickerBinding.prototype=new DataBinding,FilePickerBinding.prototype.constructor=FilePickerBinding,FilePickerBinding.superclass=DataBinding.prototype,FilePickerBinding.prototype.toString=function(){return"[FilePickerBinding]"},FilePickerBinding.prototype.onBindingAttach=function(){FilePickerBinding.superclass.onBindingAttach.call(this);var a=this.getDescendantElementsByLocalName("input").getLast(),b=this.getDescendantBindingByLocalName("datainput");b.isFocusable=!1;var c=this;a.onchange=function(){var a=this.value;a.indexOf("/")>-1?a=a.substring(a.lastIndexOf("/")+1):a.indexOf("\\")>-1&&(a=a.substring(a.lastIndexOf("\\")+1)),b.setValue(a),c.dirty(),c._isValid||c.validate()}},FilePickerBinding.prototype.validate=function(){var a=!0;if(this.getProperty("required")){var b=this.getDescendantBindingByLocalName("datainput");a=""!=b.getValue()}return!a&&this._isValid?(this._isValid=!1,this.dispatchAction(Binding.ACTION_INVALID)):a&&!this._isValid&&this.dispatchAction(Binding.ACTION_VALID),a},FilePickerBinding.prototype.focus=function(){if(FilePickerBinding.superclass.focus.call(this),this.isFocused){var a=this.getDescendantBindingByLocalName("datainput");null!=a&&a.attachClassName(DataBinding.CLASSNAME_FOCUSED)}},FilePickerBinding.prototype.blur=function(){if(FilePickerBinding.superclass.blur.call(this),!this.isFocused){var a=this.getDescendantBindingByLocalName("datainput");null!=a&&a.detachClassName(DataBinding.CLASSNAME_FOCUSED)}},FilePickerBinding.prototype.manifest=function(){},FilePickerBinding.prototype.getValue=function(){},FilePickerBinding.prototype.setValue=function(){},FilePickerBinding.prototype.getResult=function(){},FilePickerBinding.prototype.setResult=function(){},RequestBinding.prototype=new Binding,RequestBinding.prototype.constructor=RequestBinding,RequestBinding.superclass=Binding.prototype,RequestBinding.CALLBACK_ID="__REQUEST",RequestBinding.INPUT_ID="__CONSOLEID",RequestBinding.prototype.toString=function(){return"[RequestBinding]"},RequestBinding.prototype.onBindingAttach=function(){RequestBinding.superclass.onBindingAttach.call(this),this.setCallBackID(RequestBinding.CALLBACK_ID),Binding.dotnetify(this);var a=this.bindingDocument.getElementById(RequestBinding.INPUT_ID);null!=a&&(a.value=Application.CONSOLE_ID)},RequestBinding.prototype.postback=function(a){a=null!=a?a:EditorPageBinding.message,this.shadowTree.dotnetinput.value=a,this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},FieldGroupBinding.prototype=new Binding,FieldGroupBinding.prototype.constructor=FieldGroupBinding,FieldGroupBinding.superclass=Binding.prototype,FieldGroupBinding.ACTION_HIDE="fieldgrouphide",FieldGroupBinding.CLASSNAME_NOLABEL="nolabel",FieldGroupBinding.CLASSNAME_FIRST="first",FieldGroupBinding.prototype.toString=function(){return"[FieldGroupBinding]"},FieldGroupBinding.prototype.onBindingRegister=function(){FieldGroupBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.label=this.setLabel,this._buildDOMContent()},FieldGroupBinding.prototype._buildDOMContent=function(){var a=this.getProperty("label");a?this.setLabel(a):this.attachClassName(FieldGroupBinding.CLASSNAME_NOLABEL);var b=this.bindingElement.getElementsByTagName("field");b.length||(b=this.bindingElement.getElementsByTagName("ui:field"));var c=b[0];c&&(c.className+=" first")},FieldGroupBinding.prototype.setLabel=function(a){if(this.setProperty("label",a),null==this.shadowTree.labelBinding){var b=LabelBinding.newInstance(this.bindingDocument);this.shadowTree[FieldGroupBinding.NORTH];b.attachClassName("fieldgrouplabel"),this.bindingElement.insertBefore(b.bindingElement,this.bindingElement.firstChild),b.attach(),this.shadowTree.labelBinding=b,this.shadowTree.labelBinding.bindingElement.appendChild(DOMUtil.createElementNS(Constants.NS_XHTML,"div",this.bindingDocument))}this.shadowTree.labelBinding.setLabel(Resolver.resolve(a))},FieldGroupBinding.prototype.getLabel=function(){return this.getProperty("label")},FieldBinding.prototype=new Binding,FieldBinding.prototype.constructor=FieldBinding,FieldBinding.superclass=Binding.prototype,FieldBinding.prototype.toString=function(){return"[FieldBinding]"},FieldBinding.prototype.onBindingRegister=function(){FieldBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT);var a=this.getProperty("relation");null!=a&&(this.bindingRelation=a,this.subscribe(BroadcastMessages.BINDING_RELATE),this.hide())},FieldBinding.prototype.handleBroadcast=function(a,b){switch(FieldBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.BINDING_RELATE:b.relate==this.bindingRelation&&b.origin==this.bindingDocument&&(1==b.result?this.isVisible||(this.show(),this.dispatchAction(Binding.ACTION_UPDATED)):this.isVisible&&(this.hide(),this.dispatchAction(Binding.ACTION_UPDATED)))}},FieldBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:field",a);return UserInterface.registerBinding(b,FieldBinding)},FieldsBinding.prototype=new Binding,FieldsBinding.prototype.constructor=FieldsBinding,FieldsBinding.superclass=Binding.prototype,FieldsBinding.ACTION_LAYOUT_UPDATED="fieldslayoutupdated",FieldsBinding.prototype.toString=function(){return"[FieldsBinding]"},FieldsBinding.prototype.onBindingRegister=function(){FieldsBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(FieldGroupBinding.ACTION_HIDE),this._invalidFieldLabels=new Map},FieldsBinding.prototype.onBindingInitialize=function(){FieldsBinding.superclass.onBindingInitialize.call(this),this.bindingElement.style.display="block";var a=this.getDescendantBindingByLocalName("fieldgroup");null!=a&&a.attachClassName(FieldGroupBinding.CLASSNAME_FIRST)},FieldsBinding.prototype.onBindingDispose=function(){FieldsBinding.superclass.onBindingDispose.call(this),this._invalidCount>0&&this.dispatchAction(Binding.ACTION_VALID)},FieldsBinding.prototype.validate=function(){for(var a=!0,b=this.getDescendantBindingsByLocalName("*");b.hasNext();){var c=b.getNext();if(Interfaces.isImplemented(IData,c)){var d=c.validate();a&&!d&&(a=!1)}}return a},FieldsBinding.prototype.handleAction=function(a){FieldsBinding.superclass.handleAction.call(this,a);var b=a.target;if(b!=this)switch(a.type){case Binding.ACTION_INVALID:var c=DataBinding.getAssociatedLabel(b);c&&this._invalidFieldLabels.set(b.key,c),b.error&&(b.isInvalidBecauseRequired||ErrorBinding.presentError({text:b.error},b)),0==this._invalidCount&&this.dispatchAction(Binding.ACTION_INVALID),this._invalidCount++,a.consume();break;case Binding.ACTION_VALID:this._invalidFieldLabels.has(b.key)&&this._invalidFieldLabels.del(b.key),this._invalidCount--,0==this._invalidCount&&this.dispatchAction(Binding.ACTION_VALID),a.consume()}},FieldsBinding.prototype.getInvalidLabels=function(){var a=null;return this._invalidFieldLabels.hasEntries()&&(a=this._invalidFieldLabels.toList()),a},FieldsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fields",a);return UserInterface.registerBinding(b,FieldsBinding)},FieldDescBinding.prototype=new Binding,FieldDescBinding.prototype.constructor=FieldDescBinding,FieldDescBinding.superclass=Binding.prototype,FieldDescBinding.prototype.toString=function(){return"[FieldDescBinding]"},FieldDescBinding.prototype.onBindingAttach=function(){Binding.prototype.onBindingAttach.call(this),this.buildDOMContent(),this.attachDOMEvents()},FieldDescBinding.prototype.buildDOMContent=function(){var a=this.getProperty("image");a&&this.setImage(a);var b=this.getProperty("tooltip");b&&this.setToolTip(b);var c=this.getProperty("label");c&&this.setLabel(c)},FieldDescBinding.prototype.attachDOMEvents=function(){this.addEventListener(DOMEvents.CLICK)},FieldDescBinding.prototype.handleEvent=function(a){switch(FieldDescBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.CLICK:var b=this.getAncestorBindingByLocalName("field");if(b){var c=!0;b.getDescendantBindingsByLocalName("*").each(function(a){return Interfaces.isImplemented(IData,a)&&(a.focus(),c=!1),c})}}},FieldDescBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&(this.bindingElement.innerHTML=Resolver.resolve(a))},FieldDescBinding.prototype.getLabel=function(){var a=this.getProperty("label");if(!a){var b=this.bindingElement.firstChild;b&&b.nodeType==Node.TEXT_NODE&&(a=b.data)}return a},FieldDescBinding.prototype.setImage=function(a){if(this.setProperty("image",a),this.isAttached)throw"FieldDescBinding: Images not suppoerted!"},FieldDescBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&(this.bindingElement.title=a)},FieldDescBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fielddesc",a);return UserInterface.registerBinding(b,FieldDescBinding)},FieldDataBinding.prototype=new Binding,FieldDataBinding.prototype.constructor=FieldDataBinding,FieldDataBinding.superclass=Binding.prototype,FieldDataBinding.prototype.toString=function(){return"[FieldDataBinding]"},FieldDataBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fielddata",a);return UserInterface.registerBinding(b,FieldDataBinding)},FieldHelpBinding.prototype=new Binding,FieldHelpBinding.prototype.constructor=FieldHelpBinding,FieldHelpBinding.superclass=Binding.prototype,FieldHelpBinding.INDICATOR_IMAGE=null,FieldHelpBinding.prototype.toString=function(){return"[FieldHelpBinding]"},FieldHelpBinding.prototype.onBindingAttach=function(){FieldHelpBinding.superclass.onBindingAttach.call(this),this.buildPopupBinding(),this.buildPopupButton()},FieldHelpBinding.prototype.onBindingDispose=function(){FieldHelpBinding.superclass.onBindingDispose.call(this);var a=this._fieldHelpPopupBinding;a&&a.dispose()},FieldHelpBinding.prototype.buildPopupBinding=function(){var a=app.bindingMap.fieldhelpopupset,b=a.bindingDocument,c=a.add(PopupBinding.newInstance(b)),d=c.add(PopupBodyBinding.newInstance(b));if(c.position=PopupBinding.POSITION_RIGHT,c.attachClassName("fieldhelppopup"),this.bindingElement.hasChildNodes())d.bindingElement.innerHTML=this.bindingElement.innerHTML;else{var e=this.getProperty("label");e&&(d.bindingElement.innerHTML=Resolver.resolve(e))}this.bindingElement.innerHTML="",this._fieldHelpPopupBinding=c},FieldHelpBinding.prototype.buildPopupButton=function(){var a=this.getAncestorBindingByLocalName("field");a&&a.attachClassName("fieldhelp");var b=ClickButtonBinding.newInstance(this.bindingDocument);b.attachClassName("fieldhelp"),b.setImage(FieldHelpBinding.INDICATOR_IMAGE),this.add(b),b.attach();var c=this;b.oncommand=function(){c.attachPopupBinding()},b.setPopup(this._fieldHelpPopupBinding),this._fieldHelpButton=b},FieldHelpBinding.prototype.attachPopupBinding=function(){var a=this._fieldHelpPopupBinding;a&&!a.isAttached&&a.attachRecursive()},ResolverContainerBinding.prototype=new Binding,ResolverContainerBinding.prototype.constructor=ResolverContainerBinding,ResolverContainerBinding.superclass=Binding.prototype,ResolverContainerBinding.prototype.toString=function(){return"[ResolverContainerBinding]"},ResolverContainerBinding.prototype.onBindingAttach=function(){ResolverContainerBinding.superclass.onBindingAttach.call(this),new List(this.bindingElement.attributes).each(function(a){if(a.name.startsWith("data-")){var b=this.bindingDocument.getElementsByName(a.value);new List(b).each(function(b){b.setAttribute("data-qa",a.name.substring("data-".length))})}},this)},RadioDataGroupBinding.prototype=new RadioGroupBinding,RadioDataGroupBinding.prototype.constructor=RadioDataGroupBinding,RadioDataGroupBinding.superclass=RadioGroupBinding.prototype,RadioDataGroupBinding.prototype.toString=function(){return"[RadioDataGroupBinding]"},RadioDataGroupBinding.prototype.onBindingRegister=function(){RadioDataGroupBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this.addActionListener(RadioGroupBinding.ACTION_SELECTIONCHANGED,this)},RadioDataGroupBinding.prototype.onBindingAttach=function(){RadioDataGroupBinding.superclass.onBindingAttach.call(this),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this;DOMEvents.addEventListener(this.bindingElement,DOMEvents.FOCUS,{handleEvent:function(){a.focus(!0)}});var b=this.getProperty("onchange");b&&(this.onValueChange=function(){Binding.evaluate(b,this)})},RadioDataGroupBinding.prototype.onBindingDispose=function(){RadioDataGroupBinding.superclass.onBindingDispose.call(this),DataBinding.prototype.onBindingDispose.call(this)},RadioDataGroupBinding.prototype.handleAction=function(a){switch(RadioDataGroupBinding.superclass.handleAction.call(this,a),a.type){case RadioGroupBinding.ACTION_SELECTIONCHANGED:this.dirty(),this.onValueChange()}},RadioDataGroupBinding.prototype.handleEvent=function(a){if(RadioDataGroupBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.KEYDOWN)switch(a.keyCode){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a),Keyboard.keyArrow(a.keyCode)}},RadioDataGroupBinding.prototype.handleBroadcast=function(a,b){switch(RadioDataGroupBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ARROW:var c=null,d=null,e=null;switch(b){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:for(e=this.getChildBindingsByLocalName("radio");!c&&e.hasNext();){var f=e.getNext();f.getProperty("ischecked")&&(c=f)}}if(c)switch(b){case KeyEventCodes.VK_DOWN:for(d=e.getFollowing(c);null!=d&&d.isDisabled;)d=e.getFollowing(d);break;case KeyEventCodes.VK_UP:for(d=e.getPreceding(c);null!=d&&d.isDisabled;)d=e.getPreceding(d)}null!=d&&this.setCheckedButtonBinding(d)}},RadioDataGroupBinding.prototype.setName=DataBinding.prototype.setName,RadioDataGroupBinding.prototype.getName=DataBinding.prototype.getName,RadioDataGroupBinding.prototype.dirty=DataBinding.prototype.dirty,RadioDataGroupBinding.prototype.clean=DataBinding.prototype.clean,RadioDataGroupBinding.prototype.focus=function(a){this.isFocused||(DataBinding.prototype.focus.call(this),this.isFocused&&(a||FocusBinding.focusElement(this.bindingElement),this.addEventListener(DOMEvents.KEYDOWN),this.subscribe(BroadcastMessages.KEY_ARROW)))},RadioDataGroupBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this.removeEventListener(DOMEvents.KEYDOWN),this.unsubscribe(BroadcastMessages.KEY_ARROW))},RadioDataGroupBinding.prototype.validate=function(){return!0},RadioDataGroupBinding.prototype.manifest=function(){if(this.isAttached){if(!this.shadowTree.input){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.type="hidden",a.name=this._name,this.bindingElement.appendChild(a),this.shadowTree.input=a}this.shadowTree.input.value=this.getValue()}},RadioDataGroupBinding.prototype.getValue=function(){for(var a=null,b=this.getChildBindingsByLocalName("radio");!a&&b.hasNext();){var c=b.getNext();c.isChecked&&(a=c.getProperty("value"))}return a},RadioDataGroupBinding.prototype.getResult=RadioDataGroupBinding.prototype.getValue,RadioDataGroupBinding.prototype.setValue=function(a){},RadioDataGroupBinding.prototype.setResult=function(a){},RadioDataGroupBinding.prototype.onValueChange=function(){},RadioDataBinding.prototype=new Binding,RadioDataBinding.prototype.constructor=RadioDataBinding,RadioDataBinding.superclass=Binding.prototype,RadioDataBinding.prototype.toString=function(){return"[RadioDataBinding]"},RadioDataBinding.prototype.onBindingRegister=function(){RadioDataBinding.superclass.onBindingRegister.call(this),this._buttonBinding=this.add(RadioButtonBinding.newInstance(this.bindingDocument)),this._hack(),1==this.getProperty("ischecked")&&this.check(!0)},RadioDataBinding.prototype.onBindingAttach=function(){RadioDataBinding.superclass.onBindingAttach.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT),this._buttonBinding.attach(),this._buildDOMContent()},RadioDataBinding.prototype._buildDOMContent=function(){var a=this.getProperty("relate"),b=this.getProperty("oncommand"),c=this.getProperty("isdisabled");a&&(this.bindingRelate=a,this.relate()),b&&(this.oncommand=function(){Binding.evaluate(b,this)}),1==c&&this.disable(),this.hasCallBackID()&&Binding.dotnetify(this),this._buildLabelText()},RadioDataBinding.prototype.relate=function(){null!=this.bindingRelate&&(this.logger.warn("Relations not properly implemented!"),EventBroadcaster.broadcast(BroadcastMessages.BINDING_RELATE,{relate:this.bindingRelate,origin:this.bindingDocument,result:this.isChecked}))},RadioDataBinding.prototype.getButton=function(){return this._buttonBinding},RadioDataBinding.prototype._hack=function(){var a=this;this.getCallBackID();this._buttonBinding.check=function(b){RadioButtonBinding.prototype.check.call(this,b),a.setProperty("ischecked",!0),a.isChecked=!0,a.relate()},this._buttonBinding.uncheck=function(b){RadioButtonBinding.prototype.uncheck.call(this,b),a.deleteProperty("ischecked"),a.isChecked=!1,a.relate()},this._buttonBinding.oncommand=function(){a.isChecked=this.isChecked,a.setProperty("ischecked",a.isChecked),a.relate(),Types.isFunction(a.oncommand)&&a.oncommand()}},RadioDataBinding.prototype.setChecked=function(a,b){this._buttonBinding.setChecked(a,b),null!=this.bindingRelate&&this.relate(),this.setProperty("ischecked",a)},RadioDataBinding.prototype.check=function(a){this.setChecked(!0,a)},RadioDataBinding.prototype.uncheck=function(a){this.setChecked(!1,a)},RadioDataBinding.prototype.setDisabled=function(a){a!=this.isDisabled&&(this.isDisabled=a,this._buttonBinding.setDisabled(a),a?this.attachClassName(DataBinding.CLASSNAME_DISABLED):this.detachClassName(DataBinding.CLASSNAME_DISABLED))},RadioDataBinding.prototype.disable=function(){this.isDisabled||this.setDisabled(!0)},RadioDataBinding.prototype.enable=function(){this.isDisabled&&this.setDisabled(!1)},RadioDataBinding.prototype.handleEvent=function(a){if(RadioDataBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.CLICK){var b=DOMEvents.getTarget(a);switch(b){case this.shadowTree.labelText:this.isChecked||this.isDisabled||this.check()}}},RadioDataBinding.prototype._buildLabelText=function(){var a=this.getProperty("label");a&&(this.shadowTree.labelText=DOMUtil.createElementNS(Constants.NS_UI,"ui:datalabeltext",this.bindingDocument),this.shadowTree.labelText.appendChild(this.bindingDocument.createTextNode(Resolver.resolve(a))),DOMEvents.addEventListener(this.shadowTree.labelText,DOMEvents.CLICK,this),this.bindingElement.appendChild(this.shadowTree.labelText))},RadioDataBinding.prototype.setLabel=function(a){null!=this.shadowTree.labelText&&(this.shadowTree.labelText.firstChild.data=a),this.setProperty("label",a)},RadioDataBinding.prototype.handleElement=function(a){return!0},RadioDataBinding.prototype.updateElement=function(a){var b="true"===a.getAttribute("ischecked");return this.isChecked!=b&&this.setChecked(b,!0),!0},CheckBoxBinding.prototype=new Binding,CheckBoxBinding.prototype.constructor=CheckBoxBinding,CheckBoxBinding.superclass=Binding.prototype,CheckBoxBinding.ACTION_COMMAND="checkbox command",CheckBoxBinding.prototype.toString=function(){return"[CheckBoxBinding]"},CheckBoxBinding.prototype.onBindingRegister=function(){CheckBoxBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this._buildButtonBinding()},CheckBoxBinding.prototype.onBindingAttach=function(){CheckBoxBinding.superclass.onBindingAttach.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0),this._buildDOMContent()},CheckBoxBinding.prototype.onBindingDispose=function(){CheckBoxBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingDispose.call(this)},CheckBoxBinding.prototype._buildDOMContent=RadioDataBinding.prototype._buildDOMContent,CheckBoxBinding.prototype.handleEvent=function(a){if(CheckBoxBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.CLICK){var b=DOMEvents.getTarget(a);switch(b){case this.shadowTree.labelText:this.setChecked(!this.isChecked)}}},CheckBoxBinding.prototype.relate=RadioDataBinding.prototype.relate,CheckBoxBinding.prototype.handleBroadcast=function(a,b){switch(CheckBoxBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:this.setChecked(!this.isChecked)}},CheckBoxBinding.prototype._buildButtonBinding=function(){this._buttonBinding=this.add(CheckButtonBinding.newInstance(this.bindingDocument));var a=this;this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(b){b.consume(),a.dispatchAction(CheckBoxBinding.ACTION_COMMAND)}}),this._hack(),this._buttonBinding.attach(),this.getProperty("ischecked")&&this.check(!0)},CheckBoxBinding.prototype._hack=function(){var a=this,b=this.getCallBackID();this._buttonBinding.check=function(b){ButtonBinding.prototype.check.call(this,b),a.setProperty("ischecked",!0),a.isChecked=!0,a.relate(),b||a.focus()},this._buttonBinding.uncheck=function(b){ButtonBinding.prototype.uncheck.call(this,b),a.setProperty("ischecked",!1),a.isChecked=!1,a.relate()},this._buttonBinding.oncommand=function(){a.isChecked=this.isChecked,a.setProperty("ischecked",a.isChecked),a.focus(),a.relate(),a.oncommand&&a.oncommand(),a.dirty(),null!=b&&a.dispatchAction(PageBinding.ACTION_DOPOSTBACK)}},CheckBoxBinding.prototype.setChecked=RadioDataBinding.prototype.setChecked,CheckBoxBinding.prototype.check=RadioDataBinding.prototype.check,CheckBoxBinding.prototype.uncheck=RadioDataBinding.prototype.uncheck,CheckBoxBinding.prototype._buildLabelText=RadioDataBinding.prototype._buildLabelText,CheckBoxBinding.prototype.setLabel=RadioDataBinding.prototype.setLabel,CheckBoxBinding.prototype.setName=DataBinding.prototype.setName,CheckBoxBinding.prototype.getName=DataBinding.prototype.getName,CheckBoxBinding.prototype.dirty=DataBinding.prototype.dirty,CheckBoxBinding.prototype.clean=DataBinding.prototype.clean,CheckBoxBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),this.isFocused&&(FocusBinding.focusElement(this.bindingElement),this.subscribe(BroadcastMessages.KEY_SPACE)))},CheckBoxBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this.unsubscribe(BroadcastMessages.KEY_SPACE))},CheckBoxBinding.prototype.validate=function(){var a=!0,b=this.bindingElement.parentNode;if(b){var c=UserInterface.getBinding(b);c&&c instanceof CheckBoxGroupBinding&&c.isRequired&&(a=c.isValid?c.validate():!1)}return a},CheckBoxBinding.prototype.handleElement=RadioDataBinding.prototype.handleElement,CheckBoxBinding.prototype.updateElement=RadioDataBinding.prototype.updateElement,CheckBoxBinding.prototype.manifest=function(){if(this.isAttached)switch(this.isChecked){case!0:if(!this.shadowTree.input){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.type="hidden",a.name=this._name,a.style.display="none",this.bindingElement.appendChild(a),this.shadowTree.input=a}this.shadowTree.input.value=this.getValue();break;case!1:this.shadowTree.input&&(this.bindingElement.removeChild(this.shadowTree.input),this.shadowTree.input=null)}},CheckBoxBinding.prototype.getValue=function(){var a=null,b=this.getProperty("value");return this.isChecked&&(a=b?b:"on"),a},CheckBoxBinding.prototype.setValue=function(a){a==this.getValue()||"on"==a?this.check(!0):"on"!=a&&this.setPropety("value",a)},CheckBoxBinding.prototype.getResult=function(){var a=!1;return this.isChecked&&(a=null!=this._result?this._result:!0),a},CheckBoxBinding.prototype.setResult=function(a){"boolean"==typeof a?this.setChecked(a,!0):this._result=a},CheckBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkbox",a);return UserInterface.registerBinding(b,CheckBoxBinding)},CheckBoxGroupBinding.prototype=new Binding,CheckBoxGroupBinding.prototype.constructor=CheckBoxGroupBinding,CheckBoxGroupBinding.superclass=Binding.prototype,CheckBoxGroupBinding.prototype.toString=function(){return"[CheckBoxGroupBinding]"},CheckBoxGroupBinding.prototype.onBindingAttach=function(){CheckBoxGroupBinding.superclass.onBindingAttach.call(this),this.isRequired=1==this.getProperty("required")},CheckBoxGroupBinding.prototype.validate=function(){var a=!0;if(this.isRequired){var b=this.getDescendantBindingsByLocalName("checkbox");if(b.hasEntries())for(a=!1;b.hasNext()&&!a;)b.getNext().isChecked&&(a=!0);0==a&&(this._showWarning(!0),this.dispatchAction(Binding.ACTION_INVALID),this.addActionListener(CheckBoxBinding.ACTION_COMMAND))}return a},CheckBoxGroupBinding.prototype._showWarning=function(a){if(a){if(!this._labelBinding){var b=LabelBinding.newInstance(this.bindingDocument);b.attachClassName("invalid"),b.setImage("${icon:error}"),b.setLabel("Selection required"),this._labelBinding=this.addFirst(b),this._labelBinding.attach()}}else this._labelBinding&&(this._labelBinding.dispose(),this._labelBinding=null)},CheckBoxGroupBinding.prototype.handleAction=function(a){switch(CheckBoxGroupBinding.superclass.handleAction.call(this,a),a.type){case CheckBoxBinding.ACTION_COMMAND:this._showWarning(!1),this.dispatchAction(Binding.ACTION_VALID),this.removeActionListener(CheckBoxBinding.ACTION_COMMAND)}},CheckBoxGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkboxgroup",a);return UserInterface.registerBinding(b,CheckBoxGroupBinding)},BalloonSetBinding.prototype=new Binding,BalloonSetBinding.prototype.constructor=BalloonSetBinding,BalloonSetBinding.superclass=Binding.prototype,BalloonSetBinding.prototype.toString=function(){return"[BalloonSetBinding]"},BalloonBinding.prototype=new Binding,BalloonBinding.prototype.constructor=BalloonBinding,BalloonBinding.superclass=Binding.prototype,BalloonBinding.TIMEOUT=parseInt(200),BalloonBinding.OFFSET_X=parseInt(14),BalloonBinding.OFFSET_Y=parseInt(6),BalloonBinding.ACTION_SNAP="balloon snap",BalloonBinding.CLASSNAME_LEFT="left",BalloonBinding.ACTION_INITIALIZE="ballon initialize",BalloonBinding.prototype.toString=function(){return"[BalloonBinding]"},BalloonBinding.prototype.onBindingAttach=function(){BalloonBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(ControlBinding.ACTION_COMMAND),this._controlGroupBinding=this.add(ControlGroupBinding.newInstance(this.bindingDocument));var a=DialogControlBinding.newInstance(this.bindingDocument);a.setControlType(ControlBinding.TYPE_CLOSE),this._controlGroupBinding.add(a),this._controlGroupBinding.attachRecursive();var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloonspeak",this.bindingDocument);this.bindingElement.appendChild(b);var c=this.getLabel();null!=c&&this.setLabel(c)},BalloonBinding.prototype.onBindingDispose=function(){BalloonBinding.superclass.onBindingDispose.call(this),this._updateInterval&&(window.clearInterval(this._updateInterval),this._updateInterval=null);var a=this._snapTargetBinding;1==Binding.exists(a)&&(a.removeActionListener(Binding.ACTION_BLURRED,this),a.removeActionListener(Binding.ACTION_VALID,this))},BalloonBinding.prototype.snapTo=function(a){if(Interfaces.isImplemented(IData,a)){this._snapTargetBinding=a;var b=a.dispatchAction(BalloonBinding.ACTION_INITIALIZE);if(b&&b.isConsumed&&(this._environmentBinding=b.listener),!this._environmentBinding)throw"No environment fit for balloons!";a.addActionListener(Binding.ACTION_BLURRED,this),a.addActionListener(Binding.ACTION_VALID,this),
this.subscribe(BroadcastMessages.VIEW_CLOSED);var c=this;this._updateInterval=window.setInterval(function(){1==Binding.exists(a)?c._updatePosition():c.dispose()},BalloonBinding.TIMEOUT),a.dispatchAction(BalloonBinding.ACTION_SNAP)}},BalloonBinding.prototype.isSnapTo=function(a){return a===this._snapTargetBinding},BalloonBinding.prototype._updatePosition=function(){var a=this._snapTargetBinding,b=this._environmentBinding,c=UserInterface.getBinding(a.bindingDocument.body);if(Binding.exists(a)&&Binding.exists(b))if(c.isActivated){if(a.isAttached&&b.isAttached){var d=a.boxObject.getUniversalPosition(),e=b.boxObject.getUniversalPosition();e.y+=b.bindingElement.scrollTop,e.x+=b.bindingElement.scrollLeft;var f=a.boxObject.getDimension(),g=b.boxObject.getDimension(),h=!1;d.y+f.h<e.y?h=!0:d.x+f.w<e.x?h=!0:d.y>e.y+g.h?h=!0:d.x>e.x+g.w&&(h=!0),h?1==this.isVisible&&this.hide():(this._setComputedPosition(d,e,f,g),this.isVisible||this.show())}}else 1==this.isVisible&&this.hide();else this.dispose()},BalloonBinding.prototype._setComputedPosition=function(a,b,c,d){var e=WindowManager.getWindowDimensions(),f=this._getDimension(),g=a,h=!1;a.x+c.w+f.w+BalloonBinding.OFFSET_X>=e.w?h=!0:a.x+c.w>=b.x+d.w&&(h=!0),h?(g.x-=f.w+BalloonBinding.OFFSET_X,this.attachClassName(BalloonBinding.CLASSNAME_LEFT)):(g.x+=c.w+BalloonBinding.OFFSET_X,this.detachClassName(BalloonBinding.CLASSNAME_LEFT)),g.y-=f.h,g.y+=BalloonBinding.OFFSET_Y,g.y=Math.round(g.y),this._setPosition(g)},BalloonBinding.prototype.handleBroadcast=function(a,b){switch(BalloonBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.VIEW_CLOSED:1==this._isAssociatedView(b)&&this.dispose()}},BalloonBinding.prototype._isAssociatedView=function(a){var b=!1;if(this._snapTargetBinding){var c=this._snapTargetBinding.getAncestorBindingByType(ViewBinding,!0);c&&c.getHandle()==a&&(b=!0)}return b},BalloonBinding.prototype._setPosition=function(a){var b=!1,c=this.boxObject.getLocalPosition();null!=this._point&&(c.x!=this._point.x||c.y!=this._point.y)&&(b=!0),b||(this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px",this._point=a)},BalloonBinding.prototype._getPosition=function(){return new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop)},BalloonBinding.prototype._getDimension=function(){return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},BalloonBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.visibility="hidden",this.isVisible=!1)},BalloonBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.visibility="visible",this.isVisible=!0)},BalloonBinding.prototype.handleAction=function(a){BalloonBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ACTIVATED:this._snapTargetBinding&&(this._snapTargetBinding.dispatchAction(Binding.ACTION_ACTIVATED),a.consume());case Binding.ACTION_BLURRED:case Binding.ACTION_VALID:if(b==this._snapTargetBinding){var c=this;setTimeout(function(){if(Binding.exists(b)){if(b.validate()){var d=!0;if(a.type==Binding.ACTION_BLURRED){var e=b.bindingDocument.body;UserInterface.getBinding(e);e.isActivated||(d=!1)}d&&c.dispose()}}else c.dispose()},0)}break;case ControlBinding.ACTION_COMMAND:this.dispose()}},BalloonBinding.prototype.setLabel=function(a){if(this.isAttached){for(this.shadowTree.balloontext||(this.shadowTree.balloontext=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloontext",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.balloontext));this.shadowTree.balloontext.firstChild;)this.shadowTree.balloontext.removeChild(this.shadowTree.balloontext.firstChild);var b=this.bindingDocument.createTextNode(a);this.shadowTree.balloontext.appendChild(b)}this.setProperty("label",a)},BalloonBinding.prototype.getLabel=function(){return this.getProperty("label")},BalloonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloon",a),c=UserInterface.registerBinding(b,BalloonBinding);return c.hide(),c},ErrorBinding.prototype=new Binding,ErrorBinding.prototype.constructor=ErrorBinding,ErrorBinding.superclass=Binding.prototype,ErrorBinding.ACTION_INITIALIZE="error initialize",ErrorBinding.presentError=function(a,b){if(1==Interfaces.isImplemented(IData,b)){var c,d=b.dispatchAction(ErrorBinding.ACTION_INITIALIZE);if(d&&d.isConsumed)switch(d.listener.constructor){case StageBinding:c=!1;break;case StageDialogBinding:c=!0}var e=c?top.app.bindingMap.dialogballoonset:top.app.bindingMap.balloonset,f=null;e.getDescendantBindingsByType(BalloonBinding).each(function(a){return a.isSnapTo(b)?(f=a,!1):!0},this),null!=f?f.setLabel(a.text):(f=e.add(BalloonBinding.newInstance(top.app.document)),f.setLabel(a.text),f.snapTo(b),f.attach())}},ErrorBinding.prototype.toString=function(){return"[ErrorBinding]"},ErrorBinding.prototype.onBindingAttach=function(){ErrorBinding.superclass.onBindingAttach.call(this);var a=this.bindingWindow.DataManager,b=this.getProperty("text"),c=this.getProperty("targetname"),d=a.getDataBinding(c);d?ErrorBinding.presentError({text:b},d):window.console&&(console.error("ErrorBinding dysfunction: No such DataBinding!\n"+c),c.indexOf("_")>-1&&console.error("Name contains '_' - replace with '$' ?")),this.dispose()},FocusBinding.prototype=new FlexBoxBinding,FocusBinding.prototype.constructor=FocusBinding,FocusBinding.superclass=FlexBoxBinding.prototype,FocusBinding.MARKER="focusbindingcurrentfocus",FocusBinding.ACTION_ACTIVATED="focusmanager activated",FocusBinding.ACTION_ATTACHED="focusmanager attached",FocusBinding.ACTION_UPDATE="focusmanager update required",FocusBinding.ACTION_FOCUS="focusmanager focus",FocusBinding.ACTION_BLUR="focusmanager blur",FocusBinding.focusElement=function(a){var b=!0;try{a.focus(),Application.focused(!0)}catch(e){var c=UserInterface.getBinding(a),d=SystemLogger.getLogger("FocusBinding.focusElement");d.warn("Could not focus "+(c?c.toString():String(a))),b=!1}return b},FocusBinding.focusedBinding=null,FocusBinding.activeInstance=null,FocusBinding.getCachedFocus=function(a){var b=a.bindingWindow,c=a.bindingElement.id;return{getBinding:function(){var d=null;try{Binding.exists(a)&&(d=b.bindingMap[c])}catch(a){}return d}}},FocusBinding.navigateNext=function(a){Binding.exists(FocusBinding.activeInstance)&&FocusBinding.activeInstance.focusNext(a)},FocusBinding.navigatePrevious=function(){FocusBinding.navigateNext(!0)},FocusBinding.prototype.toString=function(){return"[FocusManangerBinding]"},FocusBinding.prototype.onBindingAttach=function(){if(0==this.getProperty("focusmanager"))this._isFocusManager=!1;else if(0==this.getProperty("strongfocusmanager")&&(this.isStrongFocusManager=!1),this._isFocusManager){var a=this.dispatchAction(FocusBinding.ACTION_ATTACHED);a&&a.isConsumed&&a.listener.isStrongFocusManager&&(this._isFocusManager=!1),this._isFocusManager&&(this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(Binding.ACTION_BLURRED),this.addActionListener(FocusBinding.ACTION_UPDATE),this.addActionListener(FocusBinding.ACTION_FOCUS),this.addActionListener(FocusBinding.ACTION_BLUR),this.addActionListener(FocusBinding.ACTION_ATTACHED))}FocusBinding.superclass.onBindingAttach.call(this)},FocusBinding.prototype.onBindingDispose=function(){FocusBinding.superclass.onBindingDispose.call(this),FocusBinding.activeInstance==this&&(FocusBinding.activeInstance=null)},FocusBinding.prototype.handleAction=function(a){FocusBinding.superclass.handleAction.call(this,a);var b=a.target,c=null;if(this._isFocusManager)switch(a.type){case FocusBinding.ACTION_ATTACHED:b!=this&&(this._isUpToDate=!1),a.consume();break;case FocusBinding.ACTION_UPDATE:b!=this&&(this._isUpToDate=!1,a.consume());break;case FocusBinding.ACTION_BLUR:Application.isOperational&&(c=new FocusCrawler,c.mode=FocusCrawler.MODE_BLUR,c.crawl(b.bindingElement),null!=this._cachedFocus&&(this._cachedFocus=null)),a.consume();break;case FocusBinding.ACTION_FOCUS:Application.isOperational&&b!=this&&(c=new FocusCrawler,c.mode=FocusCrawler.MODE_FOCUS,c.crawl(b.bindingElement)),a.consume();break;case Binding.ACTION_FOCUSED:Interfaces.isImplemented(IFocusable,b)&&(this.claimFocus(),this._onFocusableFocused(b)),a.consume();break;case Binding.ACTION_BLURRED:Interfaces.isImplemented(IFocusable,b)&&this._onFocusableBlurred(b),a.consume()}},FocusBinding.prototype.focusNext=function(a){var b=null,c=this._getFocusableList();if(c.reset().hasEntries()){for(;null==b&&c.hasNext();){var d=c.getNext();this._cachedFocus&&d==this._cachedFocus.getBinding()&&(b=d)}if(null!=b)if(d.isFocused){var e=a?c.getPreceding(b):c.getFollowing(b);e||(e=a?c.getLast():c.getFirst()),e.focus()}else b.focus();else c.getFirst().focus()}},FocusBinding.prototype.claimFocus=function(){FocusBinding.activeInstance=this},FocusBinding.prototype._getFocusableList=function(){if(!this._isUpToDate){var a=new FocusCrawler,b=new List;a.mode=FocusCrawler.MODE_INDEX,a.crawl(this.bindingElement,b),this._focusableList=b,this._isUpToDate=!0}return this._focusableList},FocusBinding.prototype._focusFirstFocusable=function(){if(this._isFocusManager&&this.isActivated){var a=this._getFocusableList();null!=a?a.hasEntries()&&a.getFirst().focus():this.logger.warn("Could not compute focusable list.")}},FocusBinding.prototype._focusPreviouslyFocused=function(){if(this._cachedFocus){var a=this._cachedFocus.getBinding();a&&!a.isFocused&&a.focus()}},FocusBinding.prototype._onFocusableFocused=function(a){a!=FocusBinding.focusedBinding&&(null!=FocusBinding.focusedBinding&&Binding.exists(FocusBinding.focusedBinding)&&FocusBinding.focusedBinding.blur(),FocusBinding.focusedBinding=a,a.setProperty(FocusBinding.MARKER,!0),this._cachedFocus=FocusBinding.getCachedFocus(a))},FocusBinding.prototype._onFocusableBlurred=function(a){a.deleteProperty(FocusBinding.MARKER),a==FocusBinding.focusedBinding&&(FocusBinding.focusedBinding=null)},TabsButtonBinding.prototype=new ButtonBinding,TabsButtonBinding.prototype.constructor=TabsButtonBinding,TabsButtonBinding.superclass=ButtonBinding.prototype,TabsButtonBinding.RESERVED_SPACE=36,TabsButtonBinding.NODENAME_TABBOX="tabbox",TabsButtonBinding.CHAR_INDICATOR=String.fromCharCode(187),TabsButtonBinding.prototype.toString=function(){return"[TabsButtonBinding]"},TabsButtonBinding.prototype.onBindingRegister=function(){TabsButtonBinding.superclass.onBindingRegister.call(this),this.hiddenTabBindings=new List,this.menuItemBindings=new List},TabsButtonBinding.prototype.buildDOMContent=function(){TabsButtonBinding.superclass.buildDOMContent.call(this),this.containingTabBoxBinding=this.getAncestorBindingByLocalName(this.constructor.NODENAME_TABBOX);var a=this.bindingDocument.createElement("span");a.appendChild(this.bindingDocument.createTextNode(TabsButtonBinding.CHAR_INDICATOR)),a.className="arrow",this.labelBinding.bindingElement.appendChild(a)},TabsButtonBinding.prototype.show=function(a){this.bindingElement.style.left=a+"px",this.setLabel(this.hiddenTabBindings.getLength().toString()),TabsButtonBinding.superclass.show.call(this)},TabsButtonBinding.prototype.reset=function(){if(this.menuItemBindings.hasEntries())for(;this.menuItemBindings.hasNext();)this.menuItemBindings.getNext().dispose();this.hiddenTabBindings.clear(),this.menuItemBindings.clear(),this.selectedTabBinding=null,this.isPopulated=!1},TabsButtonBinding.prototype.registerHiddenTabBinding=function(a){this.hiddenTabBindings.add(a)},TabsButtonBinding.prototype.fireCommand=function(){if(this.isChecked&&!this.isPopulated){for(this.hiddenTabBindings.reset();this.hiddenTabBindings.hasNext();){var a=this.hiddenTabBindings.getNext(),b=MenuItemBinding.newInstance(this.popupBinding.bindingDocument);b.setLabel(a.getLabel()),b.setImage(a.getImage()),b.associatedTabBinding=a;var c=this;b.oncommand=function(){c.selectedTabBinding=this.associatedTabBinding},this.popupBinding.add(b),this.menuItemBindings.add(b),this.popupBinding.attachRecursive()}this.isPopulated=!0}this.popupBinding.addActionListener(PopupBinding.ACTION_HIDE,this),TabsButtonBinding.superclass.fireCommand.call(this)},TabsButtonBinding.prototype.handleAction=function(a){switch(TabsButtonBinding.superclass.handleAction.call(this,a),a.type){case PopupBinding.ACTION_HIDE:this.popupBinding.removeActionListener(PopupBinding.ACTION_HIDE,this);var b=this.selectedTabBinding;b&&(this.containingTabBoxBinding.moveToOrdinalPosition(b,0),this.containingTabBoxBinding.select(b)),a.consume()}},TabsButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return b.setAttribute("type","checkbox"),b.setAttribute("popup","app.bindingMap.tabsbuttonpopup"),b.className="tabbutton",UserInterface.registerBinding(b,TabsButtonBinding)},TabBoxBinding.prototype=new FlexBoxBinding,TabBoxBinding.prototype.constructor=TabBoxBinding,TabBoxBinding.superclass=FlexBoxBinding.prototype,TabBoxBinding.ASSOCIATION_KEY="tabboxkey",TabBoxBinding.ACTION_ATTACHED="tabbox attached",TabBoxBinding.ACTION_SELECTED="tabbox selected",TabBoxBinding.ACTION_UNSELECTED="tabbox unselected",TabBoxBinding.ACTION_UPDATED="tabbox updated",TabBoxBinding.UPDATE_ORDINAL="tabbox ordinalupdate",TabBoxBinding.UPDATE_ATTACH="tabbox attachupdate",TabBoxBinding.UPDATE_DETACH="tabbox detachupdate",TabBoxBinding.INVALID_TAB_IMAGE="${icon:error}",TabBoxBinding.BALLOON_TAB_IMAGE="${icon:balloon}",EventBroadcaster.subscribe(BroadcastMessages.KEY_TAB,{handleBroadcast:function(){if(Keyboard.isControlPressed){var a=TabBoxBinding.currentActiveInstance;null!=a&&Binding.exists(a)}}}),TabBoxBinding.currentActiveInstance=null,TabBoxBinding.prototype.toString=function(){return"[TabBoxBinding]"},TabBoxBinding.prototype.onBindingRegister=function(){TabBoxBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_ATTACHED),this.addActionListener(Binding.ACTION_DETACHED),this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(PageBinding.ACTION_INITIALIZED),DOMEvents.addEventListener(this.bindingDocument.documentElement,DOMEvents.AFTERUPDATE,this),DOMEvents.addEventListener(this.bindingElement,DOMEvents.AFTERUPDATE,this)},TabBoxBinding.prototype.onBindingAttach=function(){TabBoxBinding.superclass.onBindingAttach.call(this),TabBoxBinding.currentActiveInstance=this,this._tabsElement=this.getTabsElement(),this._tabPanelsElement=this.getTabPanelsElement();var a=this.getTabElements().getLength(),b=this.getTabPanelElements().getLength();if(!this._tabsElement||!this._tabPanelsElement)throw new Error(this.toString()+" DOM subtree invalid.");if(a!=b)throw new Error(this.toString()+" DOM subtree invalid.");"boxed"==this.getProperty("type")&&(this.setFlexibility(!1),this.attachClassName("boxed")),this.buildDOMContent(),this._TEMPNAME(),1==this.getProperty("equalsize")?(this.dispatchAction(PageBinding.ACTION_BLOCK_INIT),this.setFlexibility(!1),this.attachClassName("equalsize"),this.isEqualSize=!0,this.addMembers(this.getDescendantBindingsByLocalName("*"))):(this.addMember(this.getTabsBinding()),this.addMember(this.getTabPanelsBinding()),this.addMembers(this.getTabBindings()),this.addMembers(this.getTabPanelBindings()))},TabBoxBinding.prototype.onBindingInitialize=function(){for(var a=this.getTabPanelElements();a.hasNext();)this._setupWarningSystem(UserInterface.getBinding(a.getNext()));this.isEqualSize&&(this.enforceEqualSize(),this.dispatchAction(PageBinding.ACTION_UNBLOCK_INIT)),this.dispatchAction(TabBoxBinding.ACTION_ATTACHED),TabBoxBinding.superclass.onBindingInitialize.call(this)},TabBoxBinding.prototype.buildDOMContent=function(){var a=DOMUtil.getOrdinalPosition(this._tabsElement),b=DOMUtil.getOrdinalPosition(this._tabPanelsElement),c=a>b?"tabsbelow":"tabsontop";this.attachClassName(c)},TabBoxBinding.prototype._TEMPNAME=function(){var a=this.getTabElements(),b=this.getTabPanelElements(),c=null,d=this.getProperty("selectedindex");if(null!=d&&d>a.getLength()-1)throw"Selectedindex out of range";if(a.hasEntries()){for(var e=0;a.hasNext();){var f=a.getNext(),g=b.getNext();this.registerTabBoxPair(f,g),d&&e==d?f.setAttribute("selected","true"):"true"==f.getAttribute("selected")&&(c=f),e++}c||(c=a.getFirst(),c.setAttribute("selected","true"))}},TabBoxBinding.prototype.enforceEqualSize=function(a){var b=null,c=null;if(this.isEqualSize){var d=CSSComputer.getPadding(this._tabPanelsElement),e=0,f=this.getTabPanelElements();f.each(function(a){e=a.offsetHeight>e?a.offsetHeight:e}),c=e+d.top+d.bottom,a&&null!=this._tabPanelsElement.style.height&&(b=this._tabPanelsElement.offsetHeight),(null!=b||c>b)&&(this._tabPanelsElement.style.height=c+"px")}},TabBoxBinding.prototype._setupWarningSystem=function(a){a._invalidCount=0,a.addActionListener(Binding.ACTION_INVALID,this),a.addActionListener(Binding.ACTION_VALID,this),a.addActionListener(BalloonBinding.ACTION_SNAP,this)},TabBoxBinding.prototype.handleAction=function(a){TabBoxBinding.superclass.handleAction.call(this,a);var b=a.target,c=a.listener;switch(a.type){case Binding.ACTION_ATTACHED:break;case Binding.ACTION_DETACHED:b.constructor==this._impl_tab&&(this.updateType=TabBoxBinding.UPDATE_DETACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),a.consume());break;case PageBinding.ACTION_INITIALIZED:b.isDialogSubPage&&this.isEqualSize&&this.enforceEqualSize();break;case Binding.ACTION_INVALID:if(c._invalidCount++,1==c._invalidCount){var d=this;setTimeout(function(){c.isSelected||d._showWarning(c,!0)},0)}break;case Binding.ACTION_VALID:c._invalidCount>0&&(c._invalidCount--,0==c._invalidCount&&c.isSelected&&this._showWarning(c,!1));break;case BalloonBinding.ACTION_SNAP:this._showBalloon(c,!0);break;case Binding.ACTION_ACTIVATED:case Binding.ACTION_FOCUSED:null==a._tabboxstamp&&(TabBoxBinding.currentActiveInstance=this,a._tabboxstamp="stamped")}},TabBoxBinding.prototype.handleEvent=function(a){switch(TabBoxBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.AFTERUPDATE:var b=DOMEvents.getTarget(a);if(b==this.bindingDocument.documentElement){if(this._hasBastardUpdates){this._hasBastardUpdates=!1;var c=this.getTabElements(),d=this.getTabPanelElements();c.each(function(a,b){if(null==a.getAttribute(TabBoxBinding.ASSOCIATION_KEY)){var c=d.get(b);this.registerTabBoxPair(a,c)}},this);var e=this._tabBoxPairs;for(var f in e){var g=e[f].tab;null==g.parentNode&&this.unRegisterTabBoxPair(g)}}}else if(!this._hasBastardUpdates){var h=DOMUtil.getLocalName(b);switch(b.__updateType){case Update.TYPE_INSERT:switch(h){case this._nodename_tab:case this._nodename_tabpanel:var i=b.parentNode;(i==this._tabsElement||i==this._tabPanelsElement)&&(this._hasBastardUpdates=!0)}break;case Update.TYPE_REMOVE:switch(h){case this._nodename_tabs:case this._nodename_tabpanels:(b==this._tabsElement||b==this._tabPanelsElement)&&(this._hasBastardUpdates=!0)}}}}},TabBoxBinding.prototype.select=function(a,b){var c=this.getBindingForArgument(a);if(null!=c&&!c.isSelected){null!=this._selectedTabBinding&&(this._selectedTabBinding.unselect(),this.getTabPanelBinding(this._selectedTabBinding).unselect()),this.dispatchAction(TabBoxBinding.ACTION_UNSELECTED),c.select(b),this.getTabPanelBinding(c).select(b);var d=this.getProperty("selectedindex");if(null!=d&&this.setProperty("selectedindex",DOMUtil.getOrdinalPosition(c.bindingElement,!0)),this._selectedTabBinding=c,this.dispatchAction(TabBoxBinding.ACTION_SELECTED),this.dispatchAction(FocusBinding.ACTION_UPDATE),c.getImage()==TabBoxBinding.BALLOON_TAB_IMAGE){var e=this.getTabPanelBinding(c);this._showBalloon(e,!1)}}},TabBoxBinding.prototype.registerTabBoxPair=function(a,b){var c=KeyMaster.getUniqueKey();a.setAttribute(TabBoxBinding.ASSOCIATION_KEY,c),b.setAttribute(TabBoxBinding.ASSOCIATION_KEY,c),this._tabBoxPairs[c]={tab:a,tabPanel:b}},TabBoxBinding.prototype.unRegisterTabBoxPair=function(a){var b=a.getAttribute(TabBoxBinding.ASSOCIATION_KEY);delete this._tabBoxPairs[b]},TabBoxBinding.prototype.getTabPanelBinding=function(a){var b=null;try{var c=a.getProperty(TabBoxBinding.ASSOCIATION_KEY),d=this._tabBoxPairs[c].tabPanel;b=UserInterface.getBinding(d)}catch(a){this.logger.error(a),SystemDebug.stack(arguments)}return b},TabBoxBinding.prototype.getTabBinding=function(a){var b=a.getProperty(TabBoxBinding.ASSOCIATION_KEY),c=this._tabBoxPairs[b].tab;return UserInterface.getBinding(c)},TabBoxBinding.prototype.summonTabBinding=function(){return TabBinding.newInstance(this.bindingDocument)},TabBoxBinding.prototype.summonTabPanelBinding=function(){var a=this._impl_tabpanel.newInstance(this.bindingDocument);return this._setupWarningSystem(a),a},TabBoxBinding.prototype.appendTabByBindings=function(a,b){var c=a.bindingElement;a.setProperty("selected",!0);var d=this.summonTabPanelBinding(),e=d.bindingElement;return b&&e.appendChild(b instanceof Binding?b.bindingElement:b),this.registerTabBoxPair(c,e),UserInterface.getBinding(this._tabsElement).add(a),this._tabPanelsElement.appendChild(e),a.attach(),UserInterface.getBinding(e).attachRecursive(),this.updateType=TabBoxBinding.UPDATE_ATTACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),a},TabBoxBinding.prototype.importTabBinding=function(a){var b=a.containingTabBoxBinding,c=b.getTabPanelBinding(a),d=c.getBindingElement(),e=a.getBindingElement();b.dismissTabBinding(a),this._tabsElement.appendChild(e),this._tabPanelsElement.appendChild(d),this.registerTabBoxPair(e,d),a.containingTabBoxBinding=this,this.select(a),this.dispatchAction(Binding.ACTION_ACTIVATED),this.dispatchAction(TabBoxBinding.ACTION_UPDATED)},TabBoxBinding.prototype.removeTab=function(a){var b=null;a.isSelected&&(b=this.getBestTab(a),this._selectedTabBinding=null);var c=this.getTabPanelBinding(a);this.unRegisterTabBoxPair(a.bindingElement),a.dispose(),c.dispose(),null!=b&&this.select(b,!0),this.updateType=TabBoxBinding.UPDATE_DETACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),this.deActivate()},TabBoxBinding.prototype.dismissTabBinding=function(a){a.isSelected&&this.selectBestTab(a)},TabBoxBinding.prototype.selectBestTab=function(a){var b=this.getBestTab(a);b?this.select(b):this._selectedTabBinding=null},TabBoxBinding.prototype.getBestTab=function(a){var b=null,c=a.getOrdinalPosition(!0),d=this.getTabBindings(),e=d.getLength(),f=e-1;return b=1==e?null:c==f?d.get(c-1):d.get(c+1)},TabBoxBinding.prototype.moveToOrdinalPosition=function(a,b){for(var c=this.bindingDocument.getElementById(a.bindingElement.id),d=this.getTabElements().get(b);d&&"true"===d.getAttribute("pinned");)d=this.getTabElements().get(++b);d&&this._tabsElement.insertBefore(c,d),this.updateType=TabBoxBinding.UPDATE_ORDINAL,this.dispatchAction(TabBoxBinding.ACTION_UPDATED)},TabBoxBinding.prototype.getTabsElement=function(){return DOMUtil.getElementsByTagName(this.bindingElement,this._nodename_tabs).item(0)},TabBoxBinding.prototype.getTabPanelsElement=function(){return DOMUtil.getElementsByTagName(this.bindingElement,this._nodename_tabpanels).item(0)},TabBoxBinding.prototype.getTabElements=function(){for(var a=this._nodename_tab,b=new List(this._tabsElement.childNodes),c=new List;b.hasNext();){var d=b.getNext();d.nodeType==Node.ELEMENT_NODE&&DOMUtil.getLocalName(d)==a&&c.add(d)}return c},TabBoxBinding.prototype.getTabPanelElements=function(){var a=this._nodename_tabpanel,b=new List(this._tabPanelsElement.childNodes),c=new List;return b.each(function(b){b.nodeType==Node.ELEMENT_NODE&&DOMUtil.getLocalName(b)==a&&c.add(b)}),c},TabBoxBinding.prototype.getTabsBinding=function(){return this.getChildBindingByLocalName(this._nodename_tabs)},TabBoxBinding.prototype.getTabPanelsBinding=function(){return this.getChildBindingByLocalName(this._nodename_tabpanels)},TabBoxBinding.prototype.getTabBindings=function(){var a=new List,b=this.getTabElements();return b.each(function(b){a.add(UserInterface.getBinding(b))}),a},TabBoxBinding.prototype.getTabPanelBindings=function(){var a=new List;return this.getTabPanelElements().each(function(b){a.add(UserInterface.getBinding(b))}),a},TabBoxBinding.prototype.getSelectedTabBinding=function(){return this._selectedTabBinding},TabBoxBinding.prototype.getSelectedTabPanelBinding=function(){var a=null;return this._selectedTabBinding&&(a=this.getTabPanelBinding(this._selectedTabBinding)),a},TabBoxBinding.prototype._showWarning=function(a,b){var c=this.getTabBinding(a);b?(c.labelBinding.hasImage&&(c._backupImage=c.getImage()),c.setImage(TabBoxBinding.INVALID_TAB_IMAGE)):c._backupImage?c.setImage(c._backupImage):c.setImage(!1)},TabBoxBinding.prototype._showBalloon=function(a,b){var c=this.getTabBinding(a);(b&&!c.isSelected||!b)&&c.getImage()!=TabBoxBinding.INVALID_TAB_IMAGE&&(b?(c.labelBinding.hasImage&&(c._backupImage=c.getImage()),c.setImage(TabBoxBinding.BALLOON_TAB_IMAGE)):null!=c._backupImage?c.setImage(c._backupImage):c.setImage(!1))},TabBoxBinding.prototype.advanceSelection=function(a){var b=this.getSelectedTabBinding(),c=this.getTabBindings(),d=b.getOrdinalPosition(!0),e=null,f=new List;c.each(function(a){a.isVisible&&f.add(a)}),f.getLength()>1&&(e=0!=d||a?d==f.getLength()-1&&a?f.getFirst():a?b.getNextBindingByLocalName(this._nodename_tab):b.getPreviousBindingByLocalName(this._nodename_tab):f.getLast(),null!=e&&this.select(e))},TabsBinding.prototype=new Binding,TabsBinding.prototype.constructor=TabsBinding,TabsBinding.superclass=Binding.prototype,TabsBinding.NODENAME_TABBOX="tabbox",TabsBinding.TABBUTTON_IMPLEMENTATION=TabsButtonBinding,TabsBinding.prototype.toString=function(){return"[TabsBinding]"},TabsBinding.prototype.onBindingRegister=function(){TabsBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},TabsBinding.prototype.onBindingAttach=function(){TabsBinding.superclass.onBindingAttach.call(this),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.containingTabBoxBinding.addActionListener(TabBoxBinding.ACTION_UPDATED,this),this.buildDOMContent(),this.dispatchAction(Binding.ACTION_ATTACHED)},TabsBinding.prototype.buildDOMContent=function(){this.shadowTree.tabManager=this.bindingDocument.createElement("div"),this.shadowTree.tabManager.className="tabmanager";var a=this.constructor.TABBUTTON_IMPLEMENTATION;this.tabsButtonBinding=a.newInstance(this.bindingDocument),this.shadowTree.tabsButton=this.tabsButtonBinding,this.add(this.tabsButtonBinding),this.tabsButtonBinding.attach()},TabsBinding.prototype.handleAction=function(a){function b(){c.manage()}switch(TabsBinding.superclass.handleAction.call(this,a),a.type){case TabBoxBinding.ACTION_UPDATED:if(!this.isManaging){var c=this;setTimeout(b,0)}}},TabsBinding.prototype.flex=function(){function a(){if(1==Binding.exists(b)){var a=b.bindingElement.offsetWidth;a!=b._cachedOffsetWidth&&b.manage(),b._cachedOffsetWidth=a}}if(1==this.isAttached){var b=this;setTimeout(a,0)}},TabsBinding.prototype.add=function(a){return a instanceof TabBinding&&this.tabsButtonBinding&&this.tabsButtonBinding.isVisible&&this.tabsButtonBinding.hide(),TabsBinding.superclass.add.call(this,a)},TabsBinding.prototype.manage=function(){if(1==Binding.exists(this)&&this.isVisible){this.isManaging=!0;var a,b,c=!1,d=this.containingTabBoxBinding.getTabElements(),e=this.constructor.TABBUTTON_IMPLEMENTATION,f=this.bindingElement.offsetWidth-e.RESERVED_SPACE,g=null,h=0,i=0,j=!0;if(d.hasEntries()){for(this.tabsButtonBinding.reset();d.hasNext()&&j;)b=d.getNext(),a=UserInterface.getBinding(b),g||(g=a),h+=b.offsetWidth,h>=f?(c=!0,a.isSelected?DOMUtil.isFirstElement(a.bindingElement,!0)||(this.isManaging=!1,g&&(g.hide(),this.tabsButtonBinding.isVisible&&this.tabsButtonBinding.hide()),this.containingTabBoxBinding.moveToOrdinalPosition(a,i-1),j=!1):(a.hide(),this.tabsButtonBinding.registerHiddenTabBinding(a))):(a.show(),g=a,i++);if(j)if(c&&this.tabsButtonBinding.hiddenTabBindings.hasEntries()){var k=g.getBindingElement(),l=k.offsetLeft+k.offsetWidth,m=this.tabsButtonBinding;setTimeout(function(){m.show(l+4)},50)}else this.tabsButtonBinding.hide()}this.isManaging=!1}},TabBinding.prototype=new Binding,TabBinding.prototype.constructor=TabBinding,TabBinding.superclass=Binding.prototype,TabBinding.ACTION_SELECTED="tabselected",TabBinding.ACTION_UNSELECTED="tabunselected",TabBinding.NODENAME_TABBOX="tabbox",TabBinding.prototype.toString=function(){return"[TabBinding]"},TabBinding.prototype.serialize=function(){var a=TabBinding.superclass.serialize.call(this);return a&&(a.label=this.getLabel(),a.image=this.getImage(),a.tooltip=this.getToolTip()),a},TabBinding.prototype.onBindingAttach=function(){TabBinding.superclass.onBindingAttach.call(this),this.defaultElementPosition=DOMUtil.getComputedStyle(this.bindingElement,"position"),this.defaultElementLeft=DOMUtil.getComputedStyle(this.bindingElement,"left"),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.buildDOMContent(),this.assignDOMEvents(),this.dispatchAction(Binding.ACTION_ATTACHED),1==this.getProperty("selected")&&this.containingTabBoxBinding.select(this,!0)},TabBinding.prototype.buildDOMContent=function(){var a=this.bindingElement.getAttribute("image"),b=this.bindingElement.getAttribute("label"),c=this.bindingElement.getAttribute("tooltip");this.bindingElement.className="default",this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.shadowTree.labelBinding=this.labelBinding,this.labelBinding.attachClassName("tablabel"),this.add(this.labelBinding),b&&this.setLabel(b),a&&this.setImage(a),c&&this.setToolTip(c)},TabBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},TabBinding.prototype.getImage=function(){return this.getProperty("image")},TabBinding.prototype.setLabel=function(a){null!=a&&(this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(a))},TabBinding.prototype.getLabel=function(){return this.getProperty("label")},TabBinding.prototype.setToolTip=function(a){a&&(this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(a))},TabBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},TabBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEENTER),this.addEventListener(DOMEvents.MOUSELEAVE)},TabBinding.prototype.handleEvent=function(a){if(TabBinding.superclass.handleEvent.call(this,a),!this.isSelected){var b=!1;if(1==Client.isMozilla,!b)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this.isSelected||(this.bindingElement.className="hover");break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this.isSelected||(this.bindingElement.className="default");break;case DOMEvents.MOUSEDOWN:DOMEvents.isRightButton(a)||this.containingTabBoxBinding.select(this)}}},TabBinding.prototype.select=function(a){this.show(),this.isSelected=!0,this.setProperty("selected",!0),this.bindingElement.className="selected"},TabBinding.prototype.unselect=function(){this.isSelected=!1,this.deleteProperty("selected"),this.bindingElement.className="default"},TabBinding.prototype.highlight=function(a){a?this.shadowTree.labelBinding.attachClassName("highlighted"):this.shadowTree.labelBinding.detachClassName("highlighted")},TabBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.position="absolute",this.bindingElement.style.left="-1000px",this.isVisible=!1)},TabBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.position=this.defaultElementPosition,this.bindingElement.style.left=this.defaultElementLeft,this.isVisible=!0)},TabBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tab",a);return UserInterface.registerBinding(b,TabBinding)},TabPanelsBinding.prototype=new FlexBoxBinding,TabPanelsBinding.prototype.constructor=TabPanelsBinding,TabPanelsBinding.superclass=FlexBoxBinding.prototype,TabPanelsBinding.prototype.toString=function(){return"[TabPanelsBinding]"},TabPanelsBinding.prototype.onBindingRegister=function(){TabPanelsBinding.superclass.onBindingRegister.call(this),this._lastKnownDimension=new Dimension(0,0)},TabPanelsBinding.prototype.hasDimensionsChanged=function(){
var a=!1,b=this.boxObject.getDimension(),c=this._lastKnownDimension;return null!=c&&Dimension.isEqual(b,c)||(a=!0,this._lastKnownDimension=b),a},TabPanelsBinding.prototype.onBindingAttach=function(){TabPanelsBinding.superclass.onBindingAttach.call(this),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.setFlexibility(this.containingTabBoxBinding.isFlexible),this.dispatchAction(Binding.ACTION_ATTACHED)},TabPanelBinding.prototype=new Binding,TabPanelBinding.prototype.constructor=TabPanelBinding,TabPanelBinding.superclass=Binding.prototype,TabPanelBinding.prototype.toString=function(){return"[TabPanelBinding]"},TabPanelBinding.prototype.onBindingAttach=function(){TabPanelBinding.superclass.onBindingAttach.call(this),this.dispatchAction(Binding.ACTION_ATTACHED),this.addActionListener(BalloonBinding.ACTION_INITIALIZE)},TabPanelBinding.prototype.select=function(a){this.isSelected||(this.isLazy?this.wakeUp("select"):(this.isSelected=!0,this.isVisible=!0,this.bindingElement.style.position="static",this._invokeManagedRecursiveFlex(),1!=a&&this.dispatchAction(FocusBinding.ACTION_FOCUS)))},TabPanelBinding.prototype.unselect=function(){this.isSelected&&(this.dispatchAction(FocusBinding.ACTION_BLUR),this.isSelected=!1,this.isVisible=!1,this.bindingElement.style.position="absolute")},TabPanelBinding.prototype._invokeManagedRecursiveFlex=function(){if(1==this.isAttached)this.reflex(!0);else{var a=UserInterface.getBinding(this.bindingElement.parentNode);a.reflex()}},TabPanelBinding.prototype.handleAction=function(a){TabPanelBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},TabPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tabpanel",a);return UserInterface.registerBinding(b,TabPanelBinding),UserInterface.getBinding(b)},SplitBoxBinding.prototype=new FlexBoxBinding,SplitBoxBinding.prototype.constructor=SplitBoxBinding,SplitBoxBinding.superclass=FlexBoxBinding.prototype,SplitBoxBinding.ORIENT_HORIZONTAL="horizontal",SplitBoxBinding.ORIENT_VERTICAL="vertical",SplitBoxBinding.prototype.toString=function(){return"[SplitBoxBinding]"},SplitBoxBinding.prototype.serialize=function(){var a=SplitBoxBinding.superclass.serialize.call(this);return a&&(a.orient=this.getOrient(),a.layout=this.getLayout()),a},SplitBoxBinding.prototype.onBindingAttach=function(){if(this.isHorizontalOrient()&&Localization.isUIRtl)for(var a=this.bindingElement.childNodes.length;a--;)this.bindingElement.appendChild(this.bindingElement.childNodes[a]);SplitBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(SplitterBinding.ACTION_DRAGGED,this),this.addActionListener(SplitterBinding.ACTION_COLLAPSE,this),this.addActionListener(SplitterBinding.ACTION_UNCOLLAPSE,this),this._initializeLayout(),this._initializeOrient(),this._initializeSplitters()},SplitBoxBinding.prototype._initializeLayout=function(){this.isLayoutInitialized=!1;var a=this.getSplitPanelElements();if(a.hasEntries()){var b=new List(this.getLayout().split(":"));if(b.getLength()!=a.getLength())throw new Error(this+" DOM subree invalid");a.each(function(a){a.setAttribute("ratio",b.getNext())})}this.isLayoutInitialized=!0},SplitBoxBinding.prototype._initializeOrient=function(){var a=this.getProperty("orient");a&&(this._orient=a),this.attachClassName(this._orient)},SplitBoxBinding.prototype._initializeSplitters=function(){for(var a=this.getSplitterBindings();a.hasNext();){var b=a.getNext();b&&1==b.getProperty("collapsed")&&b.collapse()}},SplitBoxBinding.prototype.handleAction=function(a){switch(SplitBoxBinding.superclass.handleAction.call(this,a),a.type){case SplitterBinding.ACTION_DRAGGED:this.refreshLayout();break;case SplitterBinding.ACTION_COLLAPSE:this.collapse(a.target),a.consume();break;case SplitterBinding.ACTION_UNCOLLAPSE:this.unCollapse(a.target),a.consume()}},SplitBoxBinding.prototype.flex=function(){SplitBoxBinding.superclass.flex.call(this),1==this.isAttached&&this.invokeLayout(!0)},SplitBoxBinding.prototype.collapse=function(a){this._getSplitPanelBindingForSplitter(a).collapse(),this.invokeLayout()},SplitBoxBinding.prototype.unCollapse=function(a){this._getSplitPanelBindingForSplitter(a).unCollapse(),this.invokeLayout()},SplitBoxBinding.prototype._getSplitPanelBindingForSplitter=function(a){var b,c=DOMUtil.getOrdinalPosition(a.bindingElement,!0),d=this.getSplitPanelElements();switch(a.getCollapseDirection()){case SplitterBinding.COLLAPSE_BEFORE:b=d.get(c);break;case SplitterBinding.COLLAPSE_AFTER:b=d.get(c+1)}return UserInterface.getBinding(b)},SplitBoxBinding.prototype.invokeLayout=function(a){var b,c=this.isHorizontalOrient(),d=this.getSplitPanelBindings(),e=this.getSplitterBindings(),f=new List,g=0,h=0;if(d.each(function(a){1==a.isFixed?(d.hasNext()||(h+=a.getFix()),f.add(0),g+=0):(b=a.getRatio(),f.add(b),g+=b)}),0==g&&(this.logger.warn("Division by zero was hacked"),g=1),f.getLength()!=d.getLength())throw new Error(this+" Invalid property (ratio)");var i=c?this.getInnerWidth():this.getInnerHeight();i-=h,e.each(function(a){a.isVisible&&(i-=SplitterBinding.DIMENSION)});var j=i/g,k=0;if(d.each(function(a){var b=0,d=f.getNext();for(a.isFixed?b=a.getFix():(b=Math.floor(j*d),isNaN(b)&&alert("isNaN ( span ) ["+this.getProperty("layout")+"]")),k+=b;k>i;)k--,b--;a.isFixed||(c?a.setWidth(b):a.setHeight(b))}),1!=a&&this.reflex(),this._persist&&this._persist.layout){var l=this.getLayout();l&&this.setProperty("layout",l)}},SplitBoxBinding.prototype.computeLayout=function(){var a=this.isHorizontalOrient(),b=this.getSplitPanelBindings(),c=this.getSplitterBindings(),d=null,e=null,f=null,g=null;b.each(function(b){e||(e=a?b.getWidth():b.getHeight()),g=a?b.getWidth():b.getHeight(),f&&(g-=f,f=null),d=c.getNext(),d&&d.offset&&(f=d.offset,g+=f),b.setRatio(g/e)})},SplitBoxBinding.prototype.refreshLayout=function(){this.computeLayout(),this.invokeLayout()},SplitBoxBinding.prototype.setLayout=function(a){this.logger.debug(a),this.setProperty("layout",a),this._initializeLayout(),this.invokeLayout()},SplitBoxBinding.prototype.getLayout=function(){if(this.isLayoutInitialized){var a="",b=this.getSplitPanelBindings();b.each(function(c){a+=c.getRatio().toString(),a+=b.hasNext()?":":""}),this.setProperty("layout",a)}else this.getProperty("layout")||this.setProperty("layout",this.getDefaultLayout());return new String(this.getProperty("layout"))},SplitBoxBinding.prototype.getDefaultLayout=function(){var a=this.getSplitPanelElements();a.each(function(b){layout+="1"+(a.hasNext()?":":"")}),this.setProperty("layout",layout)},SplitBoxBinding.prototype.setWidth=function(a){this.bindingElement.style.width=a+"px"},SplitBoxBinding.prototype.getInnerWidth=function(){return Client.isFirefox?Math.floor(this.bindingElement.getBoundingClientRect().width):this.bindingElement.offsetWidth},SplitBoxBinding.prototype.setHeight=function(a){this.bindingElement.style.height=a+"px"},SplitBoxBinding.prototype.getInnerHeight=function(){return Client.isFirefox?Math.floor(this.bindingElement.getBoundingClientRect().height):this.bindingElement.offsetHeight},SplitBoxBinding.prototype.getOrient=function(){return this.getProperty("orient")},SplitBoxBinding.prototype.isHorizontalOrient=function(){return this._orient==SplitBoxBinding.ORIENT_HORIZONTAL},SplitBoxBinding.prototype.getSplitPanelElements=function(){var a=this.getChildElementsByLocalName("splitpanel");return this.isHorizontalOrient()&&Localization.isUIRtl&&a.reverse(),a},SplitBoxBinding.prototype.getSplitPanelBindings=function(){return this.getChildBindingsByLocalName("splitpanel")},SplitBoxBinding.prototype.getSplitterElements=function(){return this.getChildElementsByLocalName("splitter")},SplitBoxBinding.prototype.getSplitterBindings=function(){return this.getChildBindingsByLocalName("splitter")},SplitBoxBinding.prototype.fit=function(a){if(!this.isFit||a){if(!this.isHorizontalOrient())throw"SplitBoxBinding enforceFitness not supported vertically!";var b=0,c=this.getSplitPanelBindings();c.each(function(a){var c=a.bindingElement.offsetHeight;b=c>b?c:b}),this._setFitnessHeight(b),this.isFit=!0}},SplitBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitbox",a);return UserInterface.registerBinding(b,SplitBoxBinding)},SplitPanelBinding.prototype=new ControlBoxBinding,SplitPanelBinding.prototype.constructor=SplitPanelBinding,SplitPanelBinding.superclass=ControlBoxBinding.prototype,SplitPanelBinding.prototype.toString=function(){return"[SplitPanelBinding]"},SplitPanelBinding.prototype.onBindingAttach=function(){SplitPanelBinding.superclass.onBindingAttach.call(this),this._containingSplitBoxBinding=this.getAncestorBindingByLocalName("splitbox"),this.attachClassName(this._containingSplitBoxBinding.getOrient()),this.parseDOMProperties()},SplitPanelBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("type");a&&this.attachClassName(a);var b=this.getProperty("fix");b&&this.setFix(b);var c=this.getProperty("hidden");c&&this.hide()},SplitPanelBinding.prototype.collapse=function(){this.hide(),this.isCollapsed=!0,this.setProperty("collapsed","true")},SplitPanelBinding.prototype.unCollapse=function(){this.show(),this.isCollapsed=!1,this.deleteProperty("collapsed")},SplitPanelBinding.prototype.hide=function(){1==this.isVisible&&(this.setProperty("ratiocache",this.getRatio()),this.setRatio(0),this.bindingElement.style.display="none",this.setProperty("hidden",!0),this.isVisible=!1)},SplitPanelBinding.prototype.show=function(){if(!this.isVisible){var a=this.getProperty("ratiocache");a?(this.setRatio(a),this.deleteProperty("ratiocache")):this._containingSplitBoxBinding.computeLayout(),this.bindingElement.style.display="block",this.deleteProperty("hidden"),this.isVisible=!0}},SplitPanelBinding.prototype.setWidth=function(a){if(!this.isFixed&&a!=this.getWidth()){0>a&&(a=this.getWidth(),this.logger.warn("SplitPanelBinding#setWidth bug in Internet Explorer!"));try{this.bindingElement.style.width=a+"px"}catch(b){alert("SplitPanelBinding#setWidth: Occult width: "+a),alert(arguments.caller.callee)}}},SplitPanelBinding.prototype.getWidth=function(){var a=null;return a=this.isFixed?this.getFix():this.bindingElement.offsetWidth},SplitPanelBinding.prototype.setHeight=function(a){if(!this.isFixed&&a!=this.getHeight())try{this.bindingElement.style.height=a+"px"}catch(a){alert("SplitPanelBinding.prototype.setHeight"+arguments.caller.callee)}},SplitPanelBinding.prototype.getHeight=function(){var a=null;return a=this.isFixed?this.getFix():this.bindingElement.offsetHeight},SplitPanelBinding.prototype.setRatio=function(a){this.setProperty("ratio",a)},SplitPanelBinding.prototype.getRatio=function(){return this.getProperty("ratio")},SplitPanelBinding.prototype.setFix=function(a){if(a){switch(this._fixedSpan=a,this._containingSplitBoxBinding.getOrient()){case SplitBoxBinding.ORIENT_HORIZONTAL:this.logger.warn("Fix not properly supported on horizontal splitboxes!"),this.setWidth(a);break;case SplitBoxBinding.ORIENT_VERTICAL:this.setHeight(a)}this.isFixed=!0}else this._fixedSpan=null,this.isFixed=!1},SplitPanelBinding.prototype.getFix=function(){return this._fixedSpan},SplitPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitpanel",a);return UserInterface.registerBinding(b,SplitPanelBinding)},SplitterBinding.prototype=new Binding,SplitterBinding.prototype.constructor=SplitterBinding,SplitterBinding.superclass=Binding.prototype,SplitterBinding.DIMENSION=0,SplitterBinding.BUFFER=30,SplitterBinding.COLLAPSE_AFTER="after",SplitterBinding.COLLAPSE_BEFORE="before",SplitterBinding.ACTION_DRAGSTART="splitter dragstart",SplitterBinding.ACTION_DRAGGED="splitter dragged",SplitterBinding.ACTION_COLLAPSE="splitter collapse",SplitterBinding.ACTION_UNCOLLAPSE="splitter uncollapse",SplitterBinding.CLASSNAME_ACTIVE="active",SplitterBinding.CLASSNAME_HOVER="hover",SplitterBinding.prototype.toString=function(){return"[SplitterBinding]"},SplitterBinding.prototype.serialize=function(){var a=SplitBoxBinding.superclass.serialize.call(this);return a&&(a.collapse=this.getProperty("collapse"),a.collapsed=this.getProperty("collapsed"),a.disabled=this.getProperty("isdisabled")),a},SplitterBinding.prototype.onBindingAttach=function(){SplitterBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_DRAG),this._containingSplitBoxBinding=this.getAncestorBindingByLocalName("splitbox"),this.attachClassName(this._containingSplitBoxBinding.getOrient()),this._collapseDirection=this.getProperty("collapse"),this.buildDOMContent(),this.attachDOMEvents();var a=this.getProperty("hidden");a&&this.hide()},SplitterBinding.prototype.buildDOMContent=function(){if(this.shadowTree.splitterBody=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitterbody",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.splitterBody),1==Client.isMozilla){var a=this.bindingDocument.createTextNode("!");this.bindingElement.appendChild(a)}},SplitterBinding.prototype.attachDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT)},SplitterBinding.prototype.collapse=function(){this.isCollapsed||(this.hide(),this.setProperty("collapsed","true"),this.isCollapsed=!0,this.dispatchAction(SplitterBinding.ACTION_COLLAPSE))},SplitterBinding.prototype.unCollapse=function(){1==this.isCollapsed&&(this.show(),this.deleteProperty("collapsed"),this.isCollapsed=!1,this.dispatchAction(SplitterBinding.ACTION_UNCOLLAPSE))},SplitterBinding.prototype.getCollapseDirection=function(){return this._collapseDirection},SplitterBinding.prototype.setCollapseDirection=function(a){this.setProperty("collapse",a),this._collapseDirection=a},SplitterBinding.prototype.handleAction=function(a){switch(SplitterBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DRAG:this.dragger.registerHandler(this),a.consume()}},SplitterBinding.prototype.handleEvent=function(a){SplitterBinding.superclass.handleEvent.call(this,a);var b=this;if(!this.isDragging&&!this.isDisabled)switch(a.type){case DOMEvents.MOUSEOVER:window.splitterTimeout=window.setTimeout(function(){b.shadowTree.splitterBody.className=SplitterBinding.CLASSNAME_HOVER},250);break;case DOMEvents.MOUSEOUT:window.splitterTimeout&&window.clearTimeout(window.splitterTimeout),b.shadowTree.splitterBody.className==SplitterBinding.CLASSNAME_HOVER&&(this.shadowTree.splitterBody.className="")}},SplitterBinding.prototype.onDragStart=function(a){this.dispatchAction(SplitterBinding.ACTION_DRAGSTART),this.attachClassName(SplitterBinding.CLASSNAME_ACTIVE),this.shadowTree.splitterBody.className=SplitterBinding.CLASSNAME_ACTIVE,this.isDragging=!0},SplitterBinding.prototype.onDrag=function(a){a=this.getEvaluatedDiff(a),this._containingSplitBoxBinding.isHorizontalOrient()?this.shadowTree.splitterBody.style.left=a.x+"px":this.shadowTree.splitterBody.style.top=a.y+"px"},SplitterBinding.prototype.onDragStop=function(a){a=this.getEvaluatedDiff(a),this.offset=this._containingSplitBoxBinding.isHorizontalOrient()?a.x:a.y,this.dispatchAction(SplitterBinding.ACTION_DRAGGED),this.offset=null,this.detachClassName(SplitterBinding.CLASSNAME_ACTIVE),this.shadowTree.splitterBody.className="",this.isDragging=!1,this._containingSplitBoxBinding.isHorizontalOrient()?this.shadowTree.splitterBody.style.left="0":this.shadowTree.splitterBody.style.top="0"},SplitterBinding.prototype.getEvaluatedDiff=function(a){switch(this._containingSplitBoxBinding.getOrient()){case SplitBoxBinding.ORIENT_HORIZONTAL:var b=this.bindingElement.offsetLeft,c=this.bindingElement.offsetWidth,d=this.bindingElement.parentNode.offsetWidth,e=-b+SplitterBinding.BUFFER,f=d-b-c-SplitterBinding.BUFFER;a.x=a.x<=e?e:a.x,a.x=a.x>=f?f:a.x;break;case SplitBoxBinding.ORIENT_VERTICAL:var g=this.bindingElement.offsetTop,h=this.bindingElement.offsetHeight,d=this.bindingElement.parentNode.offsetHeight,e=-g+SplitterBinding.BUFFER,f=d-g-h-SplitterBinding.BUFFER;a.y=a.y<=e?e:a.y,a.y=a.y>=f?f:a.y}return a},SplitterBinding.prototype.disable=function(){this.isDisabled||(alert("disable"),this.isDisabled=!0,this.disableDragging(),this.setProperty("isdisabled",!0))},SplitterBinding.prototype.enable=function(){1==this.isDisabled&&(this.isDisabled=!1,this.enableDragging(),this.deleteProperty("isdisabled"))},SplitterBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitter",a);return UserInterface.registerBinding(b,SplitterBinding)},DecksBinding.prototype=new FlexBoxBinding,DecksBinding.prototype.constructor=DecksBinding,DecksBinding.superclass=FlexBoxBinding.prototype,DecksBinding.ACTION_SELECTED="decks deck selected",DecksBinding.NODENAME_DECK="deck",DecksBinding.prototype.toString=function(){return"[DecksBinding]"},DecksBinding.prototype.onBindingRegister=function(){DecksBinding.superclass.onBindingRegister.call(this),this._lastKnownDimension=new Dimension(0,0),this.attachClassName("deckselement")},DecksBinding.prototype.onBindingAttach=function(){DecksBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("selectedindex"),b=this.getDeckElements();if(b.hasEntries()){for(var c=!1,d=0;b.hasNext();){var e=b.getNext();a&&d==a?(e.setAttribute("selected","true"),c=!0):"true"==e.getAttribute("selected")&&(c=!0),d++}c||b.getFirst().setAttribute("selected","true")}},DecksBinding.prototype.getDeckElements=function(){return this.getChildElementsByLocalName(this.constructor.NODENAME_DECK)},DecksBinding.prototype.select=function(a){var b=this.getBindingForArgument(a);if(null==b)throw"No deck for argument "+a;if(b!=this._selectedDeckBinding){this._selectedDeckBinding&&this._selectedDeckBinding.unselect(),this._selectedDeckBinding=b,b.select();var c=this.getProperty("selectedindex");null!=c&&this.setProperty("selectedindex",DOMUtil.getOrdinalPosition(b.bindingElement,!0)),this.dispatchAction(DecksBinding.ACTION_SELECTED),this.dispatchAction(FocusBinding.ACTION_UPDATE)}},DecksBinding.prototype.hasDimensionsChanged=function(){var a=!1,b=this.boxObject.getDimension(),c=this._lastKnownDimension;return Dimension.isEqual(b,c)||(a=!0,this._lastKnownDimension=b),a},DecksBinding.prototype.getSelectedDeckBinding=function(){return this._selectedDeckBinding},DecksBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:decks",a);return UserInterface.registerBinding(b,DecksBinding)},DeckBinding.prototype=new FlexBoxBinding,DeckBinding.prototype.constructor=DeckBinding,DeckBinding.superclass=FlexBoxBinding.prototype,DeckBinding.ACTION_SELECTED="deck selected",DeckBinding.ACTION_UNSELECTED="deck unselected",DeckBinding.NODENAME_DECKS="decks",DeckBinding.CLASSNAME="deckelement",DeckBinding.prototype.toString=function(){return"[DeckBinding]"},DeckBinding.prototype.onBindingRegister=function(){DeckBinding.superclass.onBindingRegister.call(this),this.addActionListener(BalloonBinding.ACTION_INITIALIZE),this.attachClassName(DeckBinding.CLASSNAME)},DeckBinding.prototype.onBindingAttach=function(){DeckBinding.superclass.onBindingAttach.call(this),this.containingDecksBinding=this.getAncestorBindingByLocalName(this.constructor.NODENAME_DECKS),1==this.getProperty("selected")&&this.containingDecksBinding.select(this)},DeckBinding.prototype.handleAction=function(a){DeckBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},DeckBinding.prototype.select=function(){if(!this.isSelected)if(1==this.isLazy)this.wakeUp("select");else{this.isSelected=!0,this.isVisible=!0,this.setProperty("selected","true"),this.bindingElement.style.position="static",this._invokeManagedRecursiveFlex(),this.dispatchAction(DeckBinding.ACTION_SELECTED);var a=UserInterface.getBinding(this.bindingDocument.body);a.isActivated&&this.dispatchAction(FocusBinding.ACTION_FOCUS)}},DeckBinding.prototype.unselect=function(){this.isSelected&&(this.dispatchAction(FocusBinding.ACTION_BLUR),this.deleteProperty("selected"),this.isSelected=!1,this.isVisible=!1,this.bindingElement.style.position="absolute",this.dispatchAction(DeckBinding.ACTION_UNSELECTED))},DeckBinding.prototype._invokeManagedRecursiveFlex=function(){this.reflex(!0)},DeckBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:deck",a);return UserInterface.registerBinding(b,DeckBinding)},ToolBarBinding.prototype=new Binding,ToolBarBinding.prototype.constructor=ToolBarBinding,ToolBarBinding.superclass=Binding.prototype,ToolBarBinding.TYPE_TEXTONLY="textonly",ToolBarBinding.TYPE_IMAGESONLY="imagesonly",ToolBarBinding.TYPE_DEFAULT="imagesandtext",ToolBarBinding.CLASSNAME_TEXTONLY="textonly",ToolBarBinding.CLASSNAME_IMAGESONLY="imagesonly",ToolBarBinding.CLASSNAME_IMAGESIZELARGE="imagesizelarge",ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE="imagesizexlarge",ToolBarBinding.CLASSNAME_ICONSIZE_22="icons-s-22",ToolBarBinding.IMAGESIZE_NORMAL="normal",ToolBarBinding.IMAGESIZE_LARGE="large",ToolBarBinding.ICONSIZE_22="icons-s-22",ToolBarBinding.prototype.toString=function(){return"[ToolBarBinding]"},ToolBarBinding.prototype.onBindingRegister=function(){ToolBarBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},ToolBarBinding.prototype.onBindingAttach=function(){ToolBarBinding.superclass.onBindingAttach.call(this),this.parseDOMProperties(),this.buildDOMContent(),this.addMembers(this.getChildBindingsByLocalName("toolbarbody"))},ToolBarBinding.prototype.onMemberInitialize=function(a){a instanceof ToolBarBodyBinding&&(a.isRightAligned?this._toolBarBodyRight||(this._toolBarBodyRight=a):this._toolBarBodyLeft||(this._toolBarBodyLeft=a)),ToolBarBinding.superclass.onMemberInitialize.call(this,a)},ToolBarBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("imagesize"),b=this.getProperty("type");a&&this.setImageSize(a),b?this.setType(b):this.setType(this.type)},ToolBarBinding.prototype.buildDOMContent=function(){if(1==this._hasDefaultContent&&!this._hasDOMContent){var a=ToolBarGroupBinding.newInstance(this.bindingDocument);a.add(ToolBarButtonBinding.newInstance(this.bindingDocument)),a.isDefaultContent=!0,this.add(a),a.attachRecursive(),this._hasDOMContent=!0}},ToolBarBinding.prototype.flex=function(){var a=this._toolBarBodyLeft,b=this._toolBarBodyRight;null!=a&&a.hasClassName("max")&&this._maxToolBarGroup(a,b),null!=b&&b.hasClassName("max")&&this._maxToolBarGroup(b,a)},ToolBarBinding.prototype._maxToolBarGroup=function(a,b){var c=this.boxObject.getDimension().w,d=CSSComputer.getPadding(this.bindingElement);c-=d.left+d.right,null!=b&&(c-=b.boxObject.getDimension().w,Client.isWindows||(c-=1),Client.isExplorer&&(c-=15)),a.bindingElement.style.width=c+"px"},ToolBarBinding.prototype.getToolBarGroupByIndex=function(a){return this.getDescendantBindingsByLocalName("toolbargroup").get(a)},ToolBarBinding.prototype.addLeft=function(a,b){var c=null;if(null==this._toolBarBodyLeft)throw new Error("No left toolbarbody");return c=this._toolBarBodyLeft.add(a,b)},ToolBarBinding.prototype.addLeftFirst=function(a,b){var c=null;if(!this._toolBarBodyLeft)throw new Error("No left toolbarbody");return c=this._toolBarBodyLeft.addFirst(a,b)},ToolBarBinding.prototype.addRight=function(a){var b=null;if(!this._toolBarBodyRight)throw new Error("No left toolbarbody");return b=this._toolBarBodyRight.add(a)},ToolBarBinding.prototype.empty=function(){this.emptyLeft(),this.emptyRight()},ToolBarBinding.prototype.emptyLeft=function(){this._toolBarBodyLeft&&this._toolBarBodyLeft.empty()},ToolBarBinding.prototype.emptyRight=function(){this._toolBarBodyRight&&this._toolBarBodyRight.empty()},ToolBarBinding.prototype.setImageSize=function(a){switch(a){case ToolBarBinding.IMAGESIZE_LARGE:this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE);break;case ToolBarBinding.IMAGESIZE_XLARGE:this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE);break;case ToolBarBinding.ICONSIZE_22:this.attachClassName(ToolBarBinding.CLASSNAME_ICONSIZE_22);break;default:this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE)}this._imageSize=a,this.setProperty("imagesize",a)},ToolBarBinding.prototype.getImageSize=function(){return this._imageSize},ToolBarBinding.prototype.showImagesOnly=function(){this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.hasImages=!0,this.hasText=!1},ToolBarBinding.prototype.showTextOnly=function(){this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.attachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.hasImages=!1,this.hasText=!0},ToolBarBinding.prototype.showBoth=function(){this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.hasImages=!0,this.hasText=!0},ToolBarBinding.prototype.setType=function(a){switch(a){case ToolBarBinding.TYPE_TEXTONLY:this.showTextOnly();break;case ToolBarBinding.TYPE_IMAGESONLY:this.showImagesOnly();break;default:this.showBoth()}this.setProperty("type",a)},ToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbar",a);return UserInterface.registerBinding(b,ToolBarBinding)},ToolBarBodyBinding.prototype=new Binding,ToolBarBodyBinding.prototype.constructor=ToolBarBodyBinding,ToolBarBodyBinding.superclass=Binding.prototype,ToolBarBodyBinding.prototype.toString=function(){return"[ToolBarBodyBinding]"},ToolBarBodyBinding.prototype.onBindingAttach=function(){ToolBarBodyBinding.superclass.onBindingAttach.call(this),this.addMembers(this.getChildBindingsByLocalName("toolbargroup")),("right"==this.getProperty("align")||this.isRightAligned)&&this.alignRight()},ToolBarBodyBinding.prototype.onBindingInitialize=function(){this.refreshToolBarGroups(),ToolBarBodyBinding.superclass.onBindingInitialize.call(this)},ToolBarBodyBinding.prototype.alignRight=function(){this.attachClassName("alignright"),this.setProperty("align","right"),this.isRightAligned=!0},ToolBarBodyBinding.prototype.refreshToolBarGroups=function(){var a=this.getDescendantBindingsByLocalName("toolbargroup"),b=new List,c=!0;for(a.each(function(a){a.isVisible&&!a.isDefaultContent&&b.add(a)});b.hasNext();){var d=b.getNext();d.setLayout(ToolBarGroupBinding.LAYOUT_DEFAULT),c&&(d.setLayout(ToolBarGroupBinding.LAYOUT_FIRST),c=!1),b.hasNext()||d.setLayout(ToolBarGroupBinding.LAYOUT_LAST)}this.getProperty("equalsize")&&this.enforceEqualSize()},ToolBarBodyBinding.prototype.enforceEqualSize=function(){for(var a=0,b=this.getDescendantBindingsByLocalName("clickbutton");b.hasNext();){var c=b.getNext(),d=c.getEqualSizeWidth();d>a&&(a=d)}if(0!=a)for(b.reset();b.hasNext();){var c=b.getNext();c.setEqualSizeWidth(a)}},ToolBarBodyBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},ToolBarBodyBinding.prototype.add=function(a,b){var c=ToolBarBinding.superclass.add.call(this,a);return b||a instanceof ToolBarGroupBinding&&this.isAttached&&this.refreshToolBarGroups(),c},ToolBarBodyBinding.prototype.addFirst=function(a,b){var c=ToolBarBinding.superclass.addFirst.call(this,a);return b||a instanceof ToolBarGroupBinding&&this.isAttached&&this.refreshToolBarGroups(),c},ToolBarBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbody",a);return UserInterface.registerBinding(b,ToolBarBodyBinding)},ToolBarGroupBinding.prototype=new RadioGroupBinding,ToolBarGroupBinding.prototype.constructor=ToolBarGroupBinding,ToolBarGroupBinding.superclass=RadioGroupBinding.prototype,ToolBarGroupBinding.LAYOUT_DEFAULT=0,ToolBarGroupBinding.LAYOUT_FIRST=1,ToolBarGroupBinding.LAYOUT_LAST=2,ToolBarGroupBinding.CLASSNAME_DEFAULTCONTENT="defaultcontent",ToolBarGroupBinding.prototype.toString=function(){return"[ToolBarGroupBinding]"},ToolBarGroupBinding.prototype.onBindingAttach=function(){ToolBarGroupBinding.superclass.onBindingAttach.call(this),this.addMembers(this.getDescendantBindingsByLocalName("toolbarbutton")),this.addMembers(this.getDescendantBindingsByLocalName("toolbarlabel")),this.addMembers(this.getDescendantBindingsByLocalName("clickbutton")),1==this.isDefaultContent&&this.attachClassName(ToolBarGroupBinding.CLASSNAME_DEFAULTCONTENT)},ToolBarGroupBinding.prototype.setLayout=function(a){switch(a){case ToolBarGroupBinding.LAYOUT_DEFAULT:this.detachClassName("first"),this.detachClassName("last");break;case ToolBarGroupBinding.LAYOUT_FIRST:this.attachClassName("first");break;case ToolBarGroupBinding.LAYOUT_LAST:this.attachClassName("last")}},ToolBarGroupBinding.prototype.show=function(){ToolBarGroupBinding.superclass.show.call(this);var a=this.bindingElement.parentNode;"toolbarbody"==DOMUtil.getLocalName(a)&&UserInterface.getBinding(a).refreshToolBarGroups()},ToolBarGroupBinding.prototype.hide=function(){ToolBarGroupBinding.superclass.hide.call(this);var a=this.bindingElement.parentNode;"toolbarbody"==DOMUtil.getLocalName(a)&&UserInterface.getBinding(a).refreshToolBarGroups()},ToolBarGroupBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},ToolBarGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbargroup",a);return UserInterface.registerBinding(b,ToolBarGroupBinding)},ToolBarButtonBinding.prototype=new ButtonBinding,ToolBarButtonBinding.prototype.constructor=ToolBarButtonBinding,ToolBarButtonBinding.superclass=ButtonBinding.prototype,ToolBarButtonBinding.prototype.toString=function(){return"[ToolBarButtonBinding]"},ToolBarButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,ToolBarButtonBinding)},ToolBarLabelBinding.prototype=new Binding,ToolBarLabelBinding.prototype.constructor=ToolBarLabelBinding,ToolBarLabelBinding.superclass=Binding.prototype,ToolBarLabelBinding.prototype.toString=function(){return"[ToolBarLabelBinding]"},ToolBarLabelBinding.prototype.onBindingAttach=function(){ToolBarLabelBinding.superclass.onBindingAttach.call(this),this._labelBinding=this.add(LabelBinding.newInstance(this.bindingDocument)),this.shadowTree.label=this._labelBinding;var a=this.getProperty("label"),b=this.getProperty("image");a&&this.setLabel(a),b&&this.setImage(b)},ToolBarLabelBinding.prototype.setLabel=function(a,b){this.isAttached&&this._labelBinding.setLabel(a,b),this.setProperty("label",a)},ToolBarLabelBinding.prototype.setImage=function(a,b){this.isAttached&&this._labelBinding.setImage(a,b),this.setProperty("image",a)},ToolBarLabelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarlabel",a);return UserInterface.registerBinding(b,ToolBarLabelBinding)},DialogToolBarBinding.prototype=new ToolBarBinding,DialogToolBarBinding.prototype.constructor=DialogToolBarBinding,DialogToolBarBinding.superclass=ToolBarBinding.prototype,DialogToolBarBinding.prototype.toString=function(){return"[DialogToolBarBinding]"},DialogToolBarBinding.prototype.onBindingRegister=function(){DialogToolBarBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(Binding.ACTION_BLURRED)},DialogToolBarBinding.prototype.onBindingDispose=function(){DialogToolBarBinding.superclass.onBindingDispose.call(this),1==this._isListening&&this.unsubscribe(BroadcastMessages.KEY_ENTER)},DialogToolBarBinding.prototype.onBindingInitialize=function(){this.indexDialogButtons(),DialogToolBarBinding.superclass.onBindingInitialize.call(this)},DialogToolBarBinding.prototype.indexDialogButtons=function(){var a=this.getDescendantBindingsByLocalName("clickbutton");if(a.hasEntries()){for(;a.hasNext();){var b=a.getNext();b.isDefault&&(this._defaultButton=b,b.attachClassName(ButtonBinding.CLASSNAME_DEFAULT)),!this._isListening&&b.isFocusable&&(this.subscribe(BroadcastMessages.KEY_ENTER),this._isListening=!0)}this._buttons=a}},DialogToolBarBinding.prototype.handleBroadcast=function(a,b){
switch(DialogToolBarBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ENTER:if(!PopupBinding.hasActiveInstances()&&!EditorBinding.isActive)if(Binding.exists(this)){var c=this.getAncestorBindingByType(DialogBinding,!0);null!=c&&c.isActive&&(null!=this._focusedButton?this._focusedButton.isDisabled||(this.unsubscribe(BroadcastMessages.KEY_ENTER),this._focusedButton.fireCommand()):this._defaultButton.isDisabled||(this.unsubscribe(BroadcastMessages.KEY_ENTER),this._defaultButton.fireCommand()))}else this.logger.error("Ouch: DialogToolBarBinding#handleBroadcast")}},DialogToolBarBinding.prototype.handleAction=function(a){DialogToolBarBinding.superclass.handleAction.call(this,a);var b=a.target,c=!1,d=this._buttons.reset();if(b instanceof ClickButtonBinding)switch(a.type){case Binding.ACTION_FOCUSED:b.attachClassName(ButtonBinding.CLASSNAME_FOCUSED),this._focusedButton=b,this._defaultButton&&this._defaultButton.detachClassName(ButtonBinding.CLASSNAME_DEFAULT);break;case Binding.ACTION_BLURRED:b.detachClassName(ButtonBinding.CLASSNAME_FOCUSED)}if(this._defaultButton){for(;!c&&d.hasNext();){var e=d.getNext();c=e.isFocused}c||(this._defaultButton.attachClassName(ButtonBinding.CLASSNAME_DEFAULT),this._focusedButton=null)}},ComboBoxBinding.prototype=new Binding,ComboBoxBinding.prototype.constructor=ComboBoxBinding,ComboBoxBinding.superclass=Binding.prototype,ComboBoxBinding.prototype.toString=function(){return"[ComboBoxBinding]"},ComboBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:combobox",a);return UserInterface.registerBinding(b,ComboBoxBinding)},ToolBarComboButtonBinding.prototype=new ToolBarButtonBinding,ToolBarComboButtonBinding.prototype.constructor=ToolBarComboButtonBinding,ToolBarComboButtonBinding.superclass=ToolBarButtonBinding.prototype,ToolBarComboButtonBinding.CLASSNAME_COMBOBUTTON="combobutton",ToolBarComboButtonBinding.STORAGE_PREFFIX="STORAGEBUTTONHANDLE",ToolBarComboButtonBinding.prototype.toString=function(){return"[ToolBarComboButtonBinding]"},ToolBarComboButtonBinding.prototype.onBindingAttach=function(){ToolBarComboButtonBinding.superclass.onBindingAttach.call(this),this.comboBoxBinding=ComboBoxBinding.newInstance(this.bindingDocument),this.add(this.comboBoxBinding),this.comboBoxBinding.attach(),this.attachClassName(ToolBarComboButtonBinding.CLASSNAME_COMBOBUTTON),this.keepState=this.getProperty("keepstate")!==!1},ToolBarComboButtonBinding.prototype.handleBroadcast=function(a,b){ToolBarComboButtonBinding.superclass.handleBroadcast.call(this,a,b)},ToolBarComboButtonBinding.prototype.setPopup=function(a){ToolBarComboButtonBinding.superclass.setPopup.call(this,a);var b=this,c=this.popupBinding.getDescendantBindingsByType(MenuItemBinding);c.each(function(a){var c=a.getProperty("oncommand");a.setProperty("hiddencommand",c),a.deleteProperty("oncommand"),a.oncommand=function(){b.setAndFireButton(this)}},this);var d=null;if(this.keepState){var e=this.getActiveMenuHandle();c.each(function(a){return this.getMenuHandle(a)!==e||a.isDisabled?!0:(d=a,!1)},this)}null==d&&c.each(function(a){return a.isDisabled?!0:(d=a,!1)},this),null!=d&&this.setButton(d),this.comboBoxBinding&&(c.getLength()<=1?this.comboBoxBinding.hide():this.comboBoxBinding.show())},ToolBarComboButtonBinding.prototype.setButton=function(a){if(a instanceof MenuItemBinding){var b=a.getProperty("label"),c=a.getProperty("image"),d=a.getProperty("hiddencommand");this.setLabel(b?b:""),this.setImage(c),!this.isDisabled&&a.isDisabled?this.setDisabled(!0):this.isDisabled&&!a.isDisabled&&this.setDisabled(!1),a.associatedSystemAction&&(this.associatedSystemAction=a.associatedSystemAction),this.oncommand=function(){Binding.evaluate(d,this)},this.hideActiveItem(a)}},ToolBarComboButtonBinding.prototype.getAssociatedSystemActions=function(){var a=new List;return this.popupBinding.getDescendantBindingsByType(MenuItemBinding).each(function(b){b.associatedSystemAction&&a.add(b.associatedSystemAction)}),a},ToolBarComboButtonBinding.prototype.setAndFireButton=function(a){a instanceof MenuItemBinding&&(this.keepState?(this.setButton(a),this.saveActiveMenuHandle(this.getMenuHandle(a)),this.fireCommand()):this.dispatchAction(new Action(a,this.commandAction)))},ToolBarComboButtonBinding.prototype.hideActiveItem=function(a){this.popupBinding.getDescendantBindingsByType(MenuItemBinding).each(function(b){b===a?Binding.prototype.hide.call(b):Binding.prototype.show.call(b)})},ToolBarComboButtonBinding.prototype.saveActiveMenuHandle=function(a){LocalStorage.set(ToolBarComboButtonBinding.STORAGE_PREFFIX+this.getBundleName(),a)},ToolBarComboButtonBinding.prototype.getActiveMenuHandle=function(){return LocalStorage.get(ToolBarComboButtonBinding.STORAGE_PREFFIX+this.getBundleName())},ToolBarComboButtonBinding.prototype.getMenuHandle=function(a){return a.menuHandle?a.menuHandle:a.getProperty("id")},ToolBarComboButtonBinding.prototype.getBundleName=function(){return this.getProperty("bundle")?this.getProperty("bundle"):this.getProperty("id")},ToolBarComboButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,ToolBarComboButtonBinding)},ToolBoxToolBarButtonBinding.prototype=new ToolBarButtonBinding,ToolBoxToolBarButtonBinding.prototype.constructor=ToolBoxToolBarButtonBinding,ToolBoxToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,ToolBoxToolBarButtonBinding.prototype.toString=function(){return"[ToolBoxToolBarButtonBinding]"},ToolBoxToolBarButtonBinding.prototype.onBindingAttach=function(){if(ToolBoxToolBarButtonBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives){this.subscribe(BroadcastMessages.PERSPECTIVE_CHANGED);var a=this._views;for(var b in ViewDefinitions){var c=ViewDefinitions[b],d=c.perspective;if(null!=d){a.has(d)||a.set(d,new List);var e=a.get(d);e.add(c)}}}else this.hide()},ToolBoxToolBarButtonBinding.prototype.handleBroadcast=function(a,b){switch(ToolBoxToolBarButtonBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.PERSPECTIVE_CHANGED:var c=b;if(c!=this._lastGeneratedPerspective){this._lastGeneratedPerspective=c;var d=this.bindingWindow.bindingMap.toolboxpopupgroup;if(d.empty(),this._views.has(c)){var e=this._views.get(c);e.each(function(a){var b=d.add(StageViewMenuItemBinding.newInstance(d.bindingDocument));b.setType(MenuItemBinding.TYPE_CHECKBOX),b.setHandle(a.handle),b.setLabel(a.label),b.setImage(a.image),b.setToolTip(a.toolTip),b.attach()}),d.show()}else d.hide()}}},TreeBinding.prototype=new FlexBoxBinding,TreeBinding.prototype.constructor=TreeBinding,TreeBinding.superclass=FlexBoxBinding.prototype,TreeBinding.ACTION_SELECTIONCHANGED="tree selection changed",TreeBinding.ACTION_NOSELECTION="tree selection none",TreeBinding.SELECTIONTYPE_SINGLE="single",TreeBinding.SELECTIONTYPE_MULTIPLE="multiple",TreeBinding.grid=function(a){var b=TreeNodeBinding.HEIGHT,c=(Math.ceil(a),a%b);return c>0&&(a=a-c+b),a+TreeBodyBinding.PADDING_TOP},TreeBinding.prototype.toString=function(){return"[TreeBinding]"},TreeBinding.prototype.onBindingRegister=function(){TreeBinding.superclass.onBindingRegister.call(this),this._treeNodeBindings=new Map,this._treeNodeBuffer=new List,this._focusedTreeNodeBindings=new List},TreeBinding.prototype.onBindingAttach=function(){TreeBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("focusable");if(null!=a&&(this._isFocusable=a),this._treeBodyBinding||0!==this.bindingElement.childElementCount||(this._treeBodyBinding=TreeBodyBinding.newInstance(this.bindingDocument),this.bindingElement.appendChild(this._treeBodyBinding.bindingElement),this._treeBodyBinding.attach()),this._treeBodyBinding||(this._treeBodyBinding=this.addMember(this.getChildBindingByLocalName("treebody"))),this._treeBodyBinding)this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(TreeNodeBinding.ACTION_OPEN),this.addActionListener(TreeNodeBinding.ACTION_CLOSE),this.addActionListener(TreeNodeBinding.ACTION_DISPOSE),this._isFocusable&&(this.addActionListener(TreeNodeBinding.ACTION_ONFOCUS),this.addActionListener(TreeNodeBinding.ACTION_ONMULTIFOCUS),this.addActionListener(TreeNodeBinding.ACTION_BLUR)),this.subscribe(BroadcastMessages.TYPEDRAG_START),this.subscribe(BroadcastMessages.TYPEDRAG_STOP),this.addEventListener(DOMEvents.BEFOREUPDATE),this.addEventListener(DOMEvents.AFTERUPDATE);else{var b="TreeBinding structure invalid. Missing TreeBodyBinding.";this.logger.error(b),Application.isDeveloperMode&&alert(b)}},TreeBinding.prototype.onBindingInitialize=function(){TreeBinding.superclass.onBindingInitialize.call(this),this._setupTreeSelection();var a=this.getProperty("builder");if(a)this._buildFromTextArea(a);else if(this._treeNodeBuffer.hasEntries())for(;this._treeNodeBuffer.hasNext();)this.add(this._treeNodeBuffer.getNext())},TreeBinding.prototype._setupTreeSelection=function(){var a=this.getProperty("selectable"),b=this.getProperty("selectionproperty"),c=this.getProperty("selectionvalue");a&&(this.setSelectable(!0),b&&this.setSelectionProperty(b),c&&this.setSelectionValue(c)),this._positionIndicatorBinding=this.add(TreePositionIndicatorBinding.newInstance(this.bindingDocument)),this.shadowTree.positionIndicator=this._positionIndicatorBinding,this._positionIndicatorBinding.attach()},TreeBinding.prototype._buildFromTextArea=function(a){function b(){e.subTreeFromString(c.value)}var c=this.bindingDocument.getElementById(a);if(null!=c){var d=UserInterface.getBinding(c),e=this._treeBodyBinding;d.addActionListener(Binding.ACTION_UPDATED,{handleAction:function(){b()}}),setTimeout(b,0)}},TreeBinding.prototype.registerTreeNodeBinding=function(a){var b=a.getHandle();if(this._treeNodeBindings.has(b))throw"Duplicate treenodehandles registered: "+a.getLabel();this._treeNodeBindings.set(b,a);var c=this._openTreeNodesBackupMap;null!=c&&c.has(b)&&a.open()},TreeBinding.prototype.unRegisterTreeNodeBinding=function(a){this._treeNodeBindings.del(a.getHandle())},TreeBinding.prototype.getTreeNodeBindingByHandle=function(a){var b=null;if(!this._treeNodeBindings.has(a))throw"No such treenode: "+a;return b=this._treeNodeBindings.get(a)},TreeBinding.prototype.handleAction=function(a){TreeBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case TreeNodeBinding.ACTION_OPEN:a.consume();break;case TreeNodeBinding.ACTION_CLOSE:this._blurDescendantBindings(b),a.consume();break;case TreeNodeBinding.ACTION_ONFOCUS:this._nodePrimary=b,this.focusSingleTreeNodeBinding(b),this.isFocused||this.focus(),a.consume();break;case TreeNodeBinding.ACTION_ONMULTIFOCUS:switch(this._selectionType){case TreeBinding.SELECTIONTYPE_SINGLE:this._nodePrimary=b,this.focusSingleTreeNodeBinding(b);break;case TreeBinding.SELECTIONTYPE_SINGLE:this._nodeSecondary=b,this._nodePrimary&&this._nodeSecondary!=this._nodePrimary?this.focusMultipeTreeNodeBindings(this._getVisibleTreeNodeBindingsInRange(this._nodePrimary,this._nodeSecondary)):(this._nodePrimary=b,this.focusSingleTreeNodeBinding(b))}this.isFocused||this.focus(),a.consume();break;case TreeNodeBinding.ACTION_DISPOSE:b.isFocused&&this.blurSelectedTreeNodes(),a.consume();break;case TreeNodeBinding.ACTION_BLUR:break;case Binding.ACTION_ACTIVATED:this.isFocused||this.focus()}},TreeBinding.prototype._getVisibleTreeNodeBindingsInRange=function(a,b){alert("TreeBinding#_getVisibleTreeNodeBindingsInRange")},TreeBinding.prototype.focusSingleTreeNodeBinding=function(a){null==a||a.isFocused||(this.blurSelectedTreeNodes(),this._focusedTreeNodeBindings.add(a),a.invokeManagedFocus(),this._isSelectable&&this._manageSelections())},TreeBinding.prototype.focusMultipeTreeNodeBindings=function(a){for(this.blurSelectedTreeNodes();a.hasNext();){var b=a.getNext();this._focusedTreeNodeBindings.add(b),b.invokeManagedFocus()}this._isSelectable&&this._manageSelections()},TreeBinding.prototype._manageSelections=function(){var a=this._selectedTreeNodeBindings;this._selectedTreeNodeBindings={};var b=!1,c=null;for(this._focusedTreeNodeBindings.reset();this._focusedTreeNodeBindings.hasNext();){var d=this._focusedTreeNodeBindings.getNext(),e=d.getProperty(this._selectionProperty);if(null!=e&&(!this._selectionValue||this._selectionValue[e])){c=this._selectedTreeNodeBindings[d.key]=d;var f=a[d.key];f&&f==c||(b=!0)}}if(c)b&&this.dispatchAction(TreeBinding.ACTION_SELECTIONCHANGED);else if(a)for(var g in a){this.dispatchAction(TreeBinding.ACTION_NOSELECTION);break}},TreeBinding.prototype.getSelectedTreeNodeBindings=function(){var a=new List;for(var b in this._selectedTreeNodeBindings)a.add(this._selectedTreeNodeBindings[b]);return a},TreeBinding.prototype.blurSelectedTreeNodes=function(){this._focusedTreeNodeBindings.reset().each(function(a){a.blur()}),this._focusedTreeNodeBindings.clear()},TreeBinding.prototype._blurDescendantBindings=function(a){var b=a.getDescendantBindingsByLocalName("treenode"),c=!0,d=this;b.each(function(a){return a.isFocused&&(a.blur(),d._focusedTreeNodeBindings.del(d._focusedTreeNodeBindings.getIndex(a))),c})},TreeBinding.prototype.getFocusedTreeNodeBindings=function(){return this._focusedTreeNodeBindings.reset()},TreeBinding.prototype.focus=function(){this.isFocused||(this.isFocused=!0,FocusBinding.focusElement(this.bindingElement),this.attachClassName(Binding.CLASSNAME_FOCUSED),this.dispatchAction(Binding.ACTION_FOCUSED),this.getFocusedTreeNodeBindings().hasEntries()||this.isFocusable&&this._focusDefault(),this._grabKeyboard())},TreeBinding.prototype._focusDefault=function(){var a=this._treeBodyBinding.getChildBindingByLocalName("treenode");null!=a&&(this.focusSingleTreeNodeBinding(a),a.callback())},TreeBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.detachClassName(Binding.CLASSNAME_FOCUSED),this.dispatchAction(Binding.ACTION_BLURRED),this._releaseKeyboard())},TreeBinding.prototype._grabKeyboard=function(){this.subscribe(BroadcastMessages.KEY_ARROW),this.subscribe(BroadcastMessages.KEY_ENTER),this._hasKeyboard=!0},TreeBinding.prototype._releaseKeyboard=function(){this.unsubscribe(BroadcastMessages.KEY_ARROW),this.unsubscribe(BroadcastMessages.KEY_ENTER),this._hasKeyboard=!1},TreeBinding.prototype.add=function(a){var b=null;return this._treeBodyBinding?b=this._treeBodyBinding.add(a):(this._treeNodeBuffer.add(a),b=a),b},TreeBinding.prototype.addFirst=function(a){throw new Error("Not implemented")},TreeBinding.prototype.empty=function(){this._treeBodyBinding.detachRecursive();var a=this._treeBodyBinding.bindingElement;a.innerHTML=""},TreeBinding.prototype.isEmpty=function(){return 0==this._treeNodeBindings.hasEntries()},TreeBinding.prototype.collapse=function(){this.blurSelectedTreeNodes(),this._treeNodeBindings.each(function(a,b){b.isContainer&&b.isOpen&&b.close()})},TreeBinding.prototype.setSelectable=function(a){this._isSelectable=a,a?this._selectedTreeNodeBindings={}:(this._selectedTreeNodeBindings=null,this._selectionProperty=null,this._selectionValue=null)},TreeBinding.prototype.setSelectionProperty=function(a){this._selectionProperty=a},TreeBinding.prototype.setSelectionValue=function(a){if(a){var b=new List(a.split(" "));for(this._selectionValue={};b.hasNext();)this._selectionValue[b.getNext()]=!0}},TreeBinding.prototype.handleBroadcast=function(a,b){switch(TreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.TYPEDRAG_START:this.addEventListener(DOMEvents.MOUSEMOVE),this._yposition=this.boxObject.getGlobalPosition().y;break;case BroadcastMessages.TYPEDRAG_STOP:this.removeEventListener(DOMEvents.MOUSEMOVE),this._positionIndicatorBinding.hide(),this._yposition=-1;break;case BroadcastMessages.KEY_ARROW:this._navigateByKey(b);break;case BroadcastMessages.KEY_ENTER:var c=this.getFocusedTreeNodeBindings();if(c.hasEntries()){var d=c.getFirst();d.isContainer?d.isOpen?d.close():d.open():d.fireCommand()}}},TreeBinding.prototype._navigateByKey=function(a){var b=this.getFocusedTreeNodeBindings();if(b.hasEntries()){var c=b.getFirst(),d=null;switch(a){case KeyEventCodes.VK_UP:if(d=c.getPreviousBindingByLocalName("treenode"),null!=d)for(;d.isContainer&&d.hasChildren()&&d.isOpen;)d=d.getChildBindingsByLocalName("treenode").getLast();null==d&&(d=c.getAncestorBindingByLocalName("treenode"));break;case KeyEventCodes.VK_DOWN:if(c.isContainer&&c.hasChildren()&&c.isOpen)d=c.getChildBindingByLocalName("treenode");else if(d=c.getNextBindingByLocalName("treenode"),null==d)for(var e=null;null==d&&null!=(e=c.getAncestorBindingByLocalName("treenode"));)null!=e&&(d=e.getNextBindingByLocalName("treenode")),c=e;break;case KeyEventCodes.VK_RIGHT:c.isContainer&&(c.isOpen?c.hasChildren()&&(d=c.getChildBindingByLocalName("treenode")):c.open());break;case KeyEventCodes.VK_LEFT:c.isContainer&&c.isOpen?c.close():d=c.getAncestorBindingByLocalName("treenode")}null!=d&&this.focusSingleTreeNodeBinding(d)}},TreeBinding.prototype.handleEvent=function(a){TreeBinding.superclass.handleEvent.call(this,a);DOMEvents.getTarget(a);switch(a.type){case DOMEvents.MOUSEMOVE:try{this._updatePositionIndicator(a)}catch(a){throw this.removeEventListener(DOMEvents.MOUSEMOVE),a}break;case DOMEvents.BEFOREUPDATE:var b=new TreeCrawler,c=new List;b.mode=TreeCrawler.MODE_GETOPEN,b.crawl(this.bindingElement,c);var d=new Map;if(c.hasEntries()){for(;c.hasNext();){var e=c.getNext();d.set(e.getHandle(),!0)}this._openTreeNodesBackupMap=d}break;case DOMEvents.AFTERUPDATE:this._openTreeNodesBackupMap=null}},TreeBinding.prototype._updatePositionIndicator=function(a){var b=a.clientY-this._yposition,c=this._acceptingPosition,d=this._acceptingDimension,e=this._positionIndicatorBinding;if(this._acceptingTreeNodeBinding){var f=c.y,g=c.y+d.h;if(b>=f&&g>=b){for(b=b<f+TreeNodeBinding.HEIGHT?f+TreeNodeBinding.HEIGHT:b,b-=TreeNodeBinding.HEIGHT,b=TreeBinding.grid(b);!this._acceptingPositions[b];)b+=TreeNodeBinding.HEIGHT;b!=e.getPosition().y&&e.setPosition(new Point(this._acceptingPosition.x+TreeNodeBinding.INDENT,b)),e.isVisible||e.show()}else e.isVisible&&e.hide()}else e.isVisible&&e.hide()},TreeBinding.prototype.enablePositionIndicator=function(a){this._acceptingTreeNodeBinding=a,this._acceptingPosition=a.boxObject.getLocalPosition(),this._acceptingDimension=a.boxObject.getDimension(),this._acceptingPositions=this._getChildPositions(a)},TreeBinding.prototype.disablePositionIndicator=function(){this._acceptingTreeNodeBinding=null,this._acceptingPosition=null,this._acceptingDimension=null},TreeBinding.prototype._getChildPositions=function(a){var b,c,d,e,f={},g=a.getChildBindingsByLocalName("treenode");for(e=TreeBinding.grid(a.boxObject.getLocalPosition().y),f[e]=!0;g.hasNext();)b=g.getNext(),c=b.boxObject.getLocalPosition(),d=b.boxObject.getDimension(),e=TreeBinding.grid(c.y+d.h)-TreeNodeBinding.HEIGHT,f[e]=!0;return f},TreeBinding.prototype.getDropIndex=function(){var a=this._positionIndicatorBinding.getPosition().y,b=0;for(var c in this._acceptingPositions){if(c==a)break;b++}return Number(b)},TreeBinding.prototype.getRootTreeNodeBindings=function(){return this._treeBodyBinding.getChildBindingsByLocalName("treenode")},TreeBinding.prototype.getTreeBodyBinding=function(){return this._treeBodyBinding},TreeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,TreeBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},TreeBodyBinding.prototype=new FlexBoxBinding,TreeBodyBinding.prototype.constructor=TreeBodyBinding,TreeBodyBinding.superclass=FlexBoxBinding.prototype,TreeBodyBinding.PADDING_TOP=8,TreeBodyBinding.prototype.toString=function(){return"[TreeBodyBinding]"},TreeBodyBinding.prototype.onBindingAttach=function(){TreeBodyBinding.superclass.onBindingAttach.call(this),this.addActionListener(TreeNodeBinding.ACTION_FOCUSED),this.containingTreeBinding=UserInterface.getBinding(this.bindingElement.parentNode)},TreeBodyBinding.prototype.accept=function(a){a instanceof TreeNodeBinding&&this.logger.debug(a)},TreeBodyBinding.prototype.handleAction=function(a){switch(TreeBodyBinding.superclass.handleAction.call(this,a),a.type){case TreeNodeBinding.ACTION_FOCUSED:this._scrollIntoView(a.target),a.consume()}},TreeBodyBinding.prototype._scrollIntoView=function(a){var b=a.labelBinding.bindingElement,c=this.bindingElement.clientHeight,d=this.bindingElement.clientWidth,e=a.boxObject.getGlobalPosition().y-this.boxObject.getGlobalPosition().y,f=DOMUtil.getGlobalPosition(b).x-this.boxObject.getGlobalPosition().x,g=b.offsetHeight,h=100,i=this.bindingElement.scrollTop,j=this.bindingElement.scrollLeft;0>e-i?this.bindingElement.scrollTop=e:e-i+g>c&&(this.bindingElement.scrollTop=e+g-c),0>f-j?this.bindingElement.scrollLeft=f:f-j+h>d&&(this.bindingElement.scrollLeft=f+h-d)},TreeBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treebody",a);return UserInterface.registerBinding(b,TreeBodyBinding)},TreeNodeBinding.prototype=new Binding,TreeNodeBinding.prototype.constructor=TreeNodeBinding,TreeNodeBinding.superclass=Binding.prototype,TreeNodeBinding.DEFAULT_FOLDER_CLOSED="${icon:folder}",TreeNodeBinding.DEFAULT_FOLDER_OPEN="${icon:folder_active}",TreeNodeBinding.DEFAULT_FOLDER_DISABLED="${icon:default}",TreeNodeBinding.DEFAULT_ITEM="${root}/images/icons/harmony/composite/default_16.png",TreeNodeBinding.DEFAULT_ITEM_DISABLED="${icon:default}",TreeNodeBinding.ACTION_OPEN="treenodeopen",TreeNodeBinding.ACTION_CLOSE="treenodeclose",TreeNodeBinding.ACTION_ONFOCUS="treenodeonfocus",TreeNodeBinding.ACTION_ONMULTIFOCUS="treenodeonmultifocus",TreeNodeBinding.ACTION_FOCUSED="treenodefocused",TreeNodeBinding.ACTION_BLUR="treenodeblur",TreeNodeBinding.ACTION_COMMAND="treenodecommand",TreeNodeBinding.ACTION_DISPOSE="treenodedisposed",TreeNodeBinding.CLASSNAME_DRAGGED="dragged",TreeNodeBinding.HEIGHT=19,TreeNodeBinding.INDENT=34,TreeNodeBinding.prototype.toString=function(){return"[TreeNodeBinding]"},TreeNodeBinding.prototype.serialize=function(){var a=TreeNodeBinding.superclass.serialize.call(this);if(a){a.label=this.getLabel(),a.image=this.getImage();var b=this.getHandle();b&&b!=this.key&&(a.handle=b),this.isOpen&&(a.open=!0),this.isDisabled&&(a.disabled=!0),this.dragType&&(a.dragtype=this.dragType),this.dragAccept&&(a.dragaccept=this.dragAccept)}return a},TreeNodeBinding.prototype.onBindingRegister=function(){TreeNodeBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.label=this.setLabel,this.propertyMethodMap.image=this.setImage,this.propertyMethodMap.tooltip=this.setToolTip},TreeNodeBinding.prototype.onBindingAttach=function(){TreeBinding.superclass.onBindingAttach.call(this),this.isOpen=this.isOpen?!0:this.getProperty("open"),this.isPinned=this.isPinned?!0:this.getProperty("pin"),this.isContainer||(this.isContainer=this.hasChildren()),this.buildDOMContent(),this.assignDOMEvents(),this.isDisabled&&this.labelBinding.attachClassName(LabelBinding.CLASSNAME_GRAYTEXT),this.addActionListener(TreeNodeBinding.ACTION_FOCUSED),this.addEventListener(UpdateManager.EVENT_AFTERUPDATE),this._registerWithAncestorTreeBinding()},TreeNodeBinding.prototype.onBindingDispose=function(){this.isAttached&&(null!=this.dragger&&(this.labelBinding.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.labelBinding.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.labelBinding.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.disableDragging(),this.dragger.dispose()),this.dispatchAction(TreeNodeBinding.ACTION_DISPOSE),this.containingTreeBinding.unRegisterTreeNodeBinding(this),this.labelBinding.dispose()),TreeNodeBinding.superclass.onBindingDispose.call(this)},TreeNodeBinding.prototype._registerWithAncestorTreeBinding=function(){for(var a=this.bindingElement;null!=(a=a.parentNode)&&!this.containingTreeBinding;){var b=UserInterface.getBinding(a);b&&b.containingTreeBinding&&(this.containingTreeBinding=b.containingTreeBinding)}if(!this.containingTreeBinding)throw alert(this.bindingElement.parentNode.nodeName),"TreeNodeBinding attached outside TreeBodyBinding";this.containingTreeBinding.registerTreeNodeBinding(this)},TreeNodeBinding.prototype.getHandle=function(){var a=this.key,b=this.getProperty("handle");return b&&(a=b),a},TreeNodeBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},TreeNodeBinding.prototype.buildDOMContent=function(){var a=this.getProperty("url"),b=this.getProperty("label"),c=this.getProperty("tooltip"),d=this.getProperty("oncommand"),e=this.getProperty("onbindingfocus"),f=this.getProperty("onbindingblur"),g=this.getProperty("focused"),h=this.getProperty("callbackid");if(a){var i=DOMUtil.createElementNS(Constants.NS_XHTML,"a",this.bindingDocument);i.href=a,this.bindingElement.appendChild(i),this.shadowTree.link=i}this.labelBinding=LabelBinding.newInstance(this.bindingDocument),a?this.shadowTree.link.appendChild(this.labelBinding.bindingElement):this.addFirst(this.labelBinding),this.shadowTree.label=this.labelBinding,null!=this.dragger&&(this.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEUP,this.dragger)),this.isContainer&&!this.dragAccept&&(this.acceptor=new BindingAcceptor(this)),null!=b&&this.setLabel(b),null!=c&&this.setToolTip(c),this.imageProfile||this._computeImageProfile(),this.setImage(this.computeImage()),this.isContainer&&this.updateClassNames();this.bindingWindow.WindowManager;null!=d&&(this.oncommand=function(){Binding.evaluate(d,this)}),null!=e&&(this.onfocus=function(){Binding.evaluate(e,this)}),null!=f&&(this.onblur=function(){Binding.evaluate(f,this)}),1==g&&this.focus(),null!=h&&Binding.dotnetify(this,h)},TreeNodeBinding.prototype.handleAction=function(a){switch(TreeNodeBinding.superclass.handleAction.call(this,a),a.type){case TreeNodeBinding.ACTION_FOCUSED:a.target!=this&&this.isContainer&&!this.isOpen&&this.open(!0)}},TreeNodeBinding.prototype.enableDragging=function(){},TreeNodeBinding.prototype.disableDragging=function(){this.isDraggable=!1},TreeNodeBinding.prototype.accept=function(a,b){var c=!0;if(a instanceof TreeNodeBinding){for(var d=!1,e=this.bindingElement,f=this.containingTreeBinding.bindingElement;!d&&e!=f;)e==a.getBindingElement()?d=!0:e=e.parentNode;d?(Dialog.error("Not Allowed","You cannot move a folder into itself."),c=!1):this.acceptTreeNodeBinding(a,b)}else c=!1;return c},TreeNodeBinding.prototype.acceptTreeNodeBinding=function(a,b){var c=a.serializeToString(),d=new BindingParser(this.bindingDocument),e=d.parseFromString(c).getFirst();b=b?b:this.containingTreeBinding.getDropIndex();var f=this.getChildElementsByLocalName("treenode");this.bindingElement.insertBefore(e,f.get(b)),this.bindingWindow.DocumentManager.attachBindings(this.bindingElement),a.dispose()},TreeNodeBinding.prototype.showAcceptance=function(){this.containingTreeBinding.enablePositionIndicator(this)},TreeNodeBinding.prototype.hideAcceptance=function(){this.containingTreeBinding.disablePositionIndicator()},TreeNodeBinding.prototype._computeImageProfile=function(){var a=this.getProperty("image"),b=this.getProperty("image-active"),c=this.getProperty("image-disabled");b=b?b:this.isContainer?a?a:TreeNodeBinding.DEFAULT_FOLDER_OPEN:a?a:TreeNodeBinding.DEFAULT_ITEM,c=c?c:this.isContainer?a?a:TreeNodeBinding.DEFAULT_FOLDER_DISABLED:a?a:TreeNodeBinding.DEFAULT_ITEM_DISABLED,a=a?a:this.isContainer?TreeNodeBinding.DEFAULT_FOLDER_CLOSED:TreeNodeBinding.DEFAULT_ITEM,this.imageProfile=new ImageProfile({image:a,imageHover:null,imageActive:b,imageDisabled:c})},TreeNodeBinding.prototype.assignDOMEvents=function(){this.labelBinding.addEventListener(DOMEvents.DOUBLECLICK,this),this.labelBinding.addEventListener(DOMEvents.MOUSEDOWN,this),this.labelBinding.addEventListener(DOMEvents.MOUSEOVER,this),this.labelBinding.addEventListener(DOMEvents.MOUSEOUT,this)},TreeNodeBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},TreeNodeBinding.prototype.setLabel=function(a){this.setProperty("label",String(a)),this.isAttached&&this.labelBinding.setLabel(String(a))},TreeNodeBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",String(a)),this.isAttached&&this.labelBinding.setToolTip(String(a))},TreeNodeBinding.prototype.getImage=function(){return this.getProperty("image")},TreeNodeBinding.prototype.getLabel=function(){return this.getProperty("label")},TreeNodeBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},TreeNodeBinding.prototype.computeImage=function(){var a=this.imageProfile.getDefaultImage(),b=this.imageProfile.getActiveImage();return b=b?b:a,this.isOpen?b:a},TreeNodeBinding.prototype.handleEvent=function(a){TreeNodeBinding.superclass.handleEvent.call(this,a);var b=DOMEvents.getTarget(a),c=this.labelBinding.bindingElement,d=this.labelBinding.shadowTree.labelBody,e=this.labelBinding.shadowTree.labelText;switch(a.type){case DOMEvents.MOUSEDOWN:b==c?this._onAction(a):this.isDisabled||this._onFocus(a);break;case DOMEvents.DOUBLECLICK:this._onAction(a);break;case UpdateManager.EVENT_AFTERUPDATE:if(b.parentNode==this.bindingElement&&b.__updateType==Update.TYPE_INSERT){var c=this.labelBinding.bindingElement;"treenode"==DOMUtil.getLocalName(b)&&b==this.bindingElement.firstChild&&this.bindingElement.insertBefore(b,c.nextSibling);break}}if(BindingDragger.isDragging&&this.isContainer&&!this.isOpen)switch(a.type){case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:switch(b){case c:case d:case e:this._folderDragOverTimeout(a)}}},TreeNodeBinding.prototype._folderDragOverTimeout=function(a){var b=this;switch(a.type){case DOMEvents.MOUSEOVER:this._dragTimeout=this.bindingWindow.setTimeout(function(){b.open()},500);break;case DOMEvents.MOUSEOUT:this.bindingWindow.clearTimeout(this._dragTimeout)}},TreeNodeBinding.prototype._onAction=function(a){var b=!0;if("mousedown"==a.type){var c=a.button==(a.target?0:1);c||(b=!1)}b&&(this.isContainer?this.isOpen?this.close():this.open():this.fireCommand())},TreeNodeBinding.prototype.fireCommand=function(){this.oncommand&&this.oncommand(),this.dispatchAction(TreeNodeBinding.ACTION_COMMAND)},TreeNodeBinding.prototype._onFocus=function(a){var b=!1;null!=a&&(b=a.shiftKey),this.dispatchAction(b?TreeNodeBinding.ACTION_ONMULTIFOCUS:TreeNodeBinding.ACTION_ONFOCUS),null!=a&&this.stopPropagation(a),null!=this.onfocus&&this.onfocus(),null!=a&&this.hasCallBackID()&&this.callback()},TreeNodeBinding.prototype.callback=function(){if(this.hasCallBackID()){var a=this;setTimeout(function(){a.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},0)}},TreeNodeBinding.prototype.invokeManagedFocus=function(){this.isFocused||(this.isFocused=!0,this.setProperty("focused",!0),this.labelBinding.attachClassName("focused"),this.dispatchAction(TreeNodeBinding.ACTION_FOCUSED))},TreeNodeBinding.prototype.focus=function(){this.setProperty("focused",!0),this.isAttached&&this._onFocus()},TreeNodeBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.deleteProperty("focused"),this.labelBinding.detachClassName("focused"),this.onblur&&this.onblur(),this.dispatchAction(TreeNodeBinding.ACTION_BLUR))},TreeNodeBinding.prototype.stopPropagation=function(a){"mousedown"==a.type&&(EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),this.dispatchAction(Binding.ACTION_ACTIVATED)),DOMEvents.stopPropagation(a)},TreeNodeBinding.prototype.open=function(){this.isContainer&&!this.isOpen&&(this.isOpen=!0,this.setProperty("open",!0),this.dispatchAction(TreeNodeBinding.ACTION_OPEN),this.setImage(this.computeImage()),this.updateClassNames(),this.hasBeenOpened=!0)},TreeNodeBinding.prototype.close=function(){this.isContainer&&this.isOpen&&!this.isPinned&&(this.isOpen=!1,this.setProperty("open",!1),this.dispatchAction(TreeNodeBinding.ACTION_CLOSE),this.setImage(this.computeImage()),this.updateClassNames())},TreeNodeBinding.prototype.updateClassNames=function(){
this.isContainer?(this.hasClassName("container")||this.attachClassName("container"),this.isOpen?(this.detachClassName("closed"),this.attachClassName("open"),this.labelBinding.detachClassName("closed"),this.labelBinding.attachClassName("open")):(this.detachClassName("open"),this.attachClassName("closed"),this.labelBinding.detachClassName("open"),this.labelBinding.attachClassName("closed"))):this.hasClassName("container")&&(this.detachClassName("container"),this.labelBinding.detachClassName("closed"),this.labelBinding.detachClassName("open"))},TreeNodeBinding.prototype.empty=function(){var a=this.getDescendantBindingsByLocalName("treenode");a.each(function(a){a.dispose()})},TreeNodeBinding.prototype.showDrag=function(){this.attachClassName(TreeNodeBinding.CLASSNAME_DRAGGED)},TreeNodeBinding.prototype.hideDrag=function(){this.detachClassName(TreeNodeBinding.CLASSNAME_DRAGGED)},TreeNodeBinding.prototype.hasChildren=function(){return this.bindingElement.hasChildNodes()},TreeNodeBinding.prototype.handleElement=function(a){var b=a.getAttribute("focused");return"true"==b&&(this.isFocused||this.focus()),!1},TreeNodeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",a);return UserInterface.registerBinding(b,TreeNodeBinding)},TreeContentBinding.prototype=new Binding,TreeContentBinding.prototype.constructor=TreeContentBinding,TreeContentBinding.superclass=Binding.prototype,TreeContentBinding.prototype.toString=function(){return"[TreeContentBinding]"},TreeContentBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treecontent",a);return UserInterface.registerBinding(b,TreeContentBinding)},TreePositionIndicatorBinding.prototype=new Binding,TreePositionIndicatorBinding.prototype.constructor=TreePositionIndicatorBinding,TreePositionIndicatorBinding.superclass=Binding.prototype,TreePositionIndicatorBinding.prototype.toString=function(){return"[TreePositionIndicatorBinding]"},TreePositionIndicatorBinding.prototype.onBindingAttach=function(){TreePositionIndicatorBinding.superclass.onBindingAttach.call(this),this.hide()},TreePositionIndicatorBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px",this._geometry.x=a.x,this._geometry.y=a.y},TreePositionIndicatorBinding.prototype.getPosition=function(){return new Point(this._geometry.x,this._geometry.y)},TreePositionIndicatorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treepositionindicator",a);return UserInterface.registerBinding(b,TreePositionIndicatorBinding)},TreeCrawler.prototype=new BindingCrawler,TreeCrawler.prototype.constructor=TreeCrawler,TreeCrawler.superclass=BindingCrawler.prototype,TreeCrawler.ID="treecrawler",TreeCrawler.MODE_GETOPEN="get open treenodes",TreeCrawler.prototype._construct=function(){TreeCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(a){var b=UserInterface.getBinding(a),c=null,c=null;return!b instanceof TreeNodeBinding&&(c=NodeCrawler.SKIP_NODE),c}),this.addFilter(function(b,c){var d=UserInterface.getBinding(b),e=null;switch(a.mode){case TreeCrawler.MODE_GETOPEN:d.isOpen&&c.add(d)}return e})},CheckTreeBinding.prototype=new TreeBinding,CheckTreeBinding.prototype.constructor=CheckTreeBinding,CheckTreeBinding.superclass=TreeBinding.prototype,CheckTreeBinding.prototype.toString=function(){return"[CheckTreeBinding]"},CheckTreeBinding.prototype._grabKeyboard=function(){this.subscribe(BroadcastMessages.KEY_SPACE),CheckTreeBinding.superclass._grabKeyboard.call(this)},CheckTreeBinding.prototype._releaseKeyboard=function(){this.unsubscribe(BroadcastMessages.KEY_SPACE),CheckTreeBinding.superclass._releaseKeyboard.call(this)},CheckTreeBinding.prototype.handleBroadcast=function(a,b){switch(CheckTreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:var c=this.getFocusedTreeNodeBindings();if(c.hasEntries()){var d=c.getFirst();d instanceof CheckTreeNodeBinding&&(d.isReadOnly||d.invoke())}}},CheckTreeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,CheckTreeBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},CheckTreeNodeBinding.prototype=new TreeNodeBinding,CheckTreeNodeBinding.prototype.constructor=CheckTreeNodeBinding,CheckTreeNodeBinding.superclass=TreeNodeBinding.prototype,CheckTreeNodeBinding.CLASS_NAME="checkbox",CheckTreeNodeBinding.ACTION_COMMAND="checkbox treenode command",CheckTreeNodeBinding.prototype.toString=function(){return"[CheckTreeNodeBinding]"},CheckTreeNodeBinding.prototype.onBindingRegister=function(){CheckTreeNodeBinding.superclass.onBindingRegister.call(this)},CheckTreeNodeBinding.prototype.onBindingAttach=function(){CheckTreeNodeBinding.superclass.onBindingAttach.call(this),this._parseDOMProperties(),this._buildCheckButtonBinding(),this.isReadOnly&&this.labelBinding.attachClassName(LabelBinding.CLASSNAME_GRAYTEXT)},CheckTreeNodeBinding.prototype._parseDOMProperties=function(){this.isSelectable=this.isSelectable?!0:this.getProperty("selectable")},CheckTreeNodeBinding.prototype._buildCheckButtonBinding=function(){if(this.isSelectable){this._buttonBinding=CheckButtonBinding.newInstance(this.bindingDocument),this.bindingElement.insertBefore(this._buttonBinding.bindingElement,this.labelBinding.bindingElement.nextSibling),this.getProperty("selected")===!0&&this._buttonBinding.check(!0),this.isReadOnly&&this._buttonBinding.setDisabled(!0);var a=this;this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(b){b.consume(),a.dispatchAction(CheckTreeNodeBinding.ACTION_COMMAND)}}),this._buttonBinding.attach(),this.attachClassName(CheckTreeNodeBinding.CLASS_NAME)}},CheckTreeNodeBinding.prototype.isChecked=function(){return this.isSelectable?this._buttonBinding.isChecked:void 0},CheckTreeNodeBinding.prototype.setChecked=function(a,b){this.isSelectable&&this._buttonBinding.setChecked(a,b)},CheckTreeNodeBinding.prototype.invoke=function(){this.isSelectable&&this._buttonBinding.invoke()},CheckTreeNodeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",a);return UserInterface.registerBinding(b,CheckTreeNodeBinding)},DockTabsButtonBinding.prototype=new TabsButtonBinding,DockTabsButtonBinding.prototype.constructor=DockTabsButtonBinding,DockTabsButtonBinding.superclass=TabsButtonBinding.prototype,DockTabsButtonBinding.RESERVED_SPACE=50,DockTabsButtonBinding.NODENAME_TABBOX="dock",DockTabsButtonBinding.prototype.toString=function(){return"[DockTabsButtonBinding]"},DockTabsButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return b.setAttribute("type","checkbox"),b.setAttribute("popup","app.bindingMap.tabsbuttonpopup"),b.className="tabbutton",UserInterface.registerBinding(b,DockTabsButtonBinding)},DockBinding.prototype=new TabBoxBinding,DockBinding.prototype.constructor=DockBinding,DockBinding.superclass=TabBoxBinding.prototype,DockBinding.START="start",DockBinding.EXTERNAL="external",DockBinding.EXPLORER="explorer",DockBinding.MAIN="main",DockBinding.BOTTOMLEFT="bottomleft",DockBinding.BOTTOMRIGHT="bottomright",DockBinding.RIGHTTOP="righttop",DockBinding.RIGHTBOTTOM="rightbottom",DockBinding.ABSBOTTOMLEFT="absbottomleft",DockBinding.ABSBOTTOMRIGHT="absbottomright",DockBinding.ABSRIGHTTOP="absrighttop",DockBinding.ABSRIGHTBOTTOM="absrightbottom",DockBinding.SLIDE="slide",DockBinding.TYPE_START="start",DockBinding.TYPE_EXPLORER="explorer",DockBinding.TYPE_EDITORS="editors",DockBinding.TYPE_TOOLS="tools",DockBinding.ACTION_OPENED="dockopened",DockBinding.ACTION_EMPTIED="dockemptied",DockBinding.CLASSNAME_ACTIVE="active",DockBinding.prototype.toString=function(){return"[DockBinding]"},DockBinding.prototype.serialize=function(){var a=DockBinding.superclass.serialize.call(this);return a&&(a.active=this.isActive?!0:null,a.collapsed=this.isCollapsed?!0:null),a},DockBinding.prototype.onBindingRegister=function(){DockBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_ACTIVATED,this),this.addActionListener(TabBoxBinding.ACTION_UPDATED,this),this.addActionListener(ViewBinding.ACTION_LOADED),this.addActionListener(ViewBinding.ACTION_CLOSED),this._viewBindingList=new List,this.reference=this.getProperty("reference"),this.reference==DockBinding.MAIN&&this.subscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS)},DockBinding.prototype.onBindingAttach=function(){DockBinding.superclass.onBindingAttach.call(this),this._containingSplitPanelBinding=this.getAncestorBindingByLocalName("splitpanel"),this.getTabBindings().hasEntries()?(this.isEmpty=!1,this.isActivatable=!0):this.dispatchAction(DockBinding.ACTION_EMPTIED)},DockBinding.prototype.buildDOMContent=function(){var a=this.getProperty("type");this.type=a?a:DockBinding.TYPE_TOOLS,this.attachClassName(this.type),1==this.getProperty("active")&&this.activate()},DockBinding.prototype.interceptDisplayChange=function(a){var b=this.getSelectedTabPanelBinding();b&&(b.isVisible=a,b.dispatchAction(Binding.ACTION_VISIBILITYCHANGED))},DockBinding.prototype.prepareNewView=function(a){var b=this._getBindingForDefinition(a),c=DockTabBinding.newInstance(this.bindingDocument);c.setHandle(a.handle),c.setLabel(a.flowHandle?null:a.label),c.setImage(a.image),c.setToolTip(a.toolTip),c.setEntityToken(a.entityToken),c.setAssociatedView(b),a.isPinned&&c.setProperty("pinned",!0),Application.isTestEnvironment&&c.setProperty("data-qa",a.entityToken),this.appendTabByBindings(c,null),this._setupPageBindingListeners(c);var d=this.getTabPanelBinding(c);b.snapToBinding(d,a.isFloating);var e=this.bindingWindow.bindingMap.views;return e.add(b),this.isActive||this.activate(),b.attach(),c},DockBinding.prototype.prepareOpenView=function(a,b){this.logger.debug("DockBinding.prototype.prepareOpenView: _setupDirtyStuff required?"),b.setLabel(a.label),b.setImage(a.image),b.setToolTip(a.toolTip),this._setupPageBindingListeners(b);var c=this.getTabPanelBinding(b),d=this._getBindingForDefinition(a);b.setAssociatedView(d),d.snapToBinding(c,a.isFloating),UserInterface.getBinding(this.bindingDocument.body).add(d),d.attach()},DockBinding.prototype._getBindingForDefinition=function(a){var b=this.bindingWindow.bindingMap.views,c=ViewBinding.newInstance(b.bindingDocument);return c.setDefinition(a),c},DockBinding.prototype._setupPageBindingListeners=function(a){var b=this.getTabPanelBinding(a),c=this,d={handleAction:function(d){var e=d.target;switch(d.type){case PageBinding.ACTION_ATTACHED:TabBoxBinding.currentActiveInstance=c;break;case PageBinding.ACTION_INITIALIZED:e.reflex(!0);var f=a.getAssociatedView();e.bindingWindow==f.getContentWindow()&&(a.updateDisplay(e),EventBroadcaster.broadcast(BroadcastMessages.VIEW_COMPLETED,f.getHandle()),StatusBar.state==StatusBar.BUSY&&StatusBar.clear()),a.onPageInitialize(e),d.consume();break;case PageBinding.ACTION_UPDATED:var f=a.getAssociatedView();e.bindingWindow==f.getContentWindow()&&a.updateDisplay(e);break;case DockTabBinding.ACTION_UPDATE_VISUAL:a.updateDisplay(e),d.consume();break;case DockTabBinding.ACTION_UPDATE_TOKEN:a.updateEntityToken(e),d.consume();break;case EditorPageBinding.ACTION_DIRTY:a.setDirty(!0);break;case EditorPageBinding.ACTION_SAVE:case EditorPageBinding.ACTION_SAVE_AND_PUBLISH:a.onSaveStart();break;case ViewBinding.ACTION_ONCLOSE:c.closeTab(a),d.consume();break;case ViewBinding.ACTION_ONCLOSE_FORCE:c.closeTab(a,!0),d.consume();break;case DockPanelBinding.ACTION_FORCE_SELECT:c.select(a);break;case Binding.ACTION_FORCE_REFLEX:b.reflex(!0),d.consume();break;case DockTabBinding.ACTION_FORCE_CLEAN:case EditorPageBinding.ACTION_CLEAN:a.isDirty&&a.setDirty(!1);break;case WindowBinding.ACTION_ONLOAD:alert("HWEJ")}}};new List([DockTabBinding.ACTION_UPDATE_VISUAL,DockTabBinding.ACTION_UPDATE_TOKEN,PageBinding.ACTION_ATTACHED,PageBinding.ACTION_INITIALIZED,PageBinding.ACTION_UPDATED,EditorPageBinding.ACTION_DIRTY,EditorPageBinding.ACTION_CLEAN,EditorPageBinding.ACTION_SAVE,EditorPageBinding.ACTION_SAVE_AND_PUBLISH,ViewBinding.ACTION_ONCLOSE,ViewBinding.ACTION_ONCLOSE_FORCE,DockPanelBinding.ACTION_FORCE_SELECT,Binding.ACTION_FORCE_REFLEX,DockTabBinding.ACTION_FORCE_CLEAN,WindowBinding.ACTION_ONLOAD]).each(function(a){b.addActionListener(a,d)})},DockBinding.prototype.summonTabPanelBinding=function(){return DockPanelBinding.newInstance(this.bindingDocument)},DockBinding.prototype.handleAction=function(a){DockBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ACTIVATED:this.isActive||this.activate(),a.consume();break;case TabBoxBinding.ACTION_UPDATED:b instanceof DockBinding&&b.updateType==TabBoxBinding.UPDATE_DETACH&&(this.getTabElements().hasEntries()||(this.isEmpty=!0,this.isActivatable=!1,1==this.isActive&&this.deActivate(),this.dispatchAction(DockBinding.ACTION_EMPTIED)));break;case ViewBinding.ACTION_LOADED:this._viewBindingList.add(b),this.isActive&&b.onActivate();break;case ViewBinding.ACTION_CLOSED:this._viewBindingList.del(b)}},DockBinding.prototype.handleBroadcast=function(a,b){switch(DockBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS:var c=b;b==this.perspectiveNode?this._highlightTabByEntityToken():c.perspectiveNode&&c.perspectiveNode==this.perspectiveNode&&this._highlightTabByEntityToken(c.node.getEntityToken())}},DockBinding.prototype._highlightTabByEntityToken=function(a){for(var b=this.getTabBindings();b.hasNext();){var c=b.getNext(),d=c.getEntityToken();a&&null!=d&&d==a?c.highlight(!0):c.highlight(!1)}},DockBinding.prototype._selectTabByView=function(a){for(var b=this.getTabBindings(),c=!1;b.hasNext()&&!c;){var d=b.getNext(),e=d.getAssociatedView();null!=e&&e==a&&(d.isSelected||this.select(d,!0),c=!0)}},DockBinding.prototype.collapse=function(a){this._handleCollapse(!0,a)},DockBinding.prototype.unCollapse=function(a){this._handleCollapse(!1,a)},DockBinding.prototype._handleCollapse=function(a,b){var c=this.getChildBindingByLocalName("dockpanels"),d=this.getAncestorBindingByLocalName("splitbox");a?(c.hide(),this.bindingElement.style.height="auto",this.isFlexible=!1,this.isActivatable=!1,this.setProperty("collapsed",!0),b&&d.hasBothPanelsVisible()&&this.setWidth(200)):(c.show(),this.isFlexible=!0,this.isActivatable=!0,this.deleteProperty("collapsed"),b&&this.setWidth(!1)),this.interceptDisplayChange(!a),this.isCollapsed=a},DockBinding.prototype.activate=function(){this.isActive||(this.isActive=!0,this.attachClassName(DockBinding.CLASSNAME_ACTIVE),this.setProperty("active",!0),this._containingSplitPanelBinding&&(this._containingSplitPanelBinding.isActive=!0),this.getTabBindings().each(function(a){a.onActivate()}),this._viewBindingList.each(function(a){a.onActivate()}),Application.activate(this))},DockBinding.prototype.deActivate=function(){1==this.isActive&&(this.isActive=!1,this.detachClassName(DockBinding.CLASSNAME_ACTIVE),this.deleteProperty("active"),this._containingSplitPanelBinding&&(this._containingSplitPanelBinding.isActive=!1),this.getTabBindings().each(function(a){a.onDeactivate()}),this._viewBindingList.each(function(a){a.onDeactivate()}),Application.deActivate(this))},DockBinding.prototype.closeTab=function(a,b){if(!a.isPinned)if(a.isDirty&&!b){var c=Resolver.resolve(a.getLabel()),d=this;Dialog.question(StringBundle.getString("ui","WebSite.Application.DialogSaveResource.Title"),StringBundle.getString("ui","WebSite.Application.DialogSaveResource.Text").replace("${resourcename}",c),Dialog.BUTTONS_YES_NO_CANCEL,{handleDialogResponse:function(b){switch(b){case Dialog.RESPONSE_YES:setTimeout(function(){d.saveContainedEditor(a)},0);break;case Dialog.RESPONSE_NO:d.removeTab(a)}}})}else this.removeTab(a)},DockBinding.prototype.closeTabsExcept=function(a){for(var b=this.getTabBindings();b.hasNext();){var c=b.getNext();c!=a&&this.closeTab(c)}},DockBinding.prototype.saveContainedEditor=function(a){var b=a.getAssociatedView();b.saveContainedEditor();var c=this,d={handleBroadcast:function(e,f){switch(e){case BroadcastMessages.CURRENT_SAVED:f.handle==b.getHandle()&&(EventBroadcaster.unsubscribe(BroadcastMessages.CURRENT_SAVED,d),f.isSuccess&&c.removeTab(a))}}};EventBroadcaster.subscribe(BroadcastMessages.CURRENT_SAVED,d)},DockBinding.prototype.appendTabByBindings=function(a,b){this.isEmpty&&(this.isEmpty=!1,this.isActivatable=!0,this.setWidth(!1),this.dispatchAction(DockBinding.ACTION_OPENED)),DockBinding.superclass.appendTabByBindings.call(this,a,b)},DockBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},DockBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},DockBinding.prototype.setWidth=function(a){a=a?a+"px":"100%",this.bindingElement.style.width=a},DockBinding.prototype.show=function(){this.isVisible&&(DockBinding.superclass.show.call(this),this.isFlexible=!0)},DockBinding.prototype.hide=function(){this.isVisible||(DockBinding.superclass.hide.call(this),this.isFlexible=!1,this.isActive&&this.deActivate())},DockBinding.prototype.getBestTab=function(){var a=null,b=this.getTabBindings(),c=b.getLength();return a=1==c?null:b.get(0)},DockTabsBinding.prototype=new TabsBinding,DockTabsBinding.prototype.constructor=DockTabsBinding,DockTabsBinding.superclass=TabsBinding.prototype,DockTabsBinding.NODENAME_TABBOX="dock",DockTabsBinding.TABBUTTON_IMPLEMENTATION=DockTabsButtonBinding,DockTabsBinding.prototype.toString=function(){return"[DockTabsBinding]"},DockTabsBinding.prototype.flex=function(){function a(){var a=b.containingTabBoxBinding.getWidth();isNaN(a)||(a=a>0?a-1:0,b.bindingElement.style.width=new String(a)+"px")}if(Client.isExplorer&&null!=this.containingTabBoxBinding){var b=this;setTimeout(a,250),a()}DockTabsBinding.superclass.flex.call(this)},DockTabsBinding.prototype.handleCrawler=function(a){switch(DockTabsBinding.superclass.handleCrawler.call(this,a),a.id){case FlexBoxCrawler.ID:this._explorerFlexHack()}},DockTabsBinding.prototype._explorerFlexHack=function(){function a(){var a=b.containingTabBoxBinding.getWidth();isNaN(a)||(a=a>0?a-1:0,b.bindingElement.style.width=new String(a)+"px")}if(Client.isExplorer&&null!=this.containingTabBoxBinding){var b=this;setTimeout(a,250),a()}},DockTabsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:docktabs",a);return UserInterface.registerBinding(b,DockTabsBinding)},DockTabBinding.prototype=new TabBinding,DockTabBinding.prototype.constructor=DockTabBinding,DockTabBinding.superclass=TabBinding.prototype,DockTabBinding.ACTION_FORCE_CLEAN="docktab force clean",DockTabBinding.ACTION_UPDATE_VISUAL="docktab update visual",DockTabBinding.ACTION_UPDATE_TOKEN="docktab update token",DockTabBinding.NODENAME_TABBOX="dock",DockTabBinding.LABEL_TABLOADING="${string:Website.App.LabelLoading}",DockTabBinding.LABEL_TABDEFAULT="${string:Website.App.LabelLoaded}",DockTabBinding.LABEL_TABSAVED="${string:Website.App.LabelSaved}",DockTabBinding.LABEL_OVERFLOWED_CLASSNAME="overflowed",DockTabBinding.IMG_TABLOADING="${icon:loading}",DockTabBinding.IMG_TABDEFAULT="${icon:default}",DockTabBinding.prototype.toString=function(){return"[DockTabBinding]"},DockTabBinding.prototype.onBindingAttach=function(){DockTabBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.BIND_TOKEN_TO_VIEW),this.perspectiveNode=this.containingTabBoxBinding.perspectiveNode,this.addActionListener(ControlBinding.ACTION_COMMAND,this),this.containingTabBoxBinding.type!=DockBinding.EXPLORER&&this.setContextMenu(top.app.bindingMap.docktabpopup)},DockTabBinding.prototype.setAssociatedView=function(a){this._viewBinding=a},DockTabBinding.prototype.getAssociatedView=function(){return this._viewBinding},DockTabBinding.prototype.serialize=function(){var a=DockTabBinding.superclass.serialize.call(this);return a&&(a.label=null,a.image=null,a.handle=this.getHandle()),a},DockTabBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},DockTabBinding.prototype.getHandle=function(){return this.getProperty("handle")},DockTabBinding.prototype.setEntityToken=function(a){null==this._entityToken&&this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR),this._entityToken=a,this.isAttached&&this.isSelected&&this._updateTree(!0)},DockTabBinding.prototype.getEntityToken=function(){return this._entityToken},DockTabBinding.prototype.buildDOMContent=function(){if(DockTabBinding.superclass.buildDOMContent.call(this),1!=this.getProperty("pinned")){this._controlGroupBinding=this.labelBinding.add(ControlGroupBinding.newInstance(this.bindingDocument));var a=DialogControlBinding.newInstance(this.bindingDocument);a.setControlType(ControlBinding.TYPE_CLOSE),a.attachClassName("closecontrol"),this._controlGroupBinding.add(a),this._controlGroupBinding.attachRecursive()}else this.isPinned=!0},DockTabBinding.prototype.setDirty=function(a){if(this.containingTabBoxBinding.type==DockBinding.TYPE_EDITORS){if(this.isDirty!=a&&(this.isDirty=a,Binding.exists(this.labelBinding))){var b=this.labelBinding.getLabel();null!=b?this.labelBinding.setLabel(a?"*"+b:b.slice(1,b.length)):this.labelBinding.setLabel(a?"*":"")}var c=top.app.bindingMap.broadcasterCurrentTabDirty;1==this.isDirty?(this.subscribe(BroadcastMessages.SAVE_CURRENT),EventBroadcaster.broadcast(BroadcastMessages.DOCKTAB_DIRTY,this),c.enable()):(this.unsubscribe(BroadcastMessages.SAVE_CURRENT),EventBroadcaster.broadcast(BroadcastMessages.DOCKTAB_CLEAN,this),c.disable())}else Dialog.warning("Dirty denied","Only editor docks should invoke the dirty state!")},DockTabBinding.prototype.updateDisplay=function(a){this.setLabel(a.getLabel()),this.setImage(a.getImage()),this.setToolTip(a.getToolTip())},DockTabBinding.prototype.updateEntityToken=function(a){this.setEntityToken(a.getEntityToken())},DockTabBinding.prototype.handleAction=function(a){DockTabBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case ControlBinding.ACTION_COMMAND:b.controlType==ControlBinding.TYPE_CLOSE&&this.close();break;case MenuItemBinding.ACTION_COMMAND:a.listener==this.contextMenuBinding&&this._handleContextMenuItemBinding(b)}},DockTabBinding.prototype._handleContextMenuItemBinding=function(a){var b=a.getProperty("cmd");switch(b){case DockTabPopupBinding.CMD_REFRESH:this.containingTabBoxBinding.type!=DockBinding.TYPE_TOOLS&&this.setLabel(DockTabBinding.LABEL_TABLOADING),this.setImage(DockTabBinding.IMG_TABLOADING),this._viewBinding.reload(Application.isDeveloperMode),this.isDirty=!1;break;case DockTabPopupBinding.CMD_MAKEDIRTY:this.setDirty(!0);break;case DockTabPopupBinding.CMD_VIEWSOURCE:case DockTabPopupBinding.CMD_VIEWGENERATED:case DockTabPopupBinding.CMD_VIEWSERIALIZED:this._viewSource(b);break;case DockTabPopupBinding.CMD_CLOSETAB:this.close();break;case DockTabPopupBinding.CMD_CLOSEOTHERS:this.containingTabBoxBinding.closeTabsExcept(this);break;default:alert("TODO!")}},DockTabBinding.prototype.setLabel=function(a){a||(this.getLabel()?this.getLabel()==DockTabBinding.LABEL_TABLOADING&&(a=DockTabBinding.LABEL_TABDEFAULT):a=DockTabBinding.LABEL_TABLOADING),a=this.isDirty?"*"+a:a,DockTabBinding.superclass.setLabel.call(this,a)},DockTabBinding.prototype.setImage=function(a){a||(this.getImage()?this.getImage()==DockTabBinding.IMG_TABLOADING&&(a=DockTabBinding.IMG_TABDEFAULT):a=DockTabBinding.IMG_TABLOADING),DockTabBinding.superclass.setImage.call(this,a)},DockTabBinding.prototype._viewSource=function(a){var b=ViewDefinitions["Composite.Management.SourceCodeViewer"];b.argument={action:a,doc:this._viewBinding.windowBinding.getContentDocument()};var c=Resolver.resolve(this.getLabel());switch(a){case DockTabPopupBinding.CMD_VIEWSOURCE:b.label="Source: "+c;break;case DockTabPopupBinding.CMD_VIEWGENERATED:b.label="Generated: "+c;break;case DockTabPopupBinding.CMD_VIEWSERIALIZED:b.label="Serialized: "+c}StageBinding.presentViewDefinition(b)},DockTabBinding.prototype.onActivate=function(){this._updateBroadcasters(),this.isSelected&&this._updateTree(),this._controlGroupBinding&&this._controlGroupBinding.onActivate(),this.isSelected&&this._updateGlobalEntityToken()},DockTabBinding.prototype.onDeactivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onDeactivate()},DockTabBinding.prototype.onPageInitialize=function(a){this._updateBroadcasters(),this._isEditorDockTab()&&(this.hasSubscription(BroadcastMessages.CLOSE_ALL)||(this.subscribe(BroadcastMessages.CLOSE_CURRENT),this.subscribe(BroadcastMessages.CLOSE_ALL)))},DockTabBinding.prototype.saveContainedEditor=function(){this._isEditorDockTab()&&1==this.isDirty&&this._viewBinding.saveContainedEditor()},DockTabBinding.prototype.show=function(){if(DockTabBinding.superclass.show.call(this),this.isVisible&&this.isInitiallyHidden&&Binding.exists(this)){this.isInitiallyHidden=!1;var a=this.bindingElement;setTimeout(function(){a.style.bottom="auto"},25)}},DockTabBinding.prototype.handleBroadcast=function(a,b){if(DockTabBinding.superclass.handleBroadcast.call(this,a,b),null!=this._viewBinding){var c=this._viewBinding.getContentDocument().body,d=UserInterface.getBinding(c);switch(a){case BroadcastMessages.SAVE_CURRENT:this.isDirty&&this.isSelected&&d.isActivated&&this.saveContainedEditor();break;case BroadcastMessages.CURRENT_SAVED:b.handle==this.getAssociatedView().getHandle()&&(this.unsubscribe(BroadcastMessages.CURRENT_SAVED),b.isSuccess?this._onSaveSuccess():this._onSaveFailure());break;case BroadcastMessages.CLOSE_CURRENT:this._isEditorDockTab()&&this.isSelected&&d.isActivated&&this.close();break;case BroadcastMessages.CLOSE_ALL:this._isEditorDockTab()&&this.close();break;case BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR:this.isSelected&&UserInterface.isBindingVisible(this)&&this._updateTree();break;case BroadcastMessages.BIND_TOKEN_TO_VIEW:b.handle==this._viewBinding.getDefinition().handle&&(this.setEntityToken(b.entityToken),this.isSelected&&this._updateTree())}}},DockTabBinding.prototype.onSaveStart=function(){this.subscribe(BroadcastMessages.CURRENT_SAVED)},DockTabBinding.prototype._onSaveSuccess=function(){var a=this._viewBinding.getPageBinding();null!=a&&a instanceof EditorPageBinding&&a.onSaveSuccess()},DockTabBinding.prototype._onSaveFailure=function(){},DockTabBinding.prototype.select=function(a){DockTabBinding.superclass.select.call(this,a),this._updateBroadcasters(),this._updateTree(),this._updateGlobalEntityToken()},DockTabBinding.prototype.close=function(){this.isPinned||this.containingTabBoxBinding.closeTab(this)},DockTabBinding.prototype._updateBroadcasters=function(){if(this.isSelected){var a=top.app.bindingMap.broadcasterCurrentTabDirty,b=top.app.bindingMap.broadcasterCurrentIsEditor;this._isEditorDockTab()?(b.enable(),this.isDirty?a.enable():a.disable()):(b.disable(),a.disable())}},DockTabBinding.prototype._updateTree=function(a){(this._canUpdateTree||a)&&EventBroadcaster.broadcast(BroadcastMessages.DOCKTABBINDING_SELECT,this)},DockTabBinding.prototype._isEditorDockTab=function(){var a=!1;if(null!=this._viewBinding){var b=this._viewBinding.getContentWindow();if(null!=b&&null!=b.bindingMap){var c=b.bindingMap.savebutton;null!=c&&(a=!0)}}return a},DockTabBinding.prototype._updateGlobalEntityToken=function(){StageBinding.entityToken=this._entityToken},DockTabBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:docktab",a);return UserInterface.registerBinding(b,DockTabBinding)},DockPanelsBinding.prototype=new TabPanelsBinding,DockPanelsBinding.prototype.constructor=DockPanelsBinding,DockPanelsBinding.superclass=TabPanelsBinding.prototype,DockPanelsBinding.prototype.toString=function(){return"[DockPanelsBinding]"},DockPanelsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dockpanels",a);return UserInterface.registerBinding(b,DockPanelsBinding)},DockPanelBinding.prototype=new TabPanelBinding,DockPanelBinding.prototype.constructor=DockPanelBinding,DockPanelBinding.superclass=TabPanelBinding.prototype,DockPanelBinding.ACTION_FORCE_SELECT="dockpanel force select",DockPanelBinding.prototype.toString=function(){return"[DockPanelBinding]"},DockPanelBinding.prototype.onBindingDispose=function(){DockPanelBinding.superclass.onBindingDispose.call(this),this.dispatchAction(Binding.ACTION_DISPOSED)},DockPanelBinding.prototype.select=function(a){DockPanelBinding.superclass.select.call(this,a),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED)},DockPanelBinding.prototype.unselect=function(){DockPanelBinding.superclass.unselect.call(this),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED)},DockPanelBinding.prototype.flex=function(){this.dispatchAction(Binding.ACTION_DIMENSIONCHANGED)},DockPanelBinding.prototype.handleCrawler=function(a){DockPanelBinding.superclass.handleCrawler.call(this,a),null==a.response&&a.type==NodeCrawler.TYPE_DESCENDING&&null!=this.viewBinding&&a.id==FocusCrawler.ID&&(a.nextNode=this.viewBinding.bindingElement)},DockPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dockpanel",a);return UserInterface.registerBinding(b,DockPanelBinding)},DockTabPopupBinding.prototype=new PopupBinding,DockTabPopupBinding.prototype.constructor=DockTabPopupBinding,DockTabPopupBinding.superclass=PopupBinding.prototype,DockTabPopupBinding.CMD_RESTORE="restore",DockTabPopupBinding.CMD_MINIMIZE="minimize",DockTabPopupBinding.CMD_MAXIMIZE="maximize",DockTabPopupBinding.CMD_REFRESH="refreshview",DockTabPopupBinding.CMD_MAKEDIRTY="makedirty",DockTabPopupBinding.CMD_CLOSETAB="closetab",DockTabPopupBinding.CMD_CLOSEOTHERS="closeothers",DockTabPopupBinding.CMD_CLOSEALL="closeall",DockTabPopupBinding.CMD_VIEWSOURCE="viewsource",DockTabPopupBinding.CMD_VIEWGENERATED="viewgenerated",DockTabPopupBinding.CMD_VIEWSERIALIZED="viewserialized",DockTabPopupBinding.prototype.toString=function(){return"[DockTabPopupBinding]"},DockTabPopupBinding.prototype.onBindingAttach=function(){DockTabPopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},ViewSetBinding.prototype=new Binding,ViewSetBinding.prototype.constructor=ViewSetBinding,ViewSetBinding.superclass=Binding.prototype,ViewSetBinding.prototype.toString=function(){return"[ViewSetBinding]"},ViewBinding.prototype=new FlexBoxBinding,ViewBinding.prototype.constructor=ViewBinding,ViewBinding.superclass=FlexBoxBinding.prototype,ViewBinding.ACTION_LOADED="view loaded",ViewBinding.ACTION_ONCLOSE="view onclose",ViewBinding.ACTION_ONCLOSE_FORCE="view onclose force",ViewBinding.ACTION_CLOSED="view closed",ViewBinding.ACTION_DETACH="view detach",ViewBinding.HORIZONTAL_ADJUST=1,ViewBinding.VERTICAL_ADJUST=1,ViewBinding.TYPE_EXPLORERVIEW="explorerview",ViewBinding.TYPE_DOCKVIEW="dockview",ViewBinding.TYPE_DIALOGVIEW="dialogview",ViewBinding.CLASSNAME_ACTIVE="active",ViewBinding.TIMEOUT=15,ViewBinding._instances=new Map,ViewBinding.hasInstance=function(a){return ViewBinding._instances.has(a)},ViewBinding.getInstance=function(a){var b=ViewBinding._instances.get(a);return b},ViewBinding.prototype.toString=function(){return"[ViewBinding]"},ViewBinding.prototype.onBindingRegister=function(){ViewBinding.superclass.onBindingRegister.call(this),this.addActionListener(RootBinding.ACTION_PHASE_1),this.addActionListener(RootBinding.ACTION_PHASE_2),this.addActionListener(RootBinding.ACTION_PHASE_3),this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(WindowBinding.ACTION_ONLOAD),this.addActionListener(PageBinding.ACTION_ATTACHED),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(ViewBinding.ACTION_DETACH),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_NEXT),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_PREVIOUS),this.addActionListener(WizardPageBinding.ACTION_FINISH),this.subscribe(BroadcastMessages.CLOSE_VIEW),this.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN)},ViewBinding.prototype.onBindingAttach=function(){ViewBinding.superclass.onBindingAttach.call(this),this.attachClassName(this._type),1==Client.isExplorer&&(this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)),
this._coverBinding.attach()),this._viewDefinition&&this._viewDefinition.position==DockBinding.START&&this.setProperty("position",DockBinding.START),this.windowBinding.attach()},ViewBinding.prototype.updatePositionDimension=function(){var a=this._snapBinding,b=!System.hasActivePerspectives&&Client.isExplorer;if(1==this.isFreeFloating&&!b&&1==a.isVisible&&1==a.isAttached){var c=a.boxObject.getGlobalPosition(),d=a.boxObject.getDimension();if(Point.isEqual(c,this._lastknownposition)||(this.setPosition(c),this._lastknownposition=c),Dimension.isEqual(d,this._lastknowndimension))throw"Could not snap to unattached binding!";this.setDimension(d),this._lastknowndimension=d;var e=d.h-ViewBinding.VERTICAL_ADJUST;e=0>e?0:e,this.windowBinding.getBindingElement().style.height=new String(e)+"px",this.windowBinding.reflex()}},ViewBinding.prototype.onBindingDispose=function(){if(ViewBinding.superclass.onBindingDispose.call(this),null!=this._viewDefinition){var a=this._viewDefinition.flowHandle;null!=a&&FlowControllerService.CancelFlow(a)}if(null!=this._viewDefinition){var b=this._viewDefinition.handle;EventBroadcaster.broadcast(BroadcastMessages.VIEW_CLOSED,b),this.logger.fine('ViewBinding closed: "'+b+'"')}this._snapBinding&&(this._snapBinding.removeActionListener(Binding.ACTION_DIMENSIONCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_VISIBILITYCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_DISPOSED,this),this._snapBinding.viewBinding=null),this.dispatchAction(ViewBinding.ACTION_CLOSED)},ViewBinding.prototype.setType=function(a){this._type=a},ViewBinding.prototype.getType=function(){return this._type},ViewBinding.prototype.getHandle=function(){var a=null;return null!=this._viewDefinition&&(a=this._viewDefinition.handle),a},ViewBinding.prototype.initialize=function(){if(this._isViewBindingInitialized)throw"Somehow ViewBinding got initialized twice: "+this.getHandle();this._isViewBindingInitialized=!0,this.windowBinding.setURL(this._viewDefinition.url),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle())},ViewBinding.prototype.setDefinition=function(a){this._viewDefinition=a,a.position==DockBinding.MAIN&&this.subscribe(BroadcastMessages.CLOSE_VIEWS)},ViewBinding.prototype.getDefinition=function(){return this._viewDefinition},ViewBinding.prototype.handleAction=function(a){ViewBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_1:case RootBinding.ACTION_PHASE_2:case RootBinding.ACTION_PHASE_3:a.type==RootBinding.ACTION_PHASE_1&&this.isActivated&&!b.isActivated&&b.onActivate(),a.consume();break;case Binding.ACTION_DIMENSIONCHANGED:1==this.isFreeFloating&&b==this._snapBinding&&1==this.isVisible&&(this.updatePositionDimension(),a.consume());break;case Binding.ACTION_VISIBILITYCHANGED:1==this.isFreeFloating&&b==this._snapBinding&&(1==b.isVisible?this.show():this.hide());break;case WindowBinding.ACTION_LOADED:case WindowBinding.ACTION_ONLOAD:if(b.getContentWindow().isPostBackDocument){if(a.type==WindowBinding.ACTION_ONLOAD){var c=this._viewDefinition.argument;null!=c&&null!=c.list&&null!=c.url&&(b.post(c.list,c.url),c.list=null,c.url=null)}}else if(1==Client.isExplorer){if(b==this.windowBinding){var d=this;DOMEvents.addEventListener(b.getContentWindow(),DOMEvents.UNLOAD,{handleEvent:function(a){1==Binding.exists(d._coverBinding)&&d._coverBinding.show()}})}a.type==WindowBinding.ACTION_ONLOAD&&this._coverBinding&&this._coverBinding.hide()}if(a.type==WindowBinding.ACTION_ONLOAD){var e=b.getContentWindow();null==e.WindowManager&&(this._isLoaded||this._onLoadingCompleted(b))}a.consume();break;case PageBinding.ACTION_ATTACHED:!b.label&&this._viewDefinition.label&&(b.label=this._viewDefinition.label),!b.image&&this._viewDefinition.image&&(b.image=this._viewDefinition.image),b.bindingWindow==this.getContentWindow()&&(this._pageBinding=b,this._injectPageArgument());case PageBinding.ACTION_INITIALIZED:b.bindingWindow==this.getContentWindow()&&(Client.isExplorer&&this._coverBinding&&this._coverBinding.hide(),this._isLoaded||this._onLoadingCompleted());break;case Binding.ACTION_DISPOSED:this.isFreeFloating&&b==this._snapBinding&&(this.removeActionListener(Binding.ACTION_DISPOSED),this.dispose(),a.consume());break;case WizardPageBinding.ACTION_NAVIGATE_NEXT:case WizardPageBinding.ACTION_NAVIGATE_PREVIOUS:case WizardPageBinding.ACTION_FINISH:EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle()),a.consume();break;case ViewBinding.ACTION_DETACH:this.setDefinition(ViewDefinitions["Composite.Management.Null"]),ViewBinding._instances.set(this._viewDefinition.handle,this)}},ViewBinding.prototype.handleBroadcast=function(a,b){switch(ViewBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.CLOSE_VIEW:b==this._viewDefinition.handle&&this.dispatchAction(ViewBinding.ACTION_ONCLOSE);break;case BroadcastMessages.CLOSE_VIEWS:this._viewDefinition.position==DockBinding.MAIN&&this.dispatchAction(ViewBinding.ACTION_ONCLOSE_FORCE);break;case BroadcastMessages.APPLICATION_SHUTDOWN:this.dispose()}},ViewBinding.prototype._onLoadingCompleted=function(){this._isLoaded||(this._open(),this._isLoaded=!0)},ViewBinding.prototype._open=function(){ViewBinding._instances.set(this._viewDefinition.handle,this),this.dispatchAction(ViewBinding.ACTION_LOADED),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENED,this._viewDefinition.handle),this.show(),this.logger.fine('ViewBinding opened: "'+this._viewDefinition.handle+'"')},ViewBinding.prototype.update=function(){this.dispatchAction(Binding.ACTION_ACTIVATED),this._injectPageArgument()},ViewBinding.prototype._injectPageArgument=function(){var a=this._pageBinding,b=this._viewDefinition;if(null!=a){var c=b.argument;null!=c&&a.setPageArgument(c);var d=b.width;null!=d&&(a.width=d);var e=b.height;null!=e&&(a.height=e)}},ViewBinding.prototype.handleCrawler=function(a){switch(ViewBinding.superclass.handleCrawler.call(this,a),a.type){case NodeCrawler.TYPE_DESCENDING:1==this.isFreeFloating&&a.id==FocusCrawler.ID&&a.previousNode!=this._snapBinding.bindingElement&&(a.response=NodeCrawler.SKIP_NODE);break;case NodeCrawler.TYPE_ASCENDING:1==this.isFreeFloating&&(a.nextNode=this._snapBinding.bindingElement)}},ViewBinding.prototype.show=function(){this.isVisible||(1==this.isFreeFloating?(Client.isWebKit&&(this.bindingElement.style.display=""),this._type==ViewBinding.TYPE_DOCKVIEW&&null!=this.windowBinding&&(this.windowBinding.getBindingElement().style.position="static"),this.updatePositionDimension(),this.isVisible=!0):ViewBinding.superclass.show.call(this))},ViewBinding.prototype.hide=function(){1==this.isVisible&&(1==this.isFreeFloating?(this.windowBinding&&(this.windowBinding.getBindingElement().style.position="absolute"),this.bindingElement.style.top="-10000px",Client.isWebKit&&(this.bindingElement.style.display="none"),this.isVisible=!1):ViewBinding.superclass.hide.call(this))},ViewBinding.prototype.setPosition=function(a){a.x+=ViewBinding.HORIZONTAL_ADJUST,this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},ViewBinding.prototype.setDimension=function(a){a.h-=ViewBinding.VERTICAL_ADJUST,a.w-=ViewBinding.HORIZONTAL_ADJUST,a.w-=1,a.h<0&&(a.h=0),a.w<0&&(a.w=0),this.bindingElement.style.width=String(a.w)+"px",this.bindingElement.style.height=String(a.h)+"px"},ViewBinding.prototype.snapToBinding=function(a,b){this.isFlexBoxBehavior=!1,a.addActionListener(Binding.ACTION_DIMENSIONCHANGED,this),a.addActionListener(Binding.ACTION_VISIBILITYCHANGED,this),a.addActionListener(Binding.ACTION_DISPOSED,this),this._snapBinding&&(this._snapBinding.removeActionListener(Binding.ACTION_DIMENSIONCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_VISIBILITYCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_DISPOSED,this),this._snapBinding.viewBinding=null),this._snapBinding=a,this._snapBinding.viewBinding=this,this.isFreeFloating=b!==!1,this._isViewBindingInitialized||this.initialize()},ViewBinding.prototype.getMigrationParent=function(){var a=null;return a=1==this.isFreeFloating?this._snapBinding.getBindingElement():ViewBinding.superclass.getMigrationParent.call(this)},ViewBinding.prototype.getContentWindow=function(){return this.windowBinding.getContentWindow()},ViewBinding.prototype.getContentDocument=function(){return this.windowBinding.getContentDocument()},ViewBinding.prototype.getRootBinding=function(){return this.windowBinding.getRootBinding()},ViewBinding.prototype.getPageBinding=function(){return this._pageBinding},ViewBinding.prototype.reload=function(a){this._isLoaded=!1,this.windowBinding.reload(a),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle())},ViewBinding.prototype.saveContainedEditor=function(){var a=!1,b=this._pageBinding;null!=b&&b instanceof EditorPageBinding&&b.canSave()&&(b.doSave(),a=!0),a||this.logger.error("saveContainedEditor failed")},ViewBinding.prototype.onActivate=function(){if(!this.isActivated){this.isActivated=!0;var a=this.getRootBinding();null!=a&&a.onActivate()}},ViewBinding.prototype.onDeactivate=function(){if(1==this.isActivated){this.isActivated=!1;var a=this.getRootBinding();null!=a&&this.getRootBinding().onDeactivate()}},ViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:view",a),c=UserInterface.registerBinding(b,ViewBinding);return c.windowBinding=c.add(WindowBinding.newInstance(a)),c},PageBinding.prototype=new FocusBinding,PageBinding.prototype.constructor=Binding,PageBinding.superclass=FocusBinding.prototype,PageBinding.ACTION_ATTACHED="page attached",PageBinding.ACTION_DETACHED="page detached",PageBinding.ACTION_INITIALIZED="page initialized",PageBinding.ACTION_DOPOSTBACK="page do postback",PageBinding.ACTION_VALIDATE="page validate",PageBinding.ACTION_DOVALIDATEDPOSTBACK="page do validated postback",PageBinding.ACTION_BLOCK_INIT="page block init",PageBinding.ACTION_UNBLOCK_INIT="page unblock init",PageBinding.ACTION_UPDATING="page updating",PageBinding.ACTION_UPDATED="page updated",PageBinding.ACTION_GETMESSAGES="page poll messagequeue",PageBinding.ACTION_RESPONSE="page response",PageBinding.CLASSNAME_SUBPAGE="dialogsubpage",PageBinding.TIMEOUT=250,PageBinding.prototype.toString=function(){return"[PageBinding]"},PageBinding.prototype.onBindingRegister=function(){PageBinding.superclass.onBindingRegister.call(this);var a=UserInterface.getBinding(this.bindingDocument.body);a.addActionListener(RootBinding.ACTION_PHASE_3,this),this.addActionListener(PageBinding.ACTION_DOPOSTBACK),this.addActionListener(PageBinding.ACTION_DOVALIDATEDPOSTBACK),this.addActionListener(BalloonBinding.ACTION_INITIALIZE),this.addActionListener(PageBinding.ACTION_BLOCK_INIT),this.addActionListener(PageBinding.ACTION_UNBLOCK_INIT),this.addActionListener(PageBinding.ACTION_GETMESSAGES),this.subscribe(BroadcastMessages.MESSAGEQUEUE_REQUESTED)},PageBinding.prototype.onBindingAttach=function(){PageBinding.superclass.onBindingAttach.call(this),Application.lock(this),this.parseDOMProperties(),this.dispatchAction(PageBinding.ACTION_ATTACHED)},PageBinding.prototype.onBindingDispose=function(){var a=UserInterface.getBinding(this.bindingDocument.body);a.removeActionListener(RootBinding.ACTION_PHASE_3,this),this.dispatchAction(PageBinding.ACTION_DETACHED)},PageBinding.prototype.parseDOMProperties=function(){this.getProperty("label")&&(this.label=this.getProperty("label")),this.getProperty("labelfield")&&(this.labelfield=this.getProperty("labelfield")),this.getProperty("image")&&(this.image=this.getProperty("image")),this.toolTip=this.getProperty("tooltip"),0==this.getProperty("fitasdialogsubpage")&&(this.isFitAsDialogSubPage=!1)},PageBinding.prototype.setPageArgument=function(a){Application.isOperational&&this.dispatchAction(DockPanelBinding.ACTION_FORCE_SELECT),this.pageArgument=a},PageBinding.prototype.onBeforePageInitialize=function(){this._isReadyForInitialize=!0,null==this._initBlockers&&this.onPageInitialize()},PageBinding.prototype.onPageInitialize=function(){if(this._isPageBindingInitialized){if(1!=Client.isExplorer)throw"PageBinding: Somehow initialized twice";this.logger.error("PageBinding: Somehow initialized twice"),this.logger.error(arguments.caller.callee.toString())}else{this._isPageBindingInitialized=!0,this._isDotNet()&&this._setupDotNet(),this.pageArgument&&this.pageArgument instanceof DataBindingMap&&this.bindingWindow.DataManager.populateDataBindings(this.pageArgument);var a=this;setTimeout(function(){try{1==Binding.exists(a)?(a.bindingElement.style.visibility="visible",a.dispatchAction(PageBinding.ACTION_INITIALIZED),a.onAfterPageInitialize()):(Application.unlock(Application,!0),SystemLogger.getLogger("PageBinding").warn("Premature PageBinding dispose? Please consult your developer."))}catch(b){throw a.logger.error(b),SystemDebug.stack(arguments),b}},PageBinding.TIMEOUT)}},PageBinding.prototype.onAfterPageInitialize=function(){this.removeActionListener(PageBinding.ACTION_BLOCK_INIT),this.removeActionListener(PageBinding.ACTION_UNBLOCK_INIT),Application.unlock(this),this.isActivationAware=!0;var a=UserInterface.getBinding(this.bindingDocument.body);a.makeActivationAware(this),UserInterface.isBindingVisible(this)&&this.dispatchAction(FocusBinding.ACTION_FOCUS)},PageBinding.prototype.onBeforeUpdates=function(){this._isUpdating=!0,this.dispatchAction(PageBinding.ACTION_UPDATING)},PageBinding.prototype.onAfterUpdates=function(){this.parseDOMProperties(),this._isUpdating=!1,this.dispatchAction(PageBinding.ACTION_UPDATED)},PageBinding.prototype.makeDialogSubPage=function(){this.isFitAsDialogSubPage&&(Client.isExplorer&&this.setFlexibility(!0),this.attachClassName(PageBinding.CLASSNAME_SUBPAGE),this.isDialogSubPage=!0)},PageBinding.prototype._setupDotNet=function(){var a=this,b=this.bindingDocument.forms[0],c=this.bindingWindow.__doPostBack,d=!1;!b.__isSetup&&this.isNonAjaxPage&&DOMEvents.addEventListener(this.bindingWindow,DOMEvents.UNLOAD,{handleEvent:function(){d&&Application.unlock(a)}}),this.bindingWindow.__doPostBack=function(e,f){!b.__isSetup&&a.isNonAjaxPage&&(Application.lock(a),d=!0),a.manifestAllDataBindings(),c(e,f),Application.isDeveloperMode&&a._debugDotNetPostback()}},PageBinding.prototype.postMessage=function(a,b){var c=this.bindingWindow.bindingMap.__REQUEST;if(null!=c&&this._isDotNet())switch(a){case EditorPageBinding.MESSAGE_SAVE:case EditorPageBinding.MESSAGE_PERSIST:this.bindingWindow.DataManager.isDirty&&this.validateAllDataBindings()&&(null!=b&&b.add(this),c.postback(a));break;default:c.postback(a)}null!=b&&this._postMessageToDescendants(a,b)},PageBinding.prototype._postMessageToDescendants=function(a,b){var c=this.getDescendantBindingsByType(WindowBinding);c.each(function(c){var d=c.getPageBinding();null!=d&&d.postMessage(a,b)})},PageBinding.prototype._debugDotNetPostback=function(){var a=new List;new List(this.bindingDocument.forms[0].elements).each(function(b){null!=b.name&&""!=b.name&&a.add({name:b.name,value:b.value})});var b="";a.each(function(a){b+=a.name+": "+a.value+"\n"}),this.logger.debug(b)},PageBinding.prototype.handleAction=function(a){PageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_3:if(b==UserInterface.getBinding(this.bindingDocument.body)&&(b.removeActionListener(RootBinding.ACTION_PHASE_3,this),!this._isPageBindingInitialized))try{this.onBeforePageInitialize()}catch(a){throw alert(a),SystemDebug.stack(arguments),a}break;case PageBinding.ACTION_DOPOSTBACK:this._isDotNet()&&this.doPostBack(b),a.consume();break;case PageBinding.ACTION_DOVALIDATEDPOSTBACK:if(this._isDotNet()){var c=this.validateAllDataBindings();c&&this.doPostBack(b)}a.consume();break;case BalloonBinding.ACTION_INITIALIZE:a.consume();break;case PageBinding.ACTION_BLOCK_INIT:null==this._initBlockers&&(this._initBlockers=new Map),this._initBlockers.set(b.key,!0);break;case PageBinding.ACTION_UNBLOCK_INIT:if(null!=this._initBlockers&&this._initBlockers.has(b.key)&&(this._initBlockers.del(b.key),!this._initBlockers.hasEntries()&&(this._initBlockers=null,1==this._isReadyForInitialize))){var d=this;setTimeout(function(){d.onBeforePageInitialize()},0)}break;case PageBinding.ACTION_GETMESSAGES:if(UpdateMananger.isUpdating){var d=this,e={handleAction:function(a){a.target==d&&(d.removeActionListener(PageBinding.ACTION_UPDATED,e),MessageQueue.udpdate())}};this.addActionListener(PageBinding.ACTION_UPDATED,e)}else MessageQueue.udpdate();a.consume()}},PageBinding.prototype.handleBroadcast=function(a,b){switch(PageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.MESSAGEQUEUE_REQUESTED:var c=b;this._canPostBack||c||(this._canPostBack=!0,Application.unlock(this))}},PageBinding.prototype._isDotNet=function(){var a=this.bindingDocument.forms[0];return null!=a&&"undefined"!=typeof this.bindingWindow.__doPostBack},PageBinding.prototype.doPostBack=function(a){if(this._canPostBack&&null!=a&&this._isDotNet()){var b=a.getCallBackID(),c=a.getCallBackArg();b=null!=b?b.replace(/_/g,"$"):"",null==c&&(c=""),this.bindingWindow.__doPostBack(b,c)}},PageBinding.prototype.validateAllDataBindings=function(a){for(var b=!0,c=this.bindingWindow.DataManager.getAllDataBindings();c.hasNext()&&b;){var d=c.getNext();if(d.isAttached){var e=d.validate();if(b&&!e){if(b=!1,this.logger.debug("Invalid DataBinding: "+d.toString()+" ("+d.getName()+")"),a){var f=d.getAncestorBindingByType(TabPanelBinding);if(null!=f&&!f.isVisible){var g=f.getAncestorBindingByType(TabBoxBinding),h=g.getTabBinding(f);g.select(h)}}break}}}return b},PageBinding.prototype.manifestAllDataBindings=function(){for(var a=new List,b=this.bindingWindow.DataManager.getAllDataBindings();b.hasNext();){var c=b.getNext();if(c.isAttached){var d=c.manifest();null!=d&&a.add(d)}}return a},PageBinding.prototype.cleanAllDataBindings=function(){for(var a=this.bindingWindow.DataManager.getAllDataBindings();a.hasNext();){var b=a.getNext();b.isAttached&&b.clean()}},PageBinding.prototype.getLabel=function(){var a="";if(!a&&this.labelfield){var b=this.bindingWindow.DataManager.getDataBinding(this.labelfield);null!=b&&b.getLabel?a=b.getLabel():null!=b&&b.getValue&&(a=b.getValue())}return!a&&this.label&&(a=this.label),a},PageBinding.prototype.getImage=function(){return this.image},PageBinding.prototype.getToolTip=function(){return this.toolTip},PageBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},PageBinding.prototype.onActivate=function(){if(Binding.exists(this)&&!this.isActivated&&(this.isActivated=!0,this._isFocusManager&&UserInterface.isBindingVisible(this))){try{var a=this.bindingWindow;a.focus()}catch(a){}if(null!=this._cachedFocus){var b=this;setTimeout(function(){null==FocusBinding.focusedBinding&&b._focusPreviouslyFocused()},0)}else this._focusFirstFocusable()}},PageBinding.prototype.onDeactivate=function(){if(1==this.isActivated){if(this.isActivated=!1,null!=this._cachedFocus){var a=this._cachedFocus.getBinding();a&&a.blur()}FocusBinding.activeInstance==this&&(FocusBinding.activeInstance=null)}},DialogPageBinding.prototype=new PageBinding,DialogPageBinding.prototype.constructor=DialogPageBinding,DialogPageBinding.superclass=PageBinding.prototype,DialogPageBinding.DEFAULT_WIDTH=531,DialogPageBinding.DEFAULT_TABBOXED_WIDTH=476,DialogPageBinding.DEFAULT_HEIGHT="auto",DialogPageBinding.DEFAULT_CONTROLS="close",DialogPageBinding.DEFAULT_RESIZABLE=!1,DialogPageBinding.ACTION_RESPONSE="dialogpageresponse",DialogPageBinding.ACTION_LAYOUT_D="dialoglayoutd",DialogPageBinding.CLASSNAME_TABBOXED="tabboxed",DialogPageBinding.prototype.toString=function(){return"[DialogPageBinding]"},DialogPageBinding.prototype.onBindingRegister=function(){DialogPageBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_ATTACHED),this.addActionListener(Binding.ACTION_DIRTY),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(ButtonBinding.ACTION_COMMAND)},DialogPageBinding.prototype.parseDOMProperties=function(){DialogPageBinding.superclass.parseDOMProperties.call(this);var a=this.getProperty("branded"),b=this.getAncestorBindingByType(DialogBinding,!0);if(b&&(a?b.attachClassName("branded"):b.detachClassName("branded")),null==this.width){var c=this.getProperty("width");c||(c=this.hasClassName(DialogPageBinding.CLASSNAME_TABBOXED)?DialogPageBinding.DEFAULT_TABBOXED_WIDTH:DialogPageBinding.DEFAULT_WIDTH),this.width=c}if(null==this.height){var d=this.getProperty("height");this.height=d?d:DialogPageBinding.DEFAULT_HEIGHT}if(null==this.minheight){var e=this.getProperty("minheight");null!=e&&(this.minheight=e)}if(null==this.controls){var f=this.getProperty("controls");this.controls=f?f:DialogPageBinding.DEFAULT_CONTROLS}if(!this.isResizable){var g=this.getProperty("resizable");this.isResizable=g?g:DialogPageBinding.DEFAULT_RESIZABLE}"auto"==this.height&&this.enableAutoHeightLayoutMode(!0)},DialogPageBinding.prototype.onBindingAttach=function(){DialogPageBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image"),b=this.getDescendantElementsByLocalName("dialogvignette").getFirst();a&&b&&(this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.setImage(a),b.appendChild(this.labelBinding.bindingElement),this.labelBinding.attach())},DialogPageBinding.prototype.setPageArgument=function(a){DialogPageBinding.superclass.setPageArgument.call(this,a),a&&a.image&&this.setProperty("image",a.image)},DialogPageBinding.prototype.enableAutoHeightLayoutMode=function(a){a!=this.isAutoHeightLayoutMode&&(a?this.attachClassName("auto"):this.detachClassName("auto"),this.isAutoHeightLayoutMode=a)},DialogPageBinding.prototype.handleAction=function(a){DialogPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case PageBinding.ACTION_ATTACHED:b!=this&&b.isFitAsDialogSubPage&&b.makeDialogSubPage();break;case ButtonBinding.ACTION_COMMAND:if(a.consume(),null!=b.response)switch(this.response=b.response,b.response){case Dialog.RESPONSE_ACCEPT:1==this.validateAllDataBindings()?this.onDialogAccept():this.onDialogInvalid();break;case Dialog.RESPONSE_CANCEL:this.onDialogCancel();break;default:this.onDialogResponse()}break;case Binding.ACTION_INVALID:this._disableAcceptButton(!0);break;case Binding.ACTION_VALID:this._disableAcceptButton(!1)}},DialogPageBinding.prototype._disableAcceptButton=function(a){var b=this.bindingWindow.bindingMap.buttonAccept;null!=b&&b.setDisabled(a)},DialogPageBinding.prototype.onDialogAccept=function(){if(null===this.result)try{this.result=this.bindingWindow.DataManager.getDataBindingResultMap()}catch(a){throw alert(a),a}this.onDialogResponse()},DialogPageBinding.prototype.onDialogInvalid=function(){},DialogPageBinding.prototype.onDialogCancel=function(){this.onDialogResponse()},DialogPageBinding.prototype.onDialogResponse=function(){this.dispatchAction(DialogPageBinding.ACTION_RESPONSE)},DialogPageBodyBinding.prototype=new FlexBoxBinding,DialogPageBodyBinding.prototype.constructor=DialogPageBodyBinding,DialogPageBodyBinding.superclass=FlexBoxBinding.prototype,DialogPageBodyBinding.FILLED_CLASSNAME="filled",DialogPageBodyBinding.prototype.toString=function(){return"[DialogPageBodyBinding]"},DialogPageBodyBinding.prototype._setFitnessHeight=function(a){var b=CSSComputer.getPadding(this.bindingElement),c=CSSComputer.getBorder(this.bindingElement);a+=b.top+b.bottom,a+=c.top+c.bottom,a>this.bindingElement.offsetHeight&&(this.bindingElement.style.height=a+"px")},EditorPageBinding.prototype=new PageBinding,EditorPageBinding.prototype.constructor=EditorPageBinding,EditorPageBinding.superclass=PageBinding.prototype,EditorPageBinding.ACTION_ATTACHED="editorpage attached",EditorPageBinding.ACTION_DIRTY="editorpage dirty",EditorPageBinding.ACTION_CLEAN="editorpage clean",EditorPageBinding.ACTION_SAVE="editorpage save",EditorPageBinding.ACTION_SAVE_AND_PUBLISH="editorpage save and publish",EditorPageBinding.ID_SAVEASBUTTON="saveasbutton",EditorPageBinding.ID_PREVIEWTAB="previewtab",EditorPageBinding.ID_MAINTABBOX="maintabbox",EditorPageBinding.ID_PREVIEWWINDOW="previewwindow",EditorPageBinding.MESSAGE_SAVE="save",EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH="saveandpublish",EditorPageBinding.MESSAGE_PERSIST="persist",EditorPageBinding.MESSAGE_REFRESH="refresh",EditorPageBinding.message=null,EditorPageBinding.isTabbing=!1,EditorPageBinding._registry=new Map,EditorPageBinding.register=function(a){var b=EditorPageBinding._registry;b.hasEntries()||top.app.bindingMap.broadcasterHasOpenEditors.enable(),b.set(a.key,a)},EditorPageBinding.unregister=function(a){var b=EditorPageBinding._registry;b.del(a.key),b.hasEntries()||top.app.bindingMap.broadcasterHasOpenEditors.disable()},EditorPageBinding.prototype.toString=function(){return"[EditorPageBinding]"},EditorPageBinding.prototype.onBindingRegister=function(){EditorPageBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_DIRTY),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(EditorPageBinding.ACTION_SAVE),this.addActionListener(EditorPageBinding.ACTION_SAVE_AND_PUBLISH),this.addActionListener(ResponseBinding.ACTION_SUCCESS),this.addActionListener(ResponseBinding.ACTION_FAILURE),this.addActionListener(ResponseBinding.ACTION_OOOOKAY),EditorPageBinding.register(this),this._invalidBindings=new Map,this._messengers=new List,this._messages=new List},EditorPageBinding.prototype.onBindingDispose=function(){this.dispatchAction(EditorPageBinding.ACTION_CLEAN),1==this._isPreviewWindowVisible&&setTimeout(function(){EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_OFF)},250),EditorPageBinding.unregister(this),EditorPageBinding.superclass.onBindingDispose.call(this)},EditorPageBinding.prototype.onBeforePageInitialize=function(){this._setupPreviewListeners(),EditorPageBinding.superclass.onBeforePageInitialize.call(this)},EditorPageBinding.prototype.onPageInitialize=function(){EditorPageBinding.superclass.onPageInitialize.call(this),this.enableSaveAs()},EditorPageBinding.prototype._setupPreviewListeners=function(){var a=this.bindingDocument.getElementById(EditorPageBinding.ID_MAINTABBOX),b=this.bindingDocument.getElementById(EditorPageBinding.ID_PREVIEWTAB),c=this.bindingDocument.getElementById(EditorPageBinding.ID_PREVIEWWINDOW);null!=a&&(this._tabBoxBinding=UserInterface.getBinding(a),this._tabBoxBinding.addActionListener(TabBoxBinding.ACTION_SELECTED,this),this._tabBoxBinding.addActionListener(TabBoxBinding.ACTION_UNSELECTED,this),null!=b&&null!=c&&(this._tabBinding=UserInterface.getBinding(b),this._windowBinding=UserInterface.getBinding(c),this._windowBinding.addActionListener(WindowBinding.ACTION_LOADED,this),this._windowBinding.addActionListener(WindowBinding.ACTION_ONLOAD,this),this.subscribe(BroadcastMessages.HIGHLIGHT_KEYWORDS),this._tabBinding.isSelected&&this._startPreview()))},EditorPageBinding.prototype.onSaveSuccess=function(){this.enableSave(!1),this.enableSaveAs(),this.cleanAllDataBindings(),this.isDirty=!1,EditorPageBinding.message=null,this.dispatchAction(EditorPageBinding.ACTION_CLEAN)},EditorPageBinding.prototype.handleAction=function(a){EditorPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case EditorPageBinding.ACTION_SAVE:this.postMessage(EditorPageBinding.MESSAGE_SAVE);break;case EditorPageBinding.ACTION_SAVE_AND_PUBLISH:this.postMessage(EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH);break;case ResponseBinding.ACTION_OOOOKAY:Application.isDeveloperMode;break;case ResponseBinding.ACTION_SUCCESS:if(Application.isDeveloperMode,this._messengers.hasEntries()){var c=-1;if(this._messengers.each(function(a){var d=a.bindingWindow==b.bindingWindow;return d?(a.bindingWindow.DataManager.isDirty=!1,-1==c&&(c=0)):c++,d}),c>-1&&this._messengers.del(c),!this._messengers.hasEntries())switch(this._message){case EditorPageBinding.MESSAGE_SAVE:this._saveEditorPage();break;case EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:this._saveAndPublishEditorPage();break;case EditorPageBinding.MESSAGE_PERSIST:this._refresh(),this._message=null,this._isWaitingForPreview&&(this._isWaitingForPreview=!1,this._startPreview())}}else this._refresh(),this._message=null;break;case ResponseBinding.ACTION_FAILURE:Application.isDeveloperMode,this._message=null,this._messengers=new List;break;case Binding.ACTION_DIRTY:this.canSave()&&(this.isDirty||(this.enableSave(!0),this.isDirty=!0,this.dispatchAction(EditorPageBinding.ACTION_DIRTY))),a.consume();break;case Binding.ACTION_INVALID:this.enableSave(!1),this._invalidBindings.set(b.key,b),b instanceof FieldsBinding&&this._updateStatusBar();break;case Binding.ACTION_VALID:this._invalidBindings.del(b.key),b instanceof FieldsBinding&&this._updateStatusBar(),this._invalidBindings.hasEntries()||this.enableSave(!0);break;case TabBoxBinding.ACTION_SELECTED:if(b==this._tabBoxBinding&&null!=this._windowBinding){var d=b.getSelectedTabBinding();d.getID()==EditorPageBinding.ID_PREVIEWTAB?(this._isPreviewing=!0,this._messengers.hasEntries()?this._isWaitingForPreview=!0:this._startPreview()):this._isPreviewing&&(this._isPreviewing=!1,this._stopPreview())}a.consume();break;case TabBoxBinding.ACTION_UNSELECTED:b==this._tabBoxBinding&&this.postMessage(EditorPageBinding.MESSAGE_PERSIST),a.consume();break;case WindowBinding.ACTION_LOADED:b==this._windowBinding&&(1==this._isGeneratingPreview&&(this._generatePreview(),this._isGeneratingPreview=!1),a.consume());break;case WindowBinding.ACTION_ONLOAD:if(b==this._windowBinding&&1!=b.getContentWindow().isPostBackDocument){Client.isPrism&&Prism.enableCache();var e=this;if(setTimeout(function(){Application.unlock(e)},100),EventBroadcaster.hasSubscribers(BroadcastMessages.XHTML_MARKUP_ON)){var f=WindowBinding.getMarkup(this._windowBinding);EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_ON,f)}}}},EditorPageBinding.prototype.canSave=function(){return null!=this.bindingWindow.bindingMap.savebutton},EditorPageBinding.prototype.doSave=function(){var a=this.bindingWindow.bindingMap.savebutton;null==a||a.isDisabled||a.fireCommand()},EditorPageBinding.prototype._wakeAndValidateAllDataBindings=function(a){function b(){e+=1,e===d&&f()}for(var c=this.bindingWindow.DataManager.getAllDataBindings(),d=c.getLength(),e=0,f=function(){this.validateAllDataBindings(!0)&&a()}.bind(this);c.hasNext();){var g=c.getNext();if(g.isRequired||g.getProperty("required")){for(;g&&!g.isLazy;)g=g.getAncestorBindingByType(Binding);g?g.wakeUp(b):b()}else b()}},EditorPageBinding.prototype._saveEditorPage=function(a){this._wakeAndValidateAllDataBindings(function(){this.bindingWindow.DataManager.isDirty=!1;var b=this.bindingWindow.bindingMap.__REQUEST;if(null!=b){var c=a?EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:EditorPageBinding.MESSAGE_SAVE;b.postback(c)}else this.logger.error("and publish ")}.bind(this))},EditorPageBinding.prototype._saveAndPublishEditorPage=function(){this._saveEditorPage(!0)},EditorPageBinding.prototype._refresh=function(){Application.isDeveloperMode,this.postMessage(EditorPageBinding.MESSAGE_REFRESH)},EditorPageBinding.prototype.postMessage=function(a){switch(this._message=null,a){case EditorPageBinding.MESSAGE_SAVE:case EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:this._postMessageToDescendants(a,this._messengers),this._messengers.hasEntries()?this._message=a:a==EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH?this._saveAndPublishEditorPage():this._saveEditorPage();break;case EditorPageBinding.MESSAGE_PERSIST:this._message=a,EditorPageBinding.superclass.postMessage.call(this,a,this._messengers);break;case EditorPageBinding.MESSAGE_REFRESH:EditorPageBinding.superclass.postMessage.call(this,a,this._messengers)}},EditorPageBinding.prototype.handleBroadcast=function(a,b){switch(EditorPageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.HIGHLIGHT_KEYWORDS:var c=b;UserInterface.isBindingVisible(this._windowBinding)&&WindowBinding.highlightKeywords(this._windowBinding,c)}},EditorPageBinding.prototype.onActivate=function(){
EditorPageBinding.superclass.onActivate.call(this),1==this._isPreviewWindowVisible&&EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_ACTIVATE)},EditorPageBinding.prototype.onDeactivate=function(){EditorPageBinding.superclass.onDeactivate.call(this),1==this._isPreviewWindowVisible&&EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_DEACTIVATE)},EditorPageBinding.prototype._updateStatusBar=function(){var a=new List;if(this._invalidBindings.each(function(b,c){var d=c.getInvalidLabels();d&&d.each(function(b){a.add(b)})}),a.hasEntries()){for(var b="";a.hasNext();)b+=a.getNext().toLowerCase(),b+=a.hasNext()?", ":".";var c=StringBundle.getString("ui","Website.App.StatusBar.ErrorInField");StatusBar.error(c+" "+b)}else StatusBar.clear()},EditorPageBinding.prototype._startPreview=function(){this._isGeneratingPreview=!0,Client.isPrism&&Prism.disableCache(),this._windowBinding.setURL(WindowBinding.POSTBACK_URL)},EditorPageBinding.prototype._stopPreview=function(){this._windowBinding.reset()},EditorPageBinding.prototype.enableSave=function(a){var b=this.bindingDocument.getElementById("broadcasterCanSave");if(!b)throw new Error("A required BroadcasterBinding could not be located.");var c=UserInterface.getBinding(b);a?c.enable():c.disable()},EditorPageBinding.prototype.enableSaveAs=function(){var a=this.bindingDocument.getElementById(EditorPageBinding.ID_SAVEASBUTTON);null!=a&&UserInterface.getBinding(a).enable()},EditorPageBinding.prototype.handleInvalidData=function(){this.logger.error("INVALID DATA :("),this._isGeneratingPreview&&(this._isGeneratingPreview=!1,this._windowBinding.error(),this._message=null,this._messengers=new List,Application.unlock(this))},EditorPageBinding.prototype._generatePreview=function(){var a=this._windowBinding.getContentDocument().title;if(a==WindowBinding.POSTBACK_TITLE)if(this.validateAllDataBindings()){this.manifestAllDataBindings();var b=this._tabBinding.getCallBackID(),c=new List;new List(this.bindingDocument.forms[0].elements).each(function(a){"__EVENTTARGET"==a.name&&b&&(a.value=b),c.add({name:a.name,value:a.value})});var d=String(this.bindingDocument.location);this._windowBinding.getContentWindow().submit(c,d),this._latestPostbackList=c.reset()}else this.handleInvalidData()},ResponsePageBinding.prototype=new DialogPageBinding,ResponsePageBinding.prototype.constructor=ResponsePageBinding,ResponsePageBinding.superclass=DialogPageBinding.prototype,ResponsePageBinding.prototype.toString=function(){return"[ResponsePageBinding]"},ResponsePageBinding.prototype.parseDOMProperties=function(){ResponsePageBinding.superclass.parseDOMProperties.call(this);var a=this.getProperty("responseid");this.responseid=a},ResponsePageBinding.prototype.onBindingAttach=function(){ResponsePageBinding.superclass.onBindingAttach.call(this),this.addActionListener(ResponseBinding.ACTION_SUCCESS),this.addActionListener(ResponseBinding.ACTION_FAILURE),this.addActionListener(ResponseBinding.ACTION_OOOOKAY)},ResponsePageBinding.prototype.handleAction=function(a){switch(ResponsePageBinding.superclass.handleAction.call(this,a),a.type){case ResponseBinding.ACTION_SUCCESS:this.onDialogAccept();break;case ResponseBinding.ACTION_FAILURE:}},ResponsePageBinding.prototype.onDialogAccept=function(){this.response=Dialog.RESPONSE_ACCEPT,this.responseid&&this.bindingDocument.getElementById(this.responseid)&&(this.result=this.bindingDocument.getElementById(this.responseid).value),ResponsePageBinding.superclass.onDialogAccept.call(this)},WizardPageBinding.prototype=new DialogPageBinding,WizardPageBinding.prototype.constructor=WizardPageBinding,WizardPageBinding.superclass=DialogPageBinding.prototype,WizardPageBinding.ID_NEXTBUTTON="nextbutton",WizardPageBinding.ID_PREVIOUSBUTTON="previousbutton",WizardPageBinding.ID_FINISHBUTTON="finishbutton",WizardPageBinding.ACTION_NAVIGATE_NEXT="wizardnavigatenext",WizardPageBinding.ACTION_NAVIGATE_PREVIOUS="wizardnavigateprevious",WizardPageBinding.ACTION_FINISH="wizardfinish",WizardPageBinding.prototype.toString=function(){return"[WizardPageBinding]"},WizardPageBinding.prototype.onPageInitialize=function(){WizardPageBinding.superclass.onPageInitialize.call(this),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_NEXT,this),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_PREVIOUS,this),this.addActionListener(WizardPageBinding.ACTION_FINISH,this)},WizardPageBinding.prototype.handleAction=function(a){WizardPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case WizardPageBinding.ACTION_NAVIGATE_NEXT:case WizardPageBinding.ACTION_FINISH:1==this.validateAllDataBindings()?this.doPostBack(b):a.consume();break;case WizardPageBinding.ACTION_NAVIGATE_PREVIOUS:this.doPostBack(b);break;case Binding.ACTION_INVALID:this._enableNextAndFinish(!1),a.consume();break;case Binding.ACTION_VALID:this._enableNextAndFinish(!0),a.consume()}},WizardPageBinding.prototype._enableNextAndFinish=function(a){var b=this.bindingWindow.bindingMap.nextbutton,c=this.bindingWindow.bindingMap.finishbutton;b&&b.setDisabled(!a),c&&c.setDisabled(!a)},MarkupAwarePageBinding.prototype=new PageBinding,MarkupAwarePageBinding.prototype.constructor=MarkupAwarePageBinding,MarkupAwarePageBinding.superclass=PageBinding.prototype,MarkupAwarePageBinding.prototype.toString=function(){return"[MarkupAwarePageBinding]"},MarkupAwarePageBinding.prototype.onBeforePageInitialize=function(){MarkupAwarePageBinding.superclass.onBeforePageInitialize.call(this),this.subscribe(BroadcastMessages.XHTML_MARKUP_ON),this.subscribe(BroadcastMessages.XHTML_MARKUP_OFF),this.subscribe(BroadcastMessages.XHTML_MARKUP_ACTIVATE),this.subscribe(BroadcastMessages.XHTML_MARKUP_DEACTIVATE)},MarkupAwarePageBinding.prototype.handleBroadcast=function(a,b){MarkupAwarePageBinding.superclass.handleBroadcast.call(this,a,b);var c=this;switch(a){case BroadcastMessages.XHTML_MARKUP_ON:this._activate(!0),this._handleMarkup(b);break;case BroadcastMessages.XHTML_MARKUP_OFF:this._activate(!1);break;case BroadcastMessages.XHTML_MARKUP_ACTIVATE:this._isWaiting=!0,this._activate(!0),setTimeout(function(){c._isWaiting=!1},20);break;case BroadcastMessages.XHTML_MARKUP_DEACTIVATE:setTimeout(function(){c._isActivated||c._activate(!1)},0)}},MarkupAwarePageBinding.prototype.onActivate=function(){MarkupAwarePageBinding.superclass.onActivate.call(this),this._activate(!0),this._isActivated=!0},MarkupAwarePageBinding.prototype.onDeactivate=function(){MarkupAwarePageBinding.superclass.onDeactivate.call(this),this._isActivated=!1;var a=this;setTimeout(function(){a._isWaiting||a._activate(!1)},0)},MarkupAwarePageBinding.prototype._handleMarkup=function(a){},MarkupAwarePageBinding.prototype._activate=function(a){},SystemToolBarBinding.prototype=new ToolBarBinding,SystemToolBarBinding.prototype.constructor=SystemToolBarBinding,SystemToolBarBinding.superclass=ToolBarBinding.prototype,SystemToolBarBinding.prototype.toString=function(){return"[SystemToolBarBinding]"},SystemToolBarBinding.prototype.onBindingAttach=function(){SystemToolBarBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives?(this.subscribe(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.subscribe(BroadcastMessages.INVOKE_DEFAULT_ACTION),this.addActionListener(ButtonBinding.ACTION_COMMAND)):this.hide(),"perspective"===this.getProperty("target")&&(this._syncHandle=StageBinding.perspectiveNode.getHandle())},SystemToolBarBinding.prototype.onBindingInitialize=function(){var a=this.bindingWindow.bindingMap.moreactionstoolbargroup;this._moreActionsWidth=a.boxObject.getDimension().w,a.hide();var b=this.boxObject.getDimension().h;this.bindingElement.style.height=b+"px";var c=this,d=this.bindingWindow.bindingMap.moreactionsbutton;d.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(a){c._showMoreActions(),a.consume()}});var e=this.bindingWindow.bindingMap.moreactionspopup;e.addActionListener(MenuItemBinding.ACTION_COMMAND,{handleAction:function(a){var b=a.target;c._handleSystemAction(b.associatedSystemAction)}}),SystemToolBarBinding.superclass.onBindingInitialize.call(this)},SystemToolBarBinding.prototype.handleBroadcast=function(a,b){switch(SystemToolBarBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED:var c=this;if(null!=b&&b.syncHandle==this.getSyncHandle())if(null!=b.actionProfile&&b.actionProfile.hasEntries()){this._actionProfile=b.actionProfile,this._node=b.actionProfile.Node;var d=this._getProfileKey();d!=this._currentProfileKey&&setTimeout(function(){c.emptyLeft(),c._actionFolderNames={},c.buildLeft(),c._currentProfileKey=d},0)}else setTimeout(function(){c.emptyLeft(),c._actionFolderNames={},c._currentProfileKey=null,c._node=null;var a=c.bindingWindow.bindingMap.moreactionstoolbargroup;null!=a&&a.hide()},0);break;case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.bindingWindow.WindowManager;this._toolBarBodyLeft.refreshToolBarGroups(),this._containAllButtons();break;case BroadcastMessages.INVOKE_DEFAULT_ACTION:null!=b&&b.syncHandle==this.getSyncHandle()&&this._invokeDefaultAction()}},SystemToolBarBinding.prototype._getProfileKey=function(){var a=new String("");return this._actionProfile.each(function(b,c){c.each(function(b){a+=b.getHandle()+";"+b.getKey()+";",b.isDisabled()&&(a+="isDisabled='true';")})}),a},SystemToolBarBinding.prototype.handleAction=function(a){switch(SystemToolBarBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:var b=a.target;this._handleSystemAction(b.associatedSystemAction)}},SystemToolBarBinding.prototype._handleSystemAction=function(a){null!=a&&SystemAction.invoke(a,this._node)},SystemToolBarBinding.prototype.buildLeft=function(){if(this.isInitialized&&null!=this._actionProfile&&this._actionProfile.hasEntries()){var a=this.bindingDocument,b=this,c=PopupSetBinding.getPopupSet(a,"bundlepopup"),d=new Map;this._actionProfile.each(function(e,f){var g=new List;for(f.reset();f.hasNext();){var h=f.getNext(),i=null;if(h.isInToolBar()){var j=h.getBundleName();if(j){var k;d.has(j)?k=c.getPopupByRel(j):(i=ToolBarComboButtonBinding.newInstance(a),i.setProperty("bundle",j),i.setProperty("keepstate",this._keepBundleState),d.set(j,i),k=c.createNewPopupByRel(j),k.showTextOnly());var l=SystemTreePopupBinding.prototype.getMenuItemBinding.call(this,h);k.add(l),l.attach(),l.menuHandle=h.getHandle()}else i=b.getToolBarButtonBinding(h)}null!=i&&g.add(i)}if(g.hasEntries()){var m=ToolBarGroupBinding.newInstance(a);g.each(function(a){m.add(a)}),b.addLeft(m)}},this),this.attachRecursive(),d.each(function(a,b){b.setPopup(c.getPopupByRel(a))}),this._containAllButtons()}},SystemToolBarBinding.prototype._containAllButtons=function(){var a=this.bindingWindow.bindingMap.moreactionstoolbargroup,b=CSSComputer.getPadding(this.bindingElement),c=this.bindingElement.offsetWidth-b.left-b.right;if(Localization.isUIRtl&&(c=this.bindingElement.offsetWidth-b.left-b.right),!(0>=c)){for(var d,e=0,f=new List,g=this._toolBarBodyLeft.getDescendantBindingsByLocalName("toolbarbutton");null!=(d=g.getNext());){d.isVisible||d.show();var h=CSSComputer.getMargin(d.bindingElement);e+=d.boxObject.getDimension().w+h.left+h.right,(e>=c||e+this._moreActionsWidth>=c&&g.hasNext())&&(f.add(d),d.hide())}if(f.hasEntries()){var i=f.getFirst().bindingElement.parentNode;for(UserInterface.getBinding(i).setLayout(ToolBarGroupBinding.LAYOUT_LAST),this._moreActions=new List;null!=(d=f.getNext());)d instanceof ToolBarComboButtonBinding?d.getAssociatedSystemActions().each(function(a){this._moreActions.add(a)},this):this._moreActions.add(d.associatedSystemAction);a.show()}else this._moreActions=null,a.hide()}},SystemToolBarBinding.prototype._showMoreActions=function(){if(null!=this._moreActions){var a=this.bindingWindow.bindingMap.moreactionspopup;for(a.empty();null!=(action=this._moreActions.getNext());){var b=MenuItemBinding.newInstance(a.bindingDocument);SystemTreePopupBinding.prototype.setSystemAction.call(this,b,action),a.add(b)}a.attachRecursive(),this._moreActions=null}},SystemToolBarBinding.prototype.getToolBarButtonBinding=function(a){var b=ToolBarButtonBinding.newInstance(this.bindingDocument),c=a.getLabel(),d=a.getToolTip(),e=a.getImage();a.isDisabled();return e&&b.setImage(e),c&&b.setLabel(c),d&&b.setToolTip(d),a.isDisabled()&&b.disable(),Application.isTestEnvironment&&b.setProperty("data-qa",a.getKey()),b.associatedSystemAction=a,b},SystemToolBarBinding.prototype._invokeDefaultAction=function(){var a=this.getDescendantBindingByLocalName("toolbarbutton");null!=a&&a.fireCommand()},SystemToolBarBinding.prototype.getActivePosition=function(){return this._activePosition},SystemToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbar",a);return UserInterface.registerBinding(b,SystemToolBarBinding)},SystemToolBarBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},SystemToolBarBinding.prototype.setDimension=function(a){a.h-=ViewBinding.VERTICAL_ADJUST,a.w-=ViewBinding.HORIZONTAL_ADJUST,a.w-=1,a.h<0&&(a.h=0),a.w<0&&(a.w=0),this.bindingElement.style.width=String(a.w)+"px",this.bindingElement.style.height=String(a.h)+"px"},SystemToolBarBinding.prototype.setSyncHandle=function(a){this._syncHandle=a},SystemToolBarBinding.prototype.getSyncHandle=function(){return this._syncHandle},SystemTreeBinding.prototype=new TreeBinding,SystemTreeBinding.prototype.constructor=SystemTreeBinding,SystemTreeBinding.superclass=TreeBinding.prototype,SystemTreeBinding.HAS_NO_MEMORY=!1,SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,SystemTreeBinding.URL_DIALOG_DETAILEDPASTE="${root}/content/dialogs/systemtrees/detailedpaste.aspx",SystemTreeBinding.prototype.toString=function(){return"[SystemTreeBinding]"},SystemTreeBinding.prototype.onBindingRegister=function(){SystemTreeBinding.superclass.onBindingRegister.call(this),this.perspectiveNode=StageBinding.perspectiveNode,this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_FOCUS),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_CUT),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_COPY),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_PASTE),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL),this.subscribe(BroadcastMessages.DOCKTABBINDING_SELECT),this.subscribe(BroadcastMessages.STAGEDIALOG_OPENED),this.addActionListener(SystemTreeNodeBinding.ACTION_REFRESHED_YEAH),this.addActionListener(TreeNodeBinding.ACTION_COMMAND),this._entityTokenRegistry=new Map,this._refreshingTreeNodes=new Map,0==this.getProperty("actionaware")?this._isActionProfileAware=!1:this.setContextMenu(top.app.bindingMap.systemtreepopup),1==this.getProperty("treeselector")&&(this._activePosition=SystemAction.activePositions.SelectorTree),null!=this.getProperty("locktoeditor")&&(this.isLockedToEditor=this.getProperty("locktoeditor"))},SystemTreeBinding.prototype.add=function(a){var b=SystemTreeBinding.superclass.add.call(this,a);return null===this._defaultTreeNode&&a instanceof SystemTreeNodeBinding&&(this._defaultTreeNode=a),b},SystemTreeBinding.prototype.handleAction=function(a){SystemTreeBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case TreeNodeBinding.ACTION_ONFOCUS:case TreeNodeBinding.ACTION_ONMULTIFOCUS:this._restorableFocusHandle=null;break;case SystemTreeNodeBinding.ACTION_REFRESHED_YEAH:this._updateRefreshingTrees(b.key),this._updateFocusedNode(),a.consume();break;case TreeNodeBinding.ACTION_DISPOSE:case TreeNodeBinding.ACTION_BLUR:var c=this;setTimeout(function(){c._focusedTreeNodeBindings.hasEntries()||EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{position:c._activePosition})},0),a.type==TreeNodeBinding.ACTION_BLUR&&(this._restorableFocusHandle=b.getHandle());break;case TreeNodeBinding.ACTION_COMMAND:EventBroadcaster.broadcast(BroadcastMessages.INVOKE_DEFAULT_ACTION,{syncHandle:this.getSyncHandle()}),a.consume()}},SystemTreeBinding.prototype._focusDefault=function(){this._attemptRestorableFocus(),this.getFocusedTreeNodeBindings().hasEntries()||SystemTreeBinding.superclass._focusDefault.call(this)},SystemTreeBinding.prototype.getSyncHandle=function(){return 1==this.getProperty("treeselector")?this.getAncestorBindingByType(PageBinding).getID():this.perspectiveNode.getHandle()},SystemTreeBinding.prototype._attemptRestorableFocus=function(){if(this._treeNodeBindings.has(this._restorableFocusHandle)){var a=this._treeNodeBindings.get(this._restorableFocusHandle);this.focusSingleTreeNodeBinding(a)}this._restorableFocusHandle=null},SystemTreeBinding.prototype._handleSystemTreeFocus=function(){this.getFocusedTreeNodeBindings().hasEntries()&&(this._computeClipboardSetup(),this._computeRefreshSetup(),this._isActionProfileAware&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,actionProfile:this.getCompiledActionProfile(),syncHandle:this.getSyncHandle(),source:this}))},SystemTreeBinding.prototype.getTokens=function(a){return a.node.getEntityTokens()},SystemTreeBinding.prototype.registerTreeNodeBinding=function(a){a.getHandles().each(function(b){if(this._treeNodeBindings.has(b))throw"Duplicate treenodehandles registered: "+a.getLabel();this._treeNodeBindings.set(b,a);var c=this._openTreeNodesBackupMap;null!=c&&c.has(b)&&a.open()},this);var b=this._entityTokenRegistry;this.getTokens(a).each(function(c){b.has(c)?b.get(c).add(a):b.set(c,new List([a]))},this);var c=a.node.getEntityToken(),d=null;this.isLockedToEditor?c==StageBinding.entityToken&&a.node.isTreeLockEnabled()&&(d=a):null!=this._backupfocushandle&&this._backupfocushandle==a.node.getHandle()&&(d=a),null!=d&&this.focusSingleTreeNodeBinding(d)},SystemTreeBinding.prototype.unRegisterTreeNodeBinding=function(a){a.getHandles().each(function(a){this._treeNodeBindings.del(a)},this);var b=this._entityTokenRegistry;if(this.getTokens(a).each(function(c){if(b.has(c)){var d=b.get(c);d.del(a),d.hasEntries()||b.del(c)}else this.logger.fatal("SystemTreeBinding out of synch: unRegisterTreeNodeBinding"),Application.isDeveloperMode&&Dialog.error("Attention Developer","Tree is out of synch. Please reproduce this bug and file a report.")},this),!this.isLockedToEditor&&a.isFocused&&null==this._backupfocushandle){this._backupfocushandle=a.node.getHandle();var c=this;setTimeout(function(){c._backupfocushandle=null},200)}},SystemTreeBinding.prototype._updateRefreshingTrees=function(a){var b=this._refreshingTreeNodes;b.hasEntries()&&b.has(a)&&(b.del(a),b.hasEntries()||(EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this._refreshToken),this._refreshToken=null,this._attemptRestorableFocus(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED_AFTER,{syncHandle:this.getSyncHandle()})))},SystemTreeBinding.prototype._updateFocusedNode=function(){if(!this._focusedTreeNodeBindings.hasEntries()&&this._activePosition!=SystemAction.activePositions.SelectorTree){var a=StageBinding.entityToken;null!=a&&this._focusTreeNodeByEntityToken(a)}},SystemTreeBinding.prototype._computeClipboardSetup=function(){var a=!1,b=this.getFocusedTreeNodeBindings();if(this._activePosition==SystemAction.activePositions.SelectorTree)a=!1;else if(b.hasEntries())for(a=!0;a&&b.hasNext();){var c=b.getNext();c.isDraggable||(a=!1)}SystemTreePopupBinding.isCutAllowed=a},SystemTreeBinding.prototype._computeRefreshSetup=function(){SystemTreePopupBinding.isRefreshAllowed=null===SystemTreeBinding.clipboard},SystemTreeBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:(null!=b||this.isFocused)&&this._handleCommandBroadcast(a,b);break;case BroadcastMessages.SYSTEMTREEBINDING_CUT:case BroadcastMessages.SYSTEMTREEBINDING_COPY:case BroadcastMessages.SYSTEMTREEBINDING_PASTE:this.isFocused&&this._handleCommandBroadcast(a);break;case BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL:this.collapse(!0);break;case BroadcastMessages.DOCKTABBINDING_SELECT:if(this.isLockedToEditor){var c=b;"Composite.Management.Explorer"!=c.getHandle()&&this._handleDockTabSelect(c)}break;case BroadcastMessages.STAGEDIALOG_OPENED:this.isLockedToEditor&&this.blurSelectedTreeNodes(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition});break;case BroadcastMessages.SYSTEMTREEBINDING_FOCUS:if(StageBinding.perspectiveNode===this.perspectiveNode){var d=this,e=b;setTimeout(function(){null!=e&&d._focusTreeNodeByEntityToken(e)},250)}}},SystemTreeBinding.prototype._handleDockTabSelect=function(a){var b=null==a.perspectiveNode;if(b||(b=a.perspectiveNode==this.perspectiveNode),b)if(a.isExplorerTab){var c=this.getHandleToken(),d=this;this.setHandleToken(null);var e=this.getFocusedTreeNodeBindings().getFirst();e&&e.node.getEntityToken()===c?EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS,e):setTimeout(function(){null!=c&&d._focusTreeNodeByEntityToken(c)},250)}else this.setHandleToken(a.getEntityToken())},SystemTreeBinding.prototype.setHandleToken=function(a){this._handleToken=a},SystemTreeBinding.prototype.getHandleToken=function(){return this._handleToken},SystemTreeBinding.prototype._focusTreeNodeByEntityToken=function(a,b){var c=null;if(this._entityTokenRegistry.has(a)){var d=this._entityTokenRegistry.get(a);d.each(function(a){var b=!0;return a.node.isTreeLockEnabled()&&(c=a,b=!1),b}),null!=c&&(c.isFocused&&c.node.getEntityToken()===a?c.dispatchAction(TreeNodeBinding.ACTION_FOCUSED):(c.selectToken(a),this.focusSingleTreeNodeBinding(c,!0)))}if(null==c&&1!=b){Application.lock(this),StatusBar.busy();var e=this;setTimeout(function(){Binding.exists(e)&&(e._fetchTreeForEntityToken(a),e._focusTreeNodeByEntityToken(a,!0)),Application.unlock(e),StatusBar.clear()},0)}else null==c&&(this.getFocusedTreeNodeBindings().each(function(a){a.blur()}),EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,syncHandle:this.getSyncHandle()}))},SystemTreeBinding.prototype._fetchTreeForEntityToken=function(a){function b(a,b){a.hasBeenOpened||b.hasEntries()&&(b.each(function(b){if(!j.has(b.getHandle())){var c=SystemTreeNodeBinding.newInstance(b,i.bindingDocument);k.set(b.getHandle(),c),a.add(c)}}),a.attachRecursive()),a.open(!0)}var c=new List;if(this._activePosition==SystemAction.activePositions.SelectorTree)for(var d=this.getRootTreeNodeBindings();d.hasNext();){var e=d.getNext();c.add(e.node.getEntityToken())}else c.add(StageBinding.perspectiveNode.getEntityToken());for(;c.hasNext();){var f=c.getNext(),g=this.getOpenSystemNodes(),h=System.getInvisibleBranch(f,a,g);if(null==h)this.isLockedToEditor=!1,Application.isDeveloperMode&&Dialog.warning("Ouch!","Because the web service failed, tree has disabled the lock-tree-to-editor feature. Otherwise, re-focus would fire the error indefinitely. Please try again.");else if(h.hasEntries()){var i=this,j=this._treeNodeBindings,k=new Map;h.each(function(a,c){if(j.has(a)){var d=j.get(a);b(d,c)}else if(k.has(a)){var e=k.get(a);b(e,c)}})}}},SystemTreeBinding.prototype._handleCommandBroadcast=function(a,b){switch(a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:var c=b;null!=c?this._invokeServerRefresh(c):this._invokeManualRefresh();break;case BroadcastMessages.SYSTEMTREEBINDING_CUT:null!=SystemTreeBinding.clipboard&&SystemTreeBinding.clipboard.hideDrag();var d=this.getFocusedTreeNodeBindings().getFirst();SystemTreeBinding.clipboardOperation=SystemTreePopupBinding.CMD_CUT,SystemTreeBinding.clipboard=d,d.showDrag();break;case BroadcastMessages.SYSTEMTREEBINDING_COPY:var d=this.getFocusedTreeNodeBindings().getFirst();SystemTreeBinding.clipboardOperation=SystemTreePopupBinding.CMD_COPY,SystemTreeBinding.clipboard=d;break;case BroadcastMessages.SYSTEMTREEBINDING_PASTE:this._handlePaste()}},SystemTreeBinding.prototype._invokeServerRefresh=function(a){if(null!=a&&"null"==a&&Application.isDeveloperMode&&alert("Saa har vi balladen."),this._entityTokenRegistry.has(a)){var b=this._entityTokenRegistry.get(a).reset();for(this._refreshToken=a,EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this._refreshToken);b.hasNext();){var c=b.getNext();this._refreshingTreeNodes.set(c.key,!0),setTimeout(function(){c.refresh(!0)},0)}}},SystemTreeBinding.prototype._invokeManualRefresh=function(){var a=this.getFocusedTreeNodeBindings().getFirst();if(a){var b=a.getLabel(),c=a.getAncestorBindingByLocalName("treenode");if(c&&(a=c),this._refreshToken=null,this._refreshingTreeNodes.set(a.key,!0),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,null),!StatusBar.state){var d=StringBundle.getString("ui","Website.App.StatusBar.Refreshing");StatusBar.busy(d,[b])}a.refresh()}},SystemTreeBinding.prototype._handlePaste=function(){var a=SystemTreeBinding.clipboard;if(a){var b=a.dragType,c=this.getFocusedTreeNodeBindings().getFirst();c.dragAccept?c.acceptor.isAccepting(b)?this._performPaste(c):Dialog.message(StringBundle.getString("ui","Website.Misc.Trees.DialogTitle.PasteTypeNotAllowed"),StringBundle.getString("ui","Website.Misc.Trees.DialogText.PasteTypeNotAllowed")):Dialog.message(StringBundle.getString("ui","Website.Misc.Trees.DialogTitle.PasteNotAllowed"),StringBundle.getString("ui","Website.Misc.Trees.DialogText.PasteNotAllowed"))}},SystemTreeBinding.prototype._performPaste=function(a){function b(){MessageQueue.update(),Application.unlock(c)}var c=this;if(a.node.hasDetailedDropSupport())if(a.node.hasChildren()){var d=a.node.getChildren();Dialog.invokeModal(SystemTreeBinding.URL_DIALOG_DETAILEDPASTE,{handleDialogResponse:function(d,e){if(d==Dialog.RESPONSE_ACCEPT){Application.lock(c);var f=e.get("switch"),g=e.get("sibling");"after"==f&&g++;var h=a.accept(SystemTreeBinding.clipboard,g);h?(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,setTimeout(b,0)):b()}}},d)}else{Application.lock(c);var e=a.accept(SystemTreeBinding.clipboard,0);e?(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,setTimeout(b,0)):b()}else{Application.lock(c);var e=a.accept(SystemTreeBinding.clipboard,0);e&&(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null),b()}},SystemTreeBinding.prototype.selectDefault=function(){if(this._defaultTreeNode!==!1){var a=System.getDefaultEntityToken(this.perspectiveNode.getEntityToken());if(null!=a)this._focusTreeNodeByEntityToken(a);else if(this._defaultTreeNode)this._defaultTreeNode.focus(),this._defaultTreeNode.isContainer&&!this._defaultTreeNode.isOpen&&this._defaultTreeNode.open(),this._defaultTreeNode=null;else{var b=this.getDescendantBindingByType(TreeNodeBinding);b&&b.focus()}}},SystemTreeBinding.prototype.collapse=function(a){if(EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition}),a){this.blurSelectedTreeNodes();var b=this.getRootTreeNodeBindings();b.each(function(a){a.isContainer&&a.isOpen&&(a.close(),a.hasBeenOpened=!1,a.empty())})}else SystemTreeBinding.superclass.collapse.call(this)},SystemTreeBinding.prototype.setLockToEditor=function(a){a!=this.isLockedToEditor&&(this.isLockedToEditor=a,a&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR))},SystemTreeBinding.prototype.getOpenSystemNodes=function(){var a=new List([StageBinding.perspectiveNode]);this._activePosition==SystemAction.activePositions.SelectorTree&&(a=new List);var b=this.getRootTreeNodeBindings();return b.each(function(b){var c=b.getOpenSystemNodes();null!=c&&c.hasEntries()?a.merge(c):b.isOpen&&a.add(b.node)}),a},SystemTreeBinding.prototype.focusSingleTreeNodeBinding=function(a){SystemTreeBinding.superclass.focusSingleTreeNodeBinding.call(this,a),null!=a&&this._handleSystemTreeFocus()},SystemTreeBinding.prototype.setActionGroup=function(a){if(a){var b=new List(a.split(" "));for(this._actionGroup={};b.hasNext();)this._actionGroup[b.getNext()]=!0}},SystemTreeBinding.prototype.getCompiledActionProfile=function(){var a=new Map,b=this.getFocusedTreeNodeBindings().getFirst(),c=b.node.getActionProfile();if(null!=c){var d=this;c.each(function(b,c){var e=new List;c.each(function(a){a.getActivePositions()&d._activePosition&&(!d._actionGroup||d._actionGroup[a.getGroupName()])&&e.add(a)}),e.hasEntries()&&a.set(b,e)})}a.activePosition=this._activePosition;var e=b.node.getPropertyBag();return e&&e.Uri&&"application/x-composite-page"===e.ElementType&&(a.Uri=e.Uri),a.EnitityToken=b.node.getEntityToken(),a.Node=b.node,a},SystemTreePopupBinding.prototype=new PopupBinding,SystemTreePopupBinding.prototype.constructor=SystemTreePopupBinding,SystemTreePopupBinding.superclass=PopupBinding.prototype,SystemTreePopupBinding.CMD_CUT="cut",SystemTreePopupBinding.CMD_COPY="copy",SystemTreePopupBinding.CMD_PASTE="paste",SystemTreePopupBinding.CMD_REFRESH="refresh",SystemTreePopupBinding.isCutAllowed=!1,SystemTreePopupBinding.isRefreshAllowed=!0,SystemTreePopupBinding.prototype.onBindingRegister=function(){SystemTreePopupBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED),this.addActionListener(MenuItemBinding.ACTION_COMMAND,this)},SystemTreePopupBinding.prototype.onBindingAttach=function(){SystemTreePopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},SystemTreePopupBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreePopupBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED:null!=b&&null!=b.actionProfile?(this._node=b.actionProfile.Node,this._actionProfile=b.actionProfile):this._currentProfileKey=null}},SystemTreePopupBinding.prototype._getProfileKey=SystemToolBarBinding.prototype._getProfileKey,SystemTreePopupBinding.prototype.show=function(){var a=this._getProfileKey();a!=this._currentProfileKey&&(this.disposeContent(),this.constructContent(),this._currentProfileKey=a),this._setupClipboardItems(),this._setupRefreshItem(),SystemTreePopupBinding.superclass.show.call(this)},SystemTreePopupBinding.prototype._setupClipboardItems=function(){var a=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_CUT),b=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_COPY),c=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_PASTE);a.setDisabled(!SystemTreePopupBinding.isCutAllowed),b.setDisabled(!SystemTreePopupBinding.isCutAllowed),c.setDisabled(null==SystemTreeBinding.clipboard)},SystemTreePopupBinding.prototype._setupRefreshItem=function(){var a=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_REFRESH);a.setDisabled(!SystemTreePopupBinding.isRefreshAllowed)},SystemTreePopupBinding.prototype.handleAction=function(a){switch(SystemTreePopupBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target,c=b.associatedSystemAction;if(c){if(SystemAction.invoke(c,this._node),this._keepBundleState){var d=c.getBundleName();null!=d&&LocalStorage.set(ToolBarComboButtonBinding.STORAGE_PREFFIX+d,c.getHandle())}}else{var e=b.getProperty("cmd");e&&this._handleCommand(e)}this._currentProfileKey=null}},SystemTreePopupBinding.prototype._handleCommand=function(a){var b=null;switch(a){case SystemTreePopupBinding.CMD_CUT:b=BroadcastMessages.SYSTEMTREEBINDING_CUT;break;case SystemTreePopupBinding.CMD_COPY:b=BroadcastMessages.SYSTEMTREEBINDING_COPY;break;case SystemTreePopupBinding.CMD_PASTE:b=BroadcastMessages.SYSTEMTREEBINDING_PASTE;break;case SystemTreePopupBinding.CMD_REFRESH:b=BroadcastMessages.SYSTEMTREEBINDING_REFRESH}b&&setTimeout(function(){EventBroadcaster.broadcast(b)},0)},SystemTreePopupBinding.prototype.disposeContent=function(){for(var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"menugroup")).reverse();a.hasNext();){var b=UserInterface.getBinding(a.getNext());b.getProperty("rel")||b.dispose();
}},SystemTreePopupBinding.prototype.constructContent=function(){if(null!=this._actionProfile){var a=this.bindingDocument,b=new List,c=this,d=new Map;for(this._actionProfile.each(function(e,f){var g=MenuGroupBinding.newInstance(a);f.each(function(b){var e=c.getMenuItemBinding(b),f=b.getBundleName();if(f)if(d.has(f)){var h=d.get(f);if(null==h.getChildBindingByType(MenuPopupBinding)){h.setProperty("hasaction",!0);var i=MenuPopupBinding.newInstance(a),j=i.add(MenuBodyBinding.newInstance(a)),k=j.add(MenuGroupBinding.newInstance(a));h.add(i),(this._keepBundleState||h.isDisabled)&&k.add(c.getMenuItemBinding(h.associatedSystemAction))}var l=h.getDescendantBindingByType(MenuGroupBinding);l&&l.add(e)}else g.add(e),d.set(f,e);else g.add(e)},this),b.add(g)},this),b.reverse();b.hasNext();)this._bodyBinding.addFirst(b.getNext());this._bodyBinding.attachRecursive(),d.each(function(a,b){if(b.isMenuContainer&&(this._keepBundleState||b.isDisabled)){var c=b.getDescendantBindingsByType(MenuItemBinding),d=null;if(this._keepBundleState){var e=LocalStorage.get(ToolBarComboButtonBinding.STORAGE_PREFFIX+a);c.each(function(a){return a.associatedSystemAction&&a.associatedSystemAction.getHandle()===e&&!a.isDisabled?(d=a,!1):!0})}null==d&&c.each(function(a){return a.isDisabled?!0:(d=a,!1)}),null==d&&(d=c.getFirst()),this.setSystemAction(b,d.associatedSystemAction),Binding.prototype.hide.call(d)}},this)}},SystemTreePopupBinding.prototype.getMenuItemBinding=function(a){var b=MenuItemBinding.newInstance(this.bindingDocument);return SystemTreePopupBinding.prototype.setSystemAction.call(this,b,a),b},SystemTreePopupBinding.prototype.setSystemAction=function(a,b){var c=b.getLabel(),d=b.getToolTip(),e=b.getImage(),f=b.getDisabledImage(),g=b.isCheckBox();c&&a.setLabel(c),d&&a.setToolTip(d),e&&(a.imageProfile=new ImageProfile({image:e,imageDisabled:f})),g&&(a.setType(MenuItemBinding.TYPE_CHECKBOX),b.isChecked()?a.check(!0):a.uncheck(!0)),b.isDisabled()?a.disable():a.isDisabled&&a.enable(),a.associatedSystemAction=b},SystemTreePopupBinding.prototype.snapToMouse=function(a){var b=a.target?a.target:a.srcElement,c=DOMUtil.getLocalName(b),d=null;if("tree"!=c){switch(c){case"treenode":break;default:b=DOMUtil.getAncestorByLocalName("treenode",b),null!=b&&(d=UserInterface.getBinding(b),d.isDisabled&&(d=null))}null!=d&&null!=d.node&&null!=d.node.getActionProfile()&&SystemTreePopupBinding.superclass.snapToMouse.call(this,a)}},SystemTreeNodeBinding.prototype=new TreeNodeBinding,SystemTreeNodeBinding.prototype.constructor=SystemTreeNodeBinding,SystemTreeNodeBinding.superclass=TreeNodeBinding.prototype,SystemTreeNodeBinding.ACTION_REFRESHED="systemtreenoderefreshed",SystemTreeNodeBinding.ACTION_REFRESHED_YEAH="systemtreenoderefreshedyeah!",SystemTreeNodeBinding.MAX_CHILD_IMPORT=1e4,SystemTreeNodeBinding.prototype.onBindingAttach=function(){this.addActionListener(SystemTreeNodeBinding.ACTION_REFRESHED),this.subscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCE_OPEN),this.isDisabled=this.node.isDisabled();var a=this.node.getLabel();a&&this.setLabel(a);var b=this.node.getToolTip();b&&this.setToolTip(b);var c=this.node.getHandle();c&&this.setHandle(c);var d=this.node.getPropertyBag();if(d)for(var e in d)switch(e.toLowerCase()){case"id":case"key":throw new Error("Illegal propertybag key: "+e);default:this.setProperty(e,d[e])}SystemTreeNodeBinding.superclass.onBindingAttach.call(this),this.perspectiveNode=this.containingTreeBinding.perspectiveNode},SystemTreeNodeBinding.prototype._initializeBindingDragAndDropFeatures=function(){if(this.node.hasDragType()&&this.setProperty("dragtype",this.node.getDragType()),this.node.hasDragAccept()){for(var a="",b=this.node.getDragAccept();b.hasNext();)a+=b.getNext(),b.hasNext()&&(a+=" ");this.setProperty("dragaccept",a)}SystemTreeNodeBinding.superclass._initializeBindingDragAndDropFeatures.call(this)},SystemTreeNodeBinding.prototype.handleAction=function(a){switch(SystemTreeNodeBinding.superclass.handleAction.call(this,a),a.type){case SystemTreeNodeBinding.ACTION_REFRESHED:a.target==this&&(this.isOpen||(this.hasBeenOpened=!1,a.consume()))}},SystemTreeNodeBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreeNodeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREENODEBINDING_FORCE_OPEN:if(b==this.node.getEntityToken()&&this.isContainer&&!this.isOpen){this._isForcedOpen=!0,EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN,this);var c=this;setTimeout(function(){c.open()},0)}}},SystemTreeNodeBinding.prototype._computeImageProfile=function(){},SystemTreeNodeBinding.prototype.computeImage=function(){var a=null,b=this.node.getImageProfile();return b&&(a=this.isOpen?b.getActiveImage():b.getDefaultImage()),a||(a=SystemTreeNodeBinding.superclass.computeImage.call(this)),a},SystemTreeNodeBinding.prototype.open=function(a){var b=this.isContainer&&!this.isOpen,c=!this.hasBeenOpened;SystemTreeNodeBinding.superclass.open.call(this),b&&(c||SystemTreeBinding.HAS_NO_MEMORY)&&1!=a&&(this.refresh(),this._isForcedOpen&&(EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN,this),this._isForcedOpen=!1))},SystemTreeNodeBinding.prototype.refresh=function(){var a=null;this.isContainer&&(a=this.getOpenSystemNodes()),this.isRefreshing=!0,Application.lock(this),StatusBar.busy();var b=this;setTimeout(function(){Binding.exists(b)?(b._performRefresh(a),Application.unlock(b)):Application.unlock(Application,!0),StatusBar.clear()},0)},SystemTreeNodeBinding.prototype._performRefresh=function(a){this.activeBundles=new List,this.getDescendantBindingsByType(SystemTreeNodeBinding).each(function(a){a.node.isMultiple()&&this.activeBundles.add(a.node.getHandle())},this),null!=a?this._refreshBranch(a):this._refreshChildren(),this.isRefreshing=!1,this.activeBundles=null,this.isContainer=null!=DOMUtil.getElementsByTagName(this.bindingElement,"treenode").item(0),this.updateClassNames(),this.dispatchAction(SystemTreeNodeBinding.ACTION_REFRESHED),this.dispatchAction(SystemTreeNodeBinding.ACTION_REFRESHED_YEAH)},SystemTreeNodeBinding.prototype._refreshChildren=function(){var a=(new List,this.node.getChildren());this.empty(),a.hasEntries()&&this._insertTreeNodesRegulated(a)},SystemTreeNodeBinding.prototype._insertTreeNodesRegulated=function(a){for(var b=0,c=new List([]);a.hasEntries()&&b<=SystemTreeNodeBinding.MAX_CHILD_IMPORT;){var d=SystemTreeNodeBinding.newInstance(a.extractFirst(),this.bindingDocument);d.node.isMultiple()&&d.node.getDatas().each(function(a){return this.activeBundles.has(a.ElementKey)?(d.node.select(a.ElementKey),!1):!0},this),d.autoExpand=this.autoExpand,this.add(d),d.attach(),b++,this.autoExpand&&(1==b&&!a.hasEntries()||LocalStore.openedNodes.has(d.node))&&c.add(d)}a.hasEntries()&&this._insertBufferTreeNode(a),c.each(function(a){if(a.isContainer&&!a.isOpen){var b=a;setTimeout(function(){b.open()},0)}})},SystemTreeNodeBinding.prototype._insertBufferTreeNode=function(a){alert("Max treenode count reached. This is not handled!"),alert("TODO: SystemTreeNodeBinding#._insertBufferTreeNode")},SystemTreeNodeBinding.prototype._refreshBranch=function(a){var b=this.node.getDescendantBranch(a);b.hasEntries()&&this.XXX(b)},SystemTreeNodeBinding.prototype.XXX=function(a){var b=this,c=new Map;this.empty(),a.each(function(a,d){new Map;d.hasEntries()&&d.each(function(d){var e=SystemTreeNodeBinding.newInstance(d,b.bindingDocument);if(e.node.isMultiple()&&e.node.getDatas().each(function(a){return this.activeBundles.has(a.ElementKey)?(e.node.select(a.ElementKey),!1):!0},this),c.set(d.getHandle(),e),c.has(a)){var f=c.get(a);f.add(e),f.isOpen=!0,f.hasBeenOpened=!0,d.searchToken=f.node.searchToken}else a==b.node.getHandle()&&(b.add(e),d.searchToken=b.node.searchToken)},this)},this),this.attachRecursive(),a.dispose(),c.dispose()},SystemTreeNodeBinding.prototype.getOpenDescendants=function(){var a=new TreeCrawler,b=new List;return a.mode=TreeCrawler.MODE_GETOPEN,a.crawl(this.bindingElement,b),b.hasEntries()&&b.extractFirst(),a.dispose(),b},SystemTreeNodeBinding.prototype.getOpenSystemNodes=function(){var a=null,b=this.getOpenDescendants();return b.hasEntries()&&(a=new List([this.node]),b.each(function(b){a.add(b.node)})),a},SystemTreeNodeBinding.prototype.updateClassNames=function(){this.isRefreshing||SystemTreeNodeBinding.superclass.updateClassNames.call(this)},SystemTreeNodeBinding.prototype.acceptTreeNodeBinding=function(a,b){var c=SystemTreeBinding.clipboardOperation==SystemTreePopupBinding.CMD_COPY;a instanceof SystemTreeNodeBinding&&TreeService.ExecuteDropElementAction&&TreeService.ExecuteDropElementAction(a.node.getData(),this.node.getData(),b?b:this.containingTreeBinding.getDropIndex(),Application.CONSOLE_ID,c)},SystemTreeNodeBinding.prototype.invokeManagedFocus=function(a){if(!this.isFocused){SystemTreeNodeBinding.superclass.invokeManagedFocus.call(this);var b=this.containingTreeBinding;b.isLockedToEditor&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS,this)}},SystemTreeNodeBinding.prototype.hasChildren=function(){return this.node.hasChildren()},SystemTreeNodeBinding.prototype.getHandles=function(){return this.node.getHandles()},SystemTreeNodeBinding.prototype.selectToken=function(a){this.node.selectByToken(a),this.isDisabled=this.node.isDisabled(),this.setLabel(this.node.getLabel()),this.setToolTip(this.node.getToolTip()),this.setImage(this.computeImage()),this.setHandle(this.node.getHandle())},SystemTreeNodeBinding.newInstance=function(a,b){var c=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",b),d=UserInterface.registerBinding(c,SystemTreeNodeBinding);return d.node=a,d},SystemPageBinding.prototype=new PageBinding,SystemPageBinding.prototype.constructor=SystemPageBinding,SystemPageBinding.superclass=PageBinding.prototype,SystemPageBinding.prototype.toString=function(){return"[SystemPageBinding]"},SystemPageBinding.prototype.onBindingRegister=function(){SystemPageBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH),this.addActionListener(ButtonBinding.ACTION_COMMAND)},SystemPageBinding.prototype.setPageArgument=function(a){this.node=a,SystemPageBinding.superclass.setPageArgument.call(this,a)},SystemPageBinding.prototype.onBeforePageInitialize=function(){if(!this.node)throw"SystemPageBinding requires a SystemNode";if(this._tree=this.bindingWindow.bindingMap.tree,!this._tree)throw"SystemPageBinding requires a SystemTreeBinding";this._buildTree(),SystemPageBinding.superclass.onBeforePageInitialize.call(this)},SystemPageBinding.prototype._buildTree=function(){var a=this.node.getChildren();if(a.hasEntries())for(;a.hasNext();){var b=SystemTreeNodeBinding.newInstance(a.getNext(),this.bindingDocument);this._tree.add(b),b.attach()}},SystemPageBinding.prototype._refreshTree=function(){var a=this._tree._treeBodyBinding.getChildBindingsByLocalName("treenode");a.each(function(a){a.isContainer||(a.isOpen=!0)});var b=new TreeCrawler,c=new List;b.mode=TreeCrawler.MODE_GETOPEN,b.crawl(this.bindingElement,c),b.dispose();var d=new List([this.node]);c.each(function(a){d.add(a.node)}),this._tree.empty();var e=this.node.getDescendantBranch(d);if(e.hasEntries()){var f=this,g=new Map;e.each(function(a,b){b.each(function(b){var c=SystemTreeNodeBinding.newInstance(b,f.bindingDocument);if(g.set(b.getHandle(),c),g.has(a)){var d=g.get(a);d.add(c),d.isOpen=!0}else a==f.node.getHandle()&&f._tree.add(c)})}),this._tree.attachRecursive()}},SystemPageBinding.prototype.onAfterPageInitialize=function(){if(SystemPageBinding.superclass.onAfterPageInitialize.call(this),this._tree.selectDefault(),Application.isTestEnvironment)try{this.setProperty("data-qa",this.node.getTag())}catch(a){}},SystemPageBinding.prototype.handleAction=function(a){switch(SystemPageBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:var b=a.target;switch(b.getID()){case"locktreebutton":this._tree.setLockToEditor(b.isChecked);break;case"collapsebutton":this._tree.collapse()}}},SystemPageBinding.prototype.handleBroadcast=function(a,b){switch(SystemPageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:var c=b;if(this.node&&this.node.getEntityToken()==c)try{EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,c);var d=this;Application.lock(this),setTimeout(function(){d._refreshTree(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,c),Application.unlock(d)},0)}catch(a){alert(a),SystemDebug.stack(arguments)}}},StageContainerBinding.prototype=new FlexBoxBinding,StageContainerBinding.prototype.constructor=StageContainerBinding,StageContainerBinding.superclass=FlexBoxBinding.prototype,StageContainerBinding.prototype.toString=function(){return"[StageContainerBinding]"},StageContainerBinding.prototype.onBindingAttach=function(){StageContainerBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.APPLICATION_OPERATIONAL)},StageContainerBinding.prototype.handleBroadcast=function(a,b){StageContainerBinding.superclass.handleBroadcast.call(this,a,b);var c=this.bindingWindow.WindowManager;switch(a){case BroadcastMessages.APPLICATION_OPERATIONAL:this.subscribe(c.WINDOW_RESIZED_BROADCAST),this._fit(),this.reflex();break;case c.WINDOW_RESIZED_BROADCAST:if(1==Client.isMozilla)this._fit(),this.reflex();else{Application.lock(this);var d=this;setTimeout(function(){d._fit(),d.reflex(),Application.unlock(d)},0)}}},StageContainerBinding.prototype._fit=function(){var a=this.bindingWindow.WindowManager;this.bindingElement.style.width=a.getWindowDimensions().w+"px"},StageBinding.prototype=new FocusBinding,StageBinding.prototype.constructor=StageBinding,StageBinding.superclass=FocusBinding.prototype,StageBinding.ACTION_DECK_LOADED="stage deck loaded",StageBinding.CLASSNAME_EMPTY="empty",StageBinding.bindingInstance=null,StageBinding.perspectiveNode=null,StageBinding.entityToken=null,StageBinding.treeSelector=null,StageBinding.placeholderWidth=null,StageBinding.handleViewPresentation=function(a){if(StageBinding.isViewOpen(a))EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEW,a);else{var b=ViewDefinitions[a];StageBinding.presentViewDefinition(b)}},StageBinding.isViewOpen=function(a){return null!=StageBinding.bindingInstance._activeViewDefinitions[a]},StageBinding.setSelectionByHandle=function(a){StageBinding.bindingInstance._explorerBinding.setSelectionByHandle(a)},StageBinding.getSelectionHandle=function(){return StageBinding.bindingInstance._explorerBinding.getSelectionHandle()},StageBinding.selectBrowserTab=function(){StageBinding.bindingInstance.selectBrowserTab()},StageBinding.presentViewDefinition=function(a){if(null!=a.label){var b=StringBundle.getString("ui","Website.App.StatusBar.Opening");StatusBar.busy(b,[a.label])}else StatusBar.busy();StageBinding.bindingInstance._presentViewDefinition(a)},StageBinding.prototype.toString=function(){return"[StageBinding]"},StageBinding.prototype.onBindingRegister=function(){StageBinding.superclass.onBindingRegister.call(this),StageBinding.bindingInstance=this,StageBoxHandlerAbstraction.onBindingRegister.call(this),this.addActionListener(StageDecksBinding.ACTION_INITIALIZED),this.addActionListener(TabBoxBinding.ACTION_ATTACHED),this.addActionListener(TabBoxBinding.ACTION_SELECTED),this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(StageBinding.ACTION_DECK_LOADED),this.addActionListener(StageDeckBinding.ACTION_LOADED),this.addActionListener(ErrorBinding.ACTION_INITIALIZE),DOMEvents.addEventListener(top,DOMEvents.HASHCHANGE,this),this.subscribe(BroadcastMessages.VIEW_CLOSED),this.subscribe(BroadcastMessages.VIEW_OPENED),this.subscribe(BroadcastMessages.COMPOSITE_START),this.subscribe(BroadcastMessages.COMPOSITE_STOP),this.subscribe(BroadcastMessages.DOCK_MAXIMIZED),this.subscribe(BroadcastMessages.DOCK_NORMALIZED),app.bindingMap.explorer.addActionListener(ExplorerBinding.ACTION_INITIALIZED,this),app.bindingMap.explorer.addActionListener(ExplorerMenuBinding.ACTION_SELECTIONCHANGED,this),this._initializeUsergroup();var a=System.getRootNode();this._initializeRootActions(a),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,{handleBroadcast:function(b,c){c==a.getEntityToken()&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL)}});var b=System.getPerspectiveNodes();b.hasEntries()?this._initializeSystemViewDefinitions(b):(top.app.bindingMap.stagecontainer.hide(),top.app.bindingMap.app.attachClassName(StageBinding.CLASSNAME_EMPTY),this._onStageReady(),Dialog.message(StringBundle.getString("ui","Website.Dialogs.NoAccessTitle"),StringBundle.getString("ui","Website.Dialogs.NoAccessText")))},StageBinding.prototype._renameThisMethod=function(){if(LocalStore.isInitialized)this._initializeWorkbenchLayout();else{var a=this;EventBroadcaster.subscribe(BroadcastMessages.LOCALSTORE_INITIALIZED,{handleBroadcast:function(){a._initializeWorkbenchLayout()}})}},StageBinding.prototype._initializeWorkbenchLayout=function(){if(this._explorerBinding){var a=null;LocalStore.isEnabled&&(a=LocalStore.getProperty(LocalStore.SELECTED_PERSPECTIVE_HANDLE)),a&&ViewDefinitions[a]?(alert("StageBinding#_initializeWorkbenchLayout !!!!"),this._explorerBinding.setSelectionByHandle(unescape(a))):this._explorerBinding.setSelectionDefault()}else this._onStageReady()},StageBinding.prototype._onStageReady=function(){this._isStageReady||(top.app.bindingMap.maindecks&&(top.app.bindingMap.maindecks.select("stagedeck"),Application.hasStartPage&&KickStart.justLogged&&!Client.isPad?EventBroadcaster.broadcast(BroadcastMessages.START_COMPOSITE):ViewBinding.hasInstance("Composite.Management.Start")&&ViewBinding.getInstance("Composite.Management.Start").hide()),EventBroadcaster.broadcast(BroadcastMessages.STAGE_INITIALIZED),this._isStageReady=!0)},StageBinding.prototype._initializeUsergroup=function(a){LoginService.GetUserDisplayName(!0,function(a){top.app.bindingMap.usermenu.setLabel(a)})},StageBinding.prototype._initializeRootActions=function(a){var b=a.getActionProfile();if(b&&b.hasEntries()){var c=top.app.bindingMap.toolsmenugroup,d=new Map;c&&(b.each(function(a,b){b.each(function(a){var b=MenuItemBinding.newInstance(c.bindingDocument);b.setLabel(a.getLabel()),b.setToolTip(a.getToolTip()),b.setImage(a.getImage()),b.setDisabled(a.isDisabled()),b.associatedSystemAction=a;var e=c,f=a.getTag();if(null!=f)switch(f){case SystemAction.TAG_CHANGEFROMLANGUAGE:e=top.app.bindingMap.translationsmenugroup;case SystemAction.TAG_USER:e=top.app.bindingMap.usermenugroup}var g=a.getBundleName();if(g){if(!d.has(g)){var h=MenuItemBinding.newInstance(c.bindingDocument);h.setLabel(g),h.setImage(a.getImage()),e.add(h);var i=MenuPopupBinding.newInstance(c.bindingDocument),j=i.add(MenuBodyBinding.newInstance(c.bindingDocument)),k=j.add(MenuGroupBinding.newInstance(c.bindingDocument));h.add(i),d.set(g,k)}e=d.get(g)}e.add(b)})}),c.attachRecursive())}},StageBinding.prototype._initializeSystemViewDefinitions=function(a){for(;a.hasNext();){var b=a.getNext(),c=b.getHandle();ViewDefinitions[c]=new SystemViewDefinition(b)}},StageBinding.prototype.handleAction=function(a){StageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case StageDecksBinding.ACTION_INITIALIZED:Application.isOperational||ProgressBarBinding.notch(4),this._decksBinding=b,this._inflateBinding(b),a.consume();break;case ExplorerBinding.ACTION_INITIALIZED:Application.isOperational||ProgressBarBinding.notch(4),this._explorerBinding=b,this._inflateBinding(b),a.consume();break;case ExplorerMenuBinding.ACTION_SELECTIONCHANGED:Application.isOperational||ProgressBarBinding.notch(5),this.handlePerspectiveChange(app.bindingMap.explorermenu);var c=app.bindingMap.explorermenu.getSelectionTag();EventBroadcaster.broadcast(BroadcastMessages.PERSPECTIVE_CHANGED,c),a.consume();break;case TabBoxBinding.ACTION_ATTACHED:if(b instanceof DockBinding){switch(b.reference){case DockBinding.START:case DockBinding.ABSBOTTOMLEFT:case DockBinding.ABSBOTTOMRIGHT:case DockBinding.ABSRIGHTTOP:case DockBinding.ABSRIGHTBOTTOM:this._dockBindings.set(b.reference,b)}this.handleAttachedDock(b),a.consume()}break;case TabBoxBinding.ACTION_SELECTED:b instanceof DockBinding&&(this.handleSelectedDockTab(b.getSelectedTabBinding()),a.consume());break;case WindowBinding.ACTION_LOADED:break;case StageBinding.ACTION_DECK_LOADED:this._isExplorerReady=!0,1==this._isDecksReady&&(this._isStageReady||(ProgressBarBinding.notch(3),this._onStageReady()));break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:if(!this._isFlexAbort&&Application.isOperational){this._isFlexAbort=!0,this.reflex(!0);var d=this;setTimeout(function(){1==Client.isMozilla&&d.reflex(!0),d._isFlexAbort=!1},0)}a.consume();break;case StageDeckBinding.ACTION_LOADED:this._isDecksReady=!0,1==this._isExplorerReady&&(this._isStageReady||this._onStageReady());var e=a.target;this._activeViewDefinitions["Composite.Management.Browser"]=e.definition;var f=ViewDefinitions["Composite.Management.Browser"];f.image=e.definition.image,f.label=e.definition.label,f.toolTip=e.definition.toolTip,f.argument.SystemViewDefinition=e.definition,f.argument.URL=null,f.argument.image=e.definition.image,f.argument.label=e.definition.label,f.argument.toolTip=e.definition.toolTip,e._browserTab=e._dockBindings.get("main").prepareNewView(f),e._browserTab.isExplorerTab=!0;break;case ErrorBinding.ACTION_INITIALIZE:a.consume()}StageBoxHandlerAbstraction.handleAction.call(this,a)},StageBinding.prototype.handleBroadcast=function(a,b){switch(StageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.VIEW_OPENED:Application.unlock(this);break;case BroadcastMessages.VIEW_CLOSED:var c=b;this._dontView(c);break;case BroadcastMessages.COMPOSITE_START:this._showStart(!0);break;case BroadcastMessages.COMPOSITE_STOP:this._showStart(!1);break;case BroadcastMessages.DOCK_MAXIMIZED:this._stabilizeExplorer(),this._isShowingStart&&EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE);break;case BroadcastMessages.DOCK_NORMALIZED:this._stabilizeExplorer()}},StageBinding.prototype.handleEvent=function(a){switch(StageBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.HASHCHANGE:this.handleHash(a.target),a.preventDefault()}},StageBinding.prototype.handleHash=function(a){if(a&&a.location&&a.location.hash){var b=a.location.hash.replace(/^#/,"");b&&(a.location.hash="",MessageQueue.placeConsoleCommand(decodeURIComponent(b)),MessageQueue.update(),EventBroadcaster.broadcast(BroadcastMessages.COMPOSITE_STOP))}},StageBinding.prototype._stabilizeExplorer=function(){if(1==Client.isExplorer){var a=this;1==Client.isExplorer&&setTimeout(function(){a.reflex(!0)},0)}},StageBinding.prototype._showStart=function(a){if(a!=this._isShowingStart){var b=ViewBinding.getInstance("Composite.Management.Start"),c=this._dockBindings.get(DockBinding.START);a?b.show():(b.hide(),null!=c&&c.isActive&&c.deActivate()),this._isShowingStart=a}},StageBinding.prototype._inflateBinding=function(a){for(var b in ViewDefinitions){var c=ViewDefinitions[b];c instanceof SystemViewDefinition&&a.mountDefinition(c)}var d=null!=this._decksBinding&&null!=this._explorerBinding;if(d){var e=this;setTimeout(function(){e._renameThisMethod()},0)}},StageBinding.prototype.iterateContainedStageBoxBindings=function(a){var b=new StageCrawler;b.mode=a,b.crawl(this.bindingElement),b.dispose()},StageBinding.prototype.handlePerspectiveChange=function(a){var b=a.getSelectionHandle();this._decksBinding.setSelectionByHandle(b),LocalStore.isEnabled&&LocalStore.setProperty(LocalStore.SELECTED_PERSPECTIVE_HANDLE,escape(b))},StageBinding.prototype.handleAttachedDock=function(a){var b=a.getTabBindings();if(b.hasEntries())for(;b.hasNext();){var c=b.getNext(),d=c.getHandle();if(d){var e=ViewDefinitions[d];e?this._view(a,c,e,!1):alert("StageBinding: no such predefined viewdefinition ("+d+")")}}},StageBinding.prototype._presentViewDefinition=function(a){var b=null,c=!1;switch(a.position){case Dialog.MODAL:b=app.bindingMap.masterdialogset.getModalInstance();break;case Dialog.NON_MODAL:b=app.bindingMap.masterdialogset.getInstance();break;default:if(this._dockBindings.hasEntries())switch(a.position){case DockBinding.ABSBOTTOMLEFT:case DockBinding.ABSBOTTOMRIGHT:case DockBinding.ABSRIGHTTOP:case DockBinding.ABSRIGHTBOTTOM:b=this._dockBindings.get(a.position);break;case DockBinding.EXTERNAL:window.open(a.url),c=!0;break;case DockBinding.SLIDE:var d=this._decksBinding.getSelectedDeckBinding(),e=d.getDockBindingByReference(DockBinding.MAIN),f=e.getSelectedTabPanelBinding(),g=SlideInViewBinding.newInstance(f.viewBinding.getContentDocument());g.setDefinition(a),g.attach(),g.snapToBinding(f.viewBinding.getRootBinding()),c=!0;break;default:var d=this._decksBinding.getSelectedDeckBinding();b=d.getDockBindingByReference(a.position),this._isShowingStart&&EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE)}else c=!0}if(!c){if(null==b)throw"StageBinding: Could not position view: "+a.handle;this._view(b,null,a,!0)}},StageBinding.prototype._view=function(a,b,c,d){var e=c.handle;if(c.isMutable&&(e+=KeyMaster.getUniqueKey()),this._activeViewDefinitions[e]){var f=ViewBinding.getInstance(e);null!=f?(a._selectTabByView(f),f.update()):this.logger.error("Could not update ViewBinding (declared open): \n"+e)}else switch(this._activeViewDefinitions[e]=c,Application.lock(this),a.constructor){case DockBinding:d?a.prepareNewView(c):a.prepareOpenView(c,b);break;case StageDialogBinding:d&&a.prepareNewView(c)}},StageBinding.prototype._dontView=function(a){null!=this._activeViewDefinitions[a]?delete this._activeViewDefinitions[a]:this.logger.debug("Could not unregister active view: "+a)},StageBinding.prototype.selectBrowserTab=function(){var a=this._decksBinding.getSelectedDeckBinding(),b=a.getBrowserTab();if(b&&!b.isSelected){var c=a.getSystemTree();null!=c&&c.setHandleToken(null),b.containingTabBoxBinding.select(b,!0)}},StageBinding.prototype.handleSelectedDockTab=function(a){},StageCrawler.prototype=new BindingCrawler,StageCrawler.prototype.constructor=StageCrawler,StageCrawler.superclass=BindingCrawler.prototype,StageCrawler.ID="stagecrawler",StageCrawler.MODE_MAXIMIZE="maximize",StageCrawler.MODE_UNMAXIMIZE="minimize",StageCrawler.prototype._construct=function(){StageCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b){var c=UserInterface.getBinding(b),d=null;if(c)switch(c.constructor){case StageSplitBoxBinding:case StageSplitPanelBinding:case StageSplitterBinding:switch(a.mode){case StageCrawler.MODE_MAXIMIZE:c.handleMaximization();break;case StageCrawler.MODE_UNMAXIMIZE:c.handleUnMaximization()}break;case DockBinding:d=NodeCrawler.SKIP_NODE}return d})},StageDialogSetBinding.prototype=new DialogSetBinding,StageDialogSetBinding.prototype.constructor=StageDialogSetBinding,StageDialogSetBinding.superclass=DialogSetBinding.prototype,StageDialogSetBinding.prototype.toString=function(){return"[StageDialogSetBinding]"},StageDialogSetBinding.prototype.getInstance=function(){var a=null;return this._dialogs.each(function(b){return b.isVisible||(a=b),null!=a}),a||(this._newInstance(),a=this._dialogs.getLast()),a.setModal(!1),a},StageDialogSetBinding.prototype.getModalInstance=function(){var a=this.getInstance();return a.setModal(!0),a},StageDialogSetBinding.prototype._newInstance=function(){var a=this.add(StageDialogBinding.newInstance(this.bindingDocument));this._dialogs.add(a),a.attach()},StageDialogBinding.prototype=new DialogBinding,StageDialogBinding.prototype.constructor=StageDialogBinding,StageDialogBinding.superclass=DialogBinding.prototype,StageDialogBinding.prototype.toString=function(){return"[StageDialogBinding]"},StageDialogBinding.prototype.onBindingRegister=function(){StageDialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(PageBinding.ACTION_DETACHED),this.addActionListener(DialogPageBinding.ACTION_RESPONSE),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(ViewBinding.ACTION_LOADED),this.addActionListener(ViewBinding.ACTION_ONCLOSE),this.addActionListener(ViewBinding.ACTION_CLOSED),this.addActionListener(ErrorBinding.ACTION_INITIALIZE),this.addActionListener(PageBinding.ACTION_UPDATING),this.addActionListener(PageBinding.ACTION_UPDATED),this.addActionListener(DialogBinding.ACTION_CLOSE),this.subscribe(BroadcastMessages.KEY_ESCAPE)},StageDialogBinding.prototype.onBindingAttach=function(){StageDialogBinding.superclass.onBindingAttach.call(this),this.defaultSetup()},StageDialogBinding.prototype.prepareNewView=function(a){if(a instanceof DialogViewDefinition){var b=ViewBinding.newInstance(this.bindingDocument);if(b.setDefinition(a),b.setType(ViewBinding.TYPE_DIALOGVIEW),a.handler){if(!Interfaces.isImplemented(IDialogResponseHandler,a.handler))throw"IDialogResponseHandler not implemented";this._dialogResponseHandler=a.handler}this._viewBinding=b,this._body.add(b),b.attach(),b.initialize()}},StageDialogBinding.prototype.handleAction=function(a){StageDialogBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case PageBinding.ACTION_INITIALIZED:this._handleInitializedPageBinding(b),a.consume();break;case PageBinding.ACTION_DETACHED:b.bindingDocument==this._viewBinding.getContentDocument()&&(this._pageBinding=null),a.consume();break;case DialogPageBinding.ACTION_RESPONSE:b.response&&this._handleDialogPageResponse(b),a.consume();break;case Binding.ACTION_INVALID:this._disableDialogAcceptButton(!0),a.consume();break;case Binding.ACTION_VALID:this._disableDialogAcceptButton(!1),a.consume();break;case ViewBinding.ACTION_ONCLOSE:this.close(),a.consume();break;case ViewBinding.ACTION_CLOSED:this._isFirstPage=!0,a.consume();break;case ErrorBinding.ACTION_INITIALIZE:a.consume();break;case PageBinding.ACTION_UPDATING:this._isUpdating=!0,a.consume();break;case PageBinding.ACTION_UPDATED:this._isUpdating&&(this._isUpdating=!1,this._fit()),a.consume();break;case Binding.ACTION_UPDATED:this._isUpdating||this._fit(),a.consume();break;case DialogBinding.ACTION_CLOSE:b==this&&(this._viewBinding.dispose(),this.defaultSetup())}},StageDialogBinding.prototype.handleBroadcast=function(a,b){switch(StageDialogBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ESCAPE:1==this.isVisible&&(PopupBinding.hasActiveInstances()||this._defaultClose())}},StageDialogBinding.prototype._fit=function(a){var b=new FitnessCrawler,c=new List;a&&(b.mode=FitnessCrawler.MODE_BRUTAL),b.crawl(this.bindingElement,c),b.dispose(),c.hasEntries()&&(c.reverse(),c.each(function(b){b.fit(a)}),c.dispose(),this._fitMe())},StageDialogBinding.prototype._fitMe=function(){if(null!=this._pageBinding){this._pageBinding.enableAutoHeightLayoutMode(!0),this._fixAutoHeight(this._pageBinding),this._pageBinding.enableAutoHeightLayoutMode(!1);var a=this.getDimension().h;this.reflex(!0);var b=this;if(this.getDimension().h==a){var b=this;setTimeout(function(){b.reflex(!0)},0)}}},StageDialogBinding.prototype._handleContextMenuItemBinding=function(a){var b=a.getProperty("cmd");switch(b){case DialogTitleBarPopupBinding.CMD_CLOSE:this._defaultClose();break;case DialogTitleBarPopupBinding.CMD_REFRESH:this._titlebar.setLabel(DockTabBinding.LABEL_TABLOADING),this._titlebar.setImage(DockTabBinding.IMG_TABLOADING),this._pageBinding=null,this._viewBinding.reload(Application.isDeveloperMode);break;case DialogTitleBarPopupBinding.CMD_VIEWSOURCE:case DialogTitleBarPopupBinding.CMD_VIEWGENERATED:case DialogTitleBarPopupBinding.CMD_VIEWSERIALIZED:this._viewSource(b);break;default:alert("TODO!")}},StageDialogBinding.prototype._viewSource=DockTabBinding.prototype._viewSource,StageDialogBinding.prototype._handleInitializedPageBinding=function(a){a.bindingDocument==this._viewBinding.getContentDocument()?(a instanceof DialogPageBinding&&(null==this._pageBinding&&this._parsePageBinding(a),this._pageBinding=a,"auto"==a.height&&(a.enableAutoHeightLayoutMode(!0),
this._fixAutoHeight(a),a.enableAutoHeightLayoutMode(!1),this.reflex(!0))),StatusBar.state==StatusBar.BUSY&&StatusBar.clear(),this._isFirstPage&&(EventBroadcaster.broadcast(BroadcastMessages.VIEW_COMPLETED,this._viewBinding.getHandle()),EventBroadcaster.broadcast(BroadcastMessages.STAGEDIALOG_OPENED))):a.isDialogSubPage&&(this._pageBinding.enableAutoHeightLayoutMode(!0),this._fixAutoHeight(a),this._pageBinding.enableAutoHeightLayoutMode(!1),this._fit(!0),this.reflex(!0)),this._isFirstPage=!1},StageDialogBinding.prototype._disableDialogAcceptButton=function(a){var b=this._viewBinding.getContentDocument().getElementById("dialogacceptbutton");if(b){var c=UserInterface.getBinding(b);c.setDisabled(a)}},StageDialogBinding.prototype._handleDialogPageResponse=function(a){null!=this._dialogResponseHandler&&this._dialogResponseHandler.handleDialogResponse(a.response,null!=a.result?a.result:null);var b=this;setTimeout(function(){b.close()},0)},StageDialogBinding.prototype.handleInvokedControl=function(a){a.controlType==ControlBinding.TYPE_CLOSE&&this._defaultClose(),StageDialogBinding.superclass.handleInvokedControl.call(this,a)},StageDialogBinding.prototype.buildDescendantBindings=function(){StageDialogBinding.superclass.buildDescendantBindings.call(this),this._titlebar.setContextMenu(app.bindingMap.dialogtitlebarpopup);var a=this;this._titlebar.handleAction=function(b){switch(b.type){case MenuItemBinding.ACTION_COMMAND:b.listener==this.contextMenuBinding&&a._handleContextMenuItemBinding(b.target)}}},StageDialogBinding.prototype._parsePageBinding=function(a){var b=a.label,c=a.image,d=a.width,e=a.height,f=a.controls,g=a.isResizable;if(b&&this.setLabel(b),c&&this.setImage(c),d||e){var h=this.getDimension(),i=new Dimension;this._isFirstPage?i.w=d?d:h.w:i.w=h.w,i.h=null!=e&&"auto"!=e?e:h.h,this._isResizable&&(i.h=top.window.innerHeight<i.h?top.window.innerHeight:i.h,i.w=top.window.innerWidth<i.w?top.window.innerWidth:i.w),this.setDimension(i)}if(f){this.controlBindings[ControlBinding.TYPE_MAXIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_MINIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_CLOSE].hide();for(var j,k=new List(f.split(" "));null!=(j=k.getNext());)this.controlBindings[j].show()}g!=this._isResizable&&this.setResizable(g),"auto"==e&&this._fixAutoHeight(a),a==this._pageBinding&&this.centerOnScreen(),this.isOpen||(this.reflex(!0),this.open(!0))},StageDialogBinding.prototype._fixAutoHeight=function(a){var b=this.getDimension(),c=0,d=0;a.isDialogSubPage&&(a=this._pageBinding),c=this._isFirstPage&&null!=a.width?a.width:b.w,d=a.bindingElement.offsetHeight,d+=this._titlebar.bindingElement.offsetHeight;var e=CSSComputer.getPadding(this.bindingElement),f=CSSComputer.getBorder(this.bindingElement);d+=e.top+e.bottom,d+=f.top+f.bottom,null!=a.minheight&&d<a.minheight&&(d=a.minheight),d=top.window.innerHeight<d?top.window.innerHeight:d,this.setDimension(new Dimension(c,d)),this.startPoint=this.getPosition(),this._setComputedPosition(new Point(0,0))},StageDialogBinding.prototype._defaultClose=function(){null!=this._dialogResponseHandler&&this._dialogResponseHandler.handleDialogResponse(Dialog.RESPONSE_CANCEL),this.close()},StageDialogBinding.prototype.open=function(){StageDialogBinding.superclass.open.call(this),1==this.isVisible&&this._viewBinding.onActivate()},StageDialogBinding.prototype.defaultSetup=function(){this.setImage(LabelBinding.DEFAULT_IMAGE),this.setLabel(""),this.setDimension(new Dimension(DialogBinding.DEFAULT_WIDTH,DialogBinding.DEFAULT_HEIGHT)),this.controlBindings[ControlBinding.TYPE_MAXIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_MINIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_CLOSE].show(),this._pageBinding=null,this._dialogResponseHandler=null,this._isResizable||this.setResizable(!0)},StageDialogBinding.prototype.setPosition=function(a){StageDialogBinding.superclass.setPosition.call(this,a),this._body.dispatchAction(Binding.ACTION_POSITIONCHANGED)},StageDialogBinding.prototype.setDimension=function(a){StageDialogBinding.superclass.setDimension.call(this,a),this._body.dispatchAction(Binding.ACTION_DIMENSIONCHANGED)},StageDialogBinding.prototype.activate=function(){this.isActive||(StageDialogBinding.superclass.activate.call(this),this._viewBinding.onActivate())},StageDialogBinding.prototype.deActivate=function(){1==this.isActive&&(StageDialogBinding.superclass.deActivate.call(this),this._viewBinding.onDeactivate())},StageDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialog",a),c=UserInterface.registerBinding(b,StageDialogBinding);return c.setProperty("controls","minimize maximize close"),c},StageDecksBinding.prototype=new DecksBinding,StageDecksBinding.prototype.constructor=StageDecksBinding,StageDecksBinding.superclass=DecksBinding.prototype,StageDecksBinding.NODENAME_DECK="stagedeck",StageDecksBinding.ACTION_INITIALIZED="stagedecks initialized",StageDecksBinding.prototype.toString=function(){return"[StageDecksBinding]"},StageDecksBinding.prototype.onBindingInitialize=function(){StageDecksBinding.superclass.onBindingInitialize.call(this),this.dispatchAction(StageDecksBinding.ACTION_INITIALIZED)},StageDecksBinding.prototype.mountDefinition=function(a){var b=StageDeckBinding.newInstance(this.bindingDocument);b.handle=a.handle,b.perspectiveNode=a.node,b.definition=a,Application.isTestEnvironment&&b.setProperty("data-qa","perspective"+a.label),this._decks[b.handle]=b,this.add(b),b.attach()},StageDecksBinding.prototype.setSelectionByHandle=function(a){var b=this._decks[a];StageBinding.perspectiveNode=b.perspectiveNode,this.select(b)},StageDeckBinding.prototype=new DeckBinding,StageDeckBinding.prototype.constructor=StageDeckBinding,StageDeckBinding.superclass=DeckBinding.prototype,StageDeckBinding.ACTION_LOADED="stagedeck loaded",StageDeckBinding.NODENAME_DECKS="stagedecks",StageDeckBinding.DEFAULT_URL="${root}/content/misc/stage/stagedeck.aspx",StageDeckBinding.CLASSNAME_TOOLS_OPEN="toolsopen",StageDeckBinding.prototype.toString=function(){return"[StageDeckBinding]"},StageDeckBinding.prototype.onBindingRegister=function(){StageDeckBinding.superclass.onBindingRegister.call(this),StageBoxHandlerAbstraction.onBindingRegister.call(this),this._dockBindings=new Map,this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(TabBoxBinding.ACTION_ATTACHED),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL)},StageDeckBinding.prototype.handleAction=function(a){StageDeckBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case WindowBinding.ACTION_LOADED:b==this.windowBinding&&(top.app.bindingMap.stagedeckscover.hide(),this.removeActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(StageSplitBoxBinding.ACTION_DOCK_EMPTIED),this.addActionListener(StageSplitBoxBinding.ACTION_DOCK_OPENED),this.dispatchAction(StageDeckBinding.ACTION_LOADED),a.consume());break;case TabBoxBinding.ACTION_ATTACHED:b instanceof DockBinding&&(this._dockBindings.set(b.reference,b),b.perspectiveNode=this.perspectiveNode);break;case StageSplitBoxBinding.ACTION_DOCK_OPENED:this._dockBindingCount++,a.consume();break;case StageSplitBoxBinding.ACTION_DOCK_EMPTIED:this._dockBindingCount--,a.consume()}StageBoxHandlerAbstraction.handleAction.call(this,a),StageDeckBinding.superclass.handleAction.call(this,a)},StageDeckBinding.prototype.iterateContainedStageBoxBindings=function(a){var b=new StageCrawler;b.mode=a,b.crawl(this.windowBinding.getContentDocument().body),b.dispose()},StageDeckBinding.prototype.select=function(){this._isStageDeckBindingInitialized?EventBroadcaster.broadcast(BroadcastMessages.STAGEDECK_CHANGED,this.handle):this.initialize(),StageDeckBinding.superclass.select.call(this),1==this._isRefreshRequired&&(this._refreshTree(),this._isRefreshRequired=!1)},StageDeckBinding.prototype.getDockBindingByReference=function(a){return this._dockBindings.get(a)},StageDeckBinding.prototype.initialize=function(){if(!this._isStageDeckBindingInitialized){top.app.bindingMap.stagedeckscover.show(),this.windowBinding=this.add(WindowBinding.newInstance(this.bindingDocument));var a=StageDeckBinding.DEFAULT_URL+"?handle="+this.handle;this.windowBinding.setURL(a),this.windowBinding.attach(),this._isStageDeckBindingInitialized=!0}},StageDeckBinding.prototype.getBrowserTab=function(){return this._browserTab},StageDeckBinding.prototype.getBrowserPage=function(){return this.getBrowserTab().getAssociatedView().getContentWindow().bindingMap.browserpage},StageDeckBinding.prototype.getSystemTree=function(){var a=null,b=this.getBrowserPage();return b&&(a=b.getSystemTree()),a},StageDeckBinding.prototype.handleBroadcast=function(a,b){switch(StageDeckBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL:1==this.isSelected?this._refreshTree():null!=this.perspectiveNode&&(this._isRefreshRequired=!0);break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHED:this.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED),this.select()}},StageDeckBinding.prototype._refreshTree=function(){this.perspectiveNode&&this.perspectiveNode.getEntityToken&&(this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,this.perspectiveNode.getEntityToken()))},StageDeckBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:stagedeck",a),c=UserInterface.registerBinding(b,StageDeckBinding);return c},StageDeckRootBinding.prototype=new RootBinding,StageDeckRootBinding.prototype.constructor=StageDeckRootBinding,StageDeckRootBinding.superclass=RootBinding.prototype,StageDeckRootBinding.DEFAULT_TEMPLATE="defaultstagedeck.xml",StageDeckRootBinding.prototype.toString=function(){return"[StageDeckRootBinding]"},StageSplitBoxBinding.prototype=new SplitBoxBinding,StageSplitBoxBinding.prototype.constructor=StageSplitBoxBinding,StageSplitBoxBinding.superclass=SplitBoxBinding.prototype,StageSplitBoxBinding.ACTION_HIDE="stagesplitboxbinding hide",StageSplitBoxBinding.ACTION_SHOW="stagesplitboxbinding show",StageSplitBoxBinding.ACTION_DOCK_EMPTIED="stagesplitbox says dock emptied",StageSplitBoxBinding.ACTION_DOCK_OPENED="stagesplitbox says dock opened",StageSplitBoxBinding.prototype.toString=function(){return"[StageSplitBoxBinding]"},StageSplitBoxBinding.prototype.onBindingRegister=function(){StageSplitBoxBinding.superclass.onBindingRegister.call(this),StageBoxAbstraction.onBindingRegister.call(this),this.addActionListener(DockBinding.ACTION_EMPTIED,this),this.addActionListener(DockBinding.ACTION_OPENED,this),this.addActionListener(StageSplitBoxBinding.ACTION_SHOW,this),this.addActionListener(StageSplitBoxBinding.ACTION_HIDE,this)},StageSplitBoxBinding.prototype.handleAction=function(a){StageSplitBoxBinding.superclass.handleAction.call(this,a),StageBoxAbstraction.handleAction.call(this,a);var b=a.target,c=null,d=null;switch(a.type){case DockBinding.ACTION_EMPTIED:d=this.getChildBindingByLocalName("splitter"),d.isVisible&&d.hide(),c=this.getDescendantBindingsByLocalName("dock"),c.getFirst().isEmpty&&c.getLast().isEmpty?c.getFirst().type!=DockBinding.TYPE_EDITORS&&(this.dispatchAction(StageSplitBoxBinding.ACTION_HIDE),this.hide()):(this.flex(),this.invokeLayout()),this.dispatchAction(StageSplitBoxBinding.ACTION_DOCK_EMPTIED),a.consume();break;case DockBinding.ACTION_OPENED:c=this.getDescendantBindingsByLocalName("dock"),c.getFirst().isEmpty||c.getLast().isEmpty||(d=this.getChildBindingByLocalName("splitter"),d.isVisible||d.show()),this.isVisible||(this.show(),this.dispatchAction(StageSplitBoxBinding.ACTION_SHOW)),this.flex(),this.invokeLayout(),this.dispatchAction(StageSplitBoxBinding.ACTION_DOCK_OPENED),a.consume();break;case StageSplitBoxBinding.ACTION_HIDE:b!=this&&(d=this.getChildBindingByLocalName("splitter"),d.isVisible&&d.hide(),this.invokeLayout(),a.consume());break;case StageSplitBoxBinding.ACTION_SHOW:if(b!=this){var e=this.getChildBindingsByLocalName("splitpanel");e.getFirst().isVisible&&e.getLast().isVisible&&(d=this.getChildBindingByLocalName("splitter"),d.isVisible||d.show()),this.invokeLayout(),a.consume()}}},StageSplitBoxBinding.prototype.handleMaximization=function(){StageBoxAbstraction.handleMaximization.call(this)},StageSplitBoxBinding.prototype.handleUnMaximization=function(){StageBoxAbstraction.handleUnMaximization.call(this)},StageSplitBoxBinding.prototype.flex=function(){null==this.isMaximizedForReal&&StageSplitBoxBinding.superclass.flex.call(this)},StageSplitBoxBinding.prototype.handleCrawler=function(a){switch(StageSplitBoxBinding.superclass.handleCrawler.call(this,a),a.id){case FlexBoxCrawler.ID:0==this.isMaximizedForReal&&(a.response=NodeCrawler.SKIP_CHILDREN)}},StageSplitBoxBinding.prototype.hasBothPanelsVisible=function(){var a=this.getChildBindingsByLocalName("splitpanel");return a.getFirst().isVisible&&a.getLast().isVisible},StageSplitBoxBinding.prototype.hasBothPanelsFixed=function(){var a=this.getChildBindingsByLocalName("splitpanel");return a.getFirst().isFixed&&a.getLast().isFixed},StageSplitPanelBinding.prototype=new SplitPanelBinding,StageSplitPanelBinding.prototype.constructor=StageSplitPanelBinding,StageSplitPanelBinding.superclass=SplitPanelBinding.prototype,StageSplitPanelBinding.ACTION_LAYOUTUPDATE="stagesplitpanel layout changed",StageSplitPanelBinding.prototype.toString=function(){return"[StageSplitPanelBinding]"},StageSplitPanelBinding.prototype.onBindingRegister=function(){StageSplitPanelBinding.superclass.onBindingRegister.call(this),StageBoxAbstraction.onBindingRegister.call(this),this.addActionListener(DockBinding.ACTION_OPENED,this),this.addActionListener(DockBinding.ACTION_EMPTIED,this),this.addActionListener(StageSplitBoxBinding.ACTION_HIDE,this),this.addActionListener(StageSplitBoxBinding.ACTION_SHOW,this),this.addActionListener(StageSplitPanelBinding.ACTION_LAYOUTUPDATE,this)},StageSplitPanelBinding.prototype.handleAction=function(a){switch(StageSplitPanelBinding.superclass.handleAction.call(this,a),StageBoxAbstraction.handleAction.call(this,a),a.type){case DockBinding.ACTION_EMPTIED:case StageSplitBoxBinding.ACTION_HIDE:1==this.isMaximized&&this.normalize();var b=this.getContainedDock();if(b&&b.type==DockBinding.TYPE_EDITORS?(this._invisibilize(!0),a.type==StageSplitBoxBinding.ACTION_HIDE&&a.consume()):(this.hide(),1==this.isFixed&&this.setFix(!1)),a.type==DockBinding.ACTION_EMPTIED){var c=this;setTimeout(function(){c.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE)},0)}break;case DockBinding.ACTION_OPENED:case StageSplitBoxBinding.ACTION_SHOW:var b=this.getContainedDock();b&&b.type==DockBinding.TYPE_EDITORS?(this._invisibilize(!1),a.type==StageSplitBoxBinding.ACTION_SHOW&&a.consume()):(this.show(),1==this.isFixed&&this.setFix(!1));break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:var d=a.target;if(d!=this&&d.getContainedDock()&&this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_VERTICAL){var e=d._containingSplitBoxBinding;if(e.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL){var f=e.getChildBindingsByLocalName("splitpanel"),g=f.getFirst(),h=f.getLast();1==this.isFixed?(!g.isFixed||!h.isFixed||!e.hasBothPanelsVisible()&&d.isMinimizedForReal)&&(this.setFix(!1),a.consume(),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE)):(e.hasBothPanelsFixed()||!e.hasBothPanelsVisible()&&d.isMinimizedForReal)&&(this.setFix(d.getContainedDock().getHeight()),a.consume(),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE))}}}},StageSplitPanelBinding.prototype.handleMaximization=function(){StageBoxAbstraction.handleMaximization.call(this);var a=this.getContainedDock();a&&(1==this.isMaximizePrepared||a.interceptDisplayChange(!1))},StageSplitPanelBinding.prototype.handleUnMaximization=function(){StageBoxAbstraction.handleUnMaximization.call(this);var a=this.getContainedDock();a&&(a.type==DockBinding.TYPE_EDITORS&&a.isEmpty&&this._invisibilize(!0),1==this.isMaximized?this.normalize():a.interceptDisplayChange(!0))},StageSplitPanelBinding.prototype.maximize=function(){1==this.isMinimized&&this.normalize(!0),StageSplitPanelBinding.superclass.maximize.call(this),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE);var a=this.getContainedDock();a&&(a.activate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_MAXIMIZED,a))},StageSplitPanelBinding.prototype.minimize=function(){var a=this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL,b=this.getContainedDock();b&&(b.collapse(a),a?this.setFix(b.getWidth()):this.setFix(b.getHeight())),1==this.isMaximized&&this.normalize(!0),StageSplitPanelBinding.superclass.minimize.call(this),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE),b&&b.isActive&&(b.deActivate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_MINIMIZED,b))},StageSplitPanelBinding.prototype.normalize=function(a){var b=this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL,c=this.getContainedDock();c&&1==this.isMinimized&&(c.unCollapse(b),this.setFix(!1)),StageSplitPanelBinding.superclass.normalize.call(this),a||(this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE),c&&(c.activate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_NORMALIZED,c)))},StageSplitPanelBinding.prototype.getContainedDock=function(){return this.getChildBindingByLocalName("dock")},StageSplitPanelBinding.prototype.invisibilize=function(a){var b=!0,c=this.getContainedDock();null!=c&&c.type==DockBinding.TYPE_EDITORS&&1==c.isEmpty&&(b=!1),1==b&&this._invisibilize(a)},StageSplitPanelBinding.prototype._invisibilize=function(a){a!=this._isInvisibilized&&(a?this.bindingElement.style.visibility="hidden":this.bindingElement.style.visibility="visible",this._isInvisibilized=!this._isInvisibilized)},StageSplitterBinding.prototype=new SplitterBinding,StageSplitterBinding.prototype.constructor=StageSplitterBinding,StageSplitterBinding.superclass=SplitterBinding.prototype,StageSplitterBinding.prototype.toString=function(){return"[StageSplitterBinding]"},StageSplitterBinding.prototype.handleMaximization=function(){this._wasHidden=!this.isVisible,this.bindingElement.style.display="none"},StageSplitterBinding.prototype.handleUnMaximization=function(){this._wasHidden||(this.bindingElement.style.display="block",this._wasHidden=null)},StageSplitterBinding.prototype.onDragStart=function(a){var b=top.app.bindingMap.stagesplittercover,c=this._containingSplitBoxBinding.getOrient();switch(c){case SplitBoxBinding.ORIENT_HORIZONTAL:b.bindingElement.style.cursor="e-resize";break;case SplitBoxBinding.ORIENT_VERTICAL:b.bindingElement.style.cursor="n-resize"}b.show();var d=top.app.bindingMap.stagesplitterbody;d.setPosition(this.getPosition()),d.setDimension(this.getDimension()),d.setOrient(c),d.show(),this.isDragging=!0},StageSplitterBinding.prototype.onDrag=function(a){this._updateSplitterBodyPosition(this.getEvaluatedDiff(a))},StageSplitterBinding.prototype.onDragStop=function(a){this._updateSplitterBodyPosition(this.getEvaluatedDiff(a)),top.app.bindingMap.stagesplitterbody.hide(),top.app.bindingMap.stagesplittercover.hide(),this.isDragging=!1,this.offset=this._containingSplitBoxBinding.isHorizontalOrient()?a.x:a.y,this.dispatchAction(SplitterBinding.ACTION_DRAGGED)},StageSplitterBinding.prototype._updateSplitterBodyPosition=function(a){var b=this.getPosition();b.x+=a.x,b.y+=a.y,app.bindingMap.stagesplitterbody.setPosition(b)},StageSplitterBinding.prototype.getPosition=function(){return DOMUtil.getUniversalPosition(this.bindingElement)},StageSplitterBinding.prototype.getDimension=function(){return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},StageSplitterBodyBinding.prototype=new Binding,StageSplitterBodyBinding.prototype.constructor=StageSplitterBodyBinding,StageSplitterBodyBinding.superclass=Binding.prototype,StageSplitterBodyBinding.prototype.toString=function(){return"[StageSplitterBodyBinding]"},StageSplitterBodyBinding.prototype.setOrient=function(a){this._orient=a,this.attachClassName(a)},StageSplitterBodyBinding.prototype.setPosition=function(a){var b=!0,c=!0;switch(this._orient){case SplitBoxBinding.ORIENT_HORIZONTAL:c=!1;break;case SplitBoxBinding.ORIENT_VERTICAL:b=!1}b&&(this.bindingElement.style.left=a.x+"px"),c&&(this.bindingElement.style.top=a.y+"px")},StageSplitterBodyBinding.prototype.setDimension=function(a){this.bindingElement.style.width=a.w+"px",this.bindingElement.style.height=a.h+"px"},StageSplitterBodyBinding.prototype.show=function(){this.bindingElement.style.display="block"},StageSplitterBodyBinding.prototype.hide=function(){this.bindingElement.style.display="none",this.detachClassName(SplitBoxBinding.ORIENT_HORIZONTAL),this.detachClassName(SplitBoxBinding.ORIENT_VERTICAL),this._orient=null},StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED="hidden stagebox stuff updated",StageBoxAbstraction.onBindingRegister=function(){this.addActionListener(ControlBoxBinding.ACTION_MAXIMIZE),this.addActionListener(ControlBoxBinding.ACTION_MINIMIZE),this.addActionListener(ControlBoxBinding.ACTION_NORMALIZE),this.addActionListener(TabBoxBinding.ACTION_UPDATED)},StageBoxAbstraction.handleAction=function(a){switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:this.isMaximizePrepared=!0;break;case ControlBoxBinding.ACTION_MINIMIZE:this.isMinimizedForReal=!0;break;case ControlBoxBinding.ACTION_NORMALIZE:this.isMaximizePrepared=!1,this.isMinimizedForReal=null;break;case TabBoxBinding.ACTION_UPDATED:a.target instanceof DockBinding&&(this.isHiddenForReal?this.dispatchAction(StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED):this.isMinimizedForReal&&this.normalize()),a.consume()}},StageBoxAbstraction.handleMaximization=function(){if(1==this.isMaximizePrepared)if(this.isMaximizedForReal=!0,this.isHiddenForReal=!1,this.isFlexible=!1,1==Client.isMozilla){var a=this.bindingElement.style;a.position="absolute",a.width="100%",a.height="100%",a.top="0",a.left="0"}else this.attachClassName("maximized"),this instanceof StageSplitPanelBinding&&StageBoxAbstraction._emulateBasicCSS(this,!0);else this.isMaximizedForReal=!1,this.isHiddenForReal=!0,this instanceof StageSplitPanelBinding&&this.invisibilize(!0)},StageBoxAbstraction.handleUnMaximization=function(){if(1==this.isMaximizedForReal)if(this.isFlexible=!0,1==Client.isMozilla){var a=this.bindingElement.style;a.position="relative",a.width="auto",a.height="auto",a.top="auto",a.left="auto"}else this.detachClassName("maximized"),this instanceof StageSplitPanelBinding&&StageBoxAbstraction._emulateBasicCSS(this,!1);else this instanceof StageSplitPanelBinding&&this.invisibilize(!1);this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isHiddenForReal=null},StageBoxAbstraction._emulateBasicCSS=function(a,b){var c=a.bindingElement.style,d=a.bindingElement.parentNode,e=a._containingSplitBoxBinding;1==Client.isExplorer&&(b?(a._unmodifiedFlexMethod=a.flex,a.flex=function(){c.width=d.offsetWidth+"px",c.height=d.offsetHeight+"px"}):(c.width="100%",c.height="100%",e.isHorizontalOrient()||setTimeout(function(){c.width="auto",c.height="auto",e.reflex(!0)},0),a.flex=a._unmodifiedFlexMethod,a._unmodifiedFlexMethod=null))},StageBoxHandlerAbstraction.onBindingRegister=function(){this.addActionListener(ControlBoxBinding.ACTION_MAXIMIZE,this),this.addActionListener(ControlBoxBinding.ACTION_NORMALIZE,this),this.addActionListener(StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED,this),this.addActionListener(StageSplitPanelBinding.ACTION_LAYOUTUPDATE,this)},StageBoxHandlerAbstraction.handleAction=function(a){var b=a.target;switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:case ControlBoxBinding.ACTION_NORMALIZE:b instanceof StageSplitPanelBinding&&(StageBoxHandlerAbstraction.handleControlBoxAction.call(this,a),a.consume());break;case StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED:this.isSubPanelMaximized&&(this.iterateContainedStageBoxBindings(StageCrawler.MODE_UNMAXIMIZE),this.isSubPanelMaximized=!1),a.consume();break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:}},StageBoxHandlerAbstraction.handleControlBoxAction=function(a){var b=null;switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:this.isSubPanelMaximized||(b=StageCrawler.MODE_MAXIMIZE,this.isSubPanelMaximized=!0);break;case ControlBoxBinding.ACTION_NORMALIZE:this.isSubPanelMaximized&&(b=StageCrawler.MODE_UNMAXIMIZE,this.isSubPanelMaximized=!1)}null!=b&&this.iterateContainedStageBoxBindings(b)},StageMenuBarBinding.prototype=new MenuBarBinding,StageMenuBarBinding.prototype.constructor=StageMenuBarBinding,StageMenuBarBinding.superclass=MenuBarBinding.prototype,StageMenuBarBinding.prototype.toString=function(){return"[StageMenuBarBinding]"},StageMenuBarBinding.prototype.onBindingAttach=function(){if(StageMenuBarBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives)this.addActionListener(MenuItemBinding.ACTION_COMMAND);else{var a=this;setTimeout(function(){for(var b=a.getChildBindingsByLocalName("menu");b.hasNext();){var c=b.getNext();"usermenu"!=c.bindingElement.id&&Binding.prototype.hide.call(c)}},0)}},StageMenuBarBinding.prototype.handleAction=function(a){switch(StageMenuBarBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target.associatedSystemAction;Application.isLoggedIn&&(this._rootNode||(this._rootNode=System.getRootNode()),b&&SystemAction.invoke(b,this._rootNode)),a.consume()}},StageViewMenuItemBinding.prototype=new MenuItemBinding,StageViewMenuItemBinding.prototype.constructor=StageViewMenuItemBinding,StageViewMenuItemBinding.superclass=MenuItemBinding.prototype,StageViewMenuItemBinding.prototype.toString=function(){return"[StageViewMenuItemBinding]"},StageViewMenuItemBinding.prototype.onBindingAttach=function(){StageViewMenuItemBinding.superclass.onBindingAttach.call(this),this.type==MenuItemBinding.TYPE_CHECKBOX&&(this.subscribe(BroadcastMessages.VIEW_OPENED),this.subscribe(BroadcastMessages.VIEW_CLOSED),this.subscribe(BroadcastMessages.STAGE_INITIALIZED))},StageViewMenuItemBinding.prototype.buildDOMContent=function(){StageViewMenuItemBinding.superclass.buildDOMContent.call(this);var a=this.getProperty("handle");if(!a)throw new Error("StageViewMenuItemBinding: missing handle");this._handle=a,StageBinding.isViewOpen(a)&&this.type==MenuItemBinding.TYPE_CHECKBOX&&this.check(!0),this.oncommand=function(){var b=this;Application.lock(b),setTimeout(function(){StageBinding.handleViewPresentation(a),Application.unlock(b)},Client.hasTransitions?Animation.DEFAULT_TIME:0)}},StageViewMenuItemBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},StageViewMenuItemBinding.prototype.handleBroadcast=function(a,b){if(StageViewMenuItemBinding.superclass.handleBroadcast.call(this,a,b),this.type==MenuItemBinding.TYPE_CHECKBOX)switch(a){case BroadcastMessages.STAGE_INITIALIZED:this.isChecked&&this.fireCommand();break;case BroadcastMessages.VIEW_OPENED:b==this._handle&&this.check(!0);break;case BroadcastMessages.VIEW_CLOSED:b==this._handle&&this.uncheck(!0)}},StageViewMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,StageViewMenuItemBinding),UserInterface.getBinding(b)},StageStatusBarBinding.prototype=new ToolBarBinding,StageStatusBarBinding.prototype.constructor=StageStatusBarBinding,StageStatusBarBinding.superclass=ToolBarBinding.prototype,StageStatusBarBinding.prototype.toString=function(){return"[StageStatusBarBinding]"},StageStatusBarBinding.prototype.onBindingInitialize=function(){this._label=this.bindingWindow.bindingMap.statusbarlabel,StatusBar.initialize(this),StageStatusBarBinding.superclass.onBindingInitialize.call(this)},StageStatusBarBinding.prototype.setLabel=function(a){this._label.setLabel(a)},StageStatusBarBinding.prototype.setImage=function(a){this._label.setImage(a)},StageStatusBarBinding.prototype.clear=function(){this._label.setLabel(null),this._label.setImage(!1)},StageStatusBarBinding.prototype.startFadeOut=function(a){this.logger.debug("START FADEOUT")},ExplorerBinding.prototype=new FlexBoxBinding,ExplorerBinding.prototype.constructor=ExplorerBinding,ExplorerBinding.superclass=FlexBoxBinding.prototype,ExplorerBinding.ACTION_INITIALIZED="explorer initialized",ExplorerBinding.PERSPECTIVE_CONTENT="Content",ExplorerBinding.PERSPECTIVE_MEDIA="Media",ExplorerBinding.PERSPECTIVE_DATA="Datas",ExplorerBinding.PERSPECTIVE_DESIGN="Design",ExplorerBinding.PERSPECTIVE_FUNCTIONS="Functions",ExplorerBinding.PERSPECTIVE_USERS="Users",ExplorerBinding.PERSPECTIVE_SYSTEM="System",ExplorerBinding.bindingInstance=null,ExplorerBinding.getFocusedTreeNodeBindings=function(){var a=ExplorerBinding.bindingInstance.getSelectedDeckBinding(),b=a.getSystemTree();if(!b)return new List;var c=b.getFocusedTreeNodeBindings();return!c.hasEntries()&&StageBinding.treeSelector&&(c=StageBinding.treeSelector.getFocusedTreeNodeBindings()),c},ExplorerBinding.saveFocusedNodes=function(){var a=this.getFocusedTreeNodeBindings();LocalStore.focuseNodes.clear(),a.each(function(a){LocalStore.focuseNodes.add(a.node)})},ExplorerBinding.restoreFocuseNodes=function(){var a=LocalStore.focuseNodes.getEntityTokens(),b=ExplorerBinding.bindingInstance.getSelectedDeckBinding(),c=b.getSystemTree();a=new List(TreeService.GetCurrentLocaleEntityTokens(a.toArray())),a.each(function(a){c._focusTreeNodeByEntityToken(a)}),LocalStore.focuseNodes.clear()},ExplorerBinding.prototype.toString=function(){return"[ExplorerBinding]"},ExplorerBinding.prototype.onBindingAttach=function(){ExplorerBinding.superclass.onBindingAttach.call(this),this._menuBinding=this.addMember(this.getDescendantBindingByLocalName("explorermenu"))},ExplorerBinding.prototype.onBindingInitialize=function(){ExplorerBinding.bindingInstance=this,ExplorerBinding.superclass.onBindingInitialize.call(this),this.dispatchAction(ExplorerBinding.ACTION_INITIALIZED),this._menuBinding.updateScroll()},ExplorerBinding.prototype.setSelectionByHandle=function(a){this._menuBinding.setSelectionByHandle(a)},ExplorerBinding.prototype.getSelectionHandle=function(){return this._menuBinding.getSelectionHandle()},ExplorerBinding.prototype.setSelectionDefault=function(){this._menuBinding.setSelectionDefault()},ExplorerBinding.prototype.getPerspectives=function(){return this._menuBinding.getButtons()},ExplorerBinding.prototype.getSelectedDeckBinding=function(){return app.bindingMap.stagedecks.getSelectedDeckBinding()},ExplorerBinding.prototype.mountDefinition=function(a){a instanceof SystemViewDefinition&&this._menuBinding.mountDefinition(a)},ExplorerMenuBinding.prototype=new Binding,ExplorerMenuBinding.prototype.constructor=ExplorerMenuBinding,ExplorerMenuBinding.superclass=Binding.prototype,ExplorerMenuBinding.ACTION_SELECTIONCHANGED="explorermenu selectionchanged",ExplorerMenuBinding.SCROLLUP_CLASSNAME="scrollup",ExplorerMenuBinding.SCROLLDOWN_CLASSNAME="scrolldown",ExplorerMenuBinding.prototype.toString=function(){return"[ExplorerMenuBinding]"},ExplorerMenuBinding.prototype.onBindingRegister=function(){ExplorerMenuBinding.superclass.onBindingRegister.call(this),this.addActionListener(RadioGroupBinding.ACTION_SELECTIONCHANGED,this),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.addEventListener(DOMEvents.SCROLL)},ExplorerMenuBinding.prototype.onBindingAttach=function(){ExplorerMenuBinding.superclass.onBindingAttach.call(this),this.addMember(this.getChildBindingByLocalName("explorertoolbar"))},ExplorerMenuBinding.prototype.onMemberInitialize=function(a){switch(a.constructor){case ExplorerToolBarBinding:this._group=a.getToolBarGroupByIndex(0)}ExplorerMenuBinding.superclass.onMemberInitialize.call(this,a)},ExplorerMenuBinding.prototype.mountDefinition=function(a){this._buttons.set(a.handle,this._mountMinButton(a)),this._index++},ExplorerMenuBinding.prototype.getButtons=function(){return this._buttons},ExplorerMenuBinding.prototype._mountMinButton=function(a){var b=ExplorerToolBarButtonBinding.newInstance(this.bindingDocument,ExplorerToolBarButtonBinding.TYPE_NORMAL);return b.setLabel(a.label),
b.setToolTip(a.label),b.handle=a.handle,b.node=a.node,Application.isTestEnvironment&&b.setProperty("data-qa",a.node.getTag()),this._group.add(b),this._list.add(b),b.attach(),b},ExplorerMenuBinding.prototype.handleAction=function(a){switch(ExplorerMenuBinding.superclass.handleAction.call(this,a),a.type){case RadioGroupBinding.ACTION_SELECTIONCHANGED:this.collapse();var b=a.target,c=b.getCheckedButtonBinding(),d=c.handle;this._selectedHandle=d,this._selectedTag=c.node.getTag(),this.dispatchAction(ExplorerMenuBinding.ACTION_SELECTIONCHANGED),a.consume()}},ExplorerMenuBinding.prototype.handleEvent=function(a){switch(ExplorerMenuBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.SCROLL:this.updateScroll()}},ExplorerMenuBinding.prototype.handleBroadcast=function(a,b){switch(ExplorerMenuBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.collapse(),this.updateScroll()}},ExplorerMenuBinding.prototype.setSelectionByHandle=function(a){var b=this._buttons.get(a);b?b.check():this.setSelectionDefault()},ExplorerMenuBinding.prototype.getSelectionHandle=function(){return this._selectedHandle},ExplorerMenuBinding.prototype.getSelectionTag=function(){return this._selectedTag},ExplorerMenuBinding.prototype.setSelectionDefault=function(){this._list.hasEntries()&&this._list.getFirst().check()},ExplorerMenuBinding.prototype.toggle=function(){top.app.bindingMap.app.hasClassName("exploler-expanded")?this.collapse():this.expand()},ExplorerMenuBinding.prototype.collapse=function(){top.app.bindingMap.app.detachClassName("exploler-expanded"),top.app.bindingMap.menutogglebutton.setImage("${icon:menu}")},ExplorerMenuBinding.prototype.expand=function(){top.app.bindingMap.app.attachClassName("exploler-expanded"),top.app.bindingMap.menutogglebutton.setImage("${icon:arrow-left}")},ExplorerMenuBinding.prototype.updateScroll=function(){var a=this.bindingElement.scrollTop,b=this.bindingElement.scrollHeight,c=this.bindingElement.clientHeight;0===a?ExplorerBinding.bindingInstance.detachClassName(ExplorerMenuBinding.SCROLLUP_CLASSNAME):ExplorerBinding.bindingInstance.attachClassName(ExplorerMenuBinding.SCROLLUP_CLASSNAME),b>a+c?this.attachClassName(ExplorerMenuBinding.SCROLLDOWN_CLASSNAME):this.detachClassName(ExplorerMenuBinding.SCROLLDOWN_CLASSNAME)},ExplorerToolBarBinding.prototype=new ToolBarBinding,ExplorerToolBarBinding.prototype.constructor=ExplorerToolBarBinding,ExplorerToolBarBinding.superclass=ToolBarBinding.prototype,ExplorerToolBarBinding.prototype.toString=function(){return"[ExplorerToolBarBinding]"},ExplorerToolBarBinding.prototype.onBindingRegister=function(){ExplorerToolBarBinding.superclass.onBindingRegister.call(this),this.setImageSize(ToolBarBinding.ICONSIZE_22)},ExplorerToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:explorertoolbar",a);return UserInterface.registerBinding(b,ExplorerToolBarBinding)},ExplorerToolBarButtonBinding.prototype=new ToolBarButtonBinding,ExplorerToolBarButtonBinding.prototype.constructor=ExplorerToolBarButtonBinding,ExplorerToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,ExplorerToolBarButtonBinding.TYPE_NORMAL="normal",ExplorerToolBarButtonBinding.TYPE_LARGE="large",ExplorerToolBarButtonBinding.prototype.toString=function(){return"[ExplorerToolBarButtonBinding]"},ExplorerToolBarButtonBinding.prototype.onBindingAttach=function(){var a=this.explorerToolBarButtonType==ExplorerToolBarButtonBinding.TYPE_LARGE,b=a?ToolBarBinding.IMAGESIZE_LARGE:ToolBarBinding.IMAGESIZE_NORMAL;this.imageProfile=this.node.getImageProfile(b),ExplorerToolBarButtonBinding.superclass.onBindingAttach.call(this)},ExplorerToolBarButtonBinding.newInstance=function(a,b){var c="ui:explorertoolbarbutton",d=DOMUtil.createElementNS(Constants.NS_UI,c,a),e=UserInterface.registerBinding(d,ExplorerToolBarButtonBinding);return e.explorerToolBarButtonType=b,e},EditorBinding.prototype=new WindowBinding,EditorBinding.prototype.constructor=EditorBinding,EditorBinding.superclass=WindowBinding.prototype,EditorBinding.isActive=!1,EditorBinding.ACTION_ATTACHED=null,EditorBinding.URL_DIALOG_MOZ_CONFIGURE="${root}/content/dialogs/wysiwygeditor/mozsecuritynote/mozsecuritynote.aspx",EditorBinding.URL_UPDATERENDERING="${root}/content/dialogs/functions/editFunctionCall.aspx?type={0}",EditorBinding.ABSURD_NUMBER=-999999999,EditorBinding.LINE_BREAK_ENTITY_HACK="C1.LINE.BREAK.ENTITY.HACK",EditorBinding.invokeFunctionEditorDialog=function(a,b,c){c=c?c:"";var d=FunctionService.GetCustomEditorSettingsByMarkup(a),e=ViewDefinitions["Composite.Management.PostBackDialog"];if(d){var f=top.WindowManager.getWindowDimensions();e.width=d.Width?d.Width>f.w?f.w:d.Width:void 0,e.height=d.Height?d.Height>f.h?f.h:d.Height:void 0,d.Url&&(d.Url=d.Url.indexOf("?")>-1?d.Url+"&consoleId="+Application.CONSOLE_ID:d.Url+"?consoleId="+Application.CONSOLE_ID)}else e.width=500,e.height=520;e.label="${string:Composite.Web.FormControl.FunctionCallsDesigner:DialogTitle}",e.image="${icon:parameter_overloaded}",e.handler=b,e.argument={url:d?d.Url:EditorBinding.URL_UPDATERENDERING.replace("{0}",c),list:new List([{name:"functionmarkup",value:a}])},StageBinding.presentViewDefinition(e)},EditorBinding._components=new Map,EditorBinding._editors=new Map,EditorBinding.registerComponent=function(a,b){var c=EditorBinding._components,d=EditorBinding._editors,e=b.key,f=Interfaces.isImplemented(IWysiwygEditorComponent,a);if(f||(f=Interfaces.isImplemented(ISourceEditorComponent,a)),!f)throw"Editor component interface not implemented: "+a;d.has(e)?d.get(e).initializeEditorComponent(a):(c.has(e)||c.set(e,new List),c.get(e).add(a))},EditorBinding.claimComponents=function(a,b){var c=EditorBinding._components,d=EditorBinding._editors,e=b.key;d.set(e,a);var f=null;return c.has(e)&&(f=c.get(e).copy(),c.del(e)),f},EditorBinding.prototype.toString=function(){return"[EditorBinding]"},EditorBinding.prototype.onBindingRegister=function(){EditorBinding.superclass.onBindingRegister.call(this),this._url=this.url_default,this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument));var a=this.getProperty("name");(null==a||""==a)&&(a="generated"+KeyMaster.getUniqueKey()),this._registerWithDataManager(a)},EditorBinding.prototype.onBindingAttach=function(){Application.lock(this),this.hasCallBackID()&&Binding.dotnetify(this),this._setup(),this.setURL(this._url),this.addActionListener(Binding.ACTION_DIRTY),EditorBinding.superclass.onBindingAttach.call(this)},EditorBinding.prototype._setup=function(){var a=this.getProperty("value");null!=a&&(a=decodeURIComponent(a),this._startContent=a)},EditorBinding.prototype.onBindingDispose=function(){EditorBinding.superclass.onBindingDispose.call(this);var a=this.getProperty("name");if(null!=a){var b=this.bindingWindow.DataManager;b.unRegisterDataBinding(a)}},EditorBinding.prototype._initialize=function(){this.subscribe(BroadcastMessages.STAGEDIALOG_OPENED),this.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP),null==this._startContent&&(this._startContent=new String("")),this.addEditorEvents();var a=this;setTimeout(function(){a._finalize()},0)},EditorBinding.prototype._finalize=function(){this.resetUndoRedo(),this._popupBinding=this.getEditorPopupBinding(),Application.unlock(this),this._isFinalized=!0,this.dispatchAction(this.action_initialized)},EditorBinding.prototype.initializeEditorComponents=function(a){var b=EditorBinding.claimComponents(this,a);if(null!=b)for(;b.hasNext();)this.initializeEditorComponent(b.getNext())},EditorBinding.prototype._registerWithDataManager=function(a){if(a&&""!=a){var b=this.bindingWindow.DataManager;b.getDataBinding(a)&&b.unRegisterDataBinding(a),b.registerDataBinding(a,this)}},EditorBinding.prototype.addEditorEvents=function(){var a=this.getEditorDocument();null!=a&&(Application.framework(a),DOMEvents.addEventListener(a,DOMEvents.CONTEXTMENU,this),DOMEvents.addEventListener(a,DOMEvents.KEYPRESS,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEDOWN,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEMOVE,this)),DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEDOWN,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}})},EditorBinding.prototype.checkForDirty=function(a){if(!this.isDirty||!this.bindingWindow.DataManager.isDirty)if(1==a)this.bindingWindow.DataManager.dirty(this);else{var b=this;setTimeout(function(){b._checkForRealDirty()},0)}},EditorBinding.prototype._checkForRealDirty=function(){var a=this.getCheckSum();a!=this._checksum&&(this.bindingWindow.DataManager.dirty(this),this._checksum=a)},EditorBinding.prototype.getCheckSum=function(){var a=null;return Binding.exists(this._pageBinding)&&(a=this._pageBinding.getCheckSum(this._checksum)),a},EditorBinding.prototype.handleEvent=function(a){EditorBinding.superclass.handleEvent.call(this,a);var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.CONTEXTMENU:Client.isFirefox&&a.ctrlKey||(DOMEvents.preventDefault(a),this._popupBinding.editorBinding=this,this.handleContextMenu(a));break;case DOMEvents.KEYPRESS:this.checkForDirty(),(!this._isActivated||this.isFocusable&&!this.isFocused)&&this._activateEditor(!0);break;case DOMEvents.MOUSEDOWN:b.ownerDocument==this.getEditorDocument()&&(!this._isActivated||this.isFocusable&&!this.isFocused)&&this._activateEditor(!0);break;case DOMEvents.MOUSEMOVE:Client.isAnyExplorer&&Application.isBlurred&&(this._isActivated||this.getContentWindow().focus())}},EditorBinding.prototype.handleContextMenu=function(a){this.createBookmark(),this._popupBinding.snapToMouse(a)},EditorBinding.prototype.handleBroadcast=function(a,b){EditorBinding.superclass.handleBroadcast.call(this,a,b);var c=null;switch(a){case BroadcastMessages.STAGEDIALOG_OPENED:this._isActivated&&this._activateEditor(!1);break;case BroadcastMessages.MOUSEEVENT_MOUSEUP:if(!this.isDialogMode)try{var d=!0;b instanceof Binding?1==Interfaces.isImplemented(IEditorControlBinding,b)&&b.isEditorControlBinding&&(d=!1):(c=DOMEvents.getTarget(b),c&&c.ownerDocument==this.getEditorDocument()&&(d=!1)),d&&this._isActivated&&this._activateEditor(!1)}catch(a){throw this.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP),a}}},EditorBinding.prototype._activateEditor=function(a){if(a!=this._isActivated){this._isActivated=a,EditorBinding.isActive=a;var b=this.getEditorWindow().standardEventHandler,c=this.getContentWindow().bindingMap.broadcasterIsActive;if(null==c)throw"Required broadcaster not found";a?(this.hasBookmark()&&this.deleteBookmark(),c.enable(),Client.isExplorer&&this._sanitizeExplorer(),this.focus(),b.enableNativeKeys(!0)):(c.disable(),b.disableNativeKeys(),this.blur())}},EditorBinding.prototype._sanitizeExplorer=function(){if(Client.isExplorer){var a=this.getEditorDocument().selection.createRange();a.select()}},EditorBinding.prototype._sanitizeMozilla=function(){},EditorBinding.prototype.hasSelection=function(){var a=!1;try{var b=this.getEditorWindow().getSelection();if(null!=b&&(a=b.toString().length>0,!a)){for(var c=b.getRangeAt(0),d=c.cloneContents(),e=this.getEditorDocument().createElement("element");d.hasChildNodes();)e.appendChild(d.firstChild);var f=e.getElementsByTagName("img").item(0);null!=f&&(VisualEditorBinding.isReservedElement(f)||(a=!0))}}catch(a){}return a},EditorBinding.prototype.isCommandEnabled=function(a){var b=!0;switch(a){case"Cut":case"Copy":case"Paste":b=this.getEditorDocument().queryCommandEnabled(a)}return b},EditorBinding.prototype.handleCommand=function(a,b,c){var d=!1;switch(this.restoreBookmark(),a){case"Cut":case"Copy":case"Paste":var e=null;e="Paste"==a?null:this.hasSelection();try{this.getEditorDocument().execCommand(a,b,e)}catch(a){if(1!=Client.isMozilla)throw"Clipboard operation malfunction. Contact your developer.";Dialog.invokeModal(EditorBinding.URL_DIALOG_MOZ_CONFIGURE)}finally{d=!0}}return d},EditorBinding.prototype.getButtonForCommand=function(a){var b=this.getContentWindow().bindingMap.toolbar,c=b.getButtonForCommand(a);if(!c)throw"No button for command "+a;return c},EditorBinding.prototype.getName=function(){return this.getProperty("name")},EditorBinding.prototype.dirty=DataBinding.prototype.dirty,EditorBinding.prototype.clean=function(){this.isDirty=!1,this._checksum=this.getCheckSum()},EditorBinding.prototype.enableDialogMode=function(){if(!this.isDialogMode){this.isDialogMode=!0,this.hasBookmark()||this.createBookmark();var a=this;setTimeout(function(){a._activateEditor(!1)},0)}},EditorBinding.prototype.disableDialogMode=function(){if(this.isDialogMode){this.hasBookmark()&&this.restoreBookmark();var a=this;setTimeout(function(){a.isDialogMode=!1,a.blurEditor()},100)}},EditorBinding.prototype.blurEditor=function(){var a=this.getContentDocument().getElementById("focusableinput");if(null==a)throw"Required element not found: focusableinput";a.style.display="block",FocusBinding.focusElement(a),a.style.display="none"},EditorBinding.prototype.handleAction=function(a){EditorBinding.superclass.handleAction.call(this,a);a.target,this.shadowTree.iframe;switch(a.type){case Binding.ACTION_DIRTY:a.target!=this&&this.checkForDirty()}},EditorBinding.prototype._onPageInitialize=function(a){null==this._pageBinding&&(this.reflex(),null!=this._coverBinding&&this._coverBinding.isVisible&&this._coverBinding.hide()),EditorBinding.superclass._onPageInitialize.call(this,a)},EditorBinding.prototype.handleElement=function(a){return!0},EditorBinding.prototype.updateElement=function(a){return!0},EditorBinding.prototype.focus=DataBinding.prototype.focus,EditorBinding.prototype.blur=DataBinding.prototype.blur,EditorBinding.prototype.manifest=function(){this.shadowTree.dotnetinput.value=encodeURIComponent(this.getValue())},EditorBinding.prototype.getEditorWindow=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getEditorDocument=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getEditorPopupBinding=Binding.ABSTRACT_METHOD,EditorBinding.prototype.createBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.restoreBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.hasBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.deleteBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.resetUndoRedo=Binding.ABSTRACT_METHOD,EditorBinding.prototype.validate=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getValue=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getResult=Binding.ABSTRACT_METHOD,EditorPopupBinding.prototype=new PopupBinding,EditorPopupBinding.prototype.constructor=EditorPopupBinding,EditorPopupBinding.superclass=PopupBinding.prototype,EditorPopupBinding.CONTENT_TEMPLATE=null,EditorPopupBinding.prototype.toString=function(){return"[EditorPopupBinding]"},EditorPopupBinding.prototype.show=function(){if(this._isEditorPopupBindingInitialized)EditorPopupBinding.superclass.show.call(this);else{var a=this;Application.lock(this),setTimeout(function(){a._initialize(),Application.unlock(a)},0)}},EditorPopupBinding.prototype._initialize=function(){this._isEditorPopupBindingInitialized||(this.subTreeFromString(Templates.getTemplateElementText(this.constructor.CONTENT_TEMPLATE)),this._bodyBinding=this.getChildBindingByLocalName("menubody"),this.addActionListener(MenuItemBinding.ACTION_COMMAND,this),this._indexMenuContent(),this._isEditorPopupBindingInitialized=!0,this._onInitialize())},EditorPopupBinding.prototype._onInitialize=function(){this._configure(),this.show()},EditorPopupBinding.prototype.configure=function(){this._isEditorPopupBindingInitialized&&this._configure()},EditorPopupBinding.prototype._configure=Binding.ABSTRACT_METHOD,EditorPopupBinding.prototype._showMenuGroups=function(a){var b=this._menuGroups[a];b instanceof List&&b.each(function(a){a.show()})},EditorPopupBinding.prototype._hideMenuGroups=function(a){var b=this._menuGroups[a];b instanceof List&&b.each(function(a){a.hide()})},EditorPopupBinding.prototype.handleAction=function(a){EditorPopupBinding.superclass.handleAction.call(this,a);var b=a.target;if(a.type==MenuItemBinding.ACTION_COMMAND){this.hide();var c=b.getProperty("cmd"),d=b.getProperty("gui"),e=b.getProperty("val");this.handleCommand(c,d,e)}},EditorPopupBinding.prototype.handleCommand=Binding.ABSTRACT_METHOD,EditorClickButtonBinding.prototype=new ClickButtonBinding,EditorClickButtonBinding.prototype.constructor=EditorClickButtonBinding,EditorClickButtonBinding.superclass=ClickButtonBinding.prototype,EditorClickButtonBinding.prototype.toString=function(){return"[EditorClickButtonBinding]"},EditorClickButtonBinding.prototype.onBindingAttach=function(){EditorClickButtonBinding.superclass.onBindingAttach.call(this),this._setupEditorButton()},EditorClickButtonBinding.prototype._setupEditorButton=function(){this.cmd=this.getProperty("cmd"),this.val=this.getProperty("val"),this.gui=this.getProperty("gui"),0==this.getProperty("editorcontrol")&&(this.isEditorControlBinding=!1);var a=this.bindingWindow.bindingMap.tinywindow,b=this.bindingWindow.bindingMap.codepresswindow;a?EditorBinding.registerComponent(this,a):b&&EditorBinding.registerComponent(this,b)},EditorClickButtonBinding.prototype.buildDOMContent=function(){EditorClickButtonBinding.superclass.buildDOMContent.call(this),this._buildDesignModeSanitizer()},EditorClickButtonBinding.prototype.initializeComponent=function(a,b,c,d){this._editorBinding=a,this._tinyEngine=b,this._tinyInstance=c,this._tinyTheme=d,this._setupEditorBookmarking()},EditorClickButtonBinding.prototype.initializeSourceEditorComponent=function(a,b,c){this._editorBinding=a,this._codePressFrame=b,this._codePressEngine=c},EditorClickButtonBinding.prototype._buildDesignModeSanitizer=function(){if(Client.isAnyExplorer){var a=this.bindingDocument.createElement("img");a.className="designmodesanitizer",a.src=Resolver.resolve("${root}/images/blank.png"),a.ondragstart=function(a){a.preventDefault()},this.shadowTree.designmodesanitizer=a,this.bindingElement.appendChild(a)}},EditorClickButtonBinding.prototype._setupEditorBookmarking=function(){var a=this._editorBinding;if(null!=a){var b=this,c={handleEvent:function(c){switch(c.type){case DOMEvents.MOUSEDOWN:a.hasBookmark()||a.createBookmark();break;case DOMEvents.MOUSEUP:b.isEditorSimpleControl&&null==b.popupBinding&&a.hasBookmark()&&a.restoreBookmark()}}};DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEDOWN,c),DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEUP,c)}},EditorClickButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:clickbutton",a);return UserInterface.registerBinding(b,EditorClickButtonBinding)},EditorToolBarButtonBinding.prototype=new ToolBarButtonBinding,EditorToolBarButtonBinding.prototype.constructor=EditorToolBarButtonBinding,EditorToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,EditorToolBarButtonBinding.prototype.toString=function(){return"[EditorToolBarButtonBinding]"},EditorToolBarButtonBinding.prototype.onBindingAttach=function(){EditorToolBarButtonBinding.superclass.onBindingAttach.call(this),this._setupEditorButton()},EditorToolBarButtonBinding.prototype._setupEditorButton=EditorClickButtonBinding.prototype._setupEditorButton,EditorToolBarButtonBinding.prototype.buildDOMContent=function(){EditorToolBarButtonBinding.superclass.buildDOMContent.call(this),this._buildDesignModeSanitizer()},EditorToolBarButtonBinding.prototype.initializeComponent=EditorClickButtonBinding.prototype.initializeComponent,EditorToolBarButtonBinding.prototype.initializeSourceEditorComponent=EditorClickButtonBinding.prototype.initializeSourceEditorComponent,EditorToolBarButtonBinding.prototype._buildDesignModeSanitizer=EditorClickButtonBinding.prototype._buildDesignModeSanitizer,EditorToolBarButtonBinding.prototype._setupEditorBookmarking=EditorClickButtonBinding.prototype._setupEditorBookmarking,EditorToolBarButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,EditorToolBarButtonBinding)},EditorSelectorBinding.prototype=new SelectorBinding,EditorSelectorBinding.prototype.constructor=EditorSelectorBinding,EditorSelectorBinding.superclass=SelectorBinding.prototype,EditorSelectorBinding.prototype.toString=function(){return"[EditorSelectorBinding]"},EditorSelectorBinding.prototype.onBindingAttach=function(){0==this.getProperty("editorcontrol")&&(this.isEditorControlBinding=!1,this.BUTTON_IMPLEMENTATION=ClickButtonBinding,this.MENUITEM_IMPLEMENTATION=MenuItemBinding);var a=this.bindingWindow.bindingMap.tinywindow;EditorBinding.registerComponent(this,a),Client.isPad&&this.setProperty("width",140),EditorSelectorBinding.superclass.onBindingAttach.call(this)},EditorSelectorBinding.prototype.buildButton=function(){EditorSelectorBinding.superclass.buildButton.call(this),this._buttonBinding.isEditorSimpleControl=!1,0==this.isEditorControlBinding&&(this._buttonBinding.isEditorControlBinding=!1)},EditorSelectorBinding.prototype.initializeComponent=function(a,b,c,d){this._editorBinding=a,this._tinyEngine=b,this._tinyInstance=c,this._tinyTheme=d},EditorSelectorBinding.prototype.handleAction=function(a){switch(EditorSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:if(this._editorBinding.hasBookmark()){var b=this;setTimeout(function(){b._editorBinding.isDialogMode||(b._editorBinding.restoreBookmark(),b._tinyInstance.focus())},0)}}},EditorSelectorBinding.prototype._grabKeyboard=function(){},EditorSelectorBinding.prototype._releaseKeyboard=function(){},EditorMenuItemBinding.prototype=new MenuItemBinding,EditorMenuItemBinding.prototype.constructor=EditorMenuItemBinding,EditorMenuItemBinding.superclass=MenuItemBinding.prototype,EditorMenuItemBinding.prototype.toString=function(){return"[EditorMenuItemBinding]"},EditorMenuItemBinding.prototype.buildDOMContent=function(){EditorMenuItemBinding.superclass.buildDOMContent.call(this),Client.isAnyExplorer&&this._buildDesignModeSanitizer()},EditorMenuItemBinding.prototype._buildDesignModeSanitizer=function(){if(Client.isAnyExplorer){var a=this.bindingDocument.createElement("img");a.className="designmodesanitizer",a.src=Resolver.resolve("${root}/images/blank.png"),a.ondragstart=function(a){a.preventDefault()},this.shadowTree.designmodesanitizer=a,this.bindingElement.appendChild(a)}},EditorMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,EditorMenuItemBinding)},VisualEditorBinding.prototype=new EditorBinding,VisualEditorBinding.prototype.constructor=VisualEditorBinding,VisualEditorBinding.superclass=EditorBinding.prototype,VisualEditorBinding.FUNCTION_CLASSNAME="compositeFunctionWysiwygRepresentation",VisualEditorBinding.FIELD_CLASSNAME="compositeFieldReferenceWysiwygRepresentation",VisualEditorBinding.HTML_CLASSNAME="compositeHtmlWysiwygRepresentation",VisualEditorBinding.ACTION_INITIALIZED="visualeditor initialized",VisualEditorBinding.DEFAULT_CONTENT="<p></p>",VisualEditorBinding.URL_DIALOG_CONTENTERROR="${root}/content/dialogs/wysiwygeditor/errors/contenterror.aspx",VisualEditorBinding.XHTML='<html xmlns="http://www.w3.org/1999/xhtml">\n	<head></head>\n	<body>\n${body}\n	</body>\n</html>',VisualEditorBinding.getTinyLessClassName=function(a){for(var b,c=0,d=[],e=a.split(" ");null!=(b=e[c++]);)b.length>=3&&"mce"==b.substring(0,3)||b.length>=14&&"compositemedia"==b.substring(0,14)||d.push(b);return d.join(" ")},VisualEditorBinding.getStructuredContent=function(a){var b=null;WebServiceProxy.isFaultHandler=!1;var c=XhtmlTransformationsService.TinyContentToStructuredContent(a);return c instanceof SOAPFault||(b=c.XhtmlFragment,b||(b="")),WebServiceProxy.isFaultHandler=!0,b},VisualEditorBinding.getTinyContent=function(a,b){var c=null;null!=a&&a.replace(/\s*/gm,"").length||(a=VisualEditorBinding.DEFAULT_CONTENT),WebServiceProxy.isFaultHandler=!1;var d=b.getSoapTinyContent(a);if(d instanceof SOAPFault){var e=d,f={handleDialogResponse:function(){b.dispatchAction(Binding.ACTION_VALID)}};Dialog.invokeModal(VisualEditorBinding.URL_DIALOG_CONTENTERROR,f,e)}else c=d.XhtmlFragment,null==c&&(c=new String("")),c=c.replace(/\s+<li>/g,"<li>");return WebServiceProxy.isFaultHandler=!0,c},VisualEditorBinding.isImage=function(a){return a&&"IMG"==a.nodeName},VisualEditorBinding.isImageElement=function(a){return VisualEditorBinding.isImage(a)&&!VisualEditorBinding.isReservedElement(a)},VisualEditorBinding.isReservedElement=function(a){return VisualEditorBinding.isFunctionElement(a)?!0:VisualEditorBinding.isFieldElement(a)?!0:VisualEditorBinding.isHtmlElement(a)?!0:!1},VisualEditorBinding.isFunctionElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.FUNCTION_CLASSNAME)},VisualEditorBinding.isFieldElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.FIELD_CLASSNAME)},VisualEditorBinding.isHtmlElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.HTML_CLASSNAME)},VisualEditorBinding.prototype.onBindingRegister=function(){VisualEditorBinding.superclass.onBindingRegister.call(this),StringBundle.getString("Composite.Web.VisualEditor","Preload.Key")},VisualEditorBinding.prototype.onBindingAttach=function(){var a=this.getProperty("embedablefieldstypenames");null!=a&&(this.embedableFieldConfiguration=VisualEditorFieldGroupConfiguration.getConfiguration(a));var b=this.getProperty("formattingconfiguration");null!=b&&(this._url+="?config="+b),this._previewPageId=this.getProperty("previewpageid"),null==this._previewPageId&&(this._previewPageId="00000000-0000-0000-0000-000000000000"),this._previewTemplateId=this.getProperty("previewtemplateid"),null==this._previewTemplateId&&(this._previewTemplateId="00000000-0000-0000-0000-000000000000"),this._previewPlaceholder=this.getProperty("previewplaceholder"),VisualEditorBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.TINYMCE_INITIALIZED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST)},VisualEditorBinding.prototype.toString=function(){return"[VisualEditorBinding]"},VisualEditorBinding.prototype.handleBroadcast=function(a,b){VisualEditorBinding.superclass.handleBroadcast.call(this,a,b);var c=this.getContentWindow().bindingMap.tinywindow,d=c.getContentWindow();switch(a){case BroadcastMessages.TINYMCE_INITIALIZED:b.broadcastWindow==d&&(this._tinyEngine=b.tinyEngine,this._tinyInstance=b.tinyInstance,this._tinyTheme=b.tinyTheme,this._tinyTheme.initC1(this,this._tinyEngine,this._tinyInstance),this.initializeEditorComponents(c),this._initialize(),this.unsubscribe(BroadcastMessages.TINYMCE_INITIALIZED));break;case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.handleCommand("CompositeUpdateLayout",!1,null)}},VisualEditorBinding.prototype.initializeEditorComponent=function(a){a.initializeComponent(this,this._tinyEngine,this._tinyInstance,this._tinyTheme)},VisualEditorBinding.prototype._finalize=function(){VisualEditorBinding.superclass._finalize.call(this),this._startContent=this.normalizeToDocument(this._startContent),this._startContent=this.extractBody(this._startContent);var a=VisualEditorBinding.getTinyContent(this._startContent,this);0==a.replace(/\s*/gm,"").length&&(a=VisualEditorBinding.DEFAULT_CONTENT),this._tinyInstance.setContent(a,{format:"raw"}),this._tinyInstance.undoManager.clear(),this._tinyInstance.undoManager.add(),this.updateBodyWidth(),this._maybeShowEditor()},VisualEditorBinding.prototype._onPageInitialize=function(a){VisualEditorBinding.superclass._onPageInitialize.call(this,a),this._maybeShowEditor()},VisualEditorBinding.prototype._maybeShowEditor=function(){this._isFinalized&&null!=this._pageBinding&&(this._checksum=this.getCheckSum(),this._pageBinding.showEditor(!0))},VisualEditorBinding.prototype.extractBody=function(a){var b=null,c=/(<body\s*[^>]*>)([\S\s]*)(<\/body>)/i,d=a.match(c);return d?(b=d[2],this._xhtml=a.replace(c,"$1\n${body}\n	$3")):(b=new String(""),this._xhtml=VisualEditorBinding.XHTML),b},VisualEditorBinding.prototype.normalizeToDocument=function(a){var b=a;return this._isNormalizedDocument(a)||(b=this._getHtmlMarkup().replace("${body}",a)),b},VisualEditorBinding.prototype._isNormalizedDocument=function(a){var b=!1,c=XMLParser.parse(a,!0);return null!=c&&"html"==c.documentElement.nodeName&&(b=!0),Client.isWebKit&&0!==a.indexOf("<html")&&(b=!1),b},VisualEditorBinding.prototype._getHtmlMarkup=function(){return null!=this._xhtml?this._xhtml:VisualEditorBinding.XHTML},VisualEditorBinding.prototype.handleCommand=function(a,b,c){var d=VisualEditorBinding.superclass.handleCommand.call(this,a,b,c);if(!d){try{this._tinyInstance.execCommand(a,b,c,{skip_focus:!0}),this.checkForDirty()}catch(a){SystemDebug.stack(arguments)}d=!0}return d},VisualEditorBinding.prototype.handleContextMenu=function(a){var b=DOMEvents.getTarget(a);this._popupBinding.configure(this._tinyInstance,this._tinyEngine,b),VisualEditorBinding.superclass.handleContextMenu.call(this,a)},VisualEditorBinding.prototype.getEditorWindow=function(){return DOMUtil.getParentWindow(this.getEditorDocument())},VisualEditorBinding.prototype.getEditorDocument=function(){return this._tinyInstance.getDoc()},VisualEditorBinding.prototype.getEditorPopupBinding=function(){return app.bindingMap.visualeditorpopup},VisualEditorBinding.prototype.createBookmark=function(){this._bookmark=this._tinyInstance.selection.getBookmark(!0)},VisualEditorBinding.prototype.restoreBookmark=function(){this.hasBookmark()&&(this._tinyInstance.selection.moveToBookmark(this._bookmark),this.deleteBookmark())},VisualEditorBinding.prototype.hasBookmark=function(){return null!=this._bookmark},VisualEditorBinding.prototype.deleteBookmark=function(){this._bookmark=null},VisualEditorBinding.prototype.resetUndoRedo=function(){this._tinyInstance.undoManager.clear(),this._tinyInstance.undoManager.add(),null!=this._pageBinding&&this._pageBinding.updateUndoBroadcasters()},VisualEditorBinding.prototype.validate=function(){return this._pageBinding.validate()},VisualEditorBinding.prototype.getValue=function(){return this._pageBinding.getContent()},VisualEditorBinding.prototype.setValue=function(a){this._isFinalized?Binding.exists(this._pageBinding)&&this._pageBinding.setContent(a):null==this._startContent&&(this._startContent=a)},VisualEditorBinding.prototype.getResult=function(){},VisualEditorBinding.prototype.clean=function(){VisualEditorBinding.superclass.clean.call(this),null!=this._pageBinding&&this._pageBinding.clean()},VisualEditorBinding.prototype.getSoapTinyContent=function(a){var b=this.getEffectiveWidth();return XhtmlTransformationsService.StructuredContentToTinyContentMultiTemplate(a,this._previewPageId,this._previewTemplateId,this._previewPlaceholder,b)},VisualEditorBinding.prototype.getImageTagForFunctionCall=function(a){var b=this.getEffectiveWidth();return XhtmlTransformationsService.GetImageTagForFunctionCall2(a,this._previewPageId,this._previewTemplateId,this._previewPlaceholder,b)},VisualEditorBinding.prototype.getEffectiveWidth=function(){var a=this._tinyInstance.getBody(),b=(CSSComputer.getPadding(a),this.getContentWindow().bindingMap.editorsplitpanel),c=b.bindingElement.offsetWidth-52;return 32*Math.floor(c/32)},VisualEditorBinding.prototype.getPlaceholderWidth=function(){return StageBinding.placeholderWidth},VisualEditorBinding.prototype.updateBodyWidth=function(a){void 0==a&&(a=this.getPlaceholderWidth()),a?this._tinyInstance.getBody().style.maxWidth=a+52+"px":this._tinyInstance.getBody().style.maxWidth=""},VisualEditorBinding.prototype.focus=function(){VisualEditorBinding.superclass.focus.call(this),Client.isExplorer&&this._tinyInstance&&this._tinyInstance.selection.setRng(this._tinyInstance.selection.getRng())},VisualEditorBinding.prototype.setResult=function(a){},VisualEditorPopupBinding.prototype=new EditorPopupBinding,VisualEditorPopupBinding.prototype.constructor=VisualEditorPopupBinding,VisualEditorPopupBinding.superclass=EditorPopupBinding.prototype,VisualEditorPopupBinding.CONTENT_TEMPLATE="wysiwygeditor/popup.xml",
VisualEditorPopupBinding.prototype.toString=function(){return"[VisualEditorPopupBinding]"},VisualEditorPopupBinding.prototype.configure=function(a,b,c){var d=this.editorBinding.hasSelection();this.tinyInstance=a,this.tinyEngine=b,this.tinyElement=c,this.hasSelection=d,VisualEditorPopupBinding.superclass.configure.call(this)},VisualEditorPopupBinding.prototype.handleCommand=function(a,b,c){this.editorBinding.blurEditor(),this.editorBinding.handleCommand(a,b?b:!1,c)},VisualEditorPopupBinding.prototype._configure=function(){this._isEditorPopupBindingInitialized&&(this._configureLinkGroup(),this._configureInsertGroup(),this._configureTableGroup(),this._configureRenderingGroup(),this._configureFieldGroup(),this._configureImageGroup(),this._configureSpellCheckGroup())},VisualEditorPopupBinding.prototype._configureLinkGroup=function(){var a=!1;this.hasSelection?a=!0:this.tinyElement&&("A"!=this.tinyElement.nodeName||this.tinyElement.getAttribute("name")?"IMG"==this.tinyElement.nodeName&&(a=!0):a=!0),a?(this._showMenuGroups("link"),this._configureLinkGroupDetails()):this._hideMenuGroups("link")},VisualEditorPopupBinding.prototype._configureLinkGroupDetails=function(){var a=this.getMenuItemForCommand("compositeInsertLink"),b=this.getMenuItemForCommand("unlink"),c=(this.editorBinding.getButtonForCommand("compositeInsertLink"),this.editorBinding.getButtonForCommand("unlink"));b.setDisabled(c.isDisabled),b.isDisabled?a.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelLink}"):a.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelLinkProperties}")},VisualEditorPopupBinding.prototype._configureInsertGroup=function(){var a=this.editorBinding.embedableFieldConfiguration,b=this.getMenuItemForCommand("compositeInsertFieldParent"),c=this.bindingDocument;if(b&&b.dispose(),b=MenuItemBinding.newInstance(c),b.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelField}"),b.image="${icon:fields}",b.imageDisabled="${icon:fields-disabled}",b.setProperty("cmd","compositeInsertFieldParent"),a){var d=a.getGroupNames();if(d.hasEntries()){var e=MenuPopupBinding.newInstance(c),f=e.add(MenuBodyBinding.newInstance(c)),g=f.add(MenuGroupBinding.newInstance(c));d.each(function(b){var d=a.getFieldNames(b);d.each(function(a){var d=g.add(MenuItemBinding.newInstance(c));d.setLabel(a),d.setImage("${icon:field}"),d.setProperty("cmd","compositeInsertField"),d.setProperty("val",b+":"+a),g.add(d)})}),b.add(e)}}else b.disable();this._menuGroups.insertions.getFirst().add(b),b.attachRecursive(),this._menuItems.compositeInsertFieldParent=b},VisualEditorPopupBinding.prototype._configureTableGroup=function(){var a=this.tinyInstance.dom.getParent(this.tinyElement,"table,td"),b=null,c=null;a&&("TD"==a.nodeName&&(b=a.getAttribute("colspan"),c=a.getAttribute("rowspan")),this._menuItems.mceTableSplitCells.setDisabled("1"==b&&"1"==c),this._menuItems.mceTablePasteRowBefore.setDisabled(null==this.tinyInstance.tableRowClipboard),this._menuItems.mceTablePasteRowAfter.setDisabled(null==this.tinyInstance.tableRowClipboard)),a?this._showMenuGroups("table"):this._hideMenuGroups("table")},VisualEditorPopupBinding.prototype._configureRenderingGroup=function(){VisualEditorBinding.isFunctionElement(this.tinyElement)?this._showMenuGroups("rendering"):this._hideMenuGroups("rendering")},VisualEditorPopupBinding.prototype._configureFieldGroup=function(){VisualEditorBinding.isFieldElement(this.tinyElement)?this._showMenuGroups("field"):this._hideMenuGroups("field")},VisualEditorPopupBinding.prototype._configureImageGroup=function(){VisualEditorBinding.isImageElement(this.tinyElement)?this._showMenuGroups("image"):this._hideMenuGroups("image")},VisualEditorPopupBinding.prototype._configureSpellCheckGroup=function(){Client.isFirefox?this._showMenuGroups("spellcheck"):this._hideMenuGroups("spellcheck")},VisualEditorFormattingConfiguration._configurations=new Map,VisualEditorFormattingConfiguration._options=null,VisualEditorFormattingConfiguration.getConfiguration=function(a){var b=VisualEditorFormattingConfiguration._configurations;return b.has(a)||b.set(a,new VisualEditorFormattingConfiguration),b.get(a)},VisualEditorFormattingConfiguration._getOptions=function(){if(null==VisualEditorFormattingConfiguration._options){var a="Composite.Web.VisualEditor";VisualEditorFormattingConfiguration._options={p:StringBundle.getString(a,"FormatSelector.LabelParagraph"),address:StringBundle.getString(a,"FormatSelector.LabelAddress"),blockquote:StringBundle.getString(a,"FormatSelector.LabelBlockQuote"),div:StringBundle.getString(a,"FormatSelector.LabelDivision"),h1:StringBundle.getString(a,"FormatSelector.LabelHeading1"),h2:StringBundle.getString(a,"FormatSelector.LabelHeading2"),h3:StringBundle.getString(a,"FormatSelector.LabelHeading3"),h4:StringBundle.getString(a,"FormatSelector.LabelHeading4"),h5:StringBundle.getString(a,"FormatSelector.LabelHeading5"),h6:StringBundle.getString(a,"FormatSelector.LabelHeading6")}}return VisualEditorFormattingConfiguration._options},VisualEditorFormattingConfiguration.prototype.getFormattingOptions=function(){return this._options},VisualEditorFieldGroupConfiguration._configurations=new Map,VisualEditorFieldGroupConfiguration.getConfiguration=function(a){var b=VisualEditorFieldGroupConfiguration._configurations;return b.has(a)||b.set(a,new VisualEditorFieldGroupConfiguration(EditorConfigurationService.GetEmbedableFieldGroupConfigurations(a))),b.get(a)},VisualEditorFieldGroupConfiguration.prototype.getGroupNames=function(){return this._groups.toList(!0)},VisualEditorFieldGroupConfiguration.prototype.getFieldNames=function(a){return this._groups.get(a).toList(!0)},VisualEditorFieldGroupConfiguration.prototype.getTinyMarkup=function(a,b){return this._groups.get(a).get(b).xhtml},VisualEditorFieldGroupConfiguration.prototype.getStructuredMarkup=function(a){return this._groups.get(groupname).get(fieldname).xml},VisualMultiEditorBinding.prototype=new VisualEditorBinding,VisualMultiEditorBinding.prototype.constructor=VisualMultiEditorBinding,VisualMultiEditorBinding.superclass=VisualEditorBinding.prototype,VisualMultiEditorBinding.prototype.toString=function(){return"[VisualMultiEditorBinding]"},VisualMultiEditorBinding.prototype._maybeShowEditor=function(){this._hasPlaceHolders&&VisualMultiEditorBinding.superclass._maybeShowEditor.call(this)},VisualMultiEditorBinding.prototype._setup=function(){this._xhtmls=new Map;for(var a=this.getDescendantElementsByLocalName("textarea");a.hasNext();){var b=a.getNext();"true"==b.getAttribute("selected")&&(this._startContent=b.value,this._textareaname=b.getAttribute("placeholderid"))}null==this._startContent&&(this._startContent=VisualEditorBinding.DEFAULT_CONTENT)},VisualMultiEditorBinding.prototype._initialize=function(){var a=this,b=this.getContentWindow().bindingMap.templatetree;b.addActionListener(TreeBinding.ACTION_SELECTIONCHANGED,{handleAction:function(c){var d=b.getSelectedTreeNodeBindings().getFirst();a._placeHolderSelected(d.textareaname),c.consume()}}),b.addActionListener(Binding.ACTION_FOCUSED,{handleAction:function(b){a._activateEditor(!1)}}),this._updatePlaceHolders();var c=this.getContentWindow().bindingMap.toolsplitter;c.unCollapse(),VisualMultiEditorBinding.superclass._initialize.call(this)},VisualMultiEditorBinding.prototype._updatePlaceHolders=function(){templatetree=this.getContentWindow().bindingMap.templatetree;var a=this.getDescendantElementsByLocalName("textarea");templatetree.empty(),a.hasEntries()?(this._hasPlaceHolders=!0,this._parsePlaceHolders(a),this._isFinalized&&this._pageBinding.showEditor(!0)):(this._hasPlaceHolders=!1,this._noPlaceHolders(),this._isFinalized&&this._pageBinding.showEditor(!1))},VisualMultiEditorBinding.prototype._parsePlaceHolders=function(a){for(this._textareas=new Map;a.hasNext();){var b=a.getNext(),c=b.getAttribute("placeholderid");this._textareas.set(c,{placeholderid:c,placeholdername:b.getAttribute("placeholdername"),placeholdermarkup:b.value,textareaelement:b,isSelected:"true"==b.getAttribute("selected")})}var d=new Map;if(this._textareas.each(function(a,b){var c=templatetree.add(TreeNodeBinding.newInstance(templatetree.bindingDocument));c.setLabel(b.placeholdername),c.setImage("${icon:placeholder}"),c.setProperty("placeholder",!0),c.textareaname=a,d.set(b.placeholdername,c),b.isSelected&&(selected=c)}),templatetree.attachRecursive(),null!=selected){var e=this._textareas.get(selected.textareaname);this._textareaname=selected.textareaname,this._placeholdername=e.placeholdername,this._setContentFromPlaceHolder(selected.textareaname),selected.focus()}},VisualMultiEditorBinding.prototype._noPlaceHolders=function(){var a=this.getContentWindow().bindingMap.templatetree,b=a.add(TreeNodeBinding.newInstance(a.bindingDocument));b.setLabel(StringBundle.getString("Composite.Web.VisualEditor","TemplateTree.NoTemplateWarning")),b.setImage("${icon:warning}"),b.attach();var c=this.getContentWindow().bindingMap.statusbar;c.setPlaceHolderName(null)},VisualMultiEditorBinding.prototype._setContentFromPlaceHolder=function(a){if(1==this._isFinalized){var b=this._textareas.get(a),c=b.placeholdermarkup;this.setValue(this.normalizeToDocument(c)),this.resetUndoRedo()}},VisualMultiEditorBinding.prototype._placeHolderSelected=function(a){1==this._isFinalized&&this._textareaname&&this._textareas.has(this._textareaname)&&(this._textareas.get(this._textareaname).placeholdermarkup=this.getValue()),this._textareaname=a,this._placeholdername=this._textareas.get(this._textareaname).placeholdername;var b=this.getContentWindow().bindingMap.statusbar;if(b.setPlaceHolderName(this._placeholdername),1==this._isFinalized){var c=this;Application.lock(c),setTimeout(function(){c._setContentFromPlaceHolder(a),Application.unlock(c)},0)}},VisualMultiEditorBinding.prototype.extractBody=function(a){var b=VisualMultiEditorBinding.superclass.extractBody.call(this,a);return this._xhtmls.set(this._textareaname,this._xhtml),b},VisualMultiEditorBinding.prototype._getHtmlMarkup=function(){var a=VisualEditorBinding.XHTML;return this._xhtmls.has(this._textareaname)&&(a=this._xhtmls.get(this._textareaname),null==a&&(a=VisualEditorBinding.XHTML)),a},VisualMultiEditorBinding.prototype.manifest=function(){null!=this._textareas&&this._textareas.hasEntries()&&(this._textareas.get(this._textareaname).placeholdermarkup=this.getValue(),this._textareas.each(function(a,b){b.textareaelement.value=b.placeholdermarkup}))},VisualMultiEditorBinding.prototype.updateElement=function(a,b,c){var d=a.getElementsByTagName("div").item(0),e=b.getElementsByTagName("div").item(0),f=new List(d.getElementsByTagName("textarea")),g=new List(e.getElementsByTagName("textarea"));if(f.getLength()!=g.getLength())c=!0;else{f.each(function(a,b){var d=g.get(b),e=a.getAttribute("placeholderid"),f=d.getAttribute("placeholderid"),h=a.getAttribute("placeholdername"),i=d.getAttribute("placeholdername");return(e!=f||h!=i)&&(c=!0),!c})}if(c){var h=null;null!=d.innerHTML?h=d.innerHTML:(h=DOMSerializer.serialize(d),h=h.substring(h.indexOf(">")+1,h.length),h=h.substring(0,h.lastIndexOf("<")));var i=this.bindingElement.getElementsByTagName("div").item(0);null!=i&&(i.innerHTML=h),this._updatePlaceHolders()}return!0},VisualMultiTemplateEditorBinding.prototype=new VisualMultiEditorBinding,VisualMultiTemplateEditorBinding.prototype.constructor=VisualMultiTemplateEditorBinding,VisualMultiTemplateEditorBinding.superclass=VisualMultiEditorBinding.prototype,VisualMultiTemplateEditorBinding.prototype.toString=function(){return"[VisualMultiTemplateEditorBinding]"},VisualMultiTemplateEditorBinding.prototype.onBindingAttach=function(){VisualMultiTemplateEditorBinding.superclass.onBindingAttach.call(this),this._oldtextareas=new Map,this.getProperty("pageid")&&(this._pageId=this.getProperty("pageid"))},VisualMultiTemplateEditorBinding.prototype._onPageInitialize=function(a){VisualMultiTemplateEditorBinding.superclass._onPageInitialize.call(this,a),this.bindingElement.offsetWidth>1e3&&this.getContentWindow().bindingMap.visualeditorsplitbox.setLayout("4:1");var b=this;this.getContentWindow().bindingMap.visualeditorsplitbox.addActionListener(SplitterBinding.ACTION_DRAGGED,{handleAction:function(){b.handleCommand("CompositeUpdateLayout",!1,null)}})},VisualMultiTemplateEditorBinding.prototype._initialize=function(){var a=this,b=this.getDescendantBindingByLocalName("selector");b.attach(),this._populateTemplateSelector();var c=this.getContentWindow().bindingMap.templateselector;c.addActionListener(SelectorBinding.ACTION_SELECTIONCHANGED,{handleAction:function(){setTimeout(function(){a._onTemplateSelectionChanged()},0)}}),this.getContentWindow().bindingMap.templatetoolbar.show(),VisualMultiTemplateEditorBinding.superclass._initialize.call(this),this.updateTemplatePreview()},VisualMultiTemplateEditorBinding.prototype._populateTemplateSelector=function(){var a=this.getDescendantBindingByLocalName("selector"),b=this.getContentWindow().bindingMap.templateselector;a.selections.each(function(a){a.imageProfile=new ImageProfile({image:"${icon:page-template-template}"})}),b.populateFromList(a.selections)},VisualMultiTemplateEditorBinding.prototype._onTemplateSelectionChanged=function(){var a=this.getDescendantBindingByLocalName("selector"),b=this.getContentWindow().bindingMap.templateselector;a.selectByValue(b.getValue()),a.dispatchAction(PageBinding.ACTION_DOPOSTBACK),this.checkForDirty(!0)},VisualMultiTemplateEditorBinding.prototype._parsePlaceHolders=function(a){function b(a,b){var c=b;return d.has(a)&&(c=d.get(a).placeholdermarkup),c}var c=this._textareas,d=this._oldtextareas;for(null!=c&&c.each(function(a,b){d.set(a,b)}),this._textareas=new Map;a.hasNext();){var e=a.getNext(),f=e.getAttribute("placeholderid");this._textareas.set(f,{placeholderid:f,placeholdername:e.getAttribute("placeholdername"),placeholdermarkup:b(f,e.value),textareaelement:e,isSelected:"true"==e.getAttribute("selected")})}var g=null,h=this.getContentWindow().bindingMap.templatetree,i=new Map;if(this._textareas.each(function(a,b){var c=h.add(TreeNodeBinding.newInstance(h.bindingDocument));c.setLabel(b.placeholdername),c.setImage("${icon:placeholder}"),c.setProperty("placeholder",!0),c.textareaname=a,i.set(b.placeholdername,c),b.isSelected&&(g=c)}),h.attachRecursive(),null!=g){var j=!0;if(this._oldtextareas.hasEntries()){j=!1;var k=new Map;this._textareas.each(function(a,b){k.set(b.placeholdername,!0)}),k.has(this._placeholdername)||(j=!0)}if(j){var l=this._textareas.get(g.textareaname);this._textareaname=g.textareaname,this._placeholdername=l.placeholdername,this._setContentFromPlaceHolder(g.textareaname),g.focus()}else{var m=i.get(this._placeholdername);this._textareaname=m.textareaname,m.focus()}}},VisualMultiTemplateEditorBinding.prototype._placeHolderSelected=function(a){VisualMultiTemplateEditorBinding.superclass._placeHolderSelected.call(this,a),this.updateBodyWidth()},VisualMultiTemplateEditorBinding.prototype._getElementsByTagName=function(a,b){var c=null;return c=Client.isWebKit||Client.isExplorer?a.getElementsByTagName(b):a.getElementsByTagName("ui:"+b)},VisualMultiTemplateEditorBinding.prototype.updateElement=function(a,b){var c=this._getElementsByTagName(a,"selector").item(0),d=this._getElementsByTagName(b,"selector").item(0),e=!1,f=!1;if(null!=c&&null!=d){var g=new List(this._getElementsByTagName(c,"selection")),h=new List(this._getElementsByTagName(d,"selection"));g.getLength()!=h.getLength()?(e=!0,f=!0):(g.each(function(a,b){var c=a.getAttribute("value"),d=h.get(b).getAttribute("value");return c!=d&&(e=!0),!e}),g.each(function(a,b){var c=a.getAttribute("selected"),d=h.get(b).getAttribute("selected");return c!=d&&(f=!0),!f}))}if(e){var i=this.bindingElement.getElementsByTagName("div").item(1);this.bindingWindow.DocumentManager.detachBindings(i,!0),i.innerHTML=DOMSerializer.serialize(c),this.bindingWindow.DocumentManager.attachBindings(i),this._populateTemplateSelector()}return f&&this.updateTemplatePreview(),VisualMultiTemplateEditorBinding.superclass.updateElement.call(this,a,b,f)},VisualMultiTemplateEditorBinding.prototype.enableDialogMode=function(){StageBinding.placeholderWidth=this.getPlaceholderWidth(),VisualMultiTemplateEditorBinding.superclass.enableDialogMode.call(this)},VisualMultiTemplateEditorBinding.prototype.disableDialogMode=function(){StageBinding.placeholderWidth=null,VisualMultiTemplateEditorBinding.superclass.disableDialogMode.call(this)},VisualMultiTemplateEditorBinding.prototype.getPlaceholderWidth=function(a){var b=null;void 0==a&&(a=this._textareaname);return this._templatePreview&&new List(this._templatePreview.Placeholders).each(function(c){return c.PlaceholderId==a?(b=c.ClientRectangle.Width,!1):void 0}),b},VisualMultiTemplateEditorBinding.prototype.updateTemplatePreview=function(a){var b=this._pageId,c=this.getDescendantBindingByLocalName("selector").getValue();this._templatePreview=null;var d=this;PageTemplateService.GetTemplatePreviewInformation(b,c,function(a){d._templatePreview=a,d.updateBodyWidth()})},VisualMultiTemplateEditorBinding.prototype.getSoapTinyContent=function(a){var b=this._pageId,c=this._textareaname,d=this.getDescendantBindingByLocalName("selector").getValue(),e=this.getEffectiveWidth();return XhtmlTransformationsService.StructuredContentToTinyContentMultiTemplate(a,b,d,c,e)},VisualMultiTemplateEditorBinding.prototype.getImageTagForFunctionCall=function(a){var b=this._pageId,c=this._textareaname,d=this.getDescendantBindingByLocalName("selector").getValue(),e=this.getEffectiveWidth();return XhtmlTransformationsService.GetImageTagForFunctionCall2(a,b,d,c,e)},CodeMirrorEditorPopupBinding.prototype=new EditorPopupBinding,CodeMirrorEditorPopupBinding.prototype.constructor=CodeMirrorEditorPopupBinding,CodeMirrorEditorPopupBinding.superclass=EditorPopupBinding.prototype,CodeMirrorEditorPopupBinding.CONTENT_TEMPLATE="sourceeditor/popup.xml",CodeMirrorEditorPopupBinding.prototype.toString=function(){return"[CodeMirrorEditorPopupBinding]"},CodeMirrorEditorPopupBinding.prototype.configure=function(a,b,c){this._editorBinding=a,this._codePressFrame=b,this._codePressEngine=c,WysiwygEditorPopupBinding.superclass.configure.call(this)},CodeMirrorEditorPopupBinding.prototype._configure=function(){switch(this._editorBinding.syntax){case SourceEditorBinding.syntax.XML:case SourceEditorBinding.syntax.XSL:case SourceEditorBinding.syntax.HTML:this._showMenuGroups("xml");break;default:this._hideMenuGroups("xml")}},CodeMirrorEditorPopupBinding.prototype.handleCommand=function(a,b,c){var d=this._editorBinding.getContentWindow(),e=null;switch(a){case"compositeInsert":e=d.bindingMap.insertbutton;break;case"compositeFormat":e=d.bindingMap.formatbutton}null!=e&&e.handleCommand(a,b,c)},CodeMirrorEditorBinding.prototype=new EditorBinding,CodeMirrorEditorBinding.prototype.constructor=CodeMirrorEditorBinding,CodeMirrorEditorBinding.superclass=EditorBinding.prototype,CodeMirrorEditorBinding.ACTION_INITIALIZED="codemirroreditor initialized",CodeMirrorEditorBinding.syntax={TEXT:"text",XML:"xml",XSL:"xsl",HTML:"html",CSS:"css",JAVASCRIPT:"js",CSHARP:"cs",CSHTML:"cshtml",ASPX:"aspx",SQL:"sql",SASS:"sass"},CodeMirrorEditorBinding.prototype.toString=function(){return"[CodeMirrorEditorBinding]"},CodeMirrorEditorBinding.prototype.onBindingRegister=function(){CodeMirrorEditorBinding.superclass.onBindingRegister.call(this),StringBundle.getString("Composite.Web.SourceEditor","Preload.Key")},CodeMirrorEditorBinding.prototype.onBindingAttach=function(){this.subscribe(BroadcastMessages.CODEMIRROR_LOADED),1==this.getProperty("embedded")&&(this._isEmbedded=!0);var a=this.getProperty("validate");1==a&&(this._hasStrictValidation=!0);var b=this.getProperty("strictsave");b===!1&&(this._strictSave=!1);var c=this.getProperty("validator");null!=c&&(this._validator=c),this.syntax=this.getProperty("syntax"),this.getProperty("debug")&&(this._startContent=Templates.getPlainText("sourcecodeeditor/"+this.syntax+".txt")),CodeMirrorEditorBinding.superclass.onBindingAttach.call(this)},CodeMirrorEditorBinding.prototype.handleBroadcast=function(a,b){switch(CodeMirrorEditorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.CODEMIRROR_LOADED:var c=this.getContentWindow().bindingMap.codemirrorwindow;if(null!=c){var d=c.getContentWindow();if(b.broadcastWindow==d){switch(this._codemirrorWindow=d,this._codemirrorEditor=b.codemirrorEditor,this._codemirrorWrapperElement=b.codemirrorEditor.getWrapperElement(),this.syntax){case CodeMirrorEditorBinding.syntax.XML:this._codemirrorEditor.setOption("mode","application/xml");break;case CodeMirrorEditorBinding.syntax.XSL:case CodeMirrorEditorBinding.syntax.HTML:this._codemirrorEditor.setOption("mode","text/html");break;case CodeMirrorEditorBinding.syntax.CSS:this._codemirrorEditor.setOption("mode","text/css");break;case CodeMirrorEditorBinding.syntax.CSHARP:this._codemirrorEditor.setOption("mode","text/x-csharp");break;case CodeMirrorEditorBinding.syntax.CSHTML:this._codemirrorEditor.setOption("mode","application/x-cshtml");break;case CodeMirrorEditorBinding.syntax.JAVASCRIPT:this._codemirrorEditor.setOption("mode","text/javascript");break;case CodeMirrorEditorBinding.syntax.ASPX:this._codemirrorEditor.setOption("mode","application/x-aspx");break;case CodeMirrorEditorBinding.syntax.SASS:this._codemirrorEditor.setOption("mode","text/x-sass");break;case CodeMirrorEditorBinding.syntax.SQL:this._codemirrorEditor.setOption("mode","text/x-mssql");break;case CodeMirrorEditorBinding.syntax.TEXT:this._codemirrorEditor.setOption("mode","")}this.initializeEditorComponents(c);var e=this;this._codemirrorEditor.on("change",function(a){e.checkForDirty()}),this._codemirrorEditor.on("focus",function(a){e._activateEditor(!0)}),null!=this._pageBinding&&this._initialize(),this.unsubscribe(a)}}}},CodeMirrorEditorBinding.prototype._onPageInitialize=function(a){CodeMirrorEditorBinding.superclass._onPageInitialize.call(this,a),(Client.isExplorer||null!=this._codemirrorEditor)&&this._initialize()},CodeMirrorEditorBinding.prototype._activateEditor=function(a){if(a!=this._isActivated||this.isFocusable&&!this.isFocused){this._isActivated=a,EditorBinding.isActive=a;var b=this._codemirrorWindow.standardEventHandler;a?b.enableNativeKeys(!0):b.disableNativeKeys();var c=this.getContentWindow().bindingMap.broadcasterIsActive;null!=c&&(a?c.enable():c.disable()),a?(this.focus(),this._codemirrorWindow.focus()):(this._codemirrorWindow.blur(),this.blur())}},CodeMirrorEditorBinding.prototype.handleCommand=function(a,b,c){var d=CodeMirrorEditorBinding.superclass.handleCommand.call(this,a,c);return d},CodeMirrorEditorBinding.prototype._finalize=function(){this.setContent(this._startContent),CodeMirrorEditorBinding.superclass._finalize.call(this)},CodeMirrorEditorBinding.prototype.initializeEditorComponent=function(a){a.initializeSourceEditorComponent(this,this._codemirrorEditor)},CodeMirrorEditorBinding.prototype.handleContextMenu=function(a){},CodeMirrorEditorBinding.prototype.getEditorPopupBinding=function(){return top.app.bindingMap.sourcecodeeditorpopup},CodeMirrorEditorBinding.prototype.getEditorWindow=function(){return this._codemirrorWindow},CodeMirrorEditorBinding.prototype.getEditorDocument=function(){return null!=this._codemirrorWrapperElement?this._codemirrorWrapperElement.ownerDocument:null},CodeMirrorEditorBinding.prototype.setContent=function(a){return this._isFinalized||a!=this._startContent&&(this._startContent=a),this.isInitialized&&null!=this.getContentWindow().bindingMap&&(this.getContentWindow().bindingMap.editorpage.setContent(a),this.resetUndoRedo(),this._checksum=this.getCheckSum()),!0},CodeMirrorEditorBinding.prototype.getContent=function(){var a=this.getContentWindow().bindingMap.editorpage.getContent();return a?a:""},CodeMirrorEditorBinding.prototype.resetUndoRedo=function(){this._codemirrorEditor.clearHistory()},CodeMirrorEditorBinding.prototype.cover=function(a){null!=this._pageBinding&&this._pageBinding.cover(a)},CodeMirrorEditorBinding.prototype.updateElement=function(a){if(null!=a&&null!=this.shadowTree.dotnetinput){var b=a.getAttribute("value");null!=b&&b!=this.shadowTree.dotnetinput.value&&this.setValue(decodeURIComponent(b))}return!0},CodeMirrorEditorBinding.prototype.blurEditor=function(){},CodeMirrorEditorBinding.prototype.validate=function(){var a=!0,b=this.getContent();if(null!=this._validator)a=Validator.validateInformed(b,this._validator);else switch(this.syntax){case CodeMirrorEditorBinding.syntax.XML:case CodeMirrorEditorBinding.syntax.XSL:case CodeMirrorEditorBinding.syntax.HTML:var c=b.replace("&nbsp;","&#160;").replace("&ldquo;","").replace("&rdguo;","").replace("&lsquo;","").replace("&rsquo;","").replace("&laquo;","").replace("&raquo;","").replace("&lsaquo;","").replace("&rsaquo;","").replace("&bull;","").replace("&deg;","").replace("&hellip;","").replace("&trade;","").replace("&copy;","").replace("&reg;","").replace("&mdash;","").replace("&ndash;","").replace("&sup2;","").replace("&sup3;","").replace("&frac14;","").replace("&frac12;","").replace("&frac34;","").replace("&times;","").replace("&larr;","").replace("&rarr;","").replace("&uarr;","").replace("&darr;","").replace("&middot;","").replace("<!doctype","<!DOCTYPE");if(c!=b&&(b=c,this.setContent(c)),a=XMLParser.isWellFormedDocument(b,!0,!this._strictSave),1==a&&this._hasStrictValidation)switch(this.syntax){case CodeMirrorEditorBinding.syntax.HTML:a=this._isValidHTML(b)}}return a},CodeMirrorEditorBinding.prototype._isValidHTML=function(a){var b=!0,c=XMLParser.parse(a),d=new List;if(null!=c){var e=c.documentElement;"html"!=e.nodeName&&d.add("MissingHtml"),e.namespaceURI!=Constants.NS_XHTML&&d.add("NamespaceURI");for(var f=null,g=null,h=new List(e.childNodes);h.hasNext();){var i=h.getNext();if(i.nodeType==Node.ELEMENT_NODE)switch(i.nodeName){case"head":null!=f&&d.add("MultipleHead"),null!=g&&d.add("HeadBodyIndex"),f=i;break;case"body":null!=g&&d.add("MultipleBody"),g=i;break;default:d.add("NotAllowedHtmlChild")}}null==f&&d.add("MissingHead"),null==g&&d.add("MissingBody")}return d.hasEntries()&&(b=!1,Dialog.error(StringBundle.getString("Composite.Web.SourceEditor","Invalid.HTML.DialogTitle"),StringBundle.getString("Composite.Web.SourceEditor","Invalid.HTML."+d.getFirst()))),b},CodeMirrorEditorBinding.prototype._isValidXSL=function(){return!0},CodeMirrorEditorBinding.prototype.getValue=CodeMirrorEditorBinding.prototype.getContent,CodeMirrorEditorBinding.prototype.setValue=CodeMirrorEditorBinding.prototype.setContent,CodeMirrorEditorBinding.prototype.getResult=CodeMirrorEditorBinding.prototype.getContent,CodeMirrorEditorBinding.prototype.setResult=CodeMirrorEditorBinding.prototype.setContent,CodeMirrorEditorBinding.prototype.createBookmark=function(){},CodeMirrorEditorBinding.prototype.restoreBookmark=function(){},CodeMirrorEditorBinding.prototype.hasBookmark=function(){},CodeMirrorEditorBinding.prototype.deleteBookmark=function(){},CodeMirrorEditorBinding.prototype.getCheckSum=function(){var a=null,b=this._pageBinding;return null!=b&&(a=b.getCheckSum()),a},ProgressBarBinding.prototype=new Binding,ProgressBarBinding.prototype.constructor=ProgressBarBinding,ProgressBarBinding.superclass=Binding.prototype,ProgressBarBinding.WIDTH=190,ProgressBarBinding.NOTCH=9,ProgressBarBinding._bindingInstance=null,ProgressBarBinding.notch=function(a){var b=ProgressBarBinding._bindingInstance;null!=b&&b.notch(a)},ProgressBarBinding.reload=function(){ProgressBarBinding._bindingInstance._cover.setWidth(ProgressBarBinding.WIDTH)},ProgressBarBinding.prototype.toString=function(){return"[ProgressBarBinding]"},ProgressBarBinding.prototype.onBindingAttach=function(){ProgressBarBinding.superclass.onBindingAttach.call(this),ProgressBarBinding._bindingInstance=this,this._cover=this.add(CoverBinding.newInstance(this.bindingDocument)),this._cover.setBusy(!1),this._cover.setWidth(ProgressBarBinding.WIDTH),this.shadowTree.cover=this._cover},ProgressBarBinding.prototype.notch=function(a){a=a?a:1;var b=this._cover.getWidth()-ProgressBarBinding.NOTCH*a;this._cover.setWidth(b>=0?b:0)},StartMenuItemBinding.prototype=new MenuItemBinding,StartMenuItemBinding.prototype.constructor=StartMenuItemBinding,StartMenuItemBinding.superclass=MenuItemBinding.prototype,StartMenuItemBinding.prototype.toString=function(){return"[StartMenuItemBinding]"},StartMenuItemBinding.prototype.onBindingRegister=function(){StartMenuItemBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.COMPOSITE_START),this.subscribe(BroadcastMessages.COMPOSITE_STOP)},StartMenuItemBinding.prototype.handleBroadcast=function(a,b){switch(StartMenuItemBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.COMPOSITE_START:this.isChecked||this.check(!0);break;case BroadcastMessages.COMPOSITE_STOP:this.isChecked&&this.uncheck(!0)}},StartMenuItemBinding.prototype.setChecked=function(a,b){StartMenuItemBinding.superclass.setChecked.call(this,a,b),b||(this.isChecked?EventBroadcaster.broadcast(BroadcastMessages.START_COMPOSITE):EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE))},StartMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,StartMenuItemBinding),UserInterface.getBinding(b)},KeySetBinding.prototype=new Binding,KeySetBinding.prototype.constructor=KeySetBinding,KeySetBinding.superclass=Binding.prototype,KeySetBinding.keyEventHandlers={},KeySetBinding.registerKeyEventHandler=function(a,b,c,d){var e=KeySetBinding.keyEventHandlers;if(1==Interfaces.isImplemented(IKeyEventHandler,d,!0)){"*"!=c&&(c=KeySetBinding._sanitizeKeyModifiers(c));var f=window.KeyEventCodes[b];f||(f=b.charCodeAt(0)),e[a]||(e[a]={}),e[a][f]||(e[a][f]={}),e[a][f][c]=d}},KeySetBinding.handleKey=function(a,b){var c=!1,d=b.keyCode,e=KeySetBinding.keyEventHandlers;if(e[a]&&e[a][d]){var f="[default]";f+=d!=KeyEventCodes.VK_SHIFT&&b.shiftKey?" shift":"",f+=Client.isMac?d!=KeyEventCodes.VK_COMMAND&&b.metaKey?" control":"":d!=KeyEventCodes.VK_CONTROL&&b.ctrlKey?" control":"",f+=d!=KeyEventCodes.VK_ALT&&b.altKey?" alt":"";var g=e[a][d][f];null==g&&(g=e[a][d]["*"]),null!=g&&(g.handleKeyEvent(b),c=!0)}return c},KeySetBinding._sanitizeKeyModifiers=function(a){function b(a){d[a]&&(c+=" "+a)}var c="[default]",d={};return a&&(new List(a.split(" ")).each(function(a){d[a]=!0}),b("shift"),b("control")),c},KeySetBinding.prototype.toString=function(){return"[KeySetBinding]"},KeySetBinding.prototype.onBindingAttach=function(){KeySetBinding.superclass.onBindingAttach.call(this);var a=this,b=new List(DOMUtil.getElementsByTagName(this.bindingElement,"key"));b.each(function(b){var c=b.getAttribute("oncommand"),d="true"==b.getAttribute("preventdefault");KeySetBinding.registerKeyEventHandler(a.bindingDocument,b.getAttribute("key"),b.getAttribute("modifiers"),{handleKeyEvent:function(b){DOMEvents.stopPropagation(b),d&&DOMEvents.preventDefault(b);a.bindingWindow.WindowManager;top.setTimeout(function(){Binding.evaluate(c,a)},0)}})})},CursorBinding.prototype=new Binding,CursorBinding.prototype.constructor=CursorBinding,CursorBinding.superclass=Binding.prototype,CursorBinding.fadeIn=function(a){a instanceof CursorBinding&&(a.setOpacity(0),a.show(),new Animation({modifier:9,onstep:function(b){a.setOpacity(Math.sin(b*Math.PI/180))},onstop:function(){a.setOpacity(1)}}).play())},CursorBinding.fadeOut=function(a){a instanceof CursorBinding&&new Animation({modifier:9,onstep:function(b){a.setOpacity(Math.cos(b*Math.PI/180))},onstop:function(){a.hide()}}).play()},CursorBinding.moveOut=function(a,b,c){a instanceof CursorBinding&&(c.x-=16,c.y-=16,new Animation({modifier:3,onstep:function(d){var e=Math.sin(d*Math.PI/180);a.setPosition(new Point((1-e)*b.x+(0+e)*c.x,(1-e)*b.y+(0+e)*c.y))},onstop:function(){CursorBinding.fadeOut(a)}}).play())},CursorBinding.prototype.toString=function(){return"[CursorBinding]"},CursorBinding.prototype.onBindingAttach=function(){CursorBinding.superclass.onBindingAttach.call(this),this._labelBinding=this.add(LabelBinding.newInstance(this.bindingDocument));
var a=this.getProperty("image");null!=a&&this.setImage(a),this._stopIndicatorBinding=this.add(LabelBinding.newInstance(this.bindingDocument)),this._stopIndicatorBinding.attachClassName("indicator"),this._stopIndicatorBinding.setImage("${icon:cancel}"),this.hide(),this._stopIndicatorBinding.hide()},CursorBinding.prototype.setImage=function(a){this._labelBinding.setImage(a)},CursorBinding.prototype.showAcceptance=function(){if(this.isAccepting=!0,Client.isMozilla)this._stopIndicatorBinding.hide();else{var a=this;setTimeout(function(){a.isAccepting&&a._stopIndicatorBinding.hide()},0)}},CursorBinding.prototype.hideAcceptance=function(){if(this.isAccepting=!1,Client.isMozilla)this._stopIndicatorBinding.show();else{var a=this;setTimeout(function(){a.isAccepting||a._stopIndicatorBinding.show()},0)}},CursorBinding.prototype.show=function(){CursorBinding.superclass.show.call(this)},CursorBinding.prototype.setOpacity=function(a){this.bindingElement.style.opacity=new String(a),this._opacity=a},CursorBinding.prototype.getOpacity=function(){return this._opacity},CursorBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},CursorBinding.prototype.getPosition=function(){return new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop)},CursorBinding.prototype.fadeIn=function(){CursorBinding.fadeIn(this)},CursorBinding.prototype.fadeOut=function(){CursorBinding.fadeOut(this)},CoverBinding.prototype=new Binding,CoverBinding.prototype.constructor=CoverBinding,CoverBinding.superclass=Binding.prototype,CoverBinding.CLASSNAME_TRANSPARENT="transparent",CoverBinding.fadeOut=function(a){function b(b){a.bindingElement.style.opacity=new String(b)}a instanceof CoverBinding&&new Animation({modifier:18,onstep:function(c){Binding.exists(a)&&b(Math.cos(c*Math.PI/180))},onstop:function(){Binding.exists(a)&&a.hide()}}).play()},CoverBinding.fadeIn=function(a){function b(b){a.bindingElement.style.MozOpacity=new String(b)}a instanceof CoverBinding&&new Animation({modifier:18,onstart:function(){Binding.exists(a)&&(b(0),a.show())},onstep:function(c){Binding.exists(a)&&b(Math.sin(c*Math.PI/180))},onstop:function(){b(1)}}).play()},CoverBinding.prototype.toString=function(){return"[CoverBinding]"},CoverBinding.prototype.onBindingRegister=function(){CoverBinding.superclass.onBindingRegister.call(this),this.getProperty("blockevents")&&(this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP),this.addEventListener(DOMEvents.MOUSEMOVE),this.addEventListener(DOMEvents.CLICK),this.addEventListener(DOMEvents.DOUBLECLICK)),this.getProperty("doubletouchunlock")&&this.addEventListener(DOMEvents.TOUCHEND),1==this.getProperty("transparent")&&this.setTransparent(!0),0==this.getProperty("busy")&&(this._isBusy=!1),this._isBusy&&(this.bindingElement.style.cursor="wait")},CoverBinding.prototype.show=function(){CoverBinding.superclass.show.call(this),this._isBusy&&this.isVisible&&this.addEventListener(DOMEvents.MOUSEMOVE)},CoverBinding.prototype.hide=function(){CoverBinding.superclass.hide.call(this),this._isBusy&&!this.isVisible&&this._position&&(UncoverBinding.uncover(this._position),this.removeEventListener(DOMEvents.MOUSEMOVE))},CoverBinding.prototype.handleEvent=function(a){switch(CoverBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEMOVE:this._position=DOMUtil.getUniversalMousePosition(a);break;case DOMEvents.TOUCHEND:this.lastTouch&&Date.now()-this.lastTouch<300&&Application.isLocked&&Application.unlock(Application,!0),this.lastTouch=Date.now()}},CoverBinding.prototype.setBusy=function(a){a!=this._isBusy&&(a?this.bindingElement.style.cursor="wait":this.bindingElement.style.cursor="default",this._isBusy=a)},CoverBinding.prototype.setTransparent=function(a){a!=this._isTransparent&&(a?this.attachClassName(CoverBinding.CLASSNAME_TRANSPARENT):this.detachClassName(CoverBinding.CLASSNAME_TRANSPARENT),this._isTransparent=a)},CoverBinding.prototype.setWidth=function(a){a>=0&&(this.bindingElement.style.width=new String(a+"px"))},CoverBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},CoverBinding.prototype.setHeight=function(a){a>=0&&(this.bindingElement.style.height=new String(a+"px"))},CoverBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},CoverBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:cover",a);return UserInterface.registerBinding(b,CoverBinding)},UncoverBinding.prototype=new Binding,UncoverBinding.prototype.constructor=UncoverBinding,UncoverBinding.superclass=Binding.prototype,UncoverBinding._bindingInstance=null,UncoverBinding.uncover=function(a){var b=UncoverBinding._bindingInstance;Binding.exists(b)&&b.setPosition(a)},UncoverBinding.prototype.toString=function(){return"[UncoverBinding]"},UncoverBinding.prototype.setPosition=function(a){this.bindingElement.style.display="block";var b=this.boxObject.getDimension();a.x-=.5*b.w,a.y-=.5*b.h,a.x=a.x<0?0:a.x,a.y=a.y<0?0:a.y,this.bindingElement.style.left=String(a.x)+"px",this.bindingElement.style.top=String(a.y)+"px",this.bindingElement.style.cursor="wait";var c=this;setTimeout(function(){c.bindingElement.style.cursor="default",c.bindingElement.style.display="none"},0)},TheatreBinding.prototype=new Binding,TheatreBinding.prototype.constructor=TheatreBinding,TheatreBinding.superclass=Binding.prototype,TheatreBinding.CLASSNAME_INITIALIZED="initialized",TheatreBinding.prototype.toString=function(){return"[TheatreBinding]"},TheatreBinding.prototype.onBindingAttach=function(){TheatreBinding.superclass.onBindingAttach.call(this),this._canvas=document.createElement("canvas"),this.bindingElement.appendChild(this._canvas)},TheatreBinding.prototype.play=function(a){this._isFading=1==a,this._isPlaying||(Application.lock(this),this.show(),this._isPlaying=!0,this._isFading&&this._fade())},TheatreBinding.prototype._fade=function(){var a=this._canvas.getContext("2d"),b=parseInt(0);TheatreBinding._interval=top.setInterval(function(){.5>b?(a.fillStyle="rgba(0,0,0,"+new String(b)+")",a.clearRect(0,0,300,150),a.fillRect(0,0,300,150),b+=.002):(top.clearInterval(TheatreBinding._interval),TheatreBinding._interval=null)},50)},TheatreBinding.prototype.stop=function(){if(this._isPlaying){if(this._isFading){null!=TheatreBinding._interval&&top.clearInterval(TheatreBinding._interval);var a=this._canvas.getContext("2d");a.clearRect(0,0,300,150)}Application.unlock(this,!0),this.hide(),this._isPlaying=!1}},SourceCodeViewerBinding.prototype=new WindowBinding,SourceCodeViewerBinding.prototype.constructor=SourceCodeViewerBinding,SourceCodeViewerBinding.superclass=WindowBinding.prototype,SourceCodeViewerBinding.ACTION_INITIALIZED="sourcecodeviewer initialized",SourceCodeViewerBinding.URL_DEFAULT="${root}/content/misc/viewers/sourcecodeviewer/viewsourcecontent.aspx",SourceCodeViewerBinding.syntax={XML:"xml"},SourceCodeViewerBinding.stylesheets={xml:Resolver.resolve("${root}/transformations/viewsource-xml.xsl")},SourceCodeViewerBinding.prototype.toString=function(){return"[SourceCodeViewerBinding]"},SourceCodeViewerBinding.prototype.onBindingAttach=function(){switch(this._syntax=this.getProperty("syntax"),this._syntax){case SourceCodeViewerBinding.syntax.XML:var a=SourceCodeViewerBinding.stylesheets[this._syntax];this._transformer=new XSLTransformer,this._transformer.importStylesheet(a);break;default:throw"SourceCodeViewer: Syntax error!"}var b=DOMUtil.getElementsByTagName(this.bindingElement,"textarea").item(0);b&&(this._startcontent=b.value),this.setURL(SourceCodeViewerBinding.URL_DEFAULT),this.addActionListener(WindowBinding.ACTION_ONLOAD),SourceCodeViewerBinding.superclass.onBindingAttach.call(this)},SourceCodeViewerBinding.prototype.handleAction=function(a){switch(SourceCodeViewerBinding.superclass.handleAction.call(this,a),a.type){case WindowBinding.ACTION_ONLOAD:a.target==this&&(this._startcontent&&this.view(this._startcontent),this.dispatchAction(SourceCodeViewerBinding.ACTION_INITIALIZED),a.consume())}SourceCodeViewerBinding.superclass.handleAction.call(this,a)},SourceCodeViewerBinding.prototype.view=function(a){switch(this._syntax){case SourceCodeViewerBinding.syntax.XML:this._viewXML(a)}},SourceCodeViewerBinding.prototype._viewXML=function(a){var b=null;if(a&&(typeof a==Types.STRING?b=XMLParser.parse(a):a.nodeType&&a.nodeType==Node.DOCUMENT_NODE&&(b=object)),b){var c=this._transformer.transformToString(b);this._inject(c)}},SourceCodeViewerBinding.prototype._viewHTML=function(a){},SourceCodeViewerBinding.prototype._viewJavascript=function(a){},SourceCodeViewerBinding.prototype._inject=function(a){this.getContentDocument().body.innerHTML=a},PersistanceBinding.prototype=new Binding,PersistanceBinding.prototype.constructor=PersistanceBinding,PersistanceBinding.superclass=Binding.prototype,PersistanceBinding.USERDATAKEY="persistance",PersistanceBinding.GLOBALSTOREKEY=document.location.host,PersistanceBinding.TEMPLATE="storagetemplates/persistance.xml",PersistanceBinding.prototype.toString=function(){return"[PersistanceBinding]"},PersistanceBinding.prototype.getPersistanceMap=function(){var a=null,b=null;return a=1==Client.isExplorer?this._getDocExplorer():this._getDocMozilla(),null!=a&&(this._document=a,this.logger.fine(DOMSerializer.serialize(a,!0)),b=this._getPersistanceMap(this._document)),b},PersistanceBinding.prototype.persist=function(a){var b=this._getPersistanceDoc(a);alert(DOMSerializer.serialize(b,!0)),1==Client.isExplorer?this._persistDocExplorer(b):this._persistDocMozilla(b)},PersistanceBinding.prototype._getPersistanceMap=function(a){var b={};null==this._resolver&&(this._resolver=new XPathResolver,this._resolver.setNamespacePrefixResolver({p:Constants.NS_PERSISTANCE}));for(var c=this._resolver.resolveAll("p:persist",a.documentElement);c.hasNext();){var d=c.getNext(),e=d.getAttribute("id");b[e]={};for(var f=this._resolver.resolveAll("p:att",d);f.hasNext();){var g=f.getNext(),h=g.getAttribute("name"),i=g.getAttribute("value");b[e][h]=i}}return b},PersistanceBinding.prototype._getPersistanceDoc=function(a){var b=this._document,c=b.documentElement;for(c.setAttribute("version",Installation.versionString);c.hasChildNodes();)c.removeChild(c.lastChild);for(var d in a){var e=DOMUtil.createElementNS(Constants.NS_PERSISTANCE,"persist",b);e.setAttribute("id",d);for(var f in a[d]){var g=DOMUtil.createElementNS(Constants.NS_PERSISTANCE,"att",b);g.setAttribute("name",f),g.setAttribute("value",a[d][f]),e.appendChild(g)}c.appendChild(e)}return b},PersistanceBinding.prototype._getDocExplorer=function(){this.bindingElement.load(PersistanceBinding.USERDATAKEY);var a=this.bindingElement.XMLDocument;if(""==a.documentElement.namespaceURI){var b=PersistanceBinding.TEMPLATE,c=Templates.getTemplateElementText(b);a.loadXML(c);for(var d=a.documentElement;d.hasChildNodes();)d.removeChild(d.firstChild)}return a},PersistanceBinding.prototype._persistDocExplorer=function(a){var b=DOMSerializer.serialize(a,!0);this.bindingElement.XMLDocument.loadXML(b),this.bindingElement.save(PersistanceBinding.USERDATAKEY)},PersistanceBinding.prototype._getDocMozilla=function(){delete window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance;var a=null,b=window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance;if(b)a=XMLParser.parse(b);else{var c=PersistanceBinding.TEMPLATE;a=Templates.getTemplateDocument(c);for(var d=a.documentElement;d.hasChildNodes();)d.removeChild(d.lastChild)}return a},PersistanceBinding.prototype._persistDocMozilla=function(a){var b=DOMSerializer.serialize(a,!0);window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance=b},LocalizationSelectorBinding.prototype=new MenuBinding,LocalizationSelectorBinding.prototype.constructor=LocalizationSelectorBinding,LocalizationSelectorBinding.superclass=MenuBinding.prototype,LocalizationSelectorBinding.prototype.toString=function(){return"[LocalizationSelectorBinding]"},LocalizationSelectorBinding.prototype.onBindingAttach=function(){LocalizationSelectorBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.UPDATE_LANGUAGES),this.subscribe(BroadcastMessages.TOLANGUAGE_UPDATED),this._populateFromLanguages(Localization.languages),this.addActionListener(MenuItemBinding.ACTION_COMMAND)},LocalizationSelectorBinding.prototype.handleBroadcast=function(a,b){switch(LocalizationSelectorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.TOLANGUAGE_UPDATED:ExplorerBinding.restoreFocuseNodes();break;case BroadcastMessages.UPDATE_LANGUAGES:this._populateFromLanguages(b);break;case BroadcastMessages.SAVE_ALL_DONE:this.unsubscribe(BroadcastMessages.SAVE_ALL_DONE),EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),this._invokeAction()}},LocalizationSelectorBinding.prototype.handleAction=function(a){switch(LocalizationSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:this.onValueChange(a.target.selectionValue)}},LocalizationSelectorBinding.prototype._populateFromLanguages=function(a){if(null!=a&&a.hasEntries()&&a.getLength()>1){var b=new List;a.each(function(a){b.add(new SelectorBindingSelection(a.Name,a.SerializedActionToken,a.IsCurrent,null))}),this.populateFromList(b),this.bindingElement.style.display="block"}else this.bindingElement.style.display="none"},LocalizationSelectorBinding.prototype.populateFromList=function(a){if(!this.isAttached)throw"Could not populate unattached selector";var b=this.getDescendantBindingByLocalName("menugroup");if(b.detachRecursive(),b.bindingElement.innerHTML="",a.hasEntries())for(;a.hasNext();){var c=a.getNext();c.isSelected&&this.setLabel(c.label);var d=MenuItemBinding.newInstance(this.bindingDocument);d.imageProfile=c.imageProfile,d.setLabel(c.label),null!=c.tooltip&&d.setToolTip(c.tooltip),d.selectionValue=c.value,b.add(d),d.attach()}},LocalizationSelectorBinding.prototype.onValueChange=function(a){ExplorerBinding.saveFocusedNodes();var b=this;Dialog.warning(StringBundle.getString(StringBundle.UI,"UserElementProvider.ChangeOtherActiveLocaleDialogTitle"),StringBundle.getString(StringBundle.UI,"UserElementProvider.ChangeOtherActiveLocaleDialogText"),Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(c){switch(c){case Dialog.RESPONSE_ACCEPT:b._token=a,Application.hasDirtyDockTabs()?(b.subscribe(BroadcastMessages.SAVE_ALL_DONE),EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL)):(EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),b._invokeAction());break;case Dialog.RESPONSE_CANCEL:}}})},LocalizationSelectorBinding.prototype._invokeAction=function(){var a=SystemNode.taggedNodes.get("Root"),b=new SystemAction({Label:"Generated Action: Change Locale",ActionToken:this._token});SystemAction.invoke(b,a)},ResponseBinding.prototype=new Binding,ResponseBinding.prototype.constructor=ResponseBinding,ResponseBinding.superclass=Binding.prototype,ResponseBinding.ACTION_SUCCESS="response success",ResponseBinding.ACTION_OOOOKAY="response ooookay",ResponseBinding.ACTION_FAILURE="response failure",ResponseBinding.prototype.toString=function(){return"[ResponseBinding]"},ResponseBinding.prototype.onBindingAttach=function(){ResponseBinding.superclass.onBindingAttach.call(this),this.propertyMethodMap.checksum=this._update,this._update()},ResponseBinding.prototype._update=function(){this.getProperty("dirty")===!0&&this.dispatchAction(Binding.ACTION_DIRTY);var a=this.getProperty("status");if(null!=a)switch(a){case"success":this.dispatchAction(ResponseBinding.ACTION_SUCCESS);break;case"failure":this.dispatchAction(ResponseBinding.ACTION_FAILURE);break;case"ooookay":this.dispatchAction(ResponseBinding.ACTION_OOOOKAY)}var b=this.getProperty("messagequeueindex");null!=b&&b>MessageQueue.index&&MessageQueue.update(!0)},AddressBarBinding.prototype=new DataInputBinding,AddressBarBinding.prototype.constructor=AddressBarBinding,AddressBarBinding.superclass=DataInputBinding.prototype,AddressBarBinding.prototype.toString=function(){return"[AddressBarBinding]"},AddressBarBinding.prototype.onBindingAttach=function(){AddressBarBinding.superclass.onBindingAttach.call(this),this.pathBinding=PathBinding.newInstance(this.bindingDocument),this.shadowTree.box.appendChild(this.pathBinding.bindingElement),this.pathBinding.attach()},AddressBarBinding.prototype.handleEvent=function(a){switch(AddressBarBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.CLICK:a.target===this.pathBinding.bindingElement&&(this._hideBreadcrumb(),this.shadowTree.input.value="",this.shadowTree.input.focus())}},AddressBarBinding.prototype.blur=function(){AddressBarBinding.superclass.blur.call(this),!this.isBreadcrumb||this.shadowTree.input.value||this.pathBinding.isVisible||this._showBreadcrumb()},AddressBarBinding.prototype.showBreadcrumb=function(a,b){this._stateKey=KeyMaster.getUniqueKey();var c=this.pathBinding;if(c.detachRecursive(),c.bindingElement.innerHTML="",void 0!=b&&b.reverse().each(function(a){var b=ToolBarButtonBinding.newInstance(c.bindingDocument);b.setLabel(a.getLabel()),c.add(b),b.attach(),b.entityToken=a.getEntityToken(),b.node=a,b.oncommand=function(){this.dispatchAction(PathBinding.ACTION_COMMAND)}},this),void 0!=a){var d=ToolBarButtonBinding.newInstance(c.bindingDocument);d.setLabel(a.getLabel()),c.add(d),d.attach()}this.shadowTree.input.value="",this.shadowTree.input.style.display="none",this.pathBinding.show(),this.isBreadcrumb=!0},AddressBarBinding.prototype.showAddreesbar=function(a){this.newState();var b=this.getState(),c=this;PageService.ConvertRelativePageUrlToAbsolute(a,function(a){b===c.getState()&&c.setValue(a)}),this._hideBreadcrumb(),this.isBreadcrumb=!0},AddressBarBinding.prototype._hideBreadcrumb=function(){this.pathBinding.hide(),this.shadowTree.input.style.display="block"},AddressBarBinding.prototype._showBreadcrumb=function(){this.shadowTree.input.style.display="none",this.pathBinding.show()},AddressBarBinding.prototype.newState=function(){return this._stateKey=KeyMaster.getUniqueKey(),this._stateKey},AddressBarBinding.prototype.getState=function(){return this._stateKey},GenericViewBinding.prototype=new TreeBinding,GenericViewBinding.prototype.constructor=GenericViewBinding,GenericViewBinding.superclass=TreeBinding.prototype,GenericViewBinding.CLASSNAME="genericview",GenericViewBinding.CLASSNAME_SINGLE="single",GenericViewBinding.CLASSNAME_ICONSIZE="icons-s-170",GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE="icons-s-400",GenericViewBinding.IMAGE_MAXWIDTH=300,GenericViewBinding.IMAGE_MAXHEIGHT=170,GenericViewBinding.LIST_IMAGE="listimage",GenericViewBinding.ACTION_COMMAND="generic action open",GenericViewBinding.prototype.toString=function(){return"[GenericViewBinding]"},GenericViewBinding.prototype.onBindingRegister=function(){GenericViewBinding.superclass.onBindingRegister.call(this),this.addActionListener(TreeNodeBinding.ACTION_COMMAND),this.attachClassName(GenericViewBinding.CLASSNAME),this.setContextMenu(top.app.bindingMap.systemtreepopup),this.perspectiveNode=StageBinding.perspectiveNode,1==this.getProperty("treeselector")&&(this._activePosition=SystemAction.activePositions.SelectorTree)},GenericViewBinding.prototype.handleAction=function(a){a.target;switch(a.type){case TreeNodeBinding.ACTION_COMMAND:case TreeNodeBinding.ACTION_OPEN:this.dispatchAction(new Action(a.target,GenericViewBinding.ACTION_COMMAND)),a.consume();break;case TreeNodeBinding.ACTION_COMMAND:a.consume()}GenericViewBinding.superclass.handleAction.call(this,a)},GenericViewBinding.prototype.setNode=function(a){if(this.node=a,this.empty(),this.detachClassName(GenericViewBinding.CLASSNAME_SINGLE),this.detachClassName(GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE),this.detachClassName(GenericViewBinding.CLASSNAME_ICONSIZE),this.node)if(this.node.hasChildren())for(var b=this.node.getChildren();b.hasEntries();){var c=b.extractFirst();this.addNode(c),this.attachClassName(GenericViewBinding.CLASSNAME_ICONSIZE)}else this.attachClassName(GenericViewBinding.CLASSNAME_SINGLE),this.attachClassName(GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE),this.addNode(this.node)},GenericViewBinding.prototype.addNode=function(a){var b=TreeNodeBinding.newInstance(this.bindingDocument);b.node=a;var c=b.node.getLabel();c&&b.setLabel(c);var d=b.node.getPropertyBag(),e=b.node.getImageProfile();if(d&&d.ListViewImage?this.hasClassName(GenericViewBinding.CLASSNAME_SINGLE)?b.setImage(d.ListViewImage.replace("{width}",this.bindingElement.offsetWidth-60).replace("{height}",this.bindingElement.offsetHeight-130)):(b.setImage(d.ListViewImage.replace("{width}",GenericViewBinding.IMAGE_MAXWIDTH).replace("{height}",GenericViewBinding.IMAGE_MAXHEIGHT)),b.attachClassName(GenericViewBinding.LIST_IMAGE)):e&&b.setImage(e.getDefaultImage()),d)for(var f in d)switch(f.toLowerCase()){case"id":case"key":break;default:b.setProperty(f,d[f])}b.isContainer=b.node.hasChildren(),this.add(b),b.attach()},GenericViewBinding.prototype.getSyncHandle=function(){return this.perspectiveNode.getHandle()},GenericViewBinding.prototype._handleSystemTreeFocus=function(){this.getFocusedTreeNodeBindings().hasEntries()&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,actionProfile:this.getCompiledActionProfile(),syncHandle:this.getSyncHandle(),source:this})},GenericViewBinding.prototype.focusSingleTreeNodeBinding=function(a){GenericViewBinding.superclass.focusSingleTreeNodeBinding.call(this,a),null!=a&&this._handleSystemTreeFocus()},GenericViewBinding.prototype._navigateByKey=function(a){var b=this.getFocusedTreeNodeBindings();if(b.hasEntries()){var c=b.getFirst(),d=null;switch(a){case KeyEventCodes.VK_LEFT:d=c.getPreviousBindingByLocalName("treenode");break;case KeyEventCodes.VK_RIGHT:d=c.getNextBindingByLocalName("treenode");break;case KeyEventCodes.VK_DOWN:for(d=c.getNextBindingByLocalName("treenode");d&&d.bindingElement.offsetTop==c.bindingElement.offsetTop;)d=d.getNextBindingByLocalName("treenode");for(;d&&d.bindingElement.offsetLeft<c.bindingElement.offsetLeft;)d=d.getNextBindingByLocalName("treenode");break;case KeyEventCodes.VK_UP:for(d=c.getPreviousBindingByLocalName("treenode");d&&d.bindingElement.offsetTop==c.bindingElement.offsetTop;)d=d.getPreviousBindingByLocalName("treenode");for(;d&&d.bindingElement.offsetLeft>c.bindingElement.offsetLeft;)d=d.getPreviousBindingByLocalName("treenode")}null!=d&&this.focusSingleTreeNodeBinding(d)}},GenericViewBinding.prototype.getCompiledActionProfile=SystemTreeBinding.prototype.getCompiledActionProfile,GenericViewBinding.prototype.setActionGroup=SystemTreeBinding.prototype.setActionGroup,GenericViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,GenericViewBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},GenericViewBinding.prototype.getSyncHandle=function(){return 1==this.getProperty("treeselector")?this.getAncestorBindingByType(PageBinding).getID():this.perspectiveNode.getHandle()},PathBinding.prototype=new Binding,PathBinding.prototype.constructor=PathBinding,PathBinding.superclass=Binding.prototype,PathBinding.ACTION_COMMAND="pathcommand",PathBinding.prototype.toString=function(){return"[PathBinding]"},PathBinding.prototype.onBindingRegister=function(){PathBinding.superclass.onBindingRegister.call(this)},PathBinding.prototype.onBindingAttach=function(){PathBinding.superclass.onBindingAttach.call(this)},PathBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:path",a);return UserInterface.registerBinding(b,PathBinding)},BrandSnippetBinding.prototype=new Binding,BrandSnippetBinding.prototype.constructor=BrandSnippetBinding,BrandSnippetBinding.superclass=Binding.prototype,BrandSnippetBinding.SHIPPET_URL="${root}/content/branding/{0}.inc?"+Application.CONSOLE_ID,BrandSnippetBinding.SHIPPETBRANDED_URL="${root}/content/branding/{0}-branded.inc?"+Application.CONSOLE_ID,BrandSnippetBinding.SnippetName=null,BrandSnippetBinding.snippetLoading=!1,BrandSnippetBinding.snippetLoaded=!1,BrandSnippetBinding.snippetLoad=function(a){function b(){var b=this;b.responseText?(BrandSnippetBinding.snippetLoading=!1,a.bindingElement.innerHTML=b.responseText):(b.open("GET",Resolver.resolve(a.getSnippetUrl())),b.send())}if(!BrandSnippetBinding.snippetLoading){BrandSnippetBinding.snippetLoading=!0;var c=new XMLHttpRequest;c.onload=b,c.open("GET",Resolver.resolve(a.getSnippetBrandedUrl())),c.send()}},BrandSnippetBinding.prototype.toString=function(){return"[BrandSnippetBinding]"},BrandSnippetBinding.prototype.onBindingRegister=function(){BrandSnippetBinding.superclass.onBindingRegister.call(this),BrandSnippetBinding.snippetLoad(this)},BrandSnippetBinding.prototype.onBindingAttach=function(){BrandSnippetBinding.superclass.onBindingAttach.call(this)},BrandSnippetBinding.prototype.getSnippetBrandedUrl=function(){return BrandSnippetBinding.SHIPPETBRANDED_URL.replace("{0}",this.getProperty("snippetName"))},BrandSnippetBinding.prototype.getSnippetUrl=function(){return BrandSnippetBinding.SHIPPET_URL.replace("{0}",this.getProperty("snippetName"))},BrandSnippetBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:brandsnippet",a);return UserInterface.registerBinding(b,BrandSnippetBinding)},UserInterfaceMapping.prototype.merge=function(a){for(var b in a.map)this.map[b]=a.getBindingImplementation(b)},UserInterfaceMapping.prototype.getBindingImplementation=function(a){var b=null,c=a.nodeName.toLowerCase();return this.map[c]&&(b=this.map[c]),b};var UserInterface=new function(){function a(a){if(1==Binding.exists(a)){var b=a.key;Binding.destroy(a),b&&(e[b]?(e[b].binding=null,e[b].element=null,delete e[b],a=null):d.error("URGH: "+b))}}var b=Client.isMozilla?MozEditorTextBoxBinding:IEEditorTextBoxBinding,c=new UserInterfaceMapping({body:RootBinding,"ui:binding":Binding,"ui:box":Binding,"ui:brandsnippet":BrandSnippetBinding,"ui:dialog":DialogBinding,"ui:dialoghead":DialogHeadBinding,"ui:dialogbody":DialogBodyBinding,"ui:dialogset":DialogSetBinding,"ui:dialogborder":DialogBorderBinding,"ui:dialogcover":DialogCoverBinding,"ui:titlebar":DialogTitleBarBinding,"ui:titlebarbody":DialogTitleBarBodyBinding,"ui:window":WindowBinding,"ui:controlgroup":ControlGroupBinding,"ui:control":ControlBinding,"ui:menubar":MenuBarBinding,"ui:menu":MenuBinding,"ui:menubody":MenuBodyBinding,"ui:menugroup":MenuGroupBinding,"ui:menuitem":MenuItemBinding,"ui:menupopup":MenuPopupBinding,"ui:tabbox":TabBoxBinding,"ui:tabs":TabsBinding,"ui:tab":TabBinding,"ui:tabpanels":TabPanelsBinding,"ui:tabpanel":TabPanelBinding,"ui:splitbox":SplitBoxBinding,"ui:splitpanel":SplitPanelBinding,"ui:splitter":SplitterBinding,"ui:decks":DecksBinding,"ui:deck":DeckBinding,"ui:toolbar":ToolBarBinding,"ui:toolbargroup":ToolBarGroupBinding,"ui:toolbarbody":ToolBarBodyBinding,"ui:toolbarbutton":ToolBarButtonBinding,"ui:toolbarlabel":ToolBarLabelBinding,"ui:labelbox":LabelBinding,"ui:text":TextBinding,"ui:clickbutton":ClickButtonBinding,"ui:tree":TreeBinding,"ui:treebody":TreeBodyBinding,"ui:treenode":TreeNodeBinding,"ui:flexbox":FlexBoxBinding,"ui:scrollbox":ScrollBoxBinding,"ui:popupset":PopupSetBinding,"ui:popup":PopupBinding,"ui:sourceeditor":CodeMirrorEditorBinding,"ui:visualeditor":VisualEditorBinding,"ui:visualmultieditor":VisualMultiEditorBinding,"ui:visualmultitemplateeditor":VisualMultiTemplateEditorBinding,"ui:wysiwygeditortoolbarbutton":EditorToolBarButtonBinding,"ui:dock":DockBinding,"ui:docktabs":DockTabsBinding,"ui:docktab":DockTabBinding,"ui:dockpanels":DockPanelsBinding,"ui:dockpanel":DockPanelBinding,"ui:page":PageBinding,"ui:editorpage":EditorPageBinding,"ui:dialogpage":DialogPageBinding,"ui:pagebody":DialogPageBodyBinding,"ui:wizardpage":WizardPageBinding,"ui:explorer":ExplorerBinding,"ui:explorermenu":ExplorerMenuBinding,"ui:explorertoolbar":ExplorerToolBarBinding,"ui:explorertoolbarbutton":ExplorerToolBarButtonBinding,"ui:stagecontainer":StageContainerBinding,"ui:stage":StageBinding,"ui:stagedecks":StageDecksBinding,"ui:stagedeck":StageDeckBinding,"ui:viewset":ViewSetBinding,"ui:view":ViewBinding,"ui:broadcasterset":BroadcasterSetBinding,"ui:broadcaster":BroadcasterBinding,"ui:fields":FieldsBinding,"ui:fieldgroup":FieldGroupBinding,"ui:field":FieldBinding,"ui:fielddesc":FieldDescBinding,"ui:fielddata":FieldDataBinding,"ui:fieldhelp":FieldHelpBinding,"ui:datainput":DataInputBinding,"ui:selector":SelectorBinding,"ui:simpleselector":SimpleSelectorBinding,"ui:multiselector":MultiSelectorBinding,"ui:hierarchicalselector":HierarchicalSelectorBinding,"ui:datainputselector":DataInputSelectorBinding,"ui:datainputdialog":DataInputDialogBinding,"ui:urlinputdialog":UrlInputDialogBinding,"ui:datainputbutton":DataInputButtonBinding,"ui:textbox":TextBoxBinding,"ui:editortextbox":b,"ui:radiodatagroup":RadioDataGroupBinding,"ui:radio":RadioDataBinding,"ui:checkbutton":CheckButtonBinding,"ui:checkbox":CheckBoxBinding,"ui:checkboxgroup":CheckBoxGroupBinding,"ui:datadialog":DataDialogBinding,"ui:postbackdialog":PostBackDataDialogBinding,"ui:nullpostbackdialog":NullPostBackDataDialogBinding,"ui:htmldatadialog":HTMLDataDialogBinding,"ui:functioneditor":FunctionEditorDataBinding,"ui:parametereditor":ParameterEditorDataBinding,"ui:keyset":KeySetBinding,"ui:cover":CoverBinding,"ui:uncover":UncoverBinding,"ui:cursor":CursorBinding,"ui:dialogtoolbar":DialogToolBarBinding,"ui:focus":FocusBinding,"ui:balloonset":BalloonSetBinding,"ui:balloon":BalloonBinding,"ui:error":ErrorBinding,"ui:progressbar":ProgressBarBinding,"ui:lazybinding":LazyBindingBinding,"ui:sourcecodeviewer":SourceCodeViewerBinding,"ui:theatre":TheatreBinding,"ui:persistance":PersistanceBinding,"ui:filepicker":FilePickerBinding,"ui:request":RequestBinding,"ui:response":ResponseBinding,"ui:stylesheet":StyleBinding,"ui:resolvercontainer":ResolverContainerBinding}),d=SystemLogger.getLogger("UserInterface"),e={};this.registerBinding=function(a,b){var d=null;if(!this.hasBinding(a)){var f=DOMUtil.getParentWindow(a);if("bindingmapping"!=DOMUtil.getLocalName(a)){if(!b&&null!=a.getAttribute("binding")){var g=a.getAttribute("binding");if(b=f[g],null==b)throw"No such binding in scope: "+g}if(!b){var h=f.DocumentManager;if(h){var i=h.customUserInterfaceMapping;i&&(b=i.getBindingImplementation(a))}}if(b||(b=c.getBindingImplementation(a)),null!=b&&!Application.isMalFunctional)try{d=new b}catch(a){throw Application.isMalFunctional=!0,alert("No such binding!\n"+a.message+(a.stack?"\n"+a.stack:"")),a}if(d){var j=KeyMaster.getUniqueKey();a.setAttribute("key",j),d.key=j,a.id||(a.id=j),e[j]={element:a,binding:d},d.onBindingRegister()}}}return d},this.unRegisterBinding=function(b){a(b)},this.getElement=function(a){var b=null;return e[a.key]&&(b=e[a.key].element),b},this.getBinding=function(a){var b=null;if(a&&a.nodeType==Node.ELEMENT_NODE)try{var c=a.getAttribute("key");c&&e[c]&&(b=e[c].binding)}catch(b){alert("getBinding exception occurred on element:\n\n		"+a),b.stack&&alert(b.stack)}return b},this.getBindingByKey=function(a){var b=null;return e[a]&&(b=e[a].binding),b},this.hasBinding=function(a){return null!=this.getBinding(a)},this.isBindingVisible=function(a){var b=Application.isOperational;if(1==b){var c=new Crawler;c.type=NodeCrawler.TYPE_ASCENDING,c.id="visibilitycrawler",c.addFilter(function(a){var c=UserInterface.getBinding(a),d=0;return c.isVisible||(b=!1,d=NodeCrawler.STOP_CRAWLING),d}),c.crawl(a.bindingElement),c.dispose()}return b};var f=null;this.getBindingCount=function(){var a=0;for(var b in e)a++;return a},this.setPoint=function(){f={};for(var a in e)f[a]=!0},this.getPoint=function(){var a=null;if(f){a=new List;for(var b in e)f[b]||a.add(b)}return a},this.clearPoint=function(){f=null},this.trackUndisposedBindings=function(){var a=null;for(var b in e){var c=e[b];c.binding&&c.element&&Binding.exists(c.binding)||(a||(a="Bindings illdisposed: "),a+=c.binding+" ")}null!=a&&d.error(a)},this.autoTrackDisposedBindings=function(a){a?window.disposedbindingtrackinterval||(window.disposedbindingtrackinterval=window.setInterval(UserInterface.trackUndisposedBindings,1e4),
this.trackUndisposedBindings()):window.disposedbindingtrackinterval&&(window.clearInterval(window.disposedbindingtrackinterval),window.disposedbindingtrackinterval=null)}};SOAPMessage.prototype={document:null,envelope:null,header:null,body:null,fault:null},SOAPRequest.prototype=new SOAPMessage,SOAPRequest.prototype.constructor=SOAPRequest,SOAPRequest.superclass=SOAPMessage.prototype,SOAPRequest.resolver=new XPathResolver,SOAPRequest.resolver.setNamespacePrefixResolver({soap:Constants.NS_ENVELOPE,xhtml:Constants.NS_XHTML}),SOAPRequest.newInstance=function(a,b){var c=a+"/"+b,d=new SOAPRequest(c),e=SOAPRequest.resolver;return d.document=Templates.getTemplateDocument("soapenvelope.xml"),d.envelope=e.resolve("soap:Envelope",d.document),d.header=e.resolve("soap:Header",d.envelope),d.body=e.resolve("soap:Body",d.envelope),d},SOAPRequest._parseResponse=function(a){var b=null,c=!1,d=a.responseXML;if(null!=d&&null!=d.documentElement)switch(d.documentElement.namespaceURI){case Constants.NS_ENVELOPE:b=SOAPRequestResponse.newInstance(a.responseXML),Application.isOffLine&&EventBroadcaster.broadcast(BroadcastMessages.SERVER_ONLINE);break;case Constants.NS_XHTML:if(!Application.isOffLine){var e=SOAPRequest.resolver.resolve("xhtml:html/xhtml:body",a.responseXML);e&&"offline"==e.getAttribute("id")&&(c=!0)}break;case Constants.NS_DOMPARSEERROR:var f=DOMSerializer.serialize(d);SystemLogger.getLogger("SOAPRequest._parseResponse (static)").error(f),Application.isDeveloperMode&&alert("SOAPRequest parseerror! \n\n"+f);break;default:Application.isDeveloperMode&&alert("SOAPRequest: "+d.documentElement.namespaceURI)}else if(!Application.isOffLine&&!Application.isLoggedOut){var g=a.responseText;if(503==a.status||g.indexOf('id="offline"')>-1)c=!0;else if(403==a.status){if(Application.isLoggedIn){Application.isLoggedIn=!1;var h="Warning",g="You have been logged out";Dialog.warning(h,g,Dialog.BUTTONS_ACCEPT,{handleDialogResponse:function(a){window.location.reload()}})}}else{var f="Invalid SOAP response: \n\n"+a.responseText;SystemLogger.getLogger("SOAPRequest._parseResponse (static)").error(f),Application.isDeveloperMode&&(alert("Invalid SOAP response"),window.open("about:blank").document.write(a.responseText))}}return 1==c&&EventBroadcaster.broadcast(BroadcastMessages.SERVER_OFFLINE),b},SOAPRequest.prototype.invoke=function(a){var b=DOMUtil.getXMLHTTPRequest(),c=null;b.open("post",a,!1),b.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),b.setRequestHeader("SOAPAction",this.action);try{b.send(this.document),c=SOAPRequest._parseResponse(b)}catch(b){var d="Dysfuntion in SOAP invoke: "+a;throw null!=this.document&&(d+="\n"+DOMSerializer.serialize(this.document,!0)),this.logger.error(d),b}return b=null,c},SOAPRequest.prototype.asyncInvoke=function(a,b){var c=DOMUtil.getXMLHTTPRequest();c.open("post",a,!0),c.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),c.setRequestHeader("SOAPAction",this.action),c.onreadystatechange=function(){if(4==c.readyState){var a=SOAPRequest._parseResponse(c);b(a),c=null}},c.send(this.document)},SOAPRequest.prototype.dispose=function(){for(var a in this)this[a]=null},SOAPRequestResponse.prototype=new SOAPMessage,SOAPRequestResponse.prototype.constructor=SOAPRequestResponse,SOAPRequestResponse.superclass=SOAPMessage.prototype,SOAPRequestResponse.logger=SystemLogger.getLogger("SOAPRequestResponse"),SOAPRequestResponse.resolver=new XPathResolver,SOAPRequestResponse.resolver.setNamespacePrefixResolver({soap:Constants.NS_ENVELOPE}),SOAPRequestResponse.newInstance=function(a){var b=null;if(a&&a.documentElement){b=new SOAPRequestResponse;var c=SOAPRequestResponse.resolver;b.document=a,b.envelope=c.resolve("soap:Envelope",b.document),b.header=c.resolve("soap:Header",b.envelope),b.body=c.resolve("soap:Body",b.envelope);var d=c.resolve("soap:Fault",b.body);d&&(SOAPRequestResponse.logger.fatal(DOMSerializer.serialize(d,!0)),b.fault={element:d,faultNamespaceURI:d.namespaceURI,faultCode:DOMUtil.getTextContent(c.resolve("faultcode",d)),faultString:DOMUtil.getTextContent(c.resolve("faultstring",d)),detail:d.getElementsByTagName("detail").item(0)})}return b},SOAPFault.prototype.getOperationName=function(){return this._operationName},SOAPFault.prototype.getOperationAddress=function(){return this._operationAddress},SOAPFault.prototype.getFaultString=function(){return this._faultString},SOAPFault.newInstance=function(a,b){return new SOAPFault(a.name,a.address,b.faultString)},SOAPEncoder.prototype.encode=function(a){for(var b=SOAPRequest.newInstance(this._namespace,this._operation),c=this._appendElement(b.body,this._operation),d=this._wsdl.getSchema(),e=d.lookup(this._operation),f=e.getListedDefinitions();f.hasNext();){var g=f.getNext(),h=this._appendElement(c,g.name),i=a.getNext();this._resolve(h,g,i)}return b},SOAPEncoder.prototype._resolve=function(a,b,c){var d=this._wsdl.getSchema();if(b.isSimpleValue)this._appendText(a,c,"string"==b.type);else{var e=d.lookup(b.type);if(e instanceof SchemaSimpleType)alert("SOAPEncoder: SchemaSimpleType support not implemented!");else{var f=e.getListedDefinitions();if(e.isArray)for(var g=new List(c),h=f.getNext();g.hasNext();){var i=this._appendElement(a,h.name),j=g.getNext();this._resolve(i,h,j)}else if("undefined"==typeof c)this.logger.error("SOAPEncoder: value is undefined");else for(;f.hasNext();)try{var h=f.getNext(),i=this._appendElement(a,h.name),j=c[h.name];this._resolve(i,h,j)}catch(a){this.logger.error("Mysterius malfunction in "+this._operation+":\n\n"+h.name+": "+c)}}}},SOAPEncoder.prototype._appendElement=function(a,b){var c=DOMUtil.createElementNS(this._namespace,b,a.ownerDocument);return a.appendChild(c),c},SOAPEncoder.prototype._appendText=function(a,b,c){if(null!=b){b=new String(b);for(var d,e=new String(""),f=b.split(""),g=!1,h=0;d=f[h++];){var i=!0,j=d.charCodeAt(0);switch(j){case 9:case 10:case 13:i=!1;break;default:(j>=32&&55295>=j||j>=57344&&65533>=j||j>=65536&&1114111>=j)&&(i=!1)}i?g=!0:e+=d}g&&this.logger.debug("Illegal XML character(s) was deleted from the string: "+b),a.appendChild(a.ownerDocument.createTextNode(e))}},SOAPDecoder.prototype.resolve=function(a,b){return this._resolver.resolve("result:"+a,b)},SOAPDecoder.prototype.resolveAll=function(a,b){return this._resolver.resolveAll("result:"+a,b)},SOAPDecoder.prototype.decode=function(a){for(var b=null,c=this._wsdl.getSchema(),d=this._operation+"Response",e=this.resolve(d,a.body),f=c.lookup(d),g=f.getListedDefinitions();!b&&g.hasNext();){var h=g.getNext(),i=this.resolve(h.name,e);if(h.type==SchemaDefinition.TYPE_XML_DOCUMENT){b=DOMUtil.getDOMDocument();var j=i.getElementsByTagName("*").item(0);b.appendChild(b.importNode(j,!0))}else b=this._compute(i,h)}return b},SOAPDecoder.prototype._compute=function(a,b){var c=null,d=this._wsdl.getSchema();if(b.isSimpleValue)c=this._getSimpleValue(a,b.type);else{var e=d.lookup(b.type);if(e instanceof SchemaSimpleType)c=this._getSimpleValue(a,e.restrictionType);else{var f=e.getListedDefinitions();if(e.isArray){c=[];for(var g=f.getNext(),h=this.resolveAll(g.type,a);h.hasNext();){var i=h.getNext();c.push(this._compute(i,g))}}else if(null==a)c=null;else for(c={},f.reset();f.hasNext();){var g=f.getNext(),i=this.resolve(g.name,a);if(i)c[g.name]=this._compute(i,g);else if(g.isRequired)throw new Error("SOAPDecoder: invalid SOAP response.")}}}return c},SOAPDecoder.prototype._getSimpleValue=function(a,b){var c=null;if(null!=a&&a.firstChild&&a.firstChild.nodeType==Node.TEXT_NODE)switch(Client.isMozilla&&a.childNodes.length>1&&a.normalize(),c=a.firstChild.data,b){case Schema.types.STRING:c=c;break;case Schema.types.INT:case Schema.types.FLOAT:case Schema.types.DOUBLE:c=Number(c);break;case Schema.types.BOOLEAN:c="true"==c;break;default:throw'SOAPDecoder: schema type "'+b+'" not handled.'}return c},Schema.prototype=new XPathResolver,Schema.prototype.constructor=Schema,Schema.superclass=XPathResolver.prototype,Schema.types={STRING:"string",INT:"int",FLOAT:"float",DOUBLE:"double",BOOLEAN:"boolean"},Schema.notSupportedException=new Error("Schema: Schema structure not supported!"),Schema.prototype._parseSchema=function(a){this.setNamespacePrefixResolver({wsdl:Constants.NS_WSDL,soap:Constants.NS_SOAP,s:Constants.NS_SCHEMA});for(var b={},c=null,d=this.resolveAll("s:*[@name]",a);d.hasNext();){var e=d.getNext();switch(DOMUtil.getLocalName(e)){case"element":c=new SchemaElementType(this,e);break;case"complexType":c=new SchemaComplexType(this,e);break;case"simpleType":c=new SchemaSimpleType(this,e)}b[e.getAttribute("name")]=c}return b},Schema.prototype.lookup=function(a){return this._map[a]},SchemaDefinition.TYPE_XML_DOCUMENT="xmldocument",SchemaDefinition.prototype._parse=function(a){var b=a.getAttribute("minOccurs"),c=(a.getAttribute("maxOccurs"),a.getAttribute("type"));if(this.name=a.getAttribute("name"),this.isRequired="0"!=b,c){var d=c.split(":"),e=d[0],f=d[1];this.isSimpleValue="tns"!=e,this.type=f}else{var g=a.getElementsByTagName("*").item(0);g&&"complexType"==DOMUtil.getLocalName(g)&&"true"==g.getAttribute("mixed")&&(g=g.getElementsByTagName("*").item(0),g&&"sequence"==DOMUtil.getLocalName(g)&&(g=g.getElementsByTagName("*").item(0),"any"==DOMUtil.getLocalName(g)&&(this.type=SchemaDefinition.TYPE_XML_DOCUMENT)))}},SchemaType.prototype={},SchemaElementType.prototype=new SchemaType,SchemaElementType.prototype.constructor=SchemaElementType,SchemaElementType.superclass=SchemaType.prototype,SchemaElementType.prototype._parseListedDefinitions=function(a,b){var c=a.resolveAll("s:complexType/s:sequence/s:element",b);if(!c.hasEntries())throw this.logger.warn("SchemaElementType: Unparsed SchemaDefinition encountered."),Schema.notSupportedException;for(;c.hasNext();)this._definitions.add(new SchemaDefinition(c.getNext()))},SchemaElementType.prototype.getListedDefinitions=function(){return this._definitions.copy()},SchemaComplexType.prototype=new SchemaType,SchemaComplexType.prototype.constructor=SchemaComplexType,SchemaComplexType.superclass=SchemaType.prototype,SchemaComplexType.prototype._parseListedDefinitions=function(a,b){var c=a.resolveAll("s:sequence/s:element",b);if(!c.hasEntries())throw Schema.notSupportedException;for(;c.hasNext();){var d=c.getNext();this._definitions.add(new SchemaDefinition(d))}},SchemaComplexType.prototype.getListedDefinitions=function(){return this._definitions.copy()},SchemaSimpleType.prototype=new SchemaType,SchemaSimpleType.prototype.constructor=SchemaSimpleType,SchemaSimpleType.superclass=SchemaType.prototype,SchemaSimpleType.prototype._parse=function(a,b){var c=a.resolve("s:restriction",b);if(!c)throw Schema.notSupportedException;this.restrictionType=c.getAttribute("base").split(":")[1]},WebServiceResolver.prototype=new XPathResolver,WebServiceResolver.prototype.constructor=WebServiceResolver,WebServiceResolver.superclass=XPathResolver.prototype,WebServiceResolver.prototype._getDocumentElement=function(a){var b=null,c=DOMUtil.getXMLHTTPRequest();if(c.open("get",a,!1),c.send(null),!c.responseXML)throw alert(c.responseText),new Error("WebServiceResolver: Could not read WSDL: "+a);return b=c.responseXML.documentElement},WebServiceResolver.prototype.getPortAddress=function(){return this._WSDLURL.split("?WSDL")[0]},WebServiceResolver.prototype.getTargetNamespace=function(){return this._root.getAttribute("targetNamespace")},WebServiceResolver.prototype.getOperations=function(){var a=new List,b=this.resolveAll("wsdl:portType/wsdl:operation",this._root);if(!b.hasEntries())throw new Error("WebServiceResolver: No portType found.");for(;b.hasNext();){var c=b.getNext(),d=c.getAttribute("name");a.add(new WebServiceOperation(d,this.getPortAddress(),new SOAPEncoder(this,d),new SOAPDecoder(this,d)))}return a},WebServiceResolver.prototype.getSchema=function(){return this._schema},WebServiceOperation.prototype={name:null,address:null,encoder:null,decoder:null},WebServiceProxy.isLoggingEnabled=!0,WebServiceProxy.isDOMResult=!1,WebServiceProxy.isFaultHandler=!0,WebServiceProxy.createProxy=function(a){var b=new WebServiceResolver(a),c=new WebServiceProxy,d=b.getOperations();return d.each(function(a){c[a.name]=WebServiceProxy.createProxyOperation(a)}),c},WebServiceProxy.prototype._log=function(a,b){if(WebServiceProxy.isLoggingEnabled&&Application.isDeveloperMode&&b){var c=b instanceof SOAPRequest?"SOAPRequest for ":"SOAPResponse from ";c+=a.address+": "+a.name+"\n\n",c+=DOMSerializer.serialize(b.document,!0),this.logger.fine(c)}},WebServiceProxy.createProxyOperation=function(a){return function(){var b=new List(arguments),c=null;if("function"!=typeof b.getLast()){var d=a.encoder.encode(new List(arguments));this._log(a,d);var e=d.invoke(a.address);return this._log(a,e),e&&(e.fault?(c=SOAPFault.newInstance(a,e.fault),WebServiceProxy.isFaultHandler&&WebServiceProxy.handleFault(c,d,e)):c=WebServiceProxy.isDOMResult?e.document:a.decoder.decode(e)),d.dispose(),c}var f=b.extractLast(),d=a.encoder.encode(b);this._log(a,d);var g=this,e=d.asyncInvoke(a.address,function(b){g._log(a,b),b&&(b.fault?(c=SOAPFault.newInstance(a,b.fault),WebServiceProxy.isFaultHandler&&WebServiceProxy.handleFault(c,d,b)):c=WebServiceProxy.isDOMResult?b.document:a.decoder.decode(b)),d.dispose(),f(c)})}},WebServiceProxy.handleFault=function(a,b,c){try{Dialog.invokeModal(Dialog.URL_SERVICEFAULT,null,{soapFault:a,soapRequest:b,soapResponse:c})}catch(b){alert(a.getFaultString())}};var ConfigurationService=null,ConsoleMessageQueueService=null,EditorConfigurationService=null,FlowControllerService=null,InstallationService=null,LocalizationService=null,LoginService=null,MarkupFormatService=null,PageService=null,ReadyService=null,SecurityService=null,SEOService=null,SourceValidationService=null,StringService=null,TreeService=null,XhtmlTransformationsService=null,FunctionService=null;window.MessageQueue=new function(){function a(){EventBroadcaster.broadcast(BroadcastMessages.MESSAGEQUEUE_EVALUATED,t)}function b(a){var b=a.Level.toLowerCase();SystemLogger.getLogger(a.SenderId)[b](a.Message)}function c(a){var b=l(a.Argument);if(b.hasEntries()){var c=ViewDefinition.clone("Composite.Management.PostBackView",a.ViewId);c.entityToken=a.EntityToken,c.flowHandle=a.FlowHandle,c.position=w[a.ViewType],c.label=a.Label,c.image=a.Image,c.toolTip=a.ToolTip,c.argument={url:a.Url,list:b},StageBinding.presentViewDefinition(c)}else StageBinding.presentViewDefinition(new HostedViewDefinition({handle:a.ViewId,entityToken:a.EntityToken,flowHandle:a.FlowHandle,position:w[a.ViewType],url:a.Url,label:a.Label,image:a.Image,toolTip:a.ToolTip}))}function d(a){StageBinding.presentViewDefinition(new DialogViewDefinition({handle:a.ViewId,flowHandle:a.FlowHandle,position:Dialog.MODAL,url:a.Url,handler:{handleDialogResponse:function(){setTimeout(function(){MessageQueue._nextAction()},250)}}}))}function e(a){var b=a.DialogType.toLowerCase();if("question"==b)throw"Not supported!";Dialog[b](a.Title,a.Message,null,{handleDialogResponse:function(){setTimeout(function(){MessageQueue._nextAction()},250)}})}function f(a){var b={},c=!1;new List(a.Argument).each(function(a){b[a.Key]=a.Value,c=!0});var d=ViewDefinitions[a.Handle];if(null==d)throw"Unknown ViewDefinition: "+param.Handle;var e=null;if(0==d.isMutable)e=d;else{e=new HostedViewDefinition;for(var f in d)e[f]=d[f];e.handle=a.ViewId}e.argument=c?b:null,StageBinding.presentViewDefinition(e)}function g(a){var b=ViewDefinition.clone("Composite.Management.GenericView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.argument={url:a.Url,list:l(a.UrlPostArguments)},StageBinding.presentViewDefinition(b)}function h(a){var b=ViewDefinition.clone("Composite.Management.ExternalView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.url=a.Url,StageBinding.presentViewDefinition(b)}function i(a){try{var b=ViewDefinition.clone("Composite.Management.SlideView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.url=a.Url,StageBinding.presentViewDefinition(b)}catch(a){}}function j(a){StageBinding.isViewOpen(a.ViewId)?EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEW,a.ViewId):MessageQueue._nextAction()}function k(a){EventBroadcaster.broadcast(BroadcastMessages.CURRENT_SAVED,{handle:a.ViewId,isSuccess:a.Succeeded})}function l(a){var b=new List;return new List(a).each(function(a){b.add({name:a.Key,value:a.Value})}),b}this.INTERVAL_ONLINE=5e3,this.INTERVAL_OFFLINE=1e3,this._actions=new List,this._index={},this.index=0;var m=SystemLogger.getLogger("MessageQueue"),n=null,o=0,p=null,q=new Map,r=new Map,s=!1,t=!1,u=!1,v=!1,w={Main:DockBinding.MAIN,External:DockBinding.EXTERNAL,BottomLeft:DockBinding.BOTTOMLEFT,BottomRight:DockBinding.BOTTOMRIGHT,RightTop:DockBinding.RIGHTTOP,RightBottom:DockBinding.RIGHTBOTTOM,AbsBottomLeft:DockBinding.ABSBOTTOMLEFT,AbsBottomRight:DockBinding.ABSBOTTOMRIGHT,Slide:DockBinding.SLIDE};this.initialize=function(){n=ConsoleMessageQueueService,o=n.GetCurrentSequenceNumber("dummyparam!"),this.index=o,EventBroadcaster.subscribe(BroadcastMessages.VIEW_COMPLETED,this),EventBroadcaster.subscribe(BroadcastMessages.VIEW_CLOSED,this),EventBroadcaster.subscribe(BroadcastMessages.SERVER_OFFLINE,this),EventBroadcaster.subscribe(BroadcastMessages.SERVER_ONLINE,this),window.messageQueueInterval=window.setInterval(MessageQueue._autoupdate,MessageQueue.INTERVAL_ONLINE)},this._autoupdate=function(){if(!s&&!MessageQueue._actions.hasEntries()){var a=WebServiceProxy.isLoggingEnabled;Application.isLoggedIn&&(t=!0,WebServiceProxy.isLoggingEnabled=!1,MessageQueue.update(),WebServiceProxy.isLoggingEnabled=a,t=!1)}},this._pokeserver=function(){1==s&&ReadyService.IsServerReady(!0)&&MessageQueue._lockSystem(!1)},this.update=function(a){Application.isLoggedIn&&(EventBroadcaster.broadcast(BroadcastMessages.MESSAGEQUEUE_REQUESTED,t),this._updateMessages(a))},this._updateMessages=function(b){if(u)v=!0;else{u=!0;var c=this,d=function(b){if(null!=b)if(Types.isDefined(b.CurrentSequenceNumber)){var d=b.CurrentSequenceNumber;d<c.index&&m.debug("SERVER WAS RESTARTED! old messagequeue index: "+c.index+", new messagequeue index: "+d),c.index=d;var e=new List(b.ConsoleActions);e.hasEntries()?c.evaluate(e):c._actions.hasEntries()||a()}else m.error("No sequencenumber in MessageQueue response!");u=!1,v&&(v=!1,c._updateMessages())};b?d(n.GetMessages(Application.CONSOLE_ID,this.index)):n.GetMessages(Application.CONSOLE_ID,this.index,d)}},this.evaluate=function(a){var b=new List;a.hasEntries()&&(a.each(function(a){1!=this._index[a.Id]&&b.add(a),this._index[a.Id]=!0},this),b.hasEntries()&&(this._actions.hasEntries()?this._actions.merge(b):this._actions=b,this._nextAction()))},this._closeAllViews=function(a){var b="(No reason)";null!=a&&(b=a.Reason);var c="Warning",d='The server has requested a close of all active editors for the following reason: "${reason}". It is recommended that you accept this request by clicking OK.';d=d.replace("${reason}",b);var e=this;Dialog.warning(c,d,Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(a){a==Dialog.RESPONSE_ACCEPT&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),e._nextAction()}})},this._nextAction=function(){var l=null;if(this._actions.hasEntries()){var n=this._actions.extractFirst();switch(o=n.SequenceNumber,m.debug("MessageQueue action: "+n.ActionType+" > QUEUE-MAX-SEQNUM: "+this.index+" > CURRENT SEQNUM: "+o+" > ACTIONS-LEFT: "+this._actions.getLength()),n.ActionType){case"OpenView":l=n.OpenViewParams,"ModalDialog"==l.ViewType?d(l):(p=l.ViewId,c(l));break;case"CloseView":l=n.CloseViewParams,p=l.ViewId,j(l);break;case"RefreshTree":EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,n.RefreshTreeParams.EntityToken);var r="REFRESHING TREES: "+q.countEntries()+"\n";q.each(function(a){r+="\n	TOKEN: "+a}),m.debug(r),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),this._nextAction());break;case"SelectElement":var s=n.SelectElementParams.PerspectiveElementKey;if(s&&s!=StageBinding.getSelectionHandle()){var t={handleBroadcast:function(a,b){switch(a){case BroadcastMessages.STAGEDECK_CHANGED:b==s&&(StageBinding.selectBrowserTab(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_FOCUS,n.SelectElementParams.EntityToken),EventBroadcaster.unsubscribe(BroadcastMessages.STAGEDECK_CHANGED,this))}}};EventBroadcaster.subscribe(BroadcastMessages.STAGEDECK_CHANGED,t),StageBinding.setSelectionByHandle(s)}else EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_FOCUS,n.SelectElementParams.EntityToken);this._nextAction();break;case"MessageBox":e(n.MessageBoxParams);break;case"OpenViewDefinition":l=n.OpenViewDefinitionParams,p=l.Handle,f(l);break;case"LogEntry":b(n.LogEntryParams),this._nextAction();break;case"Reboot":Application.reload(!0);break;case"LockSystem":MessageQueue._lockSystem(!0);break;case"BroadcastMessage":l=n.BroadcastMessageParams,m.debug('Server says: EventBroadcaster.broadcast ( "'+l.Name+'", '+l.Value+" )"),EventBroadcaster.broadcast(l.Name,l.Value),this._nextAction();break;case"CollapseAndRefresh":EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),this._nextAction());break;case"CloseAllViews":this._closeAllViews(n.CloseAllViewsParams);break;case"SaveStatus":k(n.SaveStatusParams),this._nextAction();break;case"DownloadFile":Download.init(n.DownloadFileParams.Url),this._nextAction();break;case"ExpandTreeNode":this._nextAction();break;case"BindEntityTokenToView":l=n.BindEntityTokenToViewParams,EventBroadcaster.broadcast(BroadcastMessages.BIND_TOKEN_TO_VIEW,{handle:l.ViewId,entityToken:l.EntityToken}),this._nextAction();break;case"OpenGenericView":l=n.OpenGenericViewParams,g(l);break;case"OpenExternalView":l=n.OpenExternalViewParams,h(l);break;case"OpenSlideView":l=n.OpenSlideViewParams,i(l);break;default:Dialog.error("Dysfunction","Unhandled action: "+n.ActionType)}}else a()},this._lockSystem=function(a){var b=top.bindingMap.offlinetheatre;if(a)b.play(!0),window.clearInterval(window.messageQueueInterval),window.messageQueueInterval=window.setInterval(MessageQueue._pokeserver,MessageQueue.INTERVAL_OFFLINE);else{b.stop(),window.clearInterval(window.messageQueueInterval),window.messageQueueInterval=window.setInterval(MessageQueue._autoupdate,MessageQueue.INTERVAL_ONLINE);var c=this;setTimeout(function(){c._actions.hasEntries()&&c._nextAction()},0)}s=a},this.placeConsoleCommand=function(a){n.PlaceConsoleCommand(Application.CONSOLE_ID,a)},this.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.APPLICATION_LOGIN:this.initialize();break;case BroadcastMessages.VIEW_COMPLETED:case BroadcastMessages.VIEW_CLOSED:null!=p&&b==p&&(p=null,this._nextAction());break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHING:null!=b?q.set(b,!0):m.debug("Saa har vi balladen!");break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHED:q.hasEntries()&&(q.del(b),m.debug("Refreshed tree: "+b+"\n("+q.countEntries()+" trees left!)"),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),setTimeout(function(){MessageQueue._nextAction()},0)));break;case BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN:r.set(b,!0);break;case BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN:1==r.hasEntries()&&(r.del(b),r.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN,this),MessageQueue._nextAction()));break;case BroadcastMessages.SERVER_OFFLINE:MessageQueue._lockSystem(!0);break;case BroadcastMessages.SERVER_ONLINE:MessageQueue._lockSystem(!1)}},EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,this)};var ViewDefinitions={"Composite.Management.Null":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.Null"}),"Composite.Management.PostBackDialog":new DialogViewDefinition({handle:"Composite.Management.PostBackDialog",isMutable:!0,position:Dialog.MODAL,url:"${root}/content/dialogs/postback/postbackdialog.aspx",argument:{url:null,list:null}}),"Composite.Management.PostBackView":new HostedViewDefinition({handle:"Composite.Management.PostBackView",isMutable:!0,position:DockBinding.MAIN,url:"${root}/postback.aspx",argument:{url:null,list:null}}),"Composite.Management.GenericView":new HostedViewDefinition({handle:"Composite.Management.GenericView",isMutable:!0,position:DockBinding.MAIN,url:"${root}/content/views/generic/generic.aspx",label:null,image:null,toolTip:null,argument:{url:null,list:null}}),"Composite.Management.ExternalView":new HostedViewDefinition({handle:"Composite.Management.ExternalView",isMutable:!0,position:DockBinding.EXTERNAL,url:null,label:null,image:null,toolTip:null}),"Composite.Management.SlideView":new HostedViewDefinition({handle:"Composite.Management.SlideView",isMutable:!0,position:DockBinding.SLIDE,url:null,label:null,image:null,toolTip:null}),"Composite.Management.Start":new HostedViewDefinition({handle:"Composite.Management.Start",position:DockBinding.START,label:"Welcome Travellers",isFloating:!1,url:"${root}/content/views/start/start.aspx"}),"Composite.Management.About":new DialogViewDefinition({handle:"Composite.Management.About",position:Dialog.MODAL,url:"${root}/content/dialogs/about/about.aspx"}),"Composite.Management.PermissionEditor":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.PermissionEditor",position:DockBinding.MAIN,url:"${root}/content/views/editors/permissioneditor/permissioneditor.aspx",argument:{serializedEntityToken:"entityTokenType='Composite\\.Plugins\\.Elements\\.ElementProviders\\.VirtualElementProvider\\.VirtualElementProviderEntityToken,Composite'entityToken='_EntityToken_Type_=\\'Composite\\\\\\.Plugins\\\\\\.Elements\\\\\\.ElementProviders\\\\\\.VirtualElementProvider\\\\\\.VirtualElementProviderEntityToken,Composite\\'_EntityToken_Source_=\\'VirtualElementProvider\\'_EntityToken_Id_=\\'DesignPerspective\\''\""}}),"Composite.Management.SystemLog":new HostedViewDefinition({handle:"Composite.Management.SystemLog",position:DockBinding.ABSBOTTOMLEFT,label:"System Log",url:"${root}/content/views/dev/systemlog/systemlog.aspx"}),"Composite.Management.Developer":new HostedViewDefinition({handle:"Composite.Management.Developer",position:DockBinding.ABSBOTTOMRIGHT,label:"Developer",url:"${root}/content/views/dev/developer/developer.aspx"}),"Composite.Management.IconPack.SpriteSVG":new HostedViewDefinition({handle:"Composite.Management.IconPack.SpriteSVG",position:DockBinding.MAIN,label:"Sprite SVG",image:"${icon:icon}",url:"${root}/content/views/dev/icons/svg/sprite.cshtml"}),"Composite.Management.Options":new DialogViewDefinition({handle:"Composite.Management.Options",position:Dialog.MODAL,url:"${root}/content/dialogs/options/options.aspx",label:"Options"}),"Composite.Management.VisualEditorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.VisualEditorDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/wysiwygeditor/wysiwygeditordialog.aspx",width:1280,height:800,argument:{formattingconfiguration:null,embedablefieldstypenames:null}}),"Composite.Management.MultiSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.MultiSelectorDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/multiselector/multiselectordialog.aspx"}),"Composite.Management.Search":new HostedViewDefinition({handle:"Composite.Management.Search",position:DockBinding.RIGHTBOTTOM,url:"${root}/content/views/search/search.aspx",label:"Search",image:"${icon:view_search}",argument:null}),"Composite.Management.Browser":new HostedViewDefinition({isMutable:!1,isPinned:!0,handle:"Composite.Management.Browser",position:DockBinding.MAIN,perspective:ExplorerBinding.PERSPECTIVE_CONTENT,label:"${string:Composite.Management:Browser.Label}",image:"${icon:page-view-administrated-scope}",toolTip:"${string:Composite.Management:Browser.ToolTip}",url:"${root}/content/views/browser/browser.aspx",argument:{URL:null}}),"Composite.Management.SEOAssistant":new HostedViewDefinition({handle:"Composite.Management.SEOAssistant",position:DockBinding.ABSBOTTOMRIGHT,perspective:ExplorerBinding.PERSPECTIVE_CONTENT,url:"${root}/content/views/seoassist/seoassist.aspx",label:"${string:Composite.Web.SEOAssistant:SEOAssistant}",image:"${icon:seoassistant}",toolTip:"${string:Composite.Web.SEOAssistant:SEOAssistant.ToolTip}"}),"Composite.Management.SourceCodeViewer":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.SourceCodeViewer",position:DockBinding.ABSBOTTOMLEFT,url:"${root}/content/views/dev/viewsource/viewsource.aspx",argument:{action:null,viewBinding:null}}),"Composite.User.SourceCodeViewer":new HostedViewDefinition({isMutable:!0,handle:"Composite.User.SourceCodeViewer",position:DockBinding.BOTTOMLEFT,url:"${root}/content/views/dev/viewsource/viewsource.aspx",argument:{action:null,viewBinding:null}}),"Composite.Management.Help":new HostedViewDefinition({label:"${string:Website.App.LabelHelp}",image:"${icon:help}",handle:"Composite.Management.Help",position:DockBinding.ABSRIGHTTOP,url:"${root}/content/views/help/help.aspx"}),"Composite.Management.Dialog.Translations":new DialogViewDefinition({handle:"Composite.Management.TranslationsDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/translations/translations.aspx",label:"Translations",image:"${icon:users-changepublicculture}"}),"Composite.Management.ImageSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.ImageSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_IMAGESELECTOR,argument:{label:"${string:Composite.Management:Website.Image.SelectDialog.Title}",image:"${icon:image}",selectionProperty:"ElementType",selectionValue:"image/jpeg image/gif image/png image/bmp image/tiff image/svg+xml",selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider",search:"MediaFileElementProvider.WebImages"}]}}),"Composite.Management.MediaWritableFolderSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.MediaWritableFolderSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.Folder.SelectDialog.Title}",image:"${icon:image}",selectionProperty:"ReadOnly",selectionValue:"False",selectionResult:"EntityToken",actionGroup:"Folder",nodes:[{key:"MediaFileElementProvider",search:"MediaFileElementProvider.WritableFolders"}]}}),"Composite.Management.EmbeddableMediaSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.EmbeddableMediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.Media.SelectDialog.Title}",image:"${icon:media}",selectionProperty:"ElementType",selectionValue:null,selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider",search:null}]}}),"Composite.Management.FrontendFileSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.EmbeddableMediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.FrontendFile.SelectDialog.Title}",image:"${icon:media}",selectionProperty:"ElementType",selectionValue:null,selectionResult:"Uri",nodes:[{key:"LayoutFileElementProvider"}]}}),"Composite.Management.PageSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.PageSelectorDialog",
position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Page.SelectDialog.Title}",image:"${icon:page}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",hasPreview:!0,nodes:[{key:"PageElementProvider"}]}}),"Composite.Management.PageIdSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.PageIdSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Page.SelectDialog.Title}",image:"${icon:page}",selectionProperty:"DataId",selectionValue:null,selectionResult:"DataId",nodes:[{key:"PageElementProvider"}]}}),"Composite.Management.LinkableSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.LinkableSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.ContentLink.SelectDialog.Title}",image:"${icon:link}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",hasPreview:!0,nodes:[{key:"PageElementProvider"},{key:"MediaFileElementProvider"}]}}),"Composite.Management.MediaSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.MediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.ContentLink.SelectDialog.Title}",image:"${icon:link}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider"}]}}),"Composite.Management.FunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.FunctionSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Function.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllFunctionsElementProvider"}]}}),"Composite.Management.WidgetFunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.WidgetFunctionSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Widget.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllWidgetFunctionsElementProvider"}]}}),"Composite.Management.XhtmlDocumentFunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.XhtmlDocumentFunctionSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Function.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllFunctionsElementProvider",search:"AllFunctionsElementProvider.VisualEditorFunctions"}]}})},KickStart=new function(){function a(a){new List([BroadcastMessages.PERSISTANCE_INITIALIZED,BroadcastMessages.APPLICATION_STARTUP,BroadcastMessages.APPLICATION_LOGIN,BroadcastMessages.APPLICATION_OPERATIONAL]).each(function(b){a?EventBroadcaster.subscribe(b,KickStart):EventBroadcaster.unsubscribe(b,KickStart)})}function b(a){switch(a){case BroadcastMessages.PERSISTANCE_INITIALIZED:j=!0}j&&(null!=bindingMap.decks&&LoginService.IsLoggedIn(!0)?g():null!=bindingMap.decks?e():d()),c()}function c(){for(var a=document.getElementsByClassName("js-applicationname"),b=0;b<a.length;++b)a[b].innerHTML=Installation.applicationName}function d(){Application.unlock(KickStart),null!=window.Welcome&&Welcome.test()}function e(){EventBroadcaster.subscribe(BroadcastMessages.KEY_ENTER,KickStart),Application.unlock(KickStart),bindingMap.decks.select("logindeck"),setTimeout(function(){Application.isLocalHost&&((Application.isDeveloperMode||Client.isPerformanceTest)&&(DataManager.getDataBinding("username").setValue(l),DataManager.getDataBinding("password").setValue(m)),Client.isPerformanceTest&&KickStart.login()),setTimeout(function(){DataManager.getDataBinding("username").focus()},250)},0)}function f(){setTimeout(function(){bindingMap.cover.hide(),a(!1),Application.unlock(KickStart)},PageBinding.TIMEOUT)}function g(){setTimeout(function(){null!=bindingMap.decks&&bindingMap.decks.select("loadingdeck"),setTimeout(function(){Application.login()},0)},0)}function h(){setTimeout(function(){Application.unlock(KickStart),null!=bindingMap.decks&&(bindingMap.decks.select("changepassworddeck"),bindingMap.cover.attachClassName("widesplash"),setTimeout(function(){var a=document.getElementById("passwordexpired");a.textContent=a.textContent.replace("{0}",Installation.passwordExpirationTimeInDays),DataManager.getDataBinding("usernameold").setValue(DataManager.getDataBinding("username").getResult()),DataManager.getDataBinding("passwordold").focus()},0))},25)}function i(){var a=DataManager.getDataBinding("username"),b=DataManager.getDataBinding("password");a.blur(),b.blur(),a.setValue(""),b.setValue(""),a.clean(),b.clean(),a.focus(),document.getElementById("loginerror").style.display="block";var c={handleAction:function(a){document.getElementById("loginerror").style.display="none",a.target.removeActionListener(Binding.ACTION_DIRTY,c)}};bindingMap.loginfields.addActionListener(Binding.ACTION_DIRTY,c)}var j=!1,k=Client.qualifies(),l="admin",m="123456";return k?(this.fireOnLoad=function(){Client.isPad&&Client.isOS7&&window.innerHeight!=document.documentElement.clientHeight&&(document.documentElement.style.height=window.innerHeight+"px"),Application.lock(this),a(!0),EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,this),SetupService=WebServiceProxy.createProxy(Constants.URL_WSDL_SETUPSERVICE),ReadyService=WebServiceProxy.createProxy(Constants.URL_WSDL_READYSERVICE),LoginService=WebServiceProxy.createProxy(Constants.URL_WSDL_LOGINSERVICE),InstallationService=WebServiceProxy.createProxy(Constants.URL_WSDL_INSTALLSERVICE),StringService=WebServiceProxy.createProxy(Constants.URL_WSDL_STRINGSERVICE),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_KICKSTART),setTimeout(function(){Persistance.initialize()},0)},this.justLogged=!1,this.handleBroadcast=function(a){switch(a){case BroadcastMessages.PERSISTANCE_INITIALIZED:b(a);break;case BroadcastMessages.APPLICATION_STARTUP:break;case BroadcastMessages.KEY_ENTER:if(null!=bindingMap.decks){var c=bindingMap.decks.getSelectedDeckBinding();if(null!=c)switch(c.getID()){case"logindeck":this.login();break;case"changepassworddeck":this.changePassword()}}break;case BroadcastMessages.APPLICATION_LOGIN:var d=window.bindingMap.appwindow;Client.isPad&&(d.bindingElement.style.borderLeft="1px solid #333"),d.setURL("app.aspx");break;case BroadcastMessages.APPLICATION_OPERATIONAL:f(),setTimeout(function(){StageBinding.bindingInstance.handleHash(window)},0);break;case BroadcastMessages.APPLICATION_SHUTDOWN:null!=bindingMap.decks&&bindingMap.decks.select("shutdowndeck"),bindingMap.cover.show()}},this.changePassword=function(){if(bindingMap.toppage.validateAllDataBindings()){var a=DataManager.getDataBinding("username").getResult(),b=DataManager.getDataBinding("passwordold").getResult(),c=DataManager.getDataBinding("passwordnew").getResult(),d=DataManager.getDataBinding("passwordnew2").getResult();if(c==d){var e=WebServiceProxy.isLoggingEnabled;WebServiceProxy.isLoggingEnabled=!1,WebServiceProxy.isFaultHandler=!1;var f=LoginService.ChangePassword(a,b,c);f instanceof SOAPFault?alert(f.getFaultString()):0==f.length?setTimeout(function(){top.window.location.reload(!0)},0):this.showPasswordErrors(f),WebServiceProxy.isFaultHandler=!0,e&&(WebServiceProxy.isLoggingEnabled=!0)}else this.showPasswordErrors([Resolver.resolve("${string:Composite.C1Console.Users:ChangePasswordForm.ConfirmationPasswordMimatch}")])}},this.showPasswordErrors=function(a){a=new List(a);var b=document.getElementById("passworderror");b.innerHTML="",a.each(function(a){var c=document.createElement("div");c.textContent=a,c.className="text-error text-sm",b.appendChild(c)}),b.style.display="block";var c={handleAction:function(a){document.getElementById("passworderror").style.display="none",a.target.removeActionListener(Binding.ACTION_DIRTY,c)}};bindingMap.passwordfields.addActionListener(Binding.ACTION_DIRTY,c),DataManager.getDataBinding("passwordold").clean(),DataManager.getDataBinding("passwordnew").clean(),DataManager.getDataBinding("passwordnew2").clean()},this.login=function(){Application.lock(KickStart),setTimeout(function(){bindingMap.toppage.validateAllDataBindings()?KickStart.doLogin(DataManager.getDataBinding("username").getResult(),DataManager.getDataBinding("password").getResult()):Application.unlock(KickStart)},25)},this.doLogin=function(a,b){var c=WebServiceProxy.isLoggingEnabled;WebServiceProxy.isLoggingEnabled=!1,WebServiceProxy.isFaultHandler=!1;var d=!1,e=!1,f=LoginService.ValidateAndLogin(a,b);f instanceof SOAPFault?alert(f.getFaultString()):("lockedAfterMaxAttempts"==f&&alert("The account was locked after maximum login attempts. Please contact administrator."),"lockedByAnAdministrator"==f&&alert("The account was locked by an administrator."),"passwordUpdateRequired"==f&&(e=!0),"success"==f&&(d=!0)),e?h():d?(EventBroadcaster.unsubscribe(BroadcastMessages.KEY_ENTER,KickStart),this.justLogged=!0,g()):(Application.unlock(KickStart),null!=bindingMap.decks&&i()),WebServiceProxy.isFaultHandler=!0,c&&(WebServiceProxy.isLoggingEnabled=!0)},WindowManager.fireOnLoad(this),void(k||(UpdateManager.isEnabled=!1))):void(document.location="unsupported.aspx")};SelectorButtonBinding.prototype=new SelectorBinding,SelectorButtonBinding.prototype.constructor=SelectorButtonBinding,SelectorButtonBinding.superclass=SelectorBinding.prototype,SelectorButtonBinding.prototype.toString=function(){return"[SelectorButtonBinding]"},SelectorButtonBinding.prototype.onBindingAttach=function(){SelectorButtonBinding.superclass.onBindingAttach.call(this),this.isSearchSelectionEnabled=!1},SelectorButtonBinding.prototype.handleBroadcast=function(a,b){SelectorButtonBinding.superclass.handleBroadcast.call(this,a,b)},SelectorButtonBinding.prototype.handleAction=function(a){a.type===ButtonBinding.ACTION_COMMAND&&this.isSingle?(this._selectionValue=this.singleValue,this.onValueChange()):SelectorButtonBinding.superclass.handleAction.call(this,a)},SelectorButtonBinding.prototype.dirty=function(){},SelectorButtonBinding.prototype.populateFromList=function(a){var b=null;a.each(function(a){if(!a.isSelected){if(null!=b)return b=null,!1;b=a}return!0},this),null!=b?(this.isSingle=!0,this._buttonBinding.setLabel(b.label),this.singleValue=b.value,this._buttonBinding.setPopup(),this.setProperty("single",!0)):(this.isSingle=!1,this._buttonBinding.setPopup(this._popupBinding),this.deleteProperty("single"),SelectorButtonBinding.superclass.populateFromList.call(this,a))},SelectorButtonBinding.prototype.clear=function(a){SelectorButtonBinding.superclass.clear.call(this,a),this.isSingle=!1},SlideInViewBinding.prototype=new ViewBinding,SlideInViewBinding.prototype.constructor=SlideInViewBinding,SlideInViewBinding.superclass=ViewBinding.prototype,SlideInViewBinding.TRANSITION_CLASSNAME="transition",SlideInViewBinding.VIEWSET_ID="slideinviews",SlideInViewBinding.VIEWSET_CLASSNAME="slidein",SlideInViewBinding.prototype.toString=function(){return"[SlideInViewBinding]"},SlideInViewBinding.prototype.onBindingAttach=function(){SlideInViewBinding.superclass.onBindingAttach.call(this),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.addActionListener(this.responseAction,this)},SlideInViewBinding.prototype.slideToBinding=function(a){this._snapBinding=a,this._isViewBindingInitialized||this.initialize()},SlideInViewBinding.prototype.show=function(){if(!this.isVisible){var a=this._snapBinding.boxObject.getDimension();this.bindingElement.style.left=String(a.w)+"px",this.attachClassName(SlideInViewBinding.TRANSITION_CLASSNAME)}SlideInViewBinding.superclass.show.call(this)},SlideInViewBinding.prototype.handleAction=function(a){SlideInViewBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case this.responseAction:if(this.getContentWindow()===b.bindingWindow){var c=this;setTimeout(function(){c.dispose()},0)}a.consume()}},SlideInViewBinding.prototype.handleBroadcast=function(a,b){switch(SlideInViewBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:1==this.isVisible&&this.updatePositionDimension()}},SlideInViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:view",a),c=UserInterface.registerBinding(b,SlideInViewBinding);c.windowBinding=c.add(WindowBinding.newInstance(a));var d=c.bindingWindow.bindingMap[SlideInViewBinding.VIEWSET_ID];if(null==d){var e=UserInterface.getBinding(c.bindingDocument.body),f=DOMUtil.createElementNS(Constants.NS_UI,"ui:viewset",c.bindingDocument);f.setAttribute("id",SlideInViewBinding.VIEWSET_ID),d=UserInterface.registerBinding(f,ViewSetBinding),d.bindingElement.style.zIndex=5,d.attachClassName(SlideInViewBinding.VIEWSET_CLASSNAME),e.bindingElement.insertBefore(d.bindingElement,e.bindingElement.firstChild),d.attach()}return d.add(c),c},SlideInButtonBinding.prototype=new ToolBarButtonBinding,SlideInButtonBinding.prototype.constructor=SlideInButtonBinding,SlideInButtonBinding.superclass=ToolBarButtonBinding.prototype,SlideInButtonBinding.prototype.toString=function(){return"[SlideInButtonBinding]"},SlideInButtonBinding.prototype.onBindingAttach=function(){SlideInButtonBinding.superclass.onBindingAttach.call(this)},SlideInButtonBinding.prototype.handleBroadcast=function(a,b){SlideInButtonBinding.superclass.handleBroadcast.call(this,a,b)},SlideInButtonBinding.prototype.oncommand=function(){var a=this.getProperty("handle"),b=this.getProperty("url"),c=null;if(null!=a?c=ViewDefinitions[a]:null!=b&&(c=new HostedViewDefinition({url:b})),null!=c){var d=UserInterface.getBinding(this.bindingDocument.body);this._viewBinding=SlideInViewBinding.newInstance(this.bindingDocument),this._viewBinding.setDefinition(c),this._viewBinding.attach(),this._viewBinding.snapToBinding(d)}},SlideInButtonBinding.prototype.setURL=function(a){this.setProperty("url",a)};
//# sourceMappingURL=top.js.map